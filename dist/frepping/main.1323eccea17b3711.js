"use strict";(self.webpackChunkfrepping=self.webpackChunkfrepping||[]).push([[792],{934:()=>{function en(n){return"function"==typeof n}function Ql(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Tf=Ql(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function eu(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class $i{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const o of t)o.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(en(i))try{i()}catch(o){e=o instanceof Tf?o.errors:[o]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const o of r)try{Ub(o)}catch(s){e=e??[],s instanceof Tf?e=[...e,...s.errors]:e.push(s)}}if(e)throw new Tf(e)}}add(e){var t;if(e&&e!==this)if(this.closed)Ub(e);else{if(e instanceof $i){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&eu(t,e)}remove(e){const{_finalizers:t}=this;t&&eu(t,e),e instanceof $i&&e._removeParent(this)}}$i.EMPTY=(()=>{const n=new $i;return n.closed=!0,n})();const Fb=$i.EMPTY;function kb(n){return n instanceof $i||n&&"closed"in n&&en(n.remove)&&en(n.add)&&en(n.unsubscribe)}function Ub(n){en(n)?n():n.unsubscribe()}const Zs={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Af={setTimeout(n,e,...t){const{delegate:i}=Af;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=Af;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Bb(n){Af.setTimeout(()=>{const{onUnhandledError:e}=Zs;if(!e)throw n;e(n)})}function ym(){}const m3=Mm("C",void 0,void 0);function Mm(n,e,t){return{kind:n,value:e,error:t}}let Ks=null;function Of(n){if(Zs.useDeprecatedSynchronousErrorHandling){const e=!Ks;if(e&&(Ks={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=Ks;if(Ks=null,t)throw i}}else n()}class bm extends $i{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,kb(e)&&e.add(this)):this.destination=C3}static create(e,t,i){return new tu(e,t,i)}next(e){this.isStopped?wm(function v3(n){return Mm("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?wm(function _3(n){return Mm("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?wm(m3,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const y3=Function.prototype.bind;function Cm(n,e){return y3.call(n,e)}class M3{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Df(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Df(i)}else Df(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Df(t)}}}class tu extends bm{constructor(e,t,i){let r;if(super(),en(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let o;this&&Zs.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&Cm(e.next,o),error:e.error&&Cm(e.error,o),complete:e.complete&&Cm(e.complete,o)}):r=e}this.destination=new M3(r)}}function Df(n){Zs.useDeprecatedSynchronousErrorHandling?function x3(n){Zs.useDeprecatedSynchronousErrorHandling&&Ks&&(Ks.errorThrown=!0,Ks.error=n)}(n):Bb(n)}function wm(n,e){const{onStoppedNotification:t}=Zs;t&&Af.setTimeout(()=>t(n,e))}const C3={closed:!0,next:ym,error:function b3(n){throw n},complete:ym},Sm="function"==typeof Symbol&&Symbol.observable||"@@observable";function ds(n){return n}function Vb(n){return 0===n.length?ds:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let Ln=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const o=function P3(n){return n&&n instanceof bm||function S3(n){return n&&en(n.next)&&en(n.error)&&en(n.complete)}(n)&&kb(n)}(t)?t:new tu(t,i,r);return Of(()=>{const{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=zb(i))((r,o)=>{const s=new tu({next:a=>{try{t(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[Sm](){return this}pipe(...t){return Vb(t)(this)}toPromise(t){return new(t=zb(t))((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return n.create=e=>new n(e),n})();function zb(n){var e;return null!==(e=n??Zs.Promise)&&void 0!==e?e:Promise}const E3=Ql(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Or=(()=>{class n extends Ln{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new Hb(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new E3}next(t){Of(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){Of(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Of(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:o}=this;return i||r?Fb:(this.currentObservers=null,o.push(t),new $i(()=>{this.currentObservers=null,eu(o,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:o}=this;i?t.error(r):o&&t.complete()}asObservable(){const t=new Ln;return t.source=this,t}}return n.create=(e,t)=>new Hb(e,t),n})();class Hb extends Or{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:Fb}}function Gb(n){return en(n?.lift)}function Vn(n){return e=>{if(Gb(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Fn(n,e,t,i,r){return new T3(n,e,t,i,r)}class T3 extends bm{constructor(e,t,i,r,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=r?function(a){try{r(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function nn(n,e){return Vn((t,i)=>{let r=0;t.subscribe(Fn(i,o=>{i.next(n.call(e,o,r++))}))})}function fs(n){return this instanceof fs?(this.v=n,this):new fs(n)}function qb(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function Am(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(s){return new Promise(function(a,c){!function r(o,s,a,c){Promise.resolve(c).then(function(l){o({value:l,done:a})},s)}(a,c,(s=n[o](s)).done,s.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const Xb=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Yb(n){return en(n?.then)}function Zb(n){return en(n[Sm])}function Kb(n){return Symbol.asyncIterator&&en(n?.[Symbol.asyncIterator])}function Jb(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Qb=function tN(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function eC(n){return en(n?.[Qb])}function tC(n){return function $b(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),o=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function s(h){return function(p){return Promise.resolve(p).then(h,d)}}),r[Symbol.asyncIterator]=function(){return this},r;function a(h,p){i[h]&&(r[h]=function(_){return new Promise(function(m,g){o.push([h,_,m,g])>1||c(h,_)})},p&&(r[h]=p(r[h])))}function c(h,p){try{!function l(h){h.value instanceof fs?Promise.resolve(h.value.v).then(u,d):f(o[0][2],h)}(i[h](p))}catch(_){f(o[0][3],_)}}function u(h){c("next",h)}function d(h){c("throw",h)}function f(h,p){h(p),o.shift(),o.length&&c(o[0][0],o[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield fs(t.read());if(r)return yield fs(void 0);yield yield fs(i)}}finally{t.releaseLock()}})}function nC(n){return en(n?.getReader)}function qi(n){if(n instanceof Ln)return n;if(null!=n){if(Zb(n))return function nN(n){return new Ln(e=>{const t=n[Sm]();if(en(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(Xb(n))return function iN(n){return new Ln(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(Yb(n))return function rN(n){return new Ln(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Bb)})}(n);if(Kb(n))return iC(n);if(eC(n))return function oN(n){return new Ln(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(nC(n))return function sN(n){return iC(tC(n))}(n)}throw Jb(n)}function iC(n){return new Ln(e=>{(function aN(n,e){var t,i,r,o;return function jb(n,e,t,i){return new(t||(t=Promise))(function(o,s){function a(u){try{l(i.next(u))}catch(d){s(d)}}function c(u){try{l(i.throw(u))}catch(d){s(d)}}function l(u){u.done?o(u.value):function r(o){return o instanceof t?o:new t(function(s){s(o)})}(u.value).then(a,c)}l((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=qb(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=t.return)&&(yield o.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function Ao(n,e,t,i=0,r=!1){const o=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(o),!r)return o}function Jn(n,e,t=1/0){return en(e)?Jn((i,r)=>nn((o,s)=>e(i,o,r,s))(qi(n(i,r))),t):("number"==typeof e&&(t=e),Vn((i,r)=>function cN(n,e,t,i,r,o,s,a){const c=[];let l=0,u=0,d=!1;const f=()=>{d&&!c.length&&!l&&e.complete()},h=_=>l<i?p(_):c.push(_),p=_=>{o&&e.next(_),l++;let m=!1;qi(t(_,u++)).subscribe(Fn(e,g=>{r?.(g),o?h(g):e.next(g)},()=>{m=!0},void 0,()=>{if(m)try{for(l--;c.length&&l<i;){const g=c.shift();s?Ao(e,s,()=>p(g)):p(g)}f()}catch(g){e.error(g)}}))};return n.subscribe(Fn(e,h,()=>{d=!0,f()})),()=>{a?.()}}(i,r,n,t)))}function Ka(n=1/0){return Jn(ds,n)}const Zr=new Ln(n=>n.complete());function Dm(n){return n[n.length-1]}function rC(n){return en(Dm(n))?n.pop():void 0}function nu(n){return function uN(n){return n&&en(n.schedule)}(Dm(n))?n.pop():void 0}function oC(n,e=0){return Vn((t,i)=>{t.subscribe(Fn(i,r=>Ao(i,n,()=>i.next(r),e),()=>Ao(i,n,()=>i.complete(),e),r=>Ao(i,n,()=>i.error(r),e)))})}function sC(n,e=0){return Vn((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function aC(n,e){if(!n)throw new Error("Iterable cannot be null");return new Ln(t=>{Ao(t,e,()=>{const i=n[Symbol.asyncIterator]();Ao(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function qn(n,e){return e?function _N(n,e){if(null!=n){if(Zb(n))return function fN(n,e){return qi(n).pipe(sC(e),oC(e))}(n,e);if(Xb(n))return function pN(n,e){return new Ln(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(Yb(n))return function hN(n,e){return qi(n).pipe(sC(e),oC(e))}(n,e);if(Kb(n))return aC(n,e);if(eC(n))return function gN(n,e){return new Ln(t=>{let i;return Ao(t,e,()=>{i=n[Qb](),Ao(t,e,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){return void t.error(s)}o?t.complete():t.next(r)},0,!0)}),()=>en(i?.return)&&i.return()})}(n,e);if(nC(n))return function mN(n,e){return aC(tC(n),e)}(n,e)}throw Jb(n)}(n,e):qi(n)}class Xi extends Or{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}function ht(...n){return qn(n,nu(n))}function cC(n={}){const{connector:e=(()=>new Or),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return o=>{let s,a,c,l=0,u=!1,d=!1;const f=()=>{a?.unsubscribe(),a=void 0},h=()=>{f(),s=c=void 0,u=d=!1},p=()=>{const _=s;h(),_?.unsubscribe()};return Vn((_,m)=>{l++,!d&&!u&&f();const g=c=c??e();m.add(()=>{l--,0===l&&!d&&!u&&(a=Im(p,r))}),g.subscribe(m),!s&&l>0&&(s=new tu({next:v=>g.next(v),error:v=>{d=!0,f(),a=Im(h,t,v),g.error(v)},complete:()=>{u=!0,f(),a=Im(h,i),g.complete()}}),qi(_).subscribe(s))})(o)}}function Im(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new tu({next:()=>{i.unsubscribe(),n()}});return qi(e(...t)).subscribe(i)}function Kr(n,e){return Vn((t,i)=>{let r=null,o=0,s=!1;const a=()=>s&&!r&&i.complete();t.subscribe(Fn(i,c=>{r?.unsubscribe();let l=0;const u=o++;qi(n(c,u)).subscribe(r=Fn(i,d=>i.next(e?e(c,d,u,l++):d),()=>{r=null,a()}))},()=>{s=!0,a()}))})}function yN(n,e){return n===e}function Xt(n){for(let e in n)if(n[e]===Xt)return e;throw Error("Could not find renamed property on target object.")}function If(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function zn(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(zn).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function Rm(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const MN=Xt({__forward_ref__:Xt});function cn(n){return n.__forward_ref__=cn,n.toString=function(){return zn(this())},n}function dt(n){return Nm(n)?n():n}function Nm(n){return"function"==typeof n&&n.hasOwnProperty(MN)&&n.__forward_ref__===cn}function Lm(n){return n&&!!n.\u0275providers}const lC="https://g.co/ng/security#xss";class de extends Error{constructor(e,t){super(function Rf(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function gt(n){return"string"==typeof n?n:null==n?"":String(n)}function Fm(n,e){throw new de(-201,!1)}function dr(n,e){null==n&&function ct(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function et(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function fr(n){return{providers:n.providers||[],imports:n.imports||[]}}function Nf(n){return uC(n,Ff)||uC(n,dC)}function uC(n,e){return n.hasOwnProperty(e)?n[e]:null}function Lf(n){return n&&(n.hasOwnProperty(km)||n.hasOwnProperty(AN))?n[km]:null}const Ff=Xt({\u0275prov:Xt}),km=Xt({\u0275inj:Xt}),dC=Xt({ngInjectableDef:Xt}),AN=Xt({ngInjectorDef:Xt});var Dt=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(Dt||{});let Um;function Oi(n){const e=Um;return Um=n,e}function hC(n,e,t){const i=Nf(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&Dt.Optional?null:void 0!==e?e:void Fm(zn(n))}const ln=globalThis;class Ve{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=et({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const iu={},Gm="__NG_DI_FLAG__",kf="ngTempTokenPath",IN=/\n/gm,gC="__source";let Ja;function hs(n){const e=Ja;return Ja=n,e}function LN(n,e=Dt.Default){if(void 0===Ja)throw new de(-203,!1);return null===Ja?hC(n,void 0,e):Ja.get(n,e&Dt.Optional?null:void 0,e)}function ot(n,e=Dt.Default){return(function fC(){return Um}()||LN)(dt(n),e)}function Be(n,e=Dt.Default){return ot(n,Uf(e))}function Uf(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function jm(n){const e=[];for(let t=0;t<n.length;t++){const i=dt(n[t]);if(Array.isArray(i)){if(0===i.length)throw new de(900,!1);let r,o=Dt.Default;for(let s=0;s<i.length;s++){const a=i[s],c=FN(a);"number"==typeof c?-1===c?r=a.token:o|=c:r=a}e.push(ot(r,o))}else e.push(ot(i))}return e}function ru(n,e){return n[Gm]=e,n.prototype[Gm]=e,n}function FN(n){return n[Gm]}function Oo(n){return{toString:n}.toString()}var Bf=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(Bf||{}),Dr=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Dr||{});const Jr={},Bt=[],Vf=Xt({\u0275cmp:Xt}),Wm=Xt({\u0275dir:Xt}),$m=Xt({\u0275pipe:Xt}),_C=Xt({\u0275mod:Xt}),Do=Xt({\u0275fac:Xt}),ou=Xt({__NG_ELEMENT_ID__:Xt}),vC=Xt({__NG_ENV_ID__:Xt});function xC(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const o=e.length;if(r+o===i||n.charCodeAt(r+o)<=32)return r}t=r+1}}function qm(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const o=t[i++],s=t[i++],a=t[i++];n.setAttribute(e,s,a,o)}else{const o=r,s=t[++i];MC(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),i++}}return i}function yC(n){return 3===n||4===n||6===n}function MC(n){return 64===n.charCodeAt(0)}function su(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||bC(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function bC(n,e,t,i,r){let o=0,s=n.length;if(-1===e)s=-1;else for(;o<n.length;){const a=n[o++];if("number"==typeof a){if(a===e){s=-1;break}if(a>e){s=o-1;break}}}for(;o<n.length;){const a=n[o];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[o+1]=r));if(i===n[o+1])return void(n[o+2]=r)}o++,null!==i&&o++,null!==r&&o++}-1!==s&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),null!==i&&n.splice(o++,0,i),null!==r&&n.splice(o++,0,r)}const CC="ng-template";function BN(n,e,t){let i=0,r=!0;for(;i<n.length;){let o=n[i++];if("string"==typeof o&&r){const s=n[i++];if(t&&"class"===o&&-1!==xC(s.toLowerCase(),e,0))return!0}else{if(1===o){for(;i<n.length&&"string"==typeof(o=n[i++]);)if(o.toLowerCase()===e)return!0;return!1}"number"==typeof o&&(r=!1)}}return!1}function wC(n){return 4===n.type&&n.value!==CC}function VN(n,e,t){return e===(4!==n.type||t?n.value:CC)}function zN(n,e,t){let i=4;const r=n.attrs||[],o=function jN(n){for(let e=0;e<n.length;e++)if(yC(n[e]))return e;return n.length}(r);let s=!1;for(let a=0;a<e.length;a++){const c=e[a];if("number"!=typeof c){if(!s)if(4&i){if(i=2|1&i,""!==c&&!VN(n,c,t)||""===c&&1===e.length){if(Ir(i))return!1;s=!0}}else{const l=8&i?c:e[++a];if(8&i&&null!==n.attrs){if(!BN(n.attrs,l,t)){if(Ir(i))return!1;s=!0}continue}const d=HN(8&i?"class":c,r,wC(n),t);if(-1===d){if(Ir(i))return!1;s=!0;continue}if(""!==l){let f;f=d>o?"":r[d+1].toLowerCase();const h=8&i?f:null;if(h&&-1!==xC(h,l,0)||2&i&&l!==f){if(Ir(i))return!1;s=!0}}}}else{if(!s&&!Ir(i)&&!Ir(c))return!1;if(s&&Ir(c))continue;s=!1,i=c|1&i}}return Ir(i)||s}function Ir(n){return 0==(1&n)}function HN(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let o=!1;for(;r<e.length;){const s=e[r];if(s===n)return r;if(3===s||6===s)o=!0;else{if(1===s||2===s){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===s)break;if(0===s){r+=4;continue}}r+=o?1:2}return-1}return function WN(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function SC(n,e,t=!1){for(let i=0;i<e.length;i++)if(zN(n,e[i],t))return!0;return!1}function PC(n,e){return n?":not("+e.trim()+")":e}function qN(n){let e=n[0],t=1,i=2,r="",o=!1;for(;t<n.length;){let s=n[t];if("string"==typeof s)if(2&i){const a=n[++t];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+s:4&i&&(r+=" "+s);else""!==r&&!Ir(s)&&(e+=PC(o,r),r=""),i=s,o=o||!Ir(i);t++}return""!==r&&(e+=PC(o,r)),e}function Zi(n){return Oo(()=>{const e=TC(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Bf.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Dr.Emulated,styles:n.styles||Bt,_:null,schemas:n.schemas||null,tView:null,id:""};AC(t);const i=n.dependencies;return t.directiveDefs=zf(i,!1),t.pipeDefs=zf(i,!0),t.id=function tL(n){let e=0;const t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const r of t)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function KN(n){return kt(n)||Qn(n)}function JN(n){return null!==n}function Rr(n){return Oo(()=>({type:n.type,bootstrap:n.bootstrap||Bt,declarations:n.declarations||Bt,imports:n.imports||Bt,exports:n.exports||Bt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function EC(n,e){if(null==n)return Jr;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],o=r;Array.isArray(r)&&(o=r[1],r=r[0]),t[r]=i,e&&(e[r]=o)}return t}function ft(n){return Oo(()=>{const e=TC(n);return AC(e),e})}function Di(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function kt(n){return n[Vf]||null}function Qn(n){return n[Wm]||null}function pi(n){return n[$m]||null}function Ki(n,e){const t=n[_C]||null;if(!t&&!0===e)throw new Error(`Type ${zn(n)} does not have '\u0275mod' property.`);return t}function TC(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||Jr,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||Bt,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:EC(n.inputs,e),outputs:EC(n.outputs)}}function AC(n){n.features?.forEach(e=>e(n))}function zf(n,e){if(!n)return null;const t=e?pi:KN;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter(JN)}const Sn=0,De=1,Mt=2,yn=3,Nr=4,au=5,oi=6,ec=7,An=8,ps=9,tc=10,mt=11,cu=12,OC=13,nc=14,On=15,lu=16,ic=17,Qr=18,uu=19,DC=20,gs=21,Io=22,du=23,fu=24,It=25,Xm=1,IC=2,eo=7,rc=9,ei=11;function Ii(n){return Array.isArray(n)&&"object"==typeof n[Xm]}function gi(n){return Array.isArray(n)&&!0===n[Xm]}function Ym(n){return 0!=(4&n.flags)}function Qs(n){return n.componentOffset>-1}function Gf(n){return 1==(1&n.flags)}function Lr(n){return!!n.template}function Zm(n){return 0!=(512&n[Mt])}function ea(n,e){return n.hasOwnProperty(Do)?n[Do]:null}let ti=null,jf=!1;function hr(n){const e=ti;return ti=n,e}const LC={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function kC(n){if(!pu(n)||n.dirty){if(!n.producerMustRecompute(n)&&!VC(n))return void(n.dirty=!1);n.producerRecomputeValue(n),n.dirty=!1}}function BC(n){n.dirty=!0,function UC(n){if(void 0===n.liveConsumerNode)return;const e=jf;jf=!0;try{for(const t of n.liveConsumerNode)t.dirty||BC(t)}finally{jf=e}}(n),n.consumerMarkedDirty?.(n)}function Jm(n){return n&&(n.nextProducerIndex=0),hr(n)}function Qm(n,e){if(hr(e),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(pu(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)Wf(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function VC(n){oc(n);for(let e=0;e<n.producerNode.length;e++){const t=n.producerNode[e],i=n.producerLastReadVersion[e];if(i!==t.version||(kC(t),i!==t.version))return!0}return!1}function zC(n){if(oc(n),pu(n))for(let e=0;e<n.producerNode.length;e++)Wf(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function Wf(n,e){if(function GC(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}(n),oc(n),1===n.liveConsumerNode.length)for(let i=0;i<n.producerNode.length;i++)Wf(n.producerNode[i],n.producerIndexOfThis[i]);const t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){const i=n.liveConsumerIndexOfThis[e],r=n.liveConsumerNode[e];oc(r),r.producerIndexOfThis[i]=e}}function pu(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function oc(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}let jC=null;const XC=()=>{},pL=(()=>({...LC,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:n=>{n.schedule(n.ref)},hasRun:!1,cleanupFn:XC}))();class gL{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function pr(){return YC}function YC(n){return n.type.prototype.ngOnChanges&&(n.setInput=_L),mL}function mL(){const n=KC(this),e=n?.current;if(e){const t=n.previous;if(t===Jr)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function _L(n,e,t,i){const r=this.declaredInputs[t],o=KC(n)||function vL(n,e){return n[ZC]=e}(n,{previous:Jr,current:null}),s=o.current||(o.current={}),a=o.previous,c=a[r];s[r]=new gL(c&&c.currentValue,e,a===Jr),n[i]=e}pr.ngInherit=!0;const ZC="__ngSimpleChanges__";function KC(n){return n[ZC]||null}const to=function(n,e,t){};function un(n){for(;Array.isArray(n);)n=n[Sn];return n}function $f(n,e){return un(e[n])}function Ri(n,e){return un(e[n.index])}function e1(n,e){return n.data[e]}function sc(n,e){return n[e]}function Ji(n,e){const t=e[n];return Ii(t)?t:t[Sn]}function _s(n,e){return null==e?null:n[e]}function t1(n){n[ic]=0}function wL(n){1024&n[Mt]||(n[Mt]|=1024,i1(n,1))}function n1(n){1024&n[Mt]&&(n[Mt]&=-1025,i1(n,-1))}function i1(n,e){let t=n[yn];if(null===t)return;t[au]+=e;let i=t;for(t=t[yn];null!==t&&(1===e&&1===i[au]||-1===e&&0===i[au]);)t[au]+=e,i=t,t=t[yn]}const lt={lFrame:p1(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function s1(){return lt.bindingsEnabled}function ne(){return lt.lFrame.lView}function Ut(){return lt.lFrame.tView}function qe(n){return lt.lFrame.contextLView=n,n[An]}function Xe(n){return lt.lFrame.contextLView=null,n}function ni(){let n=a1();for(;null!==n&&64===n.type;)n=n.parent;return n}function a1(){return lt.lFrame.currentTNode}function no(n,e){const t=lt.lFrame;t.currentTNode=n,t.isParent=e}function r_(){return lt.lFrame.isParent}function o_(){lt.lFrame.isParent=!1}function mi(){const n=lt.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function cc(){return lt.lFrame.bindingIndex++}function No(n){const e=lt.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function FL(n,e){const t=lt.lFrame;t.bindingIndex=t.bindingRootIndex=n,s_(e)}function s_(n){lt.lFrame.currentDirectiveIndex=n}function d1(){return lt.lFrame.currentQueryIndex}function c_(n){lt.lFrame.currentQueryIndex=n}function UL(n){const e=n[De];return 2===e.type?e.declTNode:1===e.type?n[oi]:null}function f1(n,e,t){if(t&Dt.SkipSelf){let r=e,o=n;for(;!(r=r.parent,null!==r||t&Dt.Host||(r=UL(o),null===r||(o=o[nc],10&r.type))););if(null===r)return!1;e=r,n=o}const i=lt.lFrame=h1();return i.currentTNode=e,i.lView=n,!0}function l_(n){const e=h1(),t=n[De];lt.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function h1(){const n=lt.lFrame,e=null===n?null:n.child;return null===e?p1(n):e}function p1(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function g1(){const n=lt.lFrame;return lt.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const m1=g1;function u_(){const n=g1();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function _i(){return lt.lFrame.selectedIndex}function ta(n){lt.lFrame.selectedIndex=n}function bn(){const n=lt.lFrame;return e1(n.tView,n.selectedIndex)}let v1=!0;function qf(){return v1}function vs(n){v1=n}function Xf(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),null!=u&&(n.destroyHooks??=[]).push(t,u)}}function Yf(n,e,t){x1(n,e,3,t)}function Zf(n,e,t,i){(3&n[Mt])===t&&x1(n,e,t,i)}function d_(n,e){let t=n[Mt];(3&t)===e&&(t&=8191,t+=1,n[Mt]=t)}function x1(n,e,t,i){const o=i??-1,s=e.length-1;let a=0;for(let c=void 0!==i?65535&n[ic]:0;c<s;c++)if("number"==typeof e[c+1]){if(a=e[c],null!=i&&a>=i)break}else e[c]<0&&(n[ic]+=65536),(a<o||-1==o)&&($L(n,t,e,c),n[ic]=(4294901760&n[ic])+c+2),c++}function y1(n,e){to(4,n,e);const t=hr(null);try{e.call(n)}finally{hr(t),to(5,n,e)}}function $L(n,e,t,i){const r=t[i]<0,o=t[i+1],a=n[r?-t[i]:t[i]];r?n[Mt]>>13<n[ic]>>16&&(3&n[Mt])===e&&(n[Mt]+=8192,y1(a,o)):y1(a,o)}const lc=-1;class mu{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function h_(n){return n!==lc}function _u(n){return 32767&n}function vu(n,e){let t=function ZL(n){return n>>16}(n),i=e;for(;t>0;)i=i[nc],t--;return i}let p_=!0;function Kf(n){const e=p_;return p_=n,e}const M1=255,b1=5;let KL=0;const io={};function Jf(n,e){const t=C1(n,e);if(-1!==t)return t;const i=e[De];i.firstCreatePass&&(n.injectorIndex=e.length,g_(i.data,n),g_(e,null),g_(i.blueprint,null));const r=Qf(n,e),o=n.injectorIndex;if(h_(r)){const s=_u(r),a=vu(r,e),c=a[De].data;for(let l=0;l<8;l++)e[o+l]=a[s+l]|c[s+l]}return e[o+8]=r,o}function g_(n,e){n.push(0,0,0,0,0,0,0,0,e)}function C1(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function Qf(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=O1(r),null===i)return lc;if(t++,r=r[nc],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return lc}function m_(n,e,t){!function JL(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(ou)&&(i=t[ou]),null==i&&(i=t[ou]=KL++);const r=i&M1;e.data[n+(r>>b1)]|=1<<r}(n,e,t)}function w1(n,e,t){if(t&Dt.Optional||void 0!==n)return n;Fm()}function S1(n,e,t,i){if(t&Dt.Optional&&void 0===i&&(i=null),!(t&(Dt.Self|Dt.Host))){const r=n[ps],o=Oi(void 0);try{return r?r.get(e,i,t&Dt.Optional):hC(e,i,t&Dt.Optional)}finally{Oi(o)}}return w1(i,0,t)}function P1(n,e,t,i=Dt.Default,r){if(null!==n){if(2048&e[Mt]&&!(i&Dt.Self)){const s=function rF(n,e,t,i,r){let o=n,s=e;for(;null!==o&&null!==s&&2048&s[Mt]&&!(512&s[Mt]);){const a=E1(o,s,t,i|Dt.Self,io);if(a!==io)return a;let c=o.parent;if(!c){const l=s[DC];if(l){const u=l.get(t,io,i);if(u!==io)return u}c=O1(s),s=s[nc]}o=c}return r}(n,e,t,i,io);if(s!==io)return s}const o=E1(n,e,t,i,io);if(o!==io)return o}return S1(e,t,i,r)}function E1(n,e,t,i,r){const o=function tF(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(ou)?n[ou]:void 0;return"number"==typeof e?e>=0?e&M1:iF:e}(t);if("function"==typeof o){if(!f1(e,n,i))return i&Dt.Host?w1(r,0,i):S1(e,t,i,r);try{let s;if(s=o(i),null!=s||i&Dt.Optional)return s;Fm()}finally{m1()}}else if("number"==typeof o){let s=null,a=C1(n,e),c=lc,l=i&Dt.Host?e[On][oi]:null;for((-1===a||i&Dt.SkipSelf)&&(c=-1===a?Qf(n,e):e[a+8],c!==lc&&A1(i,!1)?(s=e[De],a=_u(c),e=vu(c,e)):a=-1);-1!==a;){const u=e[De];if(T1(o,a,u.data)){const d=eF(a,e,t,s,i,l);if(d!==io)return d}c=e[a+8],c!==lc&&A1(i,e[De].data[a+8]===l)&&T1(o,a,e)?(s=u,a=_u(c),e=vu(c,e)):a=-1}}return r}function eF(n,e,t,i,r,o){const s=e[De],a=s.data[n+8],u=eh(a,s,t,null==i?Qs(a)&&p_:i!=s&&0!=(3&a.type),r&Dt.Host&&o===a);return null!==u?na(e,s,u,a):io}function eh(n,e,t,i,r){const o=n.providerIndexes,s=e.data,a=1048575&o,c=n.directiveStart,u=o>>20,f=r?a+u:n.directiveEnd;for(let h=i?a:a+u;h<f;h++){const p=s[h];if(h<c&&t===p||h>=c&&p.type===t)return h}if(r){const h=s[c];if(h&&Lr(h)&&h.type===t)return c}return null}function na(n,e,t,i){let r=n[t];const o=e.data;if(function qL(n){return n instanceof mu}(r)){const s=r;s.resolving&&function bN(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new de(-200,`Circular dependency in DI detected for ${n}${t}`)}(function jt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():gt(n)}(o[t]));const a=Kf(s.canSeeViewProviders);s.resolving=!0;const l=s.injectImpl?Oi(s.injectImpl):null;f1(n,i,Dt.Default);try{r=n[t]=s.factory(void 0,o,n,i),e.firstCreatePass&&t>=i.directiveStart&&function WL(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=e.type.prototype;if(i){const s=YC(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}r&&(t.preOrderHooks??=[]).push(0-n,r),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}(t,o[t],e)}finally{null!==l&&Oi(l),Kf(a),s.resolving=!1,m1()}}return r}function T1(n,e,t){return!!(t[e+(n>>b1)]&1<<n)}function A1(n,e){return!(n&Dt.Self||n&Dt.Host&&e)}class vi{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return P1(this._tNode,this._lView,e,Uf(i),t)}}function iF(){return new vi(ni(),ne())}function ii(n){return Oo(()=>{const e=n.prototype.constructor,t=e[Do]||__(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const o=r[Do]||__(r);if(o&&o!==t)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function __(n){return Nm(n)?()=>{const e=__(dt(n));return e&&e()}:ea(n)}function O1(n){const e=n[De],t=e.type;return 2===t?e.declTNode:1===t?n[oi]:null}const dc="__parameters__";function hc(n,e,t){return Oo(()=>{const i=function v_(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...o){if(this instanceof r)return i.apply(this,o),this;const s=new r(...o);return a.annotation=s,a;function a(c,l,u){const d=c.hasOwnProperty(dc)?c[dc]:Object.defineProperty(c,dc,{value:[]})[dc];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(s),c}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}function gc(n,e){n.forEach(t=>Array.isArray(t)?gc(t,e):e(t))}function I1(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function nh(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Qi(n,e,t){let i=mc(n,e);return i>=0?n[1|i]=t:(i=~i,function dF(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function x_(n,e){const t=mc(n,e);if(t>=0)return n[1|t]}function mc(n,e){return function R1(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const o=i+(r-i>>1),s=n[o<<t];if(e===s)return o<<t;s>e?r=o:i=o+1}return~(r<<t)}(n,e,1)}const rh=ru(hc("Optional"),8),oh=ru(hc("SkipSelf"),4);function uh(n){return 128==(128&n.flags)}var xs=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(xs||{});const IF=/^>|^->|<!--|-->|--!>|<!-$/g,RF=/(<|>)/g,NF="\u200b$1\u200b";const w_=new Map;let LF=0;const P_="__ngContext__";function si(n,e){Ii(e)?(n[P_]=e[uu],function kF(n){w_.set(n[uu],n)}(e)):n[P_]=e}let E_;function T_(n,e){return E_(n,e)}function wu(n){const e=n[yn];return gi(e)?e[yn]:e}function Q1(n){return tw(n[cu])}function ew(n){return tw(n[Nr])}function tw(n){for(;null!==n&&!gi(n);)n=n[Nr];return n}function xc(n,e,t,i,r){if(null!=i){let o,s=!1;gi(i)?o=i:Ii(i)&&(s=!0,i=i[Sn]);const a=un(i);0===n&&null!==t?null==r?ow(e,t,a):ia(e,t,a,r||null,!0):1===n&&null!==t?ia(e,t,a,r||null,!0):2===n?function _h(n,e,t){const i=gh(n,e);i&&function nk(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,a,s):3===n&&e.destroyNode(a),null!=o&&function ok(n,e,t,i,r){const o=t[eo];o!==un(t)&&xc(e,n,i,o,r);for(let a=ei;a<t.length;a++){const c=t[a];Pu(c[De],c,n,e,i,o)}}(e,n,o,t,r)}}function A_(n,e){return n.createComment(function W1(n){return n.replace(IF,e=>e.replace(RF,NF))}(e))}function hh(n,e,t){return n.createElement(e,t)}function iw(n,e){const t=n[rc],i=t.indexOf(e);n1(e),t.splice(i,1)}function ph(n,e){if(n.length<=ei)return;const t=ei+e,i=n[t];if(i){const r=i[lu];null!==r&&r!==n&&iw(r,i),e>0&&(n[t-1][Nr]=i[Nr]);const o=nh(n,ei+e);!function XF(n,e){Pu(n,e,e[mt],2,null,null),e[Sn]=null,e[oi]=null}(i[De],i);const s=o[Qr];null!==s&&s.detachView(o[De]),i[yn]=null,i[Nr]=null,i[Mt]&=-129}return i}function O_(n,e){if(!(256&e[Mt])){const t=e[mt];e[du]&&zC(e[du]),e[fu]&&zC(e[fu]),t.destroyNode&&Pu(n,e,t,3,null,null),function KF(n){let e=n[cu];if(!e)return D_(n[De],n);for(;e;){let t=null;if(Ii(e))t=e[cu];else{const i=e[ei];i&&(t=i)}if(!t){for(;e&&!e[Nr]&&e!==n;)Ii(e)&&D_(e[De],e),e=e[yn];null===e&&(e=n),Ii(e)&&D_(e[De],e),t=e&&e[Nr]}e=t}}(e)}}function D_(n,e){if(!(256&e[Mt])){e[Mt]&=-129,e[Mt]|=256,function tk(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof mu)){const o=t[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){const a=r[o[s]],c=o[s+1];to(4,a,c);try{c.call(a)}finally{to(5,a,c)}}else{to(4,r,o);try{o.call(r)}finally{to(5,r,o)}}}}}(n,e),function ek(n,e){const t=n.cleanup,i=e[ec];if(null!==t)for(let o=0;o<t.length-1;o+=2)if("string"==typeof t[o]){const s=t[o+3];s>=0?i[s]():i[-s].unsubscribe(),o+=2}else t[o].call(i[t[o+1]]);null!==i&&(e[ec]=null);const r=e[gs];if(null!==r){e[gs]=null;for(let o=0;o<r.length;o++)(0,r[o])()}}(n,e),1===e[De].type&&e[mt].destroy();const t=e[lu];if(null!==t&&gi(e[yn])){t!==e[yn]&&iw(t,e);const i=e[Qr];null!==i&&i.detachView(n)}!function UF(n){w_.delete(n[uu])}(e)}}function I_(n,e,t){return function rw(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[Sn];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:o}=n.data[i.directiveStart+r];if(o===Dr.None||o===Dr.Emulated)return null}return Ri(i,t)}}(n,e.parent,t)}function ia(n,e,t,i,r){n.insertBefore(e,t,i,r)}function ow(n,e,t){n.appendChild(e,t)}function sw(n,e,t,i,r){null!==i?ia(n,e,t,i,r):ow(n,e,t)}function gh(n,e){return n.parentNode(e)}let R_,k_,lw=function cw(n,e,t){return 40&n.type?Ri(n,t):null};function mh(n,e,t,i){const r=I_(n,i,e),o=e[mt],a=function aw(n,e,t){return lw(n,e,t)}(i.parent||e[oi],i,e);if(null!=r)if(Array.isArray(t))for(let c=0;c<t.length;c++)sw(o,r,t[c],a,!1);else sw(o,r,t,a,!1);void 0!==R_&&R_(o,i,e,t,r)}function Su(n,e){if(null!==e){const t=e.type;if(3&t)return Ri(e,n);if(4&t)return N_(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return Su(n,i);{const r=n[e.index];return gi(r)?N_(-1,r):un(r)}}if(32&t)return T_(e,n)()||un(n[e.index]);{const i=dw(n,e);return null!==i?Array.isArray(i)?i[0]:Su(wu(n[On]),i):Su(n,e.next)}}return null}function dw(n,e){return null!==e?n[On][oi].projection[e.projection]:null}function N_(n,e){const t=ei+n+1;if(t<e.length){const i=e[t],r=i[De].firstChild;if(null!==r)return Su(i,r)}return e[eo]}function L_(n,e,t,i,r,o,s){for(;null!=t;){const a=i[t.index],c=t.type;if(s&&0===e&&(a&&si(un(a),i),t.flags|=2),32!=(32&t.flags))if(8&c)L_(n,e,t.child,i,r,o,!1),xc(e,n,r,a,o);else if(32&c){const l=T_(t,i);let u;for(;u=l();)xc(e,n,r,u,o);xc(e,n,r,a,o)}else 16&c?hw(n,e,i,t,r,o):xc(e,n,r,a,o);t=s?t.projectionNext:t.next}}function Pu(n,e,t,i,r,o){L_(t,i,n.firstChild,e,r,o,!1)}function hw(n,e,t,i,r,o){const s=t[On],c=s[oi].projection[i.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++)xc(e,n,r,c[l],o);else{let l=c;const u=s[yn];uh(i)&&(l.flags|=128),L_(n,e,l,u,r,o,!0)}}function pw(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function gw(n,e,t){const{mergedAttrs:i,classes:r,styles:o}=t;null!==i&&qm(n,e,i),null!==r&&pw(n,e,r),null!==o&&function ak(n,e,t){n.setAttribute(e,"style",t)}(n,e,o)}class xw{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${lC})`}}function ys(n){return n instanceof xw?n.changingThisBreaksApplicationSecurity:n}const Mk=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var bc=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(bc||{});function ro(n){const e=function Au(){const n=ne();return n&&n[tc].sanitizer}();return e?e.sanitize(bc.URL,n)||"":function Eu(n,e){const t=function _k(n){return n instanceof xw&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${lC})`)}return t===e}(n,"URL")?ys(n):function B_(n){return(n=String(n)).match(Mk)?n:"unsafe:"+n}(gt(n))}const Ou=new Ve("ENVIRONMENT_INITIALIZER"),Tw=new Ve("INJECTOR",-1),Aw=new Ve("INJECTOR_DEF_TYPES");class G_{get(e,t=iu){if(t===iu){const i=new Error(`NullInjectorError: No provider for ${zn(e)}!`);throw i.name="NullInjectorError",i}return t}}function Nk(...n){return{\u0275providers:Dw(0,n),\u0275fromNgModule:!0}}function Dw(n,...e){const t=[],i=new Set;let r;const o=s=>{t.push(s)};return gc(e,s=>{const a=s;Mh(a,o,[],i)&&(r||=[],r.push(a))}),void 0!==r&&Iw(r,o),t}function Iw(n,e){for(let t=0;t<n.length;t++){const{ngModule:i,providers:r}=n[t];j_(r,o=>{e(o,i)})}}function Mh(n,e,t,i){if(!(n=dt(n)))return!1;let r=null,o=Lf(n);const s=!o&&kt(n);if(o||s){if(s&&!s.standalone)return!1;r=n}else{const c=n.ngModule;if(o=Lf(c),!o)return!1;r=c}const a=i.has(r);if(s){if(a)return!1;if(i.add(r),s.dependencies){const c="function"==typeof s.dependencies?s.dependencies():s.dependencies;for(const l of c)Mh(l,e,t,i)}}else{if(!o)return!1;{if(null!=o.imports&&!a){let l;i.add(r);try{gc(o.imports,u=>{Mh(u,e,t,i)&&(l||=[],l.push(u))})}finally{}void 0!==l&&Iw(l,e)}if(!a){const l=ea(r)||(()=>new r);e({provide:r,useFactory:l,deps:Bt},r),e({provide:Aw,useValue:r,multi:!0},r),e({provide:Ou,useValue:()=>ot(r),multi:!0},r)}const c=o.providers;if(null!=c&&!a){const l=n;j_(c,u=>{e(u,l)})}}}return r!==n&&void 0!==n.providers}function j_(n,e){for(let t of n)Lm(t)&&(t=t.\u0275providers),Array.isArray(t)?j_(t,e):e(t)}const Lk=Xt({provide:String,useValue:Xt});function W_(n){return null!==n&&"object"==typeof n&&Lk in n}function ra(n){return"function"==typeof n}const $_=new Ve("Set Injector scope."),bh={},kk={};let q_;function Ch(){return void 0===q_&&(q_=new G_),q_}class mr{}class Cc extends mr{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Y_(e,s=>this.processProvider(s)),this.records.set(Tw,wc(void 0,this)),r.has("environment")&&this.records.set(mr,wc(void 0,this));const o=this.records.get($_);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(Aw.multi,Bt,Dt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=hs(this),i=Oi(void 0);try{return e()}finally{hs(t),Oi(i)}}get(e,t=iu,i=Dt.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(vC))return e[vC](this);i=Uf(i);const o=hs(this),s=Oi(void 0);try{if(!(i&Dt.SkipSelf)){let c=this.records.get(e);if(void 0===c){const l=function Hk(n){return"function"==typeof n||"object"==typeof n&&n instanceof Ve}(e)&&Nf(e);c=l&&this.injectableDefInScope(l)?wc(X_(e),bh):null,this.records.set(e,c)}if(null!=c)return this.hydrate(e,c)}return(i&Dt.Self?Ch():this.parent).get(e,t=i&Dt.Optional&&t===iu?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[kf]=a[kf]||[]).unshift(zn(e)),o)throw a;return function kN(n,e,t,i){const r=n[kf];throw e[gC]&&r.unshift(e[gC]),n.message=function UN(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=zn(e);if(Array.isArray(e))r=e.map(zn).join(" -> ");else if("object"==typeof e){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+("string"==typeof a?JSON.stringify(a):zn(a)))}r=`{${o.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(IN,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[kf]=null,n}(a,e,"R3InjectorError",this.source)}throw a}finally{Oi(s),hs(o)}}resolveInjectorInitializers(){const e=hs(this),t=Oi(void 0);try{const r=this.get(Ou.multi,Bt,Dt.Self);for(const o of r)o()}finally{hs(e),Oi(t)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(zn(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new de(205,!1)}processProvider(e){let t=ra(e=dt(e))?e:dt(e&&e.provide);const i=function Bk(n){return W_(n)?wc(void 0,n.useValue):wc(Lw(n),bh)}(e);if(ra(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=wc(void 0,bh,!0),r.factory=()=>jm(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===bh&&(t.value=kk,t.value=t.factory()),"object"==typeof t.value&&t.value&&function zk(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=dt(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function X_(n){const e=Nf(n),t=null!==e?e.factory:ea(n);if(null!==t)return t;if(n instanceof Ve)throw new de(204,!1);if(n instanceof Function)return function Uk(n){const e=n.length;if(e>0)throw function Mu(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}(e,"?"),new de(204,!1);const t=function TN(n){return n&&(n[Ff]||n[dC])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new de(204,!1)}function Lw(n,e,t){let i;if(ra(n)){const r=dt(n);return ea(r)||X_(r)}if(W_(n))i=()=>dt(n.useValue);else if(function Nw(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...jm(n.deps||[]));else if(function Rw(n){return!(!n||!n.useExisting)}(n))i=()=>ot(dt(n.useExisting));else{const r=dt(n&&(n.useClass||n.provide));if(!function Vk(n){return!!n.deps}(n))return ea(r)||X_(r);i=()=>new r(...jm(n.deps))}return i}function wc(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Y_(n,e){for(const t of n)Array.isArray(t)?Y_(t,e):t&&Lm(t)?Y_(t.\u0275providers,e):e(t)}const wh=new Ve("AppId",{providedIn:"root",factory:()=>Gk}),Gk="ng",Fw=new Ve("Platform Initializer"),Sc=new Ve("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),kw=new Ve("CSP nonce",{providedIn:"root",factory:()=>function Mc(){if(void 0!==k_)return k_;if(typeof document<"u")return document;throw new de(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let Uw=(n,e,t)=>null;function r0(n,e,t=!1){return Uw(n,e,t)}class Qk{}class zw{}class tU{resolveComponentFactory(e){throw function eU(n){const e=Error(`No component factory found for ${zn(n)}.`);return e.ngComponent=n,e}(e)}}let Oh=(()=>{class n{static{this.NULL=new tU}}return n})();function nU(){return Tc(ni(),ne())}function Tc(n,e){return new er(Ri(n,e))}let er=(()=>{class n{constructor(t){this.nativeElement=t}static{this.__NG_ELEMENT_ID__=nU}}return n})();function iU(n){return n instanceof er?n.nativeElement:n}class Gw{}let oo=(()=>{class n{constructor(){this.destroyNode=null}static{this.__NG_ELEMENT_ID__=()=>function rU(){const n=ne(),t=Ji(ni().index,n);return(Ii(t)?t:n)[mt]}()}}return n})(),oU=(()=>{class n{static{this.\u0275prov=et({token:n,providedIn:"root",factory:()=>null})}}return n})();class Ru{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const sU=new Ru("16.2.12"),a0={};function qw(n,e=null,t=null,i){const r=Xw(n,e,t,i);return r.resolveInjectorInitializers(),r}function Xw(n,e=null,t=null,i,r=new Set){const o=[t||Bt,Nk(n)];return i=i||("object"==typeof n?void 0:zn(n)),new Cc(o,e||Ch(),i||null,r)}let tr=(()=>{class n{static{this.THROW_IF_NOT_FOUND=iu}static{this.NULL=new G_}static create(t,i){if(Array.isArray(t))return qw({name:""},i,t,"");{const r=t.name??"";return qw({name:r},t.parent,t.providers,r)}}static{this.\u0275prov=et({token:n,providedIn:"any",factory:()=>ot(Tw)})}static{this.__NG_ELEMENT_ID__=-1}}return n})();function l0(n){return n.ngOriginalError}class Fo{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&l0(e);for(;t&&l0(t);)t=l0(t);return t||null}}function u0(n){return e=>{setTimeout(n,void 0,e)}}const Cn=class pU extends Or{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let r=e,o=t||(()=>null),s=i;if(e&&"object"==typeof e){const c=e;r=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=u0(o),r&&(r=u0(r)),s&&(s=u0(s)));const a=super.subscribe({next:r,error:o,complete:s});return e instanceof $i&&e.add(a),a}};function Zw(...n){}class dn{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Cn(!1),this.onMicrotaskEmpty=new Cn(!1),this.onStable=new Cn(!1),this.onError=new Cn(!1),typeof Zone>"u")throw new de(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function gU(){const n="function"==typeof ln.requestAnimationFrame;let e=ln[n?"requestAnimationFrame":"setTimeout"],t=ln[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function vU(n){const e=()=>{!function _U(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(ln,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,f0(n),n.isCheckStableRunning=!0,d0(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),f0(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,o,s,a)=>{if(function yU(n){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0].data?.__ignore_ng_zone__}(a))return t.invokeTask(r,o,s,a);try{return Kw(n),t.invokeTask(r,o,s,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||n.shouldCoalesceRunChangeDetection)&&e(),Jw(n)}},onInvoke:(t,i,r,o,s,a,c)=>{try{return Kw(n),t.invoke(r,o,s,a,c)}finally{n.shouldCoalesceRunChangeDetection&&e(),Jw(n)}},onHasTask:(t,i,r,o)=>{t.hasTask(r,o),i===r&&("microTask"==o.change?(n._hasPendingMicrotasks=o.microTask,f0(n),d0(n)):"macroTask"==o.change&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(t,i,r,o)=>(t.handleError(r,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!dn.isInAngularZone())throw new de(909,!1)}static assertNotInAngularZone(){if(dn.isInAngularZone())throw new de(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,e,mU,Zw,Zw);try{return o.runTask(s,t,i)}finally{o.cancelTask(s)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const mU={};function d0(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function f0(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function Kw(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function Jw(n){n._nesting--,d0(n)}class xU{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Cn,this.onMicrotaskEmpty=new Cn,this.onStable=new Cn,this.onError=new Cn}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}const Qw=new Ve("",{providedIn:"root",factory:eS});function eS(){const n=Be(dn);let e=!0;return function vN(...n){const e=nu(n),t=function dN(n,e){return"number"==typeof Dm(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?qi(i[0]):Ka(t)(qn(i,e)):Zr}(new Ln(r=>{e=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{r.next(e),r.complete()})}),new Ln(r=>{let o;n.runOutsideAngular(()=>{o=n.onStable.subscribe(()=>{dn.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(e=!0,r.next(!0))})})});const s=n.onUnstable.subscribe(()=>{dn.assertInAngularZone(),e&&(e=!1,n.runOutsideAngular(()=>{r.next(!1)}))});return()=>{o.unsubscribe(),s.unsubscribe()}}).pipe(cC()))}function Nu(n){return n.ownerDocument.defaultView}function h0(n){return n.ownerDocument}function ko(n){return n instanceof Function?n():n}let p0=(()=>{class n{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static{this.\u0275prov=et({token:n,providedIn:"root",factory:()=>new n})}}return n})();function Lu(n){for(;n;){n[Mt]|=64;const e=wu(n);if(Zm(n)&&!e)return n;n=e}return null}const oS=new Ve("",{providedIn:"root",factory:()=>!1});let Rh=null;function lS(n,e){return n[e]??fS()}function uS(n,e){const t=fS();t.producerNode?.length&&(n[e]=Rh,t.lView=n,Rh=dS())}const TU={...LC,consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Lu(n.lView)},lView:null};function dS(){return Object.create(TU)}function fS(){return Rh??=dS(),Rh}const vt={};function L(n){hS(Ut(),ne(),_i()+n,!1)}function hS(n,e,t,i){if(!i)if(3==(3&e[Mt])){const o=n.preOrderCheckHooks;null!==o&&Yf(e,o,t)}else{const o=n.preOrderHooks;null!==o&&Zf(e,o,0,t)}ta(t)}function te(n,e=Dt.Default){const t=ne();return null===t?ot(n,e):P1(ni(),t,dt(n),e)}function Nh(n,e,t,i,r,o,s,a,c,l,u){const d=e.blueprint.slice();return d[Sn]=r,d[Mt]=140|i,(null!==l||n&&2048&n[Mt])&&(d[Mt]|=2048),t1(d),d[yn]=d[nc]=n,d[An]=t,d[tc]=s||n&&n[tc],d[mt]=a||n&&n[mt],d[ps]=c||n&&n[ps]||null,d[oi]=o,d[uu]=function FF(){return LF++}(),d[Io]=u,d[DC]=l,d[On]=2==e.type?n[On]:d,d}function Dc(n,e,t,i,r){let o=n.data[e];if(null===o)o=function g0(n,e,t,i,r){const o=a1(),s=r_(),c=n.data[e]=function FU(n,e,t,i,r,o){let s=e?e.injectorIndex:-1,a=0;return function ac(){return null!==lt.skipHydrationRootTNode}()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=c),null!==o&&(s?null==o.child&&null!==c.parent&&(o.child=c):null===o.next&&(o.next=c,c.prev=o)),c}(n,e,t,i,r),function LL(){return lt.lFrame.inI18n}()&&(o.flags|=32);else if(64&o.type){o.type=t,o.value=i,o.attrs=r;const s=function gu(){const n=lt.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();o.injectorIndex=null===s?-1:s.injectorIndex}return no(o,!0),o}function Fu(n,e,t,i){if(0===t)return-1;const r=e.length;for(let o=0;o<t;o++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function gS(n,e,t,i,r){const o=lS(e,du),s=_i(),a=2&i;try{ta(-1),a&&e.length>It&&hS(n,e,It,!1),to(a?2:0,r);const l=a?o:null,u=Jm(l);try{null!==l&&(l.dirty=!1),t(i,r)}finally{Qm(l,u)}}finally{a&&null===e[du]&&uS(e,du),ta(s),to(a?3:1,r)}}function m0(n,e,t){if(Ym(e)){const i=hr(null);try{const o=e.directiveEnd;for(let s=e.directiveStart;s<o;s++){const a=n.data[s];a.contentQueries&&a.contentQueries(1,t[s],s)}}finally{hr(i)}}}function _0(n,e,t){s1()&&(function GU(n,e,t,i){const r=t.directiveStart,o=t.directiveEnd;Qs(t)&&function ZU(n,e,t){const i=Ri(e,n),r=mS(t);let s=16;t.signals?s=4096:t.onPush&&(s=64);const a=Lh(n,Nh(n,r,null,s,i,e,null,n[tc].rendererFactory.createRenderer(i,t),null,null,null));n[e.index]=a}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||Jf(t,e),si(i,e);const s=t.initialInputs;for(let a=r;a<o;a++){const c=n.data[a],l=na(e,n,a,t);si(l,e),null!==s&&KU(0,a-r,l,c,0,s),Lr(c)&&(Ji(t.index,e)[An]=na(e,n,a,t))}}(n,e,t,Ri(t,e)),64==(64&t.flags)&&MS(n,e,t))}function v0(n,e,t=Ri){const i=e.localNames;if(null!==i){let r=e.index+1;for(let o=0;o<i.length;o+=2){const s=i[o+1],a=-1===s?t(e,n):n[s];n[r++]=a}}}function mS(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=x0(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function x0(n,e,t,i,r,o,s,a,c,l,u){const d=It+i,f=d+r,h=function OU(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:vt);return t}(d,f),p="function"==typeof l?l():l;return h[De]={type:n,blueprint:h,template:t,queries:null,viewQuery:a,declTNode:e,data:h.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:c,consts:p,incompleteFirstPass:!1,ssrId:u}}let _S=n=>null;function vS(n,e,t,i){for(let r in n)if(n.hasOwnProperty(r)){t=null===t?{}:t;const o=n[r];null===i?xS(t,e,r,o):i.hasOwnProperty(r)&&xS(t,e,i[r],o)}return t}function xS(n,e,t,i){n.hasOwnProperty(t)?n[t].push(e,i):n[t]=[e,i]}function y0(n,e,t,i){if(s1()){const r=null===i?null:{"":-1},o=function WU(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let o=0;o<t.length;o++){const s=t[o];if(SC(e,s.selectors,!1))if(i||(i=[]),Lr(s))if(null!==s.findHostDirectiveDefs){const a=[];r=r||new Map,s.findHostDirectiveDefs(s,a,r),i.unshift(...a,s),M0(n,e,a.length)}else i.unshift(s),M0(n,e,0);else r=r||new Map,s.findHostDirectiveDefs?.(s,i,r),i.push(s)}return null===i?null:[i,r]}(n,t);let s,a;null===o?s=a=null:[s,a]=o,null!==s&&yS(n,e,t,s,r,a),r&&function $U(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const o=t[e[r+1]];if(null==o)throw new de(-301,!1);i.push(e[r],o)}}}(t,i,r)}t.mergedAttrs=su(t.mergedAttrs,t.attrs)}function yS(n,e,t,i,r,o){for(let l=0;l<i.length;l++)m_(Jf(t,e),n,i[l].type);!function XU(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let l=0;l<i.length;l++){const u=i[l];u.providersResolver&&u.providersResolver(u)}let s=!1,a=!1,c=Fu(n,e,i.length,null);for(let l=0;l<i.length;l++){const u=i[l];t.mergedAttrs=su(t.mergedAttrs,u.hostAttrs),YU(n,t,e,c,u),qU(c,u,r),null!==u.contentQueries&&(t.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(t.flags|=64);const d=u.type.prototype;!s&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),s=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}!function kU(n,e,t){const r=e.directiveEnd,o=n.data,s=e.attrs,a=[];let c=null,l=null;for(let u=e.directiveStart;u<r;u++){const d=o[u],f=t?t.get(d):null,p=f?f.outputs:null;c=vS(d.inputs,u,c,f?f.inputs:null),l=vS(d.outputs,u,l,p);const _=null===c||null===s||wC(e)?null:JU(c,u,s);a.push(_)}null!==c&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}(n,t,o)}function MS(n,e,t){const i=t.directiveStart,r=t.directiveEnd,o=t.index,s=function kL(){return lt.lFrame.currentDirectiveIndex}();try{ta(o);for(let a=i;a<r;a++){const c=n.data[a],l=e[a];s_(a),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&jU(c,l)}}finally{ta(-1),s_(s)}}function jU(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function M0(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function qU(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Lr(e)&&(t[""]=n)}}function YU(n,e,t,i,r){n.data[i]=r;const o=r.factory||(r.factory=ea(r.type)),s=new mu(o,Lr(r),te);n.blueprint[i]=s,t[i]=s,function zU(n,e,t,i,r){const o=r.hostBindings;if(o){let s=n.hostBindingOpCodes;null===s&&(s=n.hostBindingOpCodes=[]);const a=~e.index;(function HU(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(s)!=a&&s.push(a),s.push(t,i,o)}}(n,e,i,Fu(n,t,r.hostVars,vt),r)}function so(n,e,t,i,r,o){const s=Ri(n,e);!function b0(n,e,t,i,r,o,s){if(null==o)n.removeAttribute(e,r,t);else{const a=null==s?gt(o):s(o,i||"",r);n.setAttribute(e,r,a,t)}}(e[mt],s,o,n.value,t,i,r)}function KU(n,e,t,i,r,o){const s=o[e];if(null!==s)for(let a=0;a<s.length;)bS(i,t,s[a++],s[a++],s[a++])}function bS(n,e,t,i,r){const o=hr(null);try{const s=n.inputTransforms;null!==s&&s.hasOwnProperty(i)&&(r=s[i].call(e,r)),null!==n.setInput?n.setInput(e,r,t,i):e[i]=r}finally{hr(o)}}function JU(n,e,t){let i=null,r=0;for(;r<t.length;){const o=t[r];if(0!==o)if(5!==o){if("number"==typeof o)break;if(n.hasOwnProperty(o)){null===i&&(i=[]);const s=n[o];for(let a=0;a<s.length;a+=2)if(s[a]===e){i.push(o,s[a+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function CS(n,e,t,i){return[n,!0,!1,e,null,0,i,t,null,null,null]}function wS(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const o=t[i+1];if(-1!==o){const s=n.data[o];c_(t[i]),s.contentQueries(2,e[o],o)}}}function Lh(n,e){return n[cu]?n[OC][Nr]=e:n[cu]=e,n[OC]=e,e}function C0(n,e,t){c_(0);const i=hr(null);try{e(n,t)}finally{hr(i)}}function SS(n){return n[ec]||(n[ec]=[])}function PS(n){return n.cleanup||(n.cleanup=[])}function TS(n,e){const t=n[ps],i=t?t.get(Fo,null):null;i&&i.handleError(e)}function w0(n,e,t,i,r){for(let o=0;o<t.length;){const s=t[o++],a=t[o++];bS(n.data[s],e[s],i,a,r)}}function Uo(n,e,t){const i=$f(e,n);!function nw(n,e,t){n.setValue(e,t)}(n[mt],i,t)}function QU(n,e){const t=Ji(e,n),i=t[De];!function e5(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(i,t);const r=t[Sn];null!==r&&null===t[Io]&&(t[Io]=r0(r,t[ps])),S0(i,t,t[An])}function S0(n,e,t){l_(e);try{const i=n.viewQuery;null!==i&&C0(1,i,t);const r=n.template;null!==r&&gS(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&wS(n,e),n.staticViewQueries&&C0(2,n.viewQuery,t);const o=n.components;null!==o&&function t5(n,e){for(let t=0;t<e.length;t++)QU(n,e[t])}(e,o)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[Mt]&=-5,u_()}}let AS=(()=>{class n{constructor(){this.all=new Set,this.queue=new Map}create(t,i,r){const o=typeof Zone>"u"?null:Zone.current,s=function hL(n,e,t){const i=Object.create(pL);t&&(i.consumerAllowSignalWrites=!0),i.fn=n,i.schedule=e;const r=s=>{i.cleanupFn=s};return i.ref={notify:()=>BC(i),run:()=>{if(i.dirty=!1,i.hasRun&&!VC(i))return;i.hasRun=!0;const s=Jm(i);try{i.cleanupFn(),i.cleanupFn=XC,i.fn(r)}finally{Qm(i,s)}},cleanup:()=>i.cleanupFn()},i.ref}(t,l=>{this.all.has(l)&&this.queue.set(l,o)},r);let a;this.all.add(s),s.notify();const c=()=>{s.cleanup(),a?.(),this.all.delete(s),this.queue.delete(s)};return a=i?.onDestroy(c),{destroy:c}}flush(){if(0!==this.queue.size)for(const[t,i]of this.queue)this.queue.delete(t),i?i.run(()=>t.run()):t.run()}get isQueueEmpty(){return 0===this.queue.size}static{this.\u0275prov=et({token:n,providedIn:"root",factory:()=>new n})}}return n})();function Fh(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,o=0;if(null!==e)for(let s=0;s<e.length;s++){const a=e[s];"number"==typeof a?o=a:1==o?r=Rm(r,a):2==o&&(i=Rm(i,a+": "+e[++s]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function ku(n,e,t,i,r=!1){for(;null!==t;){const o=e[t.index];null!==o&&i.push(un(o)),gi(o)&&OS(o,i);const s=t.type;if(8&s)ku(n,e,t.child,i);else if(32&s){const a=T_(t,e);let c;for(;c=a();)i.push(c)}else if(16&s){const a=dw(e,t);if(Array.isArray(a))i.push(...a);else{const c=wu(e[On]);ku(c[De],c,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function OS(n,e){for(let t=ei;t<n.length;t++){const i=n[t],r=i[De].firstChild;null!==r&&ku(i[De],i,r,e)}n[eo]!==n[Sn]&&e.push(n[eo])}function kh(n,e,t,i=!0){const r=e[tc],o=r.rendererFactory,s=r.afterRenderEventManager;o.begin?.(),s?.begin();try{DS(n,e,n.template,t)}catch(c){throw i&&TS(e,c),c}finally{o.end?.(),r.effectManager?.flush(),s?.end()}}function DS(n,e,t,i){const r=e[Mt];if(256!=(256&r)){e[tc].effectManager?.flush(),l_(e);try{t1(e),function l1(n){return lt.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&gS(n,e,t,2,i);const s=3==(3&r);if(s){const l=n.preOrderCheckHooks;null!==l&&Yf(e,l,null)}else{const l=n.preOrderHooks;null!==l&&Zf(e,l,0,null),d_(e,0)}if(function r5(n){for(let e=Q1(n);null!==e;e=ew(e)){if(!e[IC])continue;const t=e[rc];for(let i=0;i<t.length;i++){wL(t[i])}}}(e),IS(e,2),null!==n.contentQueries&&wS(n,e),s){const l=n.contentCheckHooks;null!==l&&Yf(e,l)}else{const l=n.contentHooks;null!==l&&Zf(e,l,1),d_(e,1)}!function AU(n,e){const t=n.hostBindingOpCodes;if(null===t)return;const i=lS(e,fu);try{for(let r=0;r<t.length;r++){const o=t[r];if(o<0)ta(~o);else{const s=o,a=t[++r],c=t[++r];FL(a,s),i.dirty=!1;const l=Jm(i);try{c(2,e[s])}finally{Qm(i,l)}}}}finally{null===e[fu]&&uS(e,fu),ta(-1)}}(n,e);const a=n.components;null!==a&&NS(e,a,0);const c=n.viewQuery;if(null!==c&&C0(2,c,i),s){const l=n.viewCheckHooks;null!==l&&Yf(e,l)}else{const l=n.viewHooks;null!==l&&Zf(e,l,2),d_(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[Mt]&=-73,n1(e)}finally{u_()}}}function IS(n,e){for(let t=Q1(n);null!==t;t=ew(t))for(let i=ei;i<t.length;i++)RS(t[i],e)}function o5(n,e,t){RS(Ji(e,n),t)}function RS(n,e){if(!function bL(n){return 128==(128&n[Mt])}(n))return;const t=n[De],i=n[Mt];if(80&i&&0===e||1024&i||2===e)DS(t,n,t.template,n[An]);else if(n[au]>0){IS(n,1);const r=t.components;null!==r&&NS(n,r,1)}}function NS(n,e,t){for(let i=0;i<e.length;i++)o5(n,e[i],t)}class Uu{get rootNodes(){const e=this._lView,t=e[De];return ku(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[An]}set context(e){this._lView[An]=e}get destroyed(){return 256==(256&this._lView[Mt])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[yn];if(gi(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(ph(e,i),nh(t,i))}this._attachedToViewContainer=!1}O_(this._lView[De],this._lView)}onDestroy(e){!function r1(n,e){if(256==(256&n[Mt]))throw new de(911,!1);null===n[gs]&&(n[gs]=[]),n[gs].push(e)}(this._lView,e)}markForCheck(){Lu(this._cdRefInjectingView||this._lView)}detach(){this._lView[Mt]&=-129}reattach(){this._lView[Mt]|=128}detectChanges(){kh(this._lView[De],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new de(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function ZF(n,e){Pu(n,e,e[mt],2,null,null)}(this._lView[De],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new de(902,!1);this._appRef=e}}class s5 extends Uu{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;kh(e[De],e,e[An],!1)}checkNoChanges(){}get context(){return null}}class LS extends Oh{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=kt(e);return new Bu(t,this.ngModule)}}function FS(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class c5{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=Uf(i);const r=this.injector.get(e,a0,i);return r!==a0||t===a0?r:this.parentInjector.get(e,t,i)}}class Bu extends zw{get inputs(){const e=this.componentDef,t=e.inputTransforms,i=FS(e.inputs);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return FS(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function XN(n){return n.map(qN).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){let o=(r=r||this.ngModule)instanceof mr?r:r?.injector;o&&null!==this.componentDef.getStandaloneInjector&&(o=this.componentDef.getStandaloneInjector(o)||o);const s=o?new c5(e,o):e,a=s.get(Gw,null);if(null===a)throw new de(407,!1);const d={rendererFactory:a,sanitizer:s.get(oU,null),effectManager:s.get(AS,null),afterRenderEventManager:s.get(p0,null)},f=a.createRenderer(null,this.componentDef),h=this.componentDef.selectors[0][0]||"div",p=i?function DU(n,e,t,i){const o=i.get(oS,!1)||t===Dr.ShadowDom,s=n.selectRootElement(e,o);return function IU(n){_S(n)}(s),s}(f,i,this.componentDef.encapsulation,s):hh(f,h,function a5(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(h)),g=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let v=null;null!==p&&(v=r0(p,s,!0));const x=x0(0,null,null,1,0,null,null,null,null,null,null),y=Nh(null,x,null,g,null,null,d,f,s,null,v);let S,P;l_(y);try{const T=this.componentDef;let I,C=null;T.findHostDirectiveDefs?(I=[],C=new Map,T.findHostDirectiveDefs(T,I,C),I.push(T)):I=[T];const E=function u5(n,e){const t=n[De],i=It;return n[i]=e,Dc(t,i,2,"#host",null)}(y,p),F=function d5(n,e,t,i,r,o,s){const a=r[De];!function f5(n,e,t,i){for(const r of n)e.mergedAttrs=su(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(Fh(e,e.mergedAttrs,!0),null!==t&&gw(i,t,e))}(i,n,e,s);let c=null;null!==e&&(c=r0(e,r[ps]));const l=o.rendererFactory.createRenderer(e,t);let u=16;t.signals?u=4096:t.onPush&&(u=64);const d=Nh(r,mS(t),null,u,r[n.index],n,o,l,null,null,c);return a.firstCreatePass&&M0(a,n,i.length-1),Lh(r,d),r[n.index]=d}(E,p,T,I,y,d,f);P=e1(x,It),p&&function p5(n,e,t,i){if(i)qm(n,t,["ng-version",sU.full]);else{const{attrs:r,classes:o}=function YN(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let o=n[i];if("string"==typeof o)2===r?""!==o&&e.push(o,n[++i]):8===r&&t.push(o);else{if(!Ir(r))break;r=o}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&qm(n,t,r),o&&o.length>0&&pw(n,t,o.join(" "))}}(f,T,p,i),void 0!==t&&function g5(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const o=t[r];i.push(null!=o?Array.from(o):null)}}(P,this.ngContentSelectors,t),S=function h5(n,e,t,i,r,o){const s=ni(),a=r[De],c=Ri(s,r);yS(a,r,s,t,null,i);for(let u=0;u<t.length;u++)si(na(r,a,s.directiveStart+u,s),r);MS(a,r,s),c&&si(c,r);const l=na(r,a,s.directiveStart+s.componentOffset,s);if(n[An]=r[An]=l,null!==o)for(const u of o)u(l,e);return m0(a,s,n),l}(F,T,I,C,y,[m5]),S0(x,y,null)}finally{u_()}return new l5(this.componentType,S,Tc(P,y),y,P)}}class l5 extends Qk{constructor(e,t,i,r,o){super(),this.location=i,this._rootLView=r,this._tNode=o,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new s5(r),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const o=this._rootLView;w0(o[De],o,r,e,t),this.previousInputValues.set(e,t),Lu(Ji(this._tNode.index,o))}}get injector(){return new vi(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function m5(){const n=ni();Xf(ne()[De],n)}function Yt(n){let e=function kS(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(Lr(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new de(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);const s=n;s.inputs=Uh(n.inputs),s.inputTransforms=Uh(n.inputTransforms),s.declaredInputs=Uh(n.declaredInputs),s.outputs=Uh(n.outputs);const a=r.hostBindings;a&&y5(n,a);const c=r.viewQuery,l=r.contentQueries;if(c&&v5(n,c),l&&x5(n,l),If(n.inputs,r.inputs),If(n.declaredInputs,r.declaredInputs),If(n.outputs,r.outputs),null!==r.inputTransforms&&(null===s.inputTransforms&&(s.inputTransforms={}),If(s.inputTransforms,r.inputTransforms)),Lr(r)&&r.data.animation){const u=n.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const o=r.features;if(o)for(let s=0;s<o.length;s++){const a=o[s];a&&a.ngInherit&&a(n),a===Yt&&(t=!1)}}e=Object.getPrototypeOf(e)}!function _5(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=su(r.hostAttrs,t=su(t,r.hostAttrs))}}(i)}function Uh(n){return n===Jr?{}:n===Bt?[]:n}function v5(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function x5(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,o)=>{e(i,r,o),t(i,r,o)}:e}function y5(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}function Bh(n){return!!P0(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function P0(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function ao(n,e,t){return n[e]=t}function ai(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function oa(n,e,t,i){const r=ai(n,e,t);return ai(n,e+1,i)||r}function co(n,e,t,i){const r=ne();return ai(r,cc(),e)&&(Ut(),so(bn(),r,n,e,t,i)),co}function Nc(n,e,t,i,r,o){const a=oa(n,function Ro(){return lt.lFrame.bindingIndex}(),t,r);return No(2),a?e+gt(t)+i+gt(r)+o:vt}function ie(n,e,t,i,r,o,s,a){const c=ne(),l=Ut(),u=n+It,d=l.firstCreatePass?function W5(n,e,t,i,r,o,s,a,c){const l=e.consts,u=Dc(e,n,4,s||null,_s(l,a));y0(e,t,u,_s(l,c)),Xf(e,u);const d=u.tView=x0(2,u,i,r,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return null!==e.queries&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}(u,l,c,e,t,i,r,o,s):l.data[u];no(d,!1);const f=eP(l,c,d,n);qf()&&mh(l,c,f,d),si(f,c),Lh(c,c[u]=CS(f,c,f,d)),Gf(d)&&_0(l,c,d),null!=s&&v0(c,d,a)}let eP=function tP(n,e,t,i){return vs(!0),e[mt].createComment("")};function Ms(n){return sc(function NL(){return lt.lFrame.contextLView}(),It+n)}function J(n,e,t){const i=ne();return ai(i,cc(),e)&&function nr(n,e,t,i,r,o,s,a){const c=Ri(e,t);let u,l=e.inputs;!a&&null!=l&&(u=l[i])?(w0(n,t,u,i,r),Qs(e)&&function BU(n,e){const t=Ji(e,n);16&t[Mt]||(t[Mt]|=64)}(t,e.index)):3&e.type&&(i=function UU(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=s?s(r,e.value||"",i):r,o.setProperty(c,i,r))}(Ut(),bn(),i,n,e,i[mt],t,!1),J}function I0(n,e,t,i,r){const s=r?"class":"style";w0(n,t,e.inputs[s],s,i)}function M(n,e,t,i){const r=ne(),o=Ut(),s=It+n,a=r[mt],c=o.firstCreatePass?function Y5(n,e,t,i,r,o){const s=e.consts,c=Dc(e,n,2,i,_s(s,r));return y0(e,t,c,_s(s,o)),null!==c.attrs&&Fh(c,c.attrs,!1),null!==c.mergedAttrs&&Fh(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(s,o,r,e,t,i):o.data[s],l=nP(o,r,c,a,e,n);r[s]=l;const u=Gf(c);return no(c,!0),gw(a,l,c),32!=(32&c.flags)&&qf()&&mh(o,r,l,c),0===function PL(){return lt.lFrame.elementDepthCount}()&&si(l,r),function EL(){lt.lFrame.elementDepthCount++}(),u&&(_0(o,r,c),m0(o,c,r)),null!==i&&v0(r,c),M}function b(){let n=ni();r_()?o_():(n=n.parent,no(n,!1));const e=n;(function AL(n){return lt.skipHydrationRootTNode===n})(e)&&function RL(){lt.skipHydrationRootTNode=null}(),function TL(){lt.lFrame.elementDepthCount--}();const t=Ut();return t.firstCreatePass&&(Xf(t,n),Ym(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function XL(n){return 0!=(8&n.flags)}(e)&&I0(t,e,ne(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function YL(n){return 0!=(16&n.flags)}(e)&&I0(t,e,ne(),e.stylesWithoutHost,!1),b}function U(n,e,t,i){return M(n,e,t,i),b(),U}let nP=(n,e,t,i,r,o)=>(vs(!0),hh(i,r,function _1(){return lt.lFrame.currentNamespace}()));function sa(n,e,t){const i=ne(),r=Ut(),o=n+It,s=r.firstCreatePass?function J5(n,e,t,i,r){const o=e.consts,s=_s(o,i),a=Dc(e,n,8,"ng-container",s);return null!==s&&Fh(a,s,!0),y0(e,t,a,_s(o,r)),null!==e.queries&&e.queries.elementStart(e,a),a}(o,r,i,e,t):r.data[o];no(s,!0);const a=rP(r,i,s,n);return i[o]=a,qf()&&mh(r,i,a,s),si(a,i),Gf(s)&&(_0(r,i,s),m0(r,s,i)),null!=t&&v0(i,s),sa}function aa(){let n=ni();const e=Ut();return r_()?o_():(n=n.parent,no(n,!1)),e.firstCreatePass&&(Xf(e,n),Ym(n)&&e.queries.elementEnd(n)),aa}let rP=(n,e,t,i)=>(vs(!0),A_(e[mt],""));function tn(){return ne()}function ju(n){return!!n&&"function"==typeof n.then}function oP(n){return!!n&&"function"==typeof n.subscribe}function ge(n,e,t,i){const r=ne(),o=Ut(),s=ni();return function aP(n,e,t,i,r,o,s){const a=Gf(i),l=n.firstCreatePass&&PS(n),u=e[An],d=SS(e);let f=!0;if(3&i.type||s){const _=Ri(i,e),m=s?s(_):_,g=d.length,v=s?y=>s(un(y[i.index])):i.index;let x=null;if(!s&&a&&(x=function t4(n,e,t,i){const r=n.cleanup;if(null!=r)for(let o=0;o<r.length-1;o+=2){const s=r[o];if(s===t&&r[o+1]===i){const a=e[ec],c=r[o+2];return a.length>c?a[c]:null}"string"==typeof s&&(o+=2)}return null}(n,e,r,i.index)),null!==x)(x.__ngLastListenerFn__||x).__ngNextListenerFn__=o,x.__ngLastListenerFn__=o,f=!1;else{o=lP(i,e,u,o,!1);const y=t.listen(m,r,o);d.push(o,y),l&&l.push(r,v,g,g+1)}}else o=lP(i,e,u,o,!1);const h=i.outputs;let p;if(f&&null!==h&&(p=h[r])){const _=p.length;if(_)for(let m=0;m<_;m+=2){const S=e[p[m]][p[m+1]].subscribe(o),P=d.length;d.push(o,S),l&&l.push(r,i.index,P,-(P+1))}}}(o,r,r[mt],s,n,e,i),ge}function cP(n,e,t,i){try{return to(6,e,t),!1!==t(i)}catch(r){return TS(n,r),!1}finally{to(7,e,t)}}function lP(n,e,t,i,r){return function o(s){if(s===Function)return i;Lu(n.componentOffset>-1?Ji(n.index,e):e);let c=cP(e,t,i,s),l=o.__ngNextListenerFn__;for(;l;)c=cP(e,t,l,s)&&c,l=l.__ngNextListenerFn__;return r&&!1===c&&s.preventDefault(),c}}function Q(n=1){return function BL(n){return(lt.lFrame.contextLView=function VL(n,e){for(;n>0;)e=e[nc],n--;return e}(n,lt.lFrame.contextLView))[An]}(n)}function jh(n,e){return n<<17|e<<2}function bs(n){return n>>17&32767}function N0(n){return 2|n}function ca(n){return(131068&n)>>2}function L0(n,e){return-131069&n|e<<2}function F0(n){return 1|n}function xP(n,e,t,i,r){const o=n[t+1],s=null===e;let a=i?bs(o):ca(o),c=!1;for(;0!==a&&(!1===c||s);){const u=n[a+1];u4(n[a],e)&&(c=!0,n[a+1]=i?F0(u):N0(u)),a=i?bs(u):ca(u)}c&&(n[t+1]=i?N0(o):F0(o))}function u4(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&mc(n,e)>=0}const Gn={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function yP(n){return n.substring(Gn.key,Gn.keyEnd)}function MP(n,e){const t=Gn.textEnd;return t===e?-1:(e=Gn.keyEnd=function p4(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,Gn.key=e,t),zc(n,e,t))}function zc(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function lo(n,e,t){return Fr(n,e,t,!1),lo}function bt(n,e){return Fr(n,e,null,!0),bt}function Hc(n){!function kr(n,e,t,i){const r=Ut(),o=No(2);r.firstUpdatePass&&EP(r,null,o,i);const s=ne();if(t!==vt&&ai(s,o,t)){const a=r.data[_i()];if(DP(a,i)&&!PP(r,o)){let c=i?a.classesWithoutHost:a.stylesWithoutHost;null!==c&&(t=Rm(c,t||"")),I0(r,a,s,t,i)}else!function w4(n,e,t,i,r,o,s,a){r===vt&&(r=Bt);let c=0,l=0,u=0<r.length?r[0]:null,d=0<o.length?o[0]:null;for(;null!==u||null!==d;){const f=c<r.length?r[c+1]:void 0,h=l<o.length?o[l+1]:void 0;let _,p=null;u===d?(c+=2,l+=2,f!==h&&(p=d,_=h)):null===d||null!==u&&u<d?(c+=2,p=u):(l+=2,p=d,_=h),null!==p&&AP(n,e,t,i,p,_,s,a),u=c<r.length?r[c]:null,d=l<o.length?o[l]:null}}(r,a,s,s[mt],s[o+1],s[o+1]=function b4(n,e,t){if(null==t||""===t)return Bt;const i=[],r=ys(t);if(Array.isArray(r))for(let o=0;o<r.length;o++)n(i,r[o],!0);else if("object"==typeof r)for(const o in r)r.hasOwnProperty(o)&&n(i,o,r[o]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,o)}}(C4,fo,n,!0)}function fo(n,e){for(let t=function f4(n){return function CP(n){Gn.key=0,Gn.keyEnd=0,Gn.value=0,Gn.valueEnd=0,Gn.textEnd=n.length}(n),MP(n,zc(n,0,Gn.textEnd))}(e);t>=0;t=MP(e,t))Qi(n,yP(e),!0)}function Fr(n,e,t,i){const r=ne(),o=Ut(),s=No(2);o.firstUpdatePass&&EP(o,n,s,i),e!==vt&&ai(r,s,e)&&AP(o,o.data[_i()],r,r[mt],n,r[s+1]=function S4(n,e){return null==n||""===n||("string"==typeof e?n+=e:"object"==typeof n&&(n=zn(ys(n)))),n}(e,t),i,s)}function PP(n,e){return e>=n.expandoStartIndex}function EP(n,e,t,i){const r=n.data;if(null===r[t+1]){const o=r[_i()],s=PP(n,t);DP(o,i)&&null===e&&!s&&(e=!1),e=function v4(n,e,t,i){const r=function a_(n){const e=lt.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let o=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=Wu(t=k0(null,n,e,t,i),e.attrs,i),o=null);else{const s=e.directiveStylingLast;if(-1===s||n[s]!==r)if(t=k0(r,n,e,t,i),null===o){let c=function x4(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==ca(i))return n[bs(i)]}(n,e,i);void 0!==c&&Array.isArray(c)&&(c=k0(null,n,e,c[1],i),c=Wu(c,e.attrs,i),function y4(n,e,t,i){n[bs(t?e.classBindings:e.styleBindings)]=i}(n,e,i,c))}else o=function M4(n,e,t){let i;const r=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<r;o++)i=Wu(i,n[o].hostAttrs,t);return Wu(i,e.attrs,t)}(n,e,i)}return void 0!==o&&(i?e.residualClasses=o:e.residualStyles=o),t}(r,o,e,i),function c4(n,e,t,i,r,o){let s=o?e.classBindings:e.styleBindings,a=bs(s),c=ca(s);n[i]=t;let u,l=!1;if(Array.isArray(t)?(u=t[1],(null===u||mc(t,u)>0)&&(l=!0)):u=t,r)if(0!==c){const f=bs(n[a+1]);n[i+1]=jh(f,a),0!==f&&(n[f+1]=L0(n[f+1],i)),n[a+1]=function s4(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=jh(a,0),0!==a&&(n[a+1]=L0(n[a+1],i)),a=i;else n[i+1]=jh(c,0),0===a?a=i:n[c+1]=L0(n[c+1],i),c=i;l&&(n[i+1]=N0(n[i+1])),xP(n,u,i,!0),xP(n,u,i,!1),function l4(n,e,t,i,r){const o=r?n.residualClasses:n.residualStyles;null!=o&&"string"==typeof e&&mc(o,e)>=0&&(t[i+1]=F0(t[i+1]))}(e,u,n,i,o),s=jh(a,c),o?e.classBindings=s:e.styleBindings=s}(r,o,e,t,s,i)}}function k0(n,e,t,i,r){let o=null;const s=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<s&&(o=e[a],i=Wu(i,o.hostAttrs,r),o!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function Wu(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let o=0;o<e.length;o++){const s=e[o];"number"==typeof s?r=s:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Qi(n,s,!!t||e[++o]))}return void 0===n?null:n}function C4(n,e,t){const i=String(e);""!==i&&!i.includes(" ")&&Qi(n,i,t)}function AP(n,e,t,i,r,o,s,a){if(!(3&e.type))return;const c=n.data,l=c[a+1],u=function a4(n){return 1==(1&n)}(l)?OP(c,e,t,r,ca(l),s):void 0;Wh(u)||(Wh(o)||function o4(n){return 2==(2&n)}(l)&&(o=OP(c,null,t,r,a,s)),function sk(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let o=-1===i.indexOf("-")?void 0:xs.DashCase;null==r?n.removeStyle(t,i,o):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=xs.Important),n.setStyle(t,i,r,o))}}(i,s,$f(_i(),t),r,o))}function OP(n,e,t,i,r,o){const s=null===e;let a;for(;r>0;){const c=n[r],l=Array.isArray(c),u=l?c[1]:c,d=null===u;let f=t[r+1];f===vt&&(f=d?Bt:void 0);let h=d?x_(f,i):u===i?f:void 0;if(l&&!Wh(h)&&(h=x_(c,i)),Wh(h)&&(a=h,s))return a;const p=n[r+1];r=s?bs(p):ca(p)}if(null!==e){let c=o?e.residualClasses:e.residualStyles;null!=c&&(a=x_(c,i))}return a}function Wh(n){return void 0!==n}function DP(n,e){return 0!=(n.flags&(e?8:16))}function O(n,e=""){const t=ne(),i=Ut(),r=n+It,o=i.firstCreatePass?Dc(i,r,1,e,null):i.data[r],s=IP(i,t,o,e,n);t[r]=s,qf()&&mh(i,t,s,o),no(o,!1)}let IP=(n,e,t,i,r)=>(vs(!0),function fh(n,e){return n.createText(e)}(e[mt],i));function xt(n){return Ye("",n,""),xt}function Ye(n,e,t){const i=ne(),r=function Rc(n,e,t,i){return ai(n,cc(),t)?e+gt(t)+i:vt}(i,n,e,t);return r!==vt&&Uo(i,_i(),r),Ye}function $h(n,e,t,i,r){const o=ne(),s=Nc(o,n,e,t,i,r);return s!==vt&&Uo(o,_i(),s),$h}const la=void 0;var q4=["en",[["a","p"],["AM","PM"],la],[["AM","PM"],la,la],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],la,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],la,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",la,"{1} 'at' {0}",la],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function $4(n){const t=Math.floor(Math.abs(n)),i=n.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===i?1:5}];let Gc={};function xi(n){const e=function X4(n){return n.toLowerCase().replace(/_/g,"-")}(n);let t=JP(e);if(t)return t;const i=e.split("-")[0];if(t=JP(i),t)return t;if("en"===i)return q4;throw new de(701,!1)}function JP(n){return n in Gc||(Gc[n]=ln.ng&&ln.ng.common&&ln.ng.common.locales&&ln.ng.common.locales[n]),Gc[n]}var fn=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(fn||{});const jc="en-US";let QP=jc;function V0(n,e,t,i,r){if(n=dt(n),Array.isArray(n))for(let o=0;o<n.length;o++)V0(n[o],e,t,i,r);else{const o=Ut(),s=ne(),a=ni();let c=ra(n)?n:dt(n.provide);const l=Lw(n),u=1048575&a.providerIndexes,d=a.directiveStart,f=a.providerIndexes>>20;if(ra(n)||!n.multi){const h=new mu(l,r,te),p=H0(c,e,r?u:u+f,d);-1===p?(m_(Jf(a,s),o,c),z0(o,n,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(h),s.push(h)):(t[p]=h,s[p]=h)}else{const h=H0(c,e,u+f,d),p=H0(c,e,u,u+f),m=p>=0&&t[p];if(r&&!m||!r&&!(h>=0&&t[h])){m_(Jf(a,s),o,c);const g=function $B(n,e,t,i,r){const o=new mu(n,t,te);return o.multi=[],o.index=e,o.componentProviders=0,wE(o,r,i&&!t),o}(r?WB:jB,t.length,r,i,l);!r&&m&&(t[p].providerFactory=g),z0(o,n,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(g),s.push(g)}else z0(o,n,h>-1?h:p,wE(t[r?p:h],l,!r&&i));!r&&i&&m&&t[p].componentProviders++}}}function z0(n,e,t,i){const r=ra(e),o=function Fk(n){return!!n.useClass}(e);if(r||o){const c=(o?dt(e.useClass):e).prototype.ngOnDestroy;if(c){const l=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const u=l.indexOf(t);-1===u?l.push(t,[i,c]):l[u+1].push(i,c)}else l.push(t,c)}}}function wE(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function H0(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function jB(n,e,t,i){return G0(this.multi,[])}function WB(n,e,t,i){const r=this.multi;let o;if(this.providerFactory){const s=this.providerFactory.componentProviders,a=na(t,t[De],this.providerFactory.index,i);o=a.slice(0,s),G0(r,o);for(let c=s;c<a.length;c++)o.push(a[c])}else o=[],G0(r,o);return o}function G0(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function Mn(n,e=[]){return t=>{t.providersResolver=(i,r)=>function GB(n,e,t){const i=Ut();if(i.firstCreatePass){const r=Lr(n);V0(t,i.data,i.blueprint,r,!0),V0(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class ua{}class SE{}class j0 extends ua{constructor(e,t,i){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new LS(this);const r=Ki(e);this._bootstrapComponents=ko(r.bootstrap),this._r3Injector=Xw(e,t,[{provide:ua,useValue:this},{provide:Oh,useValue:this.componentFactoryResolver},...i],zn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class W0 extends SE{constructor(e){super(),this.moduleType=e}create(e){return new j0(this.moduleType,e,[])}}class PE extends ua{constructor(e){super(),this.componentFactoryResolver=new LS(this),this.instance=null;const t=new Cc([...e.providers,{provide:ua,useValue:this},{provide:Oh,useValue:this.componentFactoryResolver}],e.parent||Ch(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function $0(n,e,t=null){return new PE({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let YB=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const i=Dw(0,t.type),r=i.length>0?$0([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=et({token:n,providedIn:"environment",factory:()=>new n(ot(mr))})}}return n})();function q0(n){n.getStandaloneInjector=e=>e.get(YB).getOrCreateStandaloneInjector(n)}function Ku(n,e,t){const i=mi()+n,r=ne();return r[i]===vt?ao(r,i,t?e.call(t):e()):function Vu(n,e){return n[e]}(r,i)}function Ju(n,e){const t=n[e];return t===vt?void 0:t}function LE(n,e,t,i,r,o,s,a){const c=e+t;return function Vh(n,e,t,i,r){const o=oa(n,e,t,i);return ai(n,e+2,r)||o}(n,c,r,o,s)?ao(n,c+3,a?i.call(a,r,o,s):i(r,o,s)):Ju(n,c+3)}function Qu(n,e){const t=Ut();let i;const r=n+It;t.firstCreatePass?(i=function hV(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];const o=i.factory||(i.factory=ea(i.type)),a=Oi(te);try{const c=Kf(!1),l=o();return Kf(c),function X5(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,ne(),r,l),l}finally{Oi(a)}}function UE(n,e,t){const i=n+It,r=ne(),o=sc(r,i);return ed(r,i)?function RE(n,e,t,i,r,o){const s=e+t;return ai(n,s,r)?ao(n,s+1,o?i.call(o,r):i(r)):Ju(n,s+1)}(r,mi(),e,o.transform,t,o):o.transform(t)}function Kh(n,e,t,i,r){const o=n+It,s=ne(),a=sc(s,o);return ed(s,o)?LE(s,mi(),e,a.transform,t,i,r,a):a.transform(t,i,r)}function ed(n,e){return n[De].data[e].pure}function _V(){return this._results[Symbol.iterator]()}class Y0{get changes(){return this._changes||(this._changes=new Cn)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Y0.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=_V)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=function gr(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function lF(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],o=e[i];if(t&&(r=t(r),o=t(o)),o!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function xV(n,e,t,i=!0){const r=e[De];if(function JF(n,e,t,i){const r=ei+i,o=t.length;i>0&&(t[r-1][Nr]=e),i<o-ei?(e[Nr]=t[r],I1(t,ei+i,e)):(t.push(e),e[Nr]=null),e[yn]=t;const s=e[lu];null!==s&&t!==s&&function QF(n,e){const t=n[rc];e[On]!==e[yn][yn][On]&&(n[IC]=!0),null===t?n[rc]=[e]:t.push(e)}(s,e);const a=e[Qr];null!==a&&a.insertView(n),e[Mt]|=128}(r,e,n,t),i){const o=N_(t,n),s=e[mt],a=gh(s,n[eo]);null!==a&&function YF(n,e,t,i,r,o){i[Sn]=r,i[oi]=e,Pu(n,i,t,1,r,o)}(r,n[oi],s,e,a,o)}}let Bo=(()=>{class n{static{this.__NG_ELEMENT_ID__=bV}}return n})();const yV=Bo,MV=class extends yV{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,i){const r=function vV(n,e,t,i){const r=e.tView,a=Nh(n,r,t,4096&n[Mt]?4096:16,null,e,null,null,null,i?.injector??null,i?.hydrationInfo??null);a[lu]=n[e.index];const l=n[Qr];return null!==l&&(a[Qr]=l.createEmbeddedView(r)),S0(r,a,t),a}(this._declarationLView,this._declarationTContainer,e,{injector:t,hydrationInfo:i});return new Uu(r)}};function bV(){return Jh(ni(),ne())}function Jh(n,e){return 4&n.type?new MV(e,n,Tc(n,e)):null}let Ur=(()=>{class n{static{this.__NG_ELEMENT_ID__=TV}}return n})();function TV(){return WE(ni(),ne())}const AV=Ur,GE=class extends AV{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Tc(this._hostTNode,this._hostLView)}get injector(){return new vi(this._hostTNode,this._hostLView)}get parentInjector(){const e=Qf(this._hostTNode,this._hostLView);if(h_(e)){const t=vu(e,this._hostLView),i=_u(e);return new vi(t[De].data[i+8],t)}return new vi(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=jE(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-ei}createEmbeddedView(e,t,i){let r,o;"number"==typeof i?r=i:null!=i&&(r=i.index,o=i.injector);const a=e.createEmbeddedViewImpl(t||{},o,null);return this.insertImpl(a,r,false),a}createComponent(e,t,i,r,o){const s=e&&!function yu(n){return"function"==typeof n}(e);let a;if(s)a=t;else{const _=t||{};a=_.index,i=_.injector,r=_.projectableNodes,o=_.environmentInjector||_.ngModuleRef}const c=s?e:new Bu(kt(e)),l=i||this.parentInjector;if(!o&&null==c.ngModule){const m=(s?l:this.parentInjector).get(mr,null);m&&(o=m)}kt(c.componentType??{});const h=c.create(l,r,null,o);return this.insertImpl(h.hostView,a,false),h}insert(e,t){return this.insertImpl(e,t,!1)}insertImpl(e,t,i){const r=e._lView;if(function CL(n){return gi(n[yn])}(r)){const c=this.indexOf(e);if(-1!==c)this.detach(c);else{const l=r[yn],u=new GE(l,l[oi],l[yn]);u.detach(u.indexOf(e))}}const s=this._adjustIndex(t),a=this._lContainer;return xV(a,r,s,!i),e.attachToViewContainerRef(),I1(Z0(a),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=jE(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=ph(this._lContainer,t);i&&(nh(Z0(this._lContainer),t),O_(i[De],i))}detach(e){const t=this._adjustIndex(e,-1),i=ph(this._lContainer,t);return i&&null!=nh(Z0(this._lContainer),t)?new Uu(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function jE(n){return n[8]}function Z0(n){return n[8]||(n[8]=[])}function WE(n,e){let t;const i=e[n.index];return gi(i)?t=i:(t=CS(i,e,null,n),e[n.index]=t,Lh(e,t)),$E(t,e,n,i),new GE(t,n,e)}let $E=function qE(n,e,t,i){if(n[eo])return;let r;r=8&t.type?un(i):function OV(n,e){const t=n[mt],i=t.createComment(""),r=Ri(e,n);return ia(t,gh(t,r),i,function ik(n,e){return n.nextSibling(e)}(t,r),!1),i}(e,t),n[eo]=r};class K0{constructor(e){this.queryList=e,this.matches=null}clone(){return new K0(this.queryList)}setDirty(){this.queryList.setDirty()}}class J0{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let o=0;o<i;o++){const s=t.getByIndex(o);r.push(this.queries[s.indexInDeclarationView].clone())}return new J0(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==QE(e,t).matches&&this.queries[t].setDirty()}}class XE{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class Q0{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,o=this.getByIndex(i).embeddedTView(e,r);o&&(o.indexInDeclarationView=i,null!==t?t.push(o):t=[o])}return null!==t?new Q0(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class ev{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new ev(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const o=i[r];this.matchTNodeWithReadOption(e,t,RV(t,o)),this.matchTNodeWithReadOption(e,t,eh(t,e,o,!1,!1))}else i===Bo?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,eh(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===er||r===Ur||r===Bo&&4&t.type)this.addMatch(t.index,-2);else{const o=eh(t,e,r,!1,!1);null!==o&&this.addMatch(t.index,o)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function RV(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function LV(n,e,t,i){return-1===t?function NV(n,e){return 11&n.type?Tc(n,e):4&n.type?Jh(n,e):null}(e,n):-2===t?function FV(n,e,t){return t===er?Tc(e,n):t===Bo?Jh(e,n):t===Ur?WE(e,n):void 0}(n,e,i):na(n,n[De],t,e)}function YE(n,e,t,i){const r=e[Qr].queries[i];if(null===r.matches){const o=n.data,s=t.matches,a=[];for(let c=0;c<s.length;c+=2){const l=s[c];a.push(l<0?null:LV(e,o[l],s[c+1],t.metadata.read))}r.matches=a}return r.matches}function tv(n,e,t,i){const r=n.queries.getByIndex(t),o=r.matches;if(null!==o){const s=YE(n,e,r,t);for(let a=0;a<o.length;a+=2){const c=o[a];if(c>0)i.push(s[a/2]);else{const l=o[a+1],u=e[-c];for(let d=ei;d<u.length;d++){const f=u[d];f[lu]===f[yn]&&tv(f[De],f,l,i)}if(null!==u[rc]){const d=u[rc];for(let f=0;f<d.length;f++){const h=d[f];tv(h[De],h,l,i)}}}}}return i}function td(n){const e=ne(),t=Ut(),i=d1();c_(i+1);const r=QE(t,i);if(n.dirty&&function ML(n){return 4==(4&n[Mt])}(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const o=r.crossesNgTemplate?tv(t,e,i,[]):YE(t,e,r,i);n.reset(o,iU),n.notifyOnChanges()}return!0}return!1}function ep(n,e,t){const i=Ut();i.firstCreatePass&&(function JE(n,e,t){null===n.queries&&(n.queries=new Q0),n.queries.track(new ev(e,t))}(i,new XE(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),function KE(n,e,t){const i=new Y0(4==(4&t));(function LU(n,e,t,i){const r=SS(e);r.push(t),n.firstCreatePass&&PS(n).push(i,r.length-1)})(n,e,i,i.destroy),null===e[Qr]&&(e[Qr]=new J0),e[Qr].queries.push(new K0(i))}(i,ne(),e)}function nd(){return function kV(n,e){return n[Qr].queries[e].queryList}(ne(),d1())}function QE(n,e){return n.queries.getByIndex(e)}function Cs(n,e){return Jh(n,e)}const av=new Ve("Application Initializer");let cv=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.appInits=Be(av,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const o=r();if(ju(o))t.push(o);else if(oP(o)){const s=new Promise((a,c)=>{o.subscribe({complete:a,error:c})});t.push(s)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),mT=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})();const Vo=new Ve("LocaleId",{providedIn:"root",factory:()=>Be(Vo,Dt.Optional|Dt.SkipSelf)||function oz(){return typeof $localize<"u"&&$localize.locale||jc}()});let _T=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Xi(!1)}add(){this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();class cz{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let vT=(()=>{class n{compileModuleSync(t){return new W0(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),o=ko(Ki(t).declarations).reduce((s,a)=>{const c=kt(a);return c&&s.push(new Bu(c)),s},[]);return new cz(i,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const bT=new Ve(""),ip=new Ve("");let hv,dv=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,hv||(function Oz(n){hv=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{dn.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==o),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:o,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}static{this.\u0275fac=function(i){return new(i||n)(ot(dn),ot(fv),ot(ip))}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac})}}return n})(),fv=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return hv?.findTestabilityInTree(this,t,i)??null}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})(),ws=null;const CT=new Ve("AllowMultipleToken"),pv=new Ve("PlatformDestroyListeners"),gv=new Ve("appBootstrapListener");class ST{constructor(e,t){this.name=e,this.token=t}}function ET(n,e,t=[]){const i=`Platform: ${e}`,r=new Ve(i);return(o=[])=>{let s=mv();if(!s||s.injector.get(CT,!1)){const a=[...t,...o,{provide:r,useValue:!0}];n?n(a):function Rz(n){if(ws&&!ws.get(CT,!1))throw new de(400,!1);(function wT(){!function cL(n){jC=n}(()=>{throw new de(600,!1)})})(),ws=n;const e=n.get(AT);(function PT(n){n.get(Fw,null)?.forEach(t=>t())})(n)}(function TT(n=[],e){return tr.create({name:e,providers:[{provide:$_,useValue:"platform"},{provide:pv,useValue:new Set([()=>ws=null])},...n]})}(a,i))}return function Lz(n){const e=mv();if(!e)throw new de(401,!1);return e}()}}function mv(){return ws?.get(AT)??null}let AT=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function Fz(n="zone.js",e){return"noop"===n?new xU:"zone.js"===n?new dn(e):n}(i?.ngZone,function OT(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const o=function XB(n,e,t){return new j0(n,e,t)}(t.moduleType,this.injector,function LT(n){return[{provide:dn,useFactory:n},{provide:Ou,multi:!0,useFactory:()=>{const e=Be(Uz,{optional:!0});return()=>e.initialize()}},{provide:NT,useFactory:kz},{provide:Qw,useFactory:eS}]}(()=>r)),s=o.injector.get(Fo,null);return r.runOutsideAngular(()=>{const a=r.onError.subscribe({next:c=>{s.handleError(c)}});o.onDestroy(()=>{rp(this._modules,o),a.unsubscribe()})}),function DT(n,e,t){try{const i=t();return ju(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(s,r,()=>{const a=o.injector.get(cv);return a.runInitializers(),a.donePromise.then(()=>(function eE(n){dr(n,"Expected localeId to be defined"),"string"==typeof n&&(QP=n.toLowerCase().replace(/_/g,"-"))}(o.injector.get(Vo,jc)||jc),this._moduleDoBootstrap(o),o))})})}bootstrapModule(t,i=[]){const r=IT({},i);return function Dz(n,e,t){const i=new W0(t);return Promise.resolve(i)}(0,0,t).then(o=>this.bootstrapModuleFactory(o,r))}_moduleDoBootstrap(t){const i=t.injector.get(qc);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new de(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new de(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(pv,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static{this.\u0275fac=function(i){return new(i||n)(ot(tr))}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})();function IT(n,e){return Array.isArray(e)?e.reduce(IT,n):{...n,...e}}let qc=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Be(NT),this.zoneIsStable=Be(Qw),this.componentTypes=[],this.components=[],this.isStable=Be(_T).hasPendingTasks.pipe(Kr(t=>t?ht(!1):this.zoneIsStable),function xN(n,e=ds){return n=n??yN,Vn((t,i)=>{let r,o=!0;t.subscribe(Fn(i,s=>{const a=e(s);(o||!n(r,a))&&(o=!1,r=a,i.next(s))}))})}(),cC()),this._injector=Be(mr)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof zw;if(!this._injector.get(cv).done)throw!r&&function Qa(n){const e=kt(n)||Qn(n)||pi(n);return null!==e&&e.standalone}(t),new de(405,!1);let s;s=r?t:this._injector.get(Oh).resolveComponentFactory(t),this.componentTypes.push(s.componentType);const a=function Iz(n){return n.isBoundToModule}(s)?void 0:this._injector.get(ua),l=s.create(tr.NULL,[],i||s.selector,a),u=l.location.nativeElement,d=l.injector.get(bT,null);return d?.registerApplication(u),l.onDestroy(()=>{this.detachView(l.hostView),rp(this.components,l),d?.unregisterApplication(u)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new de(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;rp(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(gv,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>rp(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new de(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function rp(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const NT=new Ve("",{providedIn:"root",factory:()=>Be(Fo).handleError.bind(void 0)});function kz(){const n=Be(dn),e=Be(Fo);return t=>n.runOutsideAngular(()=>e.handleError(t))}let Uz=(()=>{class n{constructor(){this.zone=Be(dn),this.applicationRef=Be(qc)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();let Xc=(()=>{class n{static{this.__NG_ELEMENT_ID__=Vz}}return n})();function Vz(n){return function zz(n,e,t){if(Qs(n)&&!t){const i=Ji(n.index,e);return new Uu(i,i)}return 47&n.type?new Uu(e[On],e):null}(ni(),ne(),16==(16&n))}class VT{constructor(){}supports(e){return Bh(e)}create(e){return new $z(e)}}const Wz=(n,e)=>e;class $z{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Wz}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,o=null;for(;t||i;){const s=!i||t&&t.currentIndex<HT(i,r,o)?t:i,a=HT(s,r,o),c=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(t=t._next,null==s.previousIndex)r++;else{o||(o=[]);const l=a-r,u=c-r;if(l!=u){for(let f=0;f<l;f++){const h=f<o.length?o[f]:o[f]=0,p=h+f;u<=p&&p<l&&(o[f]=h+1)}o[s.previousIndex]=u-l}}a!==c&&e(s,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Bh(e))throw new de(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,o,s,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),null!==t&&Object.is(t.trackById,s)?(i&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)):(t=this._mismatch(t,o,s,a),i=!0),t=t._next}else r=0,function E5(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Symbol.iterator]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{s=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,s)?(i&&(t=this._verifyReinsertion(t,a,s,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,s,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let o;return null===e?o=this._itTail:(o=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,r)):e=this._addAfter(new qz(t,i),o,r),e}_verifyReinsertion(e,t,i,r){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==o?e=this._reinsertAfter(o,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,o=e._nextRemoved;return null===r?this._removalsHead=o:r._nextRemoved=o,null===o?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new zT),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new zT),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class qz{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Xz{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class zT{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new Xz,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function HT(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class GT{constructor(){}supports(e){return e instanceof Map||P0(e)}create(){return new Yz}}class Yz{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||P0(e)))throw new de(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const o=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,o)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const o=r._prev,s=r._next;return o&&(o._next=s),s&&(s._prev=o),r._next=null,r._prev=null,r}const i=new Zz(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class Zz{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function jT(){return new ap([new VT])}let ap=(()=>{class n{static{this.\u0275prov=et({token:n,providedIn:"root",factory:jT})}constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||jT()),deps:[[n,new oh,new rh]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new de(901,!1)}}return n})();function WT(){return new od([new GT])}let od=(()=>{class n{static{this.\u0275prov=et({token:n,providedIn:"root",factory:WT})}constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||WT()),deps:[[n,new oh,new rh]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new de(901,!1)}}return n})();const Qz=ET(null,"core",[]);let eH=(()=>{class n{constructor(t){}static{this.\u0275fac=function(i){return new(i||n)(ot(qc))}}static{this.\u0275mod=Rr({type:n})}static{this.\u0275inj=fr({})}}return n})();let bv=null;function Ss(){return bv}class pH{}const vr=new Ve("DocumentToken");let Cv=(()=>{class n{historyGo(t){throw new Error("Not implemented")}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:function(){return Be(mH)},providedIn:"platform"})}}return n})();const gH=new Ve("Location Initialized");let mH=(()=>{class n extends Cv{constructor(){super(),this._doc=Be(vr),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Ss().getBaseHref(this._doc)}onPopState(t){const i=Ss().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Ss().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:function(){return new n},providedIn:"platform"})}}return n})();function wv(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function eA(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function zo(n){return n&&"?"!==n[0]?"?"+n:n}let fa=(()=>{class n{historyGo(t){throw new Error("Not implemented")}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:function(){return Be(nA)},providedIn:"root"})}}return n})();const tA=new Ve("appBaseHref");let nA=(()=>{class n extends fa{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??Be(vr).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return wv(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+zo(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,o){const s=this.prepareExternalUrl(r+zo(o));this._platformLocation.pushState(t,i,s)}replaceState(t,i,r,o){const s=this.prepareExternalUrl(r+zo(o));this._platformLocation.replaceState(t,i,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(i){return new(i||n)(ot(Cv),ot(tA,8))}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),_H=(()=>{class n extends fa{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=wv(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,o){let s=this.prepareExternalUrl(r+zo(o));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.pushState(t,i,s)}replaceState(t,i,r,o){let s=this.prepareExternalUrl(r+zo(o));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(i){return new(i||n)(ot(Cv),ot(tA,8))}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac})}}return n})(),Sv=(()=>{class n{constructor(t){this._subject=new Cn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function yH(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(eA(iA(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+zo(i))}normalize(t){return n.stripTrailingSlash(function xH(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,iA(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+zo(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+zo(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}static{this.normalizeQueryParams=zo}static{this.joinWithSlash=wv}static{this.stripTrailingSlash=eA}static{this.\u0275fac=function(i){return new(i||n)(ot(fa))}}static{this.\u0275prov=et({token:n,factory:function(){return function vH(){return new Sv(ot(fa))}()},providedIn:"root"})}}return n})();function iA(n){return n.replace(/\/index.html$/,"")}var lp=function(n){return n[n.Decimal=0]="Decimal",n[n.Percent=1]="Percent",n[n.Currency=2]="Currency",n[n.Scientific=3]="Scientific",n}(lp||{}),Dn=function(n){return n[n.Decimal=0]="Decimal",n[n.Group=1]="Group",n[n.List=2]="List",n[n.PercentSign=3]="PercentSign",n[n.PlusSign=4]="PlusSign",n[n.MinusSign=5]="MinusSign",n[n.Exponential=6]="Exponential",n[n.SuperscriptingExponent=7]="SuperscriptingExponent",n[n.PerMille=8]="PerMille",n[n.Infinity=9]="Infinity",n[n.NaN=10]="NaN",n[n.TimeSeparator=11]="TimeSeparator",n[n.CurrencyDecimal=12]="CurrencyDecimal",n[n.CurrencyGroup=13]="CurrencyGroup",n}(Dn||{});function xr(n,e){const t=xi(n),i=t[fn.NumberSymbols][e];if(typeof i>"u"){if(e===Dn.CurrencyDecimal)return t[fn.NumberSymbols][Dn.Decimal];if(e===Dn.CurrencyGroup)return t[fn.NumberSymbols][Dn.Group]}return i}const qH=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function Rv(n){const e=parseInt(n);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+n);return e}const Lv=/\s+/,fA=[];let hA=(()=>{class n{constructor(t,i,r,o){this._iterableDiffers=t,this._keyValueDiffers=i,this._ngEl=r,this._renderer=o,this.initialClasses=fA,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(Lv):fA}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(Lv):t}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const i of t)this._updateState(i,!0);else if(null!=t)for(const i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){const r=this.stateMap.get(t);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){(t=t.trim()).length>0&&t.split(Lv).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static{this.\u0275fac=function(i){return new(i||n)(te(ap),te(od),te(er),te(oo))}}static{this.\u0275dir=ft({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0})}}return n})();class s8{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Ps=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,o,s)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new s8(r.item,this._ngForOf,-1,-1),null===s?void 0:s);else if(null==s)i.remove(null===o?void 0:o);else if(null!==o){const a=i.get(o);i.move(a,s),gA(a,r)}});for(let r=0,o=i.length;r<o;r++){const a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{gA(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}static{this.\u0275fac=function(i){return new(i||n)(te(Ur),te(Bo),te(ap))}}static{this.\u0275dir=ft({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}}return n})();function gA(n,e){n.context.$implicit=e.item}let jo=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new a8,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){mA("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){mA("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}static{this.\u0275fac=function(i){return new(i||n)(te(Ur),te(Bo))}}static{this.\u0275dir=ft({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}}return n})();class a8{constructor(){this.$implicit=null,this.ngIf=null}}function mA(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${zn(e)}'.`)}function Vr(n,e){return new de(2100,!1)}let xA=(()=>{class n{constructor(t){this._locale=t}transform(t,i,r){if(!function Uv(n){return!(null==n||""===n||n!=n)}(t))return null;r=r||this._locale;try{return function QH(n,e,t){return function Dv(n,e,t,i,r,o,s=!1){let a="",c=!1;if(isFinite(n)){let l=function t8(n){let i,r,o,s,a,e=Math.abs(n)+"",t=0;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(o=e.search(/e/i))>0?(r<0&&(r=o),r+=+e.slice(o+1),e=e.substring(0,o)):r<0&&(r=e.length),o=0;"0"===e.charAt(o);o++);if(o===(a=e.length))i=[0],r=1;else{for(a--;"0"===e.charAt(a);)a--;for(r-=o,i=[],s=0;o<=a;o++,s++)i[s]=Number(e.charAt(o))}return r>22&&(i=i.splice(0,21),t=r-1,r=1),{digits:i,exponent:t,integerLen:r}}(n);s&&(l=function e8(n){if(0===n.digits[0])return n;const e=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(0===e?n.digits.push(0,0):1===e&&n.digits.push(0),n.integerLen+=2),n}(l));let u=e.minInt,d=e.minFrac,f=e.maxFrac;if(o){const v=o.match(qH);if(null===v)throw new Error(`${o} is not a valid digit info`);const x=v[1],y=v[3],S=v[5];null!=x&&(u=Rv(x)),null!=y&&(d=Rv(y)),null!=S?f=Rv(S):null!=y&&d>f&&(f=d)}!function n8(n,e,t){if(e>t)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${t}).`);let i=n.digits,r=i.length-n.integerLen;const o=Math.min(Math.max(e,r),t);let s=o+n.integerLen,a=i[s];if(s>0){i.splice(Math.max(n.integerLen,s));for(let d=s;d<i.length;d++)i[d]=0}else{r=Math.max(0,r),n.integerLen=1,i.length=Math.max(1,s=o+1),i[0]=0;for(let d=1;d<s;d++)i[d]=0}if(a>=5)if(s-1<0){for(let d=0;d>s;d--)i.unshift(0),n.integerLen++;i.unshift(1),n.integerLen++}else i[s-1]++;for(;r<Math.max(0,o);r++)i.push(0);let c=0!==o;const l=e+n.integerLen,u=i.reduceRight(function(d,f,h,p){return p[h]=(f+=d)<10?f:f-10,c&&(0===p[h]&&h>=l?p.pop():c=!1),f>=10?1:0},0);u&&(i.unshift(u),n.integerLen++)}(l,d,f);let h=l.digits,p=l.integerLen;const _=l.exponent;let m=[];for(c=h.every(v=>!v);p<u;p++)h.unshift(0);for(;p<0;p++)h.unshift(0);p>0?m=h.splice(p,h.length):(m=h,h=[0]);const g=[];for(h.length>=e.lgSize&&g.unshift(h.splice(-e.lgSize,h.length).join(""));h.length>e.gSize;)g.unshift(h.splice(-e.gSize,h.length).join(""));h.length&&g.unshift(h.join("")),a=g.join(xr(t,i)),m.length&&(a+=xr(t,r)+m.join("")),_&&(a+=xr(t,Dn.Exponential)+"+"+_)}else a=xr(t,Dn.Infinity);return a=n<0&&!c?e.negPre+a+e.negSuf:e.posPre+a+e.posSuf,a}(n,function Iv(n,e="-"){const t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},i=n.split(";"),r=i[0],o=i[1],s=-1!==r.indexOf(".")?r.split("."):[r.substring(0,r.lastIndexOf("0")+1),r.substring(r.lastIndexOf("0")+1)],a=s[0],c=s[1]||"";t.posPre=a.substring(0,a.indexOf("#"));for(let u=0;u<c.length;u++){const d=c.charAt(u);"0"===d?t.minFrac=t.maxFrac=u+1:"#"===d?t.maxFrac=u+1:t.posSuf+=d}const l=a.split(",");if(t.gSize=l[1]?l[1].length:0,t.lgSize=l[2]||l[1]?(l[2]||l[1]).length:0,o){const u=r.length-t.posPre.length-t.posSuf.length,d=o.indexOf("#");t.negPre=o.substring(0,d).replace(/'/g,""),t.negSuf=o.slice(d+u).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}(function Pv(n,e){return xi(n)[fn.NumberFormats][e]}(e,lp.Decimal),xr(e,Dn.MinusSign)),e,Dn.Group,Dn.Decimal,t)}(function Bv(n){if("string"==typeof n&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if("number"!=typeof n)throw new Error(`${n} is not a number`);return n}(t),r,i)}catch(o){throw Vr()}}static{this.\u0275fac=function(i){return new(i||n)(te(Vo,16))}}static{this.\u0275pipe=Di({name:"number",type:n,pure:!0,standalone:!0})}}return n})();let Vv=(()=>{class n{transform(t,i,r){if(null==t)return null;if(!this.supports(t))throw Vr();return t.slice(i,r)}supports(t){return"string"==typeof t||Array.isArray(t)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275pipe=Di({name:"slice",type:n,pure:!1,standalone:!0})}}return n})(),yA=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Rr({type:n})}static{this.\u0275inj=fr({})}}return n})();function bA(n){return"server"===n}let N8=(()=>{class n{static{this.\u0275prov=et({token:n,providedIn:"root",factory:()=>new L8(ot(vr),window)})}}return n})();class L8{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function F8(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const o=r.shadowRoot;if(o){const s=o.getElementById(e)||o.querySelector(`[name="${e}"]`);if(s)return s}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(i-o[0],r-o[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class s6 extends pH{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Gv extends s6{static makeCurrent(){!function hH(n){bv||(bv=n)}(new Gv)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function a6(){return ld=ld||document.querySelector("base"),ld?ld.getAttribute("href"):null}();return null==t?null:function c6(n){Mp=Mp||document.createElement("a"),Mp.setAttribute("href",n);const e=Mp.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){ld=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function r8(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,o]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(o)}return null}(document.cookie,e)}}let Mp,ld=null,u6=(()=>{class n{build(){return new XMLHttpRequest}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac})}}return n})();const jv=new Ve("EventManagerPlugins");let EA=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(o=>o.supports(t)),!i)throw new de(5101,!1);return this._eventNameToPlugin.set(t,i),i}static{this.\u0275fac=function(i){return new(i||n)(ot(jv),ot(dn))}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac})}}return n})();class TA{constructor(e){this._doc=e}}const Wv="ng-app-id";let AA=(()=>{class n{constructor(t,i,r,o={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=bA(o),this.resetHostNodes()}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${Wv}="${this.appId}"]`);if(t?.length){const i=new Map;return t.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){const r=this.styleRef;if(r.has(t)){const o=r.get(t);return o.usage+=i,o.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){const r=this.styleNodesInDOM,o=r?.get(i);if(o?.parentNode===t)return r.delete(i),o.removeAttribute(Wv),o;{const s=this.doc.createElement("style");return this.nonce&&s.setAttribute("nonce",this.nonce),s.textContent=i,this.platformIsServer&&s.setAttribute(Wv,this.appId),s}}addStyleToHost(t,i){const r=this.getStyleElement(t,i);t.appendChild(r);const o=this.styleRef,s=o.get(i)?.elements;s?s.push(r):o.set(i,{elements:[r],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(i){return new(i||n)(ot(vr),ot(wh),ot(kw,8),ot(Sc))}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac})}}return n})();const $v={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},qv=/%COMP%/g,p6=new Ve("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function DA(n,e){return e.map(t=>t.replace(qv,n))}let IA=(()=>{class n{constructor(t,i,r,o,s,a,c,l=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=bA(a),this.defaultRenderer=new Xv(t,s,c,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Dr.ShadowDom&&(i={...i,encapsulation:Dr.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof NA?r.applyToHost(t):r instanceof Yv&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let o=r.get(i.id);if(!o){const s=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(i.encapsulation){case Dr.Emulated:o=new NA(c,l,i,this.appId,u,s,a,d);break;case Dr.ShadowDom:return new v6(c,l,t,i,s,a,this.nonce,d);default:o=new Yv(c,l,i,u,s,a,d)}r.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(i){return new(i||n)(ot(EA),ot(AA),ot(wh),ot(p6),ot(vr),ot(Sc),ot(dn),ot(kw))}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac})}}return n})();class Xv{constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS($v[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(RA(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(RA(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?this.doc.querySelector(e):e;if(!i)throw new de(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const o=$v[r];o?e.setAttributeNS(o,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=$v[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(xs.DashCase|xs.Important)?e.style.setProperty(t,i,r&xs.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&xs.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){if("string"==typeof e&&!(e=Ss().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function RA(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class v6 extends Xv{constructor(e,t,i,r,o,s,a,c){super(e,o,s,c),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=DA(r.id,r.styles);for(const u of l){const d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=u,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Yv extends Xv{constructor(e,t,i,r,o,s,a,c){super(e,o,s,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=c?DA(c,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class NA extends Yv{constructor(e,t,i,r,o,s,a,c){const l=r+"-"+i.id;super(e,t,i,o,s,a,c,l),this.contentAttr=function g6(n){return"_ngcontent-%COMP%".replace(qv,n)}(l),this.hostAttr=function m6(n){return"_nghost-%COMP%".replace(qv,n)}(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let x6=(()=>{class n extends TA{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static{this.\u0275fac=function(i){return new(i||n)(ot(vr))}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac})}}return n})();const LA=["alt","control","meta","shift"],y6={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},M6={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let b6=(()=>{class n extends TA{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const o=n.parseEventName(i),s=n.eventCallback(o.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ss().onAndCancel(t,o.domEventName,s))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const o=n._normalizeKey(i.pop());let s="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),s="code."),LA.forEach(l=>{const u=i.indexOf(l);u>-1&&(i.splice(u,1),s+=l+".")}),s+=o,0!=i.length||0===o.length)return null;const c={};return c.domEventName=r,c.fullKey=s,c}static matchEventFullKeyCode(t,i){let r=y6[t.key]||t.key,o="";return i.indexOf("code.")>-1&&(r=t.code,o="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),LA.forEach(s=>{s!==r&&(0,M6[s])(t)&&(o+=s+".")}),o+=r,o===i)}static eventCallback(t,i,r){return o=>{n.matchEventFullKeyCode(o,t)&&r.runGuarded(()=>i(o))}}static _normalizeKey(t){return"esc"===t?"escape":t}static{this.\u0275fac=function(i){return new(i||n)(ot(vr))}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac})}}return n})();const P6=ET(Qz,"browser",[{provide:Sc,useValue:"browser"},{provide:Fw,useValue:function C6(){Gv.makeCurrent()},multi:!0},{provide:vr,useFactory:function S6(){return function dk(n){k_=n}(document),document},deps:[]}]),E6=new Ve(""),UA=[{provide:ip,useClass:class l6{addToWindow(e){ln.getAngularTestability=(i,r=!0)=>{const o=e.findTestabilityInTree(i,r);if(null==o)throw new de(5103,!1);return o},ln.getAllAngularTestabilities=()=>e.getAllTestabilities(),ln.getAllAngularRootElements=()=>e.getAllRootElements(),ln.frameworkStabilizers||(ln.frameworkStabilizers=[]),ln.frameworkStabilizers.push(i=>{const r=ln.getAllAngularTestabilities();let o=r.length,s=!1;const a=function(c){s=s||c,o--,0==o&&i(s)};r.forEach(c=>{c.whenStable(a)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?Ss().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:bT,useClass:dv,deps:[dn,fv,ip]},{provide:dv,useClass:dv,deps:[dn,fv,ip]}],BA=[{provide:$_,useValue:"root"},{provide:Fo,useFactory:function w6(){return new Fo},deps:[]},{provide:jv,useClass:x6,multi:!0,deps:[vr,dn,Sc]},{provide:jv,useClass:b6,multi:!0,deps:[vr]},IA,AA,EA,{provide:Gw,useExisting:IA},{provide:class k8{},useClass:u6,deps:[]},[]];let T6=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:wh,useValue:t.appId}]}}static{this.\u0275fac=function(i){return new(i||n)(ot(E6,12))}}static{this.\u0275mod=Rr({type:n})}static{this.\u0275inj=fr({providers:[...BA,...UA],imports:[yA,eH]})}}return n})(),VA=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(i){return new(i||n)(ot(vr))}}static{this.\u0275prov=et({token:n,factory:function(i){let r=null;return r=i?new i:function O6(){return new VA(ot(vr))}(),r},providedIn:"root"})}}return n})();typeof window<"u"&&window;const{isArray:F6}=Array,{getPrototypeOf:k6,prototype:U6,keys:B6}=Object;function jA(n){if(1===n.length){const e=n[0];if(F6(e))return{args:e,keys:null};if(function V6(n){return n&&"object"==typeof n&&k6(n)===U6}(e)){const t=B6(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:z6}=Array;function WA(n){return nn(e=>function H6(n,e){return z6(e)?n(...e):n(e)}(n,e))}function $A(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function Kv(...n){const e=nu(n),t=rC(n),{args:i,keys:r}=jA(n);if(0===i.length)return qn([],e);const o=new Ln(function G6(n,e,t=ds){return i=>{qA(e,()=>{const{length:r}=n,o=new Array(r);let s=r,a=r;for(let c=0;c<r;c++)qA(e,()=>{const l=qn(n[c],e);let u=!1;l.subscribe(Fn(i,d=>{o[c]=d,u||(u=!0,a--),a||i.next(t(o.slice()))},()=>{--s||i.complete()}))},i)},i)}}(i,e,r?s=>$A(r,s):ds));return t?o.pipe(WA(t)):o}function qA(n,e,t){n?Ao(t,n,e):e()}const bp=Ql(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Jv(...n){return function j6(){return Ka(1)}()(qn(n,nu(n)))}function XA(n){return new Ln(e=>{qi(n()).subscribe(e)})}function ud(n,e){const t=en(n)?n:()=>n,i=r=>r.error(t());return new Ln(e?r=>e.schedule(i,0,r):i)}function Qv(){return Vn((n,e)=>{let t=null;n._refCount++;const i=Fn(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,o=t;t=null,r&&(!o||r===o)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class YA extends Ln{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Gb(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new $i;const t=this.getSubject();e.add(this.source.subscribe(Fn(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=$i.EMPTY)}return e}refCount(){return Qv()(this)}}function Kc(n){return n<=0?()=>Zr:Vn((e,t)=>{let i=0;e.subscribe(Fn(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function Ts(n,e){return Vn((t,i)=>{let r=0;t.subscribe(Fn(i,o=>n.call(e,o,r++)&&i.next(o)))})}function Cp(n){return Vn((e,t)=>{let i=!1;e.subscribe(Fn(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function ZA(n=$6){return Vn((e,t)=>{let i=!1;e.subscribe(Fn(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function $6(){return new bp}function ha(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Ts((r,o)=>n(r,o,i)):ds,Kc(1),t?Cp(e):ZA(()=>new bp))}function dd(n,e){return en(e)?Jn(n,e,1):Jn(n,1)}function ci(n,e,t){const i=en(n)||e||t?{next:n,error:e,complete:t}:n;return i?Vn((r,o)=>{var s;null===(s=i.subscribe)||void 0===s||s.call(i);let a=!0;r.subscribe(Fn(o,c=>{var l;null===(l=i.next)||void 0===l||l.call(i,c),o.next(c)},()=>{var c;a=!1,null===(c=i.complete)||void 0===c||c.call(i),o.complete()},c=>{var l;a=!1,null===(l=i.error)||void 0===l||l.call(i,c),o.error(c)},()=>{var c,l;a&&(null===(c=i.unsubscribe)||void 0===c||c.call(i)),null===(l=i.finalize)||void 0===l||l.call(i)}))}):ds}function pa(n){return Vn((e,t)=>{let o,i=null,r=!1;i=e.subscribe(Fn(t,void 0,void 0,s=>{o=qi(n(s,pa(n)(e))),i?(i.unsubscribe(),i=null,o.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,o.subscribe(t))})}function ex(n){return n<=0?()=>Zr:Vn((e,t)=>{let i=[];e.subscribe(Fn(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function tx(n){return Vn((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const wt="primary",fd=Symbol("RouteTitle");class J6{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Jc(n){return new J6(n)}function Q6(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let o=0;o<i.length;o++){const s=i[o],a=n[o];if(s.startsWith(":"))r[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function ho(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let o=0;o<t.length;o++)if(r=t[o],!KA(n[r],e[r]))return!1;return!0}function KA(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,o)=>i[o]===r)}return n===e}function JA(n){return n.length>0?n[n.length-1]:null}function As(n){return function L6(n){return!!n&&(n instanceof Ln||en(n.lift)&&en(n.subscribe))}(n)?n:ju(n)?qn(Promise.resolve(n)):ht(n)}const t9={exact:function tO(n,e,t){if(!ga(n.segments,e.segments)||!wp(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!tO(n.children[i],e.children[i],t))return!1;return!0},subset:nO},QA={exact:function n9(n,e){return ho(n,e)},subset:function i9(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>KA(n[t],e[t]))},ignored:()=>!0};function eO(n,e,t){return t9[t.paths](n.root,e.root,t.matrixParams)&&QA[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function nO(n,e,t){return iO(n,e,e.segments,t)}function iO(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!ga(r,t)||e.hasChildren()||!wp(r,t,i))}if(n.segments.length===t.length){if(!ga(n.segments,t)||!wp(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!nO(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!!(ga(n.segments,r)&&wp(n.segments,r,i)&&n.children[wt])&&iO(n.children[wt],e,o,i)}}function wp(n,e,t){return e.every((i,r)=>QA[t](n[r].parameters,i.parameters))}class Qc{constructor(e=new Zt([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Jc(this.queryParams)),this._queryParamMap}toString(){return s9.serialize(this)}}class Zt{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Sp(this)}}class hd{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Jc(this.parameters)),this._parameterMap}toString(){return sO(this)}}function ga(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let pd=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:function(){return new nx},providedIn:"root"})}}return n})();class nx{parse(e){const t=new _9(e);return new Qc(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${gd(e.root,!0)}`,i=function l9(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${Pp(t)}=${Pp(r)}`).join("&"):`${Pp(t)}=${Pp(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function a9(n){return encodeURI(n)}(e.fragment)}`:""}`}}const s9=new nx;function Sp(n){return n.segments.map(e=>sO(e)).join("/")}function gd(n,e){if(!n.hasChildren())return Sp(n);if(e){const t=n.children[wt]?gd(n.children[wt],!1):"",i=[];return Object.entries(n.children).forEach(([r,o])=>{r!==wt&&i.push(`${r}:${gd(o,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function o9(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===wt&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==wt&&(t=t.concat(e(r,i)))}),t}(n,(i,r)=>r===wt?[gd(n.children[wt],!1)]:[`${r}:${gd(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[wt]?`${Sp(n)}/${t[0]}`:`${Sp(n)}/(${t.join("//")})`}}function rO(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Pp(n){return rO(n).replace(/%3B/gi,";")}function ix(n){return rO(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ep(n){return decodeURIComponent(n)}function oO(n){return Ep(n.replace(/\+/g,"%20"))}function sO(n){return`${ix(n.path)}${function c9(n){return Object.keys(n).map(e=>`;${ix(e)}=${ix(n[e])}`).join("")}(n.parameters)}`}const u9=/^[^\/()?;#]+/;function rx(n){const e=n.match(u9);return e?e[0]:""}const d9=/^[^\/()?;=#]+/,h9=/^[^=?&#]+/,g9=/^[^&#]+/;class _9{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Zt([],{}):new Zt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[wt]=new Zt(e,t)),i}parseSegment(){const e=rx(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new de(4009,!1);return this.capture(e),new hd(Ep(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function f9(n){const e=n.match(d9);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=rx(this.remaining);r&&(i=r,this.capture(i))}e[Ep(t)]=Ep(i)}parseQueryParam(e){const t=function p9(n){const e=n.match(h9);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const s=function m9(n){const e=n.match(g9);return e?e[0]:""}(this.remaining);s&&(i=s,this.capture(i))}const r=oO(t),o=oO(i);if(e.hasOwnProperty(r)){let s=e[r];Array.isArray(s)||(s=[s],e[r]=s),s.push(o)}else e[r]=o}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=rx(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new de(4010,!1);let o;i.indexOf(":")>-1?(o=i.slice(0,i.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=wt);const s=this.parseChildren();t[o]=1===Object.keys(s).length?s[wt]:new Zt([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new de(4011,!1)}}function aO(n){return n.segments.length>0?new Zt([],{[wt]:n}):n}function cO(n){const e={};for(const i of Object.keys(n.children)){const o=cO(n.children[i]);if(i===wt&&0===o.segments.length&&o.hasChildren())for(const[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[i]=o)}return function v9(n){if(1===n.numberOfChildren&&n.children[wt]){const e=n.children[wt];return new Zt(n.segments.concat(e.segments),e.children)}return n}(new Zt(n.segments,e))}function ma(n){return n instanceof Qc}function lO(n){let e;const r=aO(function t(o){const s={};for(const c of o.children){const l=t(c);s[c.outlet]=l}const a=new Zt(o.url,s);return o===n&&(e=a),a}(n.root));return e??r}function uO(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(0===e.length)return ox(r,r,r,t,i);const o=function y9(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new fO(!0,0,n);let e=0,t=!1;const i=n.reduce((r,o,s)=>{if("object"==typeof o&&null!=o){if(o.outlets){const a={};return Object.entries(o.outlets).forEach(([c,l])=>{a[c]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(o.segmentPath)return[...r,o.segmentPath]}return"string"!=typeof o?[...r,o]:0===s?(o.split("/").forEach((a,c)=>{0==c&&"."===a||(0==c&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,o]},[]);return new fO(t,e,i)}(e);if(o.toRoot())return ox(r,r,new Zt([],{}),t,i);const s=function M9(n,e,t){if(n.isAbsolute)return new Ap(e,!0,0);if(!t)return new Ap(e,!1,NaN);if(null===t.parent)return new Ap(t,!0,0);const i=Tp(n.commands[0])?0:1;return function b9(n,e,t){let i=n,r=e,o=t;for(;o>r;){if(o-=r,i=i.parent,!i)throw new de(4005,!1);r=i.segments.length}return new Ap(i,!1,r-o)}(t,t.segments.length-1+i,n.numberOfDoubleDots)}(o,r,n),a=s.processChildren?_d(s.segmentGroup,s.index,o.commands):hO(s.segmentGroup,s.index,o.commands);return ox(r,s.segmentGroup,a,t,i)}function Tp(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function md(n){return"object"==typeof n&&null!=n&&n.outlets}function ox(n,e,t,i,r){let s,o={};i&&Object.entries(i).forEach(([c,l])=>{o[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`}),s=n===e?t:dO(n,e,t);const a=aO(cO(s));return new Qc(a,o,r)}function dO(n,e,t){const i={};return Object.entries(n.children).forEach(([r,o])=>{i[r]=o===e?t:dO(o,e,t)}),new Zt(n.segments,i)}class fO{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Tp(i[0]))throw new de(4003,!1);const r=i.find(md);if(r&&r!==JA(i))throw new de(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Ap{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function hO(n,e,t){if(n||(n=new Zt([],{})),0===n.segments.length&&n.hasChildren())return _d(n,e,t);const i=function w9(n,e,t){let i=0,r=e;const o={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return o;const s=n.segments[r],a=t[i];if(md(a))break;const c=`${a}`,l=i<t.length-1?t[i+1]:null;if(r>0&&void 0===c)break;if(c&&l&&"object"==typeof l&&void 0===l.outlets){if(!gO(c,l,s))return o;i+=2}else{if(!gO(c,{},s))return o;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const o=new Zt(n.segments.slice(0,i.pathIndex),{});return o.children[wt]=new Zt(n.segments.slice(i.pathIndex),n.children),_d(o,0,r)}return i.match&&0===r.length?new Zt(n.segments,{}):i.match&&!n.hasChildren()?sx(n,e,t):i.match?_d(n,0,r):sx(n,e,t)}function _d(n,e,t){if(0===t.length)return new Zt(n.segments,{});{const i=function C9(n){return md(n[0])?n[0].outlets:{[wt]:n}}(t),r={};if(Object.keys(i).some(o=>o!==wt)&&n.children[wt]&&1===n.numberOfChildren&&0===n.children[wt].segments.length){const o=_d(n.children[wt],e,t);return new Zt(n.segments,o.children)}return Object.entries(i).forEach(([o,s])=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=hO(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{void 0===i[o]&&(r[o]=s)}),new Zt(n.segments,r)}}function sx(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const o=t[r];if(md(o)){const c=S9(o.outlets);return new Zt(i,c)}if(0===r&&Tp(t[0])){i.push(new hd(n.segments[e].path,pO(t[0]))),r++;continue}const s=md(o)?o.outlets[wt]:`${o}`,a=r<t.length-1?t[r+1]:null;s&&a&&Tp(a)?(i.push(new hd(s,pO(a))),r+=2):(i.push(new hd(s,{})),r++)}return new Zt(i,{})}function S9(n){const e={};return Object.entries(n).forEach(([t,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(e[t]=sx(new Zt([],{}),0,i))}),e}function pO(n){const e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function gO(n,e,t){return n==t.path&&ho(e,t.parameters)}const vd="imperative";class po{constructor(e,t){this.id=e,this.url=t}}class Op extends po{constructor(e,t,i="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Wo extends po{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class xd extends po{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class el extends po{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=16}}class Dp extends po{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class mO extends po{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class P9 extends po{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class E9 extends po{constructor(e,t,i,r,o){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=o,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class T9 extends po{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class A9 extends po{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class O9{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class D9{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class I9{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class R9{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class N9{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class L9{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class _O{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class ax{}class cx{constructor(e){this.url=e}}class F9{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new yd,this.attachRef=null}}let yd=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new F9,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();class vO{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=lx(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=lx(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=ux(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return ux(e,this._root).map(t=>t.value)}}function lx(n,e){if(n===e.value)return e;for(const t of e.children){const i=lx(n,t);if(i)return i}return null}function ux(n,e){if(n===e.value)return[e];for(const t of e.children){const i=ux(n,t);if(i.length)return i.unshift(e),i}return[]}class $o{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function tl(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class xO extends vO{constructor(e,t){super(e),this.snapshot=t,dx(this,e)}toString(){return this.snapshot.toString()}}function yO(n,e){const t=function k9(n,e){const s=new Ip([],{},{},"",{},wt,e,null,{});return new bO("",new $o(s,[]))}(0,e),i=new Xi([new hd("",{})]),r=new Xi({}),o=new Xi({}),s=new Xi({}),a=new Xi(""),c=new Os(i,r,s,a,o,wt,e,t.root);return c.snapshot=t.root,new xO(new $o(c,[]),t)}class Os{constructor(e,t,i,r,o,s,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(nn(l=>l[fd]))??ht(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(nn(e=>Jc(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(nn(e=>Jc(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function MO(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],o=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(o.component)break;i--}}return function U9(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class Ip{get title(){return this.data?.[fd]}constructor(e,t,i,r,o,s,a,c,l){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o,this.outlet=s,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Jc(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Jc(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class bO extends vO{constructor(e,t){super(t),this.url=e,dx(this,t)}toString(){return CO(this._root)}}function dx(n,e){e.value._routerState=n,e.children.forEach(t=>dx(n,t))}function CO(n){const e=n.children.length>0?` { ${n.children.map(CO).join(", ")} } `:"";return`${n.value}${e}`}function fx(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,ho(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),ho(e.params,t.params)||n.paramsSubject.next(t.params),function e9(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!ho(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.urlSubject.next(t.url),ho(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function hx(n,e){const t=ho(n.params,e.params)&&function r9(n,e){return ga(n,e)&&n.every((t,i)=>ho(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||hx(n.parent,e.parent))}let px=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=wt,this.activateEvents=new Cn,this.deactivateEvents=new Cn,this.attachEvents=new Cn,this.detachEvents=new Cn,this.parentContexts=Be(yd),this.location=Be(Ur),this.changeDetector=Be(Xc),this.environmentInjector=Be(mr),this.inputBinder=Be(Rp,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new de(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new de(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new de(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new de(4013,!1);this._activatedRoute=t;const r=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new B9(t,a,r.injector);this.activated=r.createComponent(s,{index:r.length,injector:c,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=ft({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[pr]})}}return n})();class B9{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===Os?this.route:e===yd?this.childContexts:this.parent.get(e,t)}}const Rp=new Ve("");let wO=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:i}=t,r=Kv([i.queryParams,i.params,i.data]).pipe(Kr(([o,s,a],c)=>(a={...o,...s,...a},0===c?ht(a):Promise.resolve(a)))).subscribe(o=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(t);const s=function fH(n){const e=kt(n);if(!e)return null;const t=new Bu(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(i.component);if(s)for(const{templateName:a}of s.inputs)t.activatedComponentRef.setInput(a,o[a]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,r)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac})}}return n})();function Md(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function z9(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return Md(n,i,r);return Md(n,i)})}(n,e,t);return new $o(i,r)}{if(n.shouldAttach(e.value)){const o=n.retrieve(e.value);if(null!==o){const s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>Md(n,a)),s}}const i=function H9(n){return new Os(new Xi(n.url),new Xi(n.params),new Xi(n.queryParams),new Xi(n.fragment),new Xi(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(o=>Md(n,o));return new $o(i,r)}}const gx="ngNavigationCancelingError";function SO(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=ma(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=PO(!1,0,e);return r.url=t,r.navigationBehaviorOptions=i,r}function PO(n,e,t){const i=new Error("NavigationCancelingError: "+(n||""));return i[gx]=!0,i.cancellationCode=e,t&&(i.url=t),i}function EO(n){return n&&n[gx]}let TO=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Zi({type:n,selectors:[["ng-component"]],standalone:!0,features:[q0],decls:1,vars:0,template:function(i,r){1&i&&U(0,"router-outlet")},dependencies:[px],encapsulation:2})}}return n})();function mx(n){const e=n.children&&n.children.map(mx),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==wt&&(t.component=TO),t}function zr(n){return n.outlet||wt}function bd(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class Z9{constructor(e,t,i,r,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=o}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),fx(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=tl(t);e.children.forEach(o=>{const s=o.value.outlet;this.deactivateRoutes(o,r[s],i),delete r[s]}),Object.values(r).forEach(o=>{this.deactivateRouteAndItsChildren(o,i)})}deactivateRoutes(e,t,i){const r=e.value,o=t?t.value:null;if(r===o)if(r.component){const s=i.getContext(r.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,i);else o&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=tl(e);for(const s of Object.keys(o))this.deactivateRouteAndItsChildren(o[s],r);if(i&&i.outlet){const s=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=tl(e);for(const s of Object.keys(o))this.deactivateRouteAndItsChildren(o[s],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){const r=tl(t);e.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],i),this.forwardEvent(new L9(o.value.snapshot))}),e.children.length&&this.forwardEvent(new R9(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,o=t?t.value:null;if(fx(r),r===o)if(r.component){const s=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const s=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),fx(a.route.value),this.activateChildRoutes(e,null,s.children)}else{const a=bd(r.snapshot);s.attachRef=null,s.route=r,s.injector=a,s.outlet&&s.outlet.activateWith(r,s.injector),this.activateChildRoutes(e,null,s.children)}}else this.activateChildRoutes(e,null,i)}}class AO{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Np{constructor(e,t){this.component=e,this.route=t}}function K9(n,e,t){const i=n._root;return Cd(i,e?e._root:null,t,[i.value])}function nl(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function EN(n){return null!==Nf(n)}(n)?e.get(n):n:i}function Cd(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const o=tl(e);return n.children.forEach(s=>{(function Q9(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){const c=function eG(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!ga(n.url,e.url);case"pathParamsOrQueryParamsChange":return!ga(n.url,e.url)||!ho(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!hx(n,e)||!ho(n.queryParams,e.queryParams);default:return!hx(n,e)}}(s,o,o.routeConfig.runGuardsAndResolvers);c?r.canActivateChecks.push(new AO(i)):(o.data=s.data,o._resolvedData=s._resolvedData),Cd(n,e,o.component?a?a.children:null:t,i,r),c&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Np(a.outlet.component,s))}else s&&wd(e,a,r),r.canActivateChecks.push(new AO(i)),Cd(n,null,o.component?a?a.children:null:t,i,r)})(s,o[s.value.outlet],t,i.concat([s.value]),r),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>wd(a,t.getContext(s),r)),r}function wd(n,e,t){const i=tl(n),r=n.value;Object.entries(i).forEach(([o,s])=>{wd(s,r.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new Np(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function Sd(n){return"function"==typeof n}function OO(n){return n instanceof bp||"EmptyError"===n?.name}const Lp=Symbol("INITIAL_VALUE");function il(){return Kr(n=>Kv(n.map(e=>e.pipe(Kc(1),function W6(...n){const e=nu(n);return Vn((t,i)=>{(e?Jv(n,t,e):Jv(n,t)).subscribe(i)})}(Lp)))).pipe(nn(e=>{for(const t of e)if(!0!==t){if(t===Lp)return Lp;if(!1===t||t instanceof Qc)return t}return!0}),Ts(e=>e!==Lp),Kc(1)))}function DO(n){return function w3(...n){return Vb(n)}(ci(e=>{if(ma(e))throw SO(0,e)}),nn(e=>!0===e))}class Fp{constructor(e){this.segmentGroup=e||null}}class IO{constructor(e){this.urlTree=e}}function rl(n){return ud(new Fp(n))}function RO(n){return ud(new IO(n))}class yG{constructor(e,t){this.urlSerializer=e,this.urlTree=t}noMatchError(e){return new de(4002,!1)}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return ht(i);if(r.numberOfChildren>1||!r.children[wt])return ud(new de(4e3,!1));r=r.children[wt]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreateUrlTree(e,t,i,r){const o=this.createSegmentGroup(e,t.root,i,r);return new Qc(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Object.entries(e).forEach(([r,o])=>{if("string"==typeof o&&o.startsWith(":")){const a=o.substring(1);i[r]=t[a]}else i[r]=o}),i}createSegmentGroup(e,t,i,r){const o=this.createSegments(e,t.segments,i,r);let s={};return Object.entries(t.children).forEach(([a,c])=>{s[a]=this.createSegmentGroup(e,c,i,r)}),new Zt(o,s)}createSegments(e,t,i,r){return t.map(o=>o.path.startsWith(":")?this.findPosParam(e,o,r):this.findOrReturn(o,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new de(4001,!1);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}const _x={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function MG(n,e,t,i,r){const o=vx(n,e,t);return o.matched?(i=function j9(n,e){return n.providers&&!n._injector&&(n._injector=$0(n.providers,e,`Route: ${n.path}`)),n._injector??e}(e,i),function _G(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?ht(r.map(s=>{const a=nl(s,n);return As(function sG(n){return n&&Sd(n.canMatch)}(a)?a.canMatch(e,t):n.runInContext(()=>a(e,t)))})).pipe(il(),DO()):ht(!0)}(i,e,t).pipe(nn(s=>!0===s?o:{..._x}))):ht(o)}function vx(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{..._x}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||Q6)(t,n,e);if(!r)return{..._x};const o={};Object.entries(r.posParams??{}).forEach(([a,c])=>{o[a]=c.path});const s=r.consumed.length>0?{...o,...r.consumed[r.consumed.length-1].parameters}:o;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:s,positionalParamSegments:r.posParams??{}}}function NO(n,e,t,i){return t.length>0&&function wG(n,e,t){return t.some(i=>kp(n,e,i)&&zr(i)!==wt)}(n,t,i)?{segmentGroup:new Zt(e,CG(i,new Zt(t,n.children))),slicedSegments:[]}:0===t.length&&function SG(n,e,t){return t.some(i=>kp(n,e,i))}(n,t,i)?{segmentGroup:new Zt(n.segments,bG(n,0,t,i,n.children)),slicedSegments:t}:{segmentGroup:new Zt(n.segments,n.children),slicedSegments:t}}function bG(n,e,t,i,r){const o={};for(const s of i)if(kp(n,t,s)&&!r[zr(s)]){const a=new Zt([],{});o[zr(s)]=a}return{...r,...o}}function CG(n,e){const t={};t[wt]=e;for(const i of n)if(""===i.path&&zr(i)!==wt){const r=new Zt([],{});t[zr(i)]=r}return t}function kp(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class AG{constructor(e,t,i,r,o,s,a){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.allowRedirects=!0,this.applyRedirects=new yG(this.urlSerializer,this.urlTree)}noMatchError(e){return new de(4002,!1)}recognize(){const e=NO(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,wt).pipe(pa(t=>{if(t instanceof IO)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof Fp?this.noMatchError(t):t}),nn(t=>{const i=new Ip([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},wt,this.rootComponentType,null,{}),r=new $o(i,t),o=new bO("",r),s=function x9(n,e,t=null,i=null){return uO(lO(n),e,t,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),this.inheritParamsAndData(o._root),{state:o,tree:s}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e.root,wt).pipe(pa(i=>{throw i instanceof Fp?this.noMatchError(i):i}))}inheritParamsAndData(e){const t=e.value,i=MO(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r,!0)}processChildren(e,t,i){const r=[];for(const o of Object.keys(i.children))"primary"===o?r.unshift(o):r.push(o);return qn(r).pipe(dd(o=>{const s=i.children[o],a=function X9(n,e){const t=n.filter(i=>zr(i)===e);return t.push(...n.filter(i=>zr(i)!==e)),t}(t,o);return this.processSegmentGroup(e,a,s,o)}),function X6(n,e){return Vn(function q6(n,e,t,i,r){return(o,s)=>{let a=t,c=e,l=0;o.subscribe(Fn(s,u=>{const d=l++;c=a?n(c,u,d):(a=!0,u),i&&s.next(c)},r&&(()=>{a&&s.next(c),s.complete()})))}}(n,e,arguments.length>=2,!0))}((o,s)=>(o.push(...s),o)),Cp(null),function Y6(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Ts((r,o)=>n(r,o,i)):ds,ex(1),t?Cp(e):ZA(()=>new bp))}(),Jn(o=>{if(null===o)return rl(i);const s=LO(o);return function OG(n){n.sort((e,t)=>e.value.outlet===wt?-1:t.value.outlet===wt?1:e.value.outlet.localeCompare(t.value.outlet))}(s),ht(s)}))}processSegment(e,t,i,r,o,s){return qn(t).pipe(dd(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,i,r,o,s).pipe(pa(c=>{if(c instanceof Fp)return ht(null);throw c}))),ha(a=>!!a),pa(a=>{if(OO(a))return function EG(n,e,t){return 0===e.length&&!n.children[t]}(i,r,o)?ht([]):rl(i);throw a}))}processSegmentAgainstRoute(e,t,i,r,o,s,a){return function PG(n,e,t,i){return!!(zr(n)===i||i!==wt&&kp(e,t,n))&&("**"===n.path||vx(e,n,t).matched)}(i,r,o,s)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,r,i,o,s,a):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,o,s):rl(r):rl(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,o,s){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,s):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,o,s)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const o=this.applyRedirects.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?RO(o):this.applyRedirects.lineralizeSegments(i,o).pipe(Jn(s=>{const a=new Zt(s,{});return this.processSegment(e,t,a,s,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,o,s){const{matched:a,consumedSegments:c,remainingSegments:l,positionalParamSegments:u}=vx(t,r,o);if(!a)return rl(t);const d=this.applyRedirects.applyRedirectCommands(c,r.redirectTo,u);return r.redirectTo.startsWith("/")?RO(d):this.applyRedirects.lineralizeSegments(r,d).pipe(Jn(f=>this.processSegment(e,i,t,f.concat(l),s,!1)))}matchSegmentAgainstRoute(e,t,i,r,o,s){let a;if("**"===i.path){const c=r.length>0?JA(r).parameters:{};a=ht({snapshot:new Ip(r,c,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,FO(i),zr(i),i.component??i._loadedComponent??null,i,kO(i)),consumedSegments:[],remainingSegments:[]}),t.children={}}else a=MG(t,i,r,e).pipe(nn(({matched:c,consumedSegments:l,remainingSegments:u,parameters:d})=>c?{snapshot:new Ip(l,d,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,FO(i),zr(i),i.component??i._loadedComponent??null,i,kO(i)),consumedSegments:l,remainingSegments:u}:null));return a.pipe(Kr(c=>null===c?rl(t):this.getChildConfig(e=i._injector??e,i,r).pipe(Kr(({routes:l})=>{const u=i._loadedInjector??e,{snapshot:d,consumedSegments:f,remainingSegments:h}=c,{segmentGroup:p,slicedSegments:_}=NO(t,f,h,l);if(0===_.length&&p.hasChildren())return this.processChildren(u,l,p).pipe(nn(g=>null===g?null:[new $o(d,g)]));if(0===l.length&&0===_.length)return ht([new $o(d,[])]);const m=zr(i)===o;return this.processSegment(u,l,p,_,m?wt:o,!0).pipe(nn(g=>[new $o(d,g)]))}))))}getChildConfig(e,t,i){return t.children?ht({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?ht({routes:t._loadedRoutes,injector:t._loadedInjector}):function mG(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?ht(!0):ht(r.map(s=>{const a=nl(s,n);return As(function nG(n){return n&&Sd(n.canLoad)}(a)?a.canLoad(e,t):n.runInContext(()=>a(e,t)))})).pipe(il(),DO())}(e,t,i).pipe(Jn(r=>r?this.configLoader.loadChildren(e,t).pipe(ci(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):function xG(n){return ud(PO(!1,3))}())):ht({routes:[],injector:e})}}function DG(n){const e=n.value.routeConfig;return e&&""===e.path}function LO(n){const e=[],t=new Set;for(const i of n){if(!DG(i)){e.push(i);continue}const r=e.find(o=>i.value.routeConfig===o.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=LO(i.children);e.push(new $o(i.value,r))}return e.filter(i=>!t.has(i))}function FO(n){return n.data||{}}function kO(n){return n.resolve||{}}function UO(n){return"string"==typeof n.title||null===n.title}function xx(n){return Kr(e=>{const t=n(e);return t?qn(t).pipe(nn(()=>e)):ht(e)})}const ol=new Ve("ROUTES");let yx=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Be(vT)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return ht(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=As(t.loadComponent()).pipe(nn(BO),ci(o=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=o}),tx(()=>{this.componentLoaders.delete(t)})),r=new YA(i,()=>new Or).pipe(Qv());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return ht({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const o=function UG(n,e,t,i){return As(n.loadChildren()).pipe(nn(BO),Jn(r=>r instanceof SE||Array.isArray(r)?ht(r):qn(e.compileModuleAsync(r))),nn(r=>{i&&i(n);let o,s,a=!1;return Array.isArray(r)?(s=r,!0):(o=r.create(t).injector,s=o.get(ol,[],{optional:!0,self:!0}).flat()),{routes:s.map(mx),injector:o}}))}(i,this.compiler,t,this.onLoadEndListener).pipe(tx(()=>{this.childrenLoaders.delete(i)})),s=new YA(o,()=>new Or).pipe(Qv());return this.childrenLoaders.set(i,s),s}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function BO(n){return function BG(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let Up=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Or,this.transitionAbortSubject=new Or,this.configLoader=Be(yx),this.environmentInjector=Be(mr),this.urlSerializer=Be(pd),this.rootContexts=Be(yd),this.inputBindingEnabled=null!==Be(Rp,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>ht(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new D9(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new O9(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t,i,r){return this.transitions=new Xi({id:0,currentUrlTree:i,currentRawUrl:i,currentBrowserUrl:i,extractedUrl:t.urlHandlingStrategy.extract(i),urlAfterRedirects:t.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:vd,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Ts(o=>0!==o.id),nn(o=>({...o,extractedUrl:t.urlHandlingStrategy.extract(o.rawUrl)})),Kr(o=>{this.currentTransition=o;let s=!1,a=!1;return ht(o).pipe(ci(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Kr(c=>{const l=c.currentBrowserUrl.toString(),u=!t.navigated||c.extractedUrl.toString()!==l||l!==c.currentUrlTree.toString();if(!u&&"reload"!==(c.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const f="";return this.events.next(new el(c.id,this.urlSerializer.serialize(c.rawUrl),f,0)),c.resolve(null),Zr}if(t.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return ht(c).pipe(Kr(f=>{const h=this.transitions?.getValue();return this.events.next(new Op(f.id,this.urlSerializer.serialize(f.extractedUrl),f.source,f.restoredState)),h!==this.transitions?.getValue()?Zr:Promise.resolve(f)}),function IG(n,e,t,i,r,o){return Jn(s=>function TG(n,e,t,i,r,o,s="emptyOnly"){return new AG(n,e,t,i,r,s,o).recognize()}(n,e,t,i,s.extractedUrl,r,o).pipe(nn(({state:a,tree:c})=>({...s,targetSnapshot:a,urlAfterRedirects:c}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),ci(f=>{o.targetSnapshot=f.targetSnapshot,o.urlAfterRedirects=f.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:f.urlAfterRedirects};const h=new mO(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(h)}));if(u&&t.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){const{id:f,extractedUrl:h,source:p,restoredState:_,extras:m}=c,g=new Op(f,this.urlSerializer.serialize(h),p,_);this.events.next(g);const v=yO(0,this.rootComponentType).snapshot;return this.currentTransition=o={...c,targetSnapshot:v,urlAfterRedirects:h,extras:{...m,skipLocationChange:!1,replaceUrl:!1}},ht(o)}{const f="";return this.events.next(new el(c.id,this.urlSerializer.serialize(c.extractedUrl),f,1)),c.resolve(null),Zr}}),ci(c=>{const l=new P9(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),nn(c=>(this.currentTransition=o={...c,guards:K9(c.targetSnapshot,c.currentSnapshot,this.rootContexts)},o)),function cG(n,e){return Jn(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return 0===s.length&&0===o.length?ht({...t,guardsResult:!0}):function lG(n,e,t,i){return qn(n).pipe(Jn(r=>function gG(n,e,t,i,r){const o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return o&&0!==o.length?ht(o.map(a=>{const c=bd(e)??r,l=nl(a,c);return As(function oG(n){return n&&Sd(n.canDeactivate)}(l)?l.canDeactivate(n,e,t,i):c.runInContext(()=>l(n,e,t,i))).pipe(ha())})).pipe(il()):ht(!0)}(r.component,r.route,t,e,i)),ha(r=>!0!==r,!0))}(s,i,r,n).pipe(Jn(a=>a&&function tG(n){return"boolean"==typeof n}(a)?function uG(n,e,t,i){return qn(e).pipe(dd(r=>Jv(function fG(n,e){return null!==n&&e&&e(new I9(n)),ht(!0)}(r.route.parent,i),function dG(n,e){return null!==n&&e&&e(new N9(n)),ht(!0)}(r.route,i),function pG(n,e,t){const i=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>function J9(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(s)).filter(s=>null!==s).map(s=>XA(()=>ht(s.guards.map(c=>{const l=bd(s.node)??t,u=nl(c,l);return As(function rG(n){return n&&Sd(n.canActivateChild)}(u)?u.canActivateChild(i,n):l.runInContext(()=>u(i,n))).pipe(ha())})).pipe(il())));return ht(o).pipe(il())}(n,r.path,t),function hG(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return ht(!0);const r=i.map(o=>XA(()=>{const s=bd(e)??t,a=nl(o,s);return As(function iG(n){return n&&Sd(n.canActivate)}(a)?a.canActivate(e,n):s.runInContext(()=>a(e,n))).pipe(ha())}));return ht(r).pipe(il())}(n,r.route,t))),ha(r=>!0!==r,!0))}(i,o,n,e):ht(a)),nn(a=>({...t,guardsResult:a})))})}(this.environmentInjector,c=>this.events.next(c)),ci(c=>{if(o.guardsResult=c.guardsResult,ma(c.guardsResult))throw SO(0,c.guardsResult);const l=new E9(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(l)}),Ts(c=>!!c.guardsResult||(this.cancelNavigationTransition(c,"",3),!1)),xx(c=>{if(c.guards.canActivateChecks.length)return ht(c).pipe(ci(l=>{const u=new T9(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}),Kr(l=>{let u=!1;return ht(l).pipe(function RG(n,e){return Jn(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return ht(t);let o=0;return qn(r).pipe(dd(s=>function NG(n,e,t,i){const r=n.routeConfig,o=n._resolve;return void 0!==r?.title&&!UO(r)&&(o[fd]=r.title),function LG(n,e,t,i){const r=function FG(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return ht({});const o={};return qn(r).pipe(Jn(s=>function kG(n,e,t,i){const r=bd(e)??i,o=nl(n,r);return As(o.resolve?o.resolve(e,t):r.runInContext(()=>o(e,t)))}(n[s],e,t,i).pipe(ha(),ci(a=>{o[s]=a}))),ex(1),function Z6(n){return nn(()=>n)}(o),pa(s=>OO(s)?Zr:ud(s)))}(o,n,e,i).pipe(nn(s=>(n._resolvedData=s,n.data=MO(n,t).resolve,r&&UO(r)&&(n.data[fd]=r.title),null)))}(s.route,i,n,e)),ci(()=>o++),ex(1),Jn(s=>o===r.length?ht(t):Zr))})}(t.paramsInheritanceStrategy,this.environmentInjector),ci({next:()=>u=!0,complete:()=>{u||this.cancelNavigationTransition(l,"",2)}}))}),ci(l=>{const u=new A9(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}))}),xx(c=>{const l=u=>{const d=[];u.routeConfig?.loadComponent&&!u.routeConfig._loadedComponent&&d.push(this.configLoader.loadComponent(u.routeConfig).pipe(ci(f=>{u.component=f}),nn(()=>{})));for(const f of u.children)d.push(...l(f));return d};return Kv(l(c.targetSnapshot.root)).pipe(Cp(),Kc(1))}),xx(()=>this.afterPreactivation()),nn(c=>{const l=function V9(n,e,t){const i=Md(n,e._root,t?t._root:void 0);return new xO(i,e)}(t.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o={...c,targetRouterState:l},o}),ci(()=>{this.events.next(new ax)}),((n,e,t,i)=>nn(r=>(new Z9(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)))(this.rootContexts,t.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Kc(1),ci({next:c=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Wo(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),t.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{s=!0}}),function K6(n){return Vn((e,t)=>{qi(n).subscribe(Fn(t,()=>t.complete(),ym)),!t.closed&&e.subscribe(t)})}(this.transitionAbortSubject.pipe(ci(c=>{throw c}))),tx(()=>{s||a||this.cancelNavigationTransition(o,"",1),this.currentNavigation?.id===o.id&&(this.currentNavigation=null)}),pa(c=>{if(a=!0,EO(c))this.events.next(new xd(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),function G9(n){return EO(n)&&ma(n.url)}(c)?this.events.next(new cx(c.url)):o.resolve(!1);else{this.events.next(new Dp(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0));try{o.resolve(t.errorHandler(c))}catch(l){o.reject(l)}}return Zr}))}))}cancelNavigationTransition(t,i,r){const o=new xd(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(o),t.resolve(!1)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function VO(n){return n!==vd}let zO=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(o=>o.outlet===wt);return i}getResolvedTitleForRoute(t){return t.data[fd]}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:function(){return Be(VG)},providedIn:"root"})}}return n})(),VG=(()=>{class n extends zO{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}static{this.\u0275fac=function(i){return new(i||n)(ot(VA))}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),zG=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:function(){return Be(GG)},providedIn:"root"})}}return n})();class HG{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let GG=(()=>{class n extends HG{static{this.\u0275fac=function(){let t;return function(r){return(t||(t=ii(n)))(r||n)}}()}static{this.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const Bp=new Ve("",{providedIn:"root",factory:()=>({})});let jG=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:function(){return Be(WG)},providedIn:"root"})}}return n})(),WG=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Pd=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Pd||{});function HO(n,e){n.events.pipe(Ts(t=>t instanceof Wo||t instanceof xd||t instanceof Dp||t instanceof el),nn(t=>t instanceof Wo||t instanceof el?Pd.COMPLETE:t instanceof xd&&(0===t.code||1===t.code)?Pd.REDIRECTING:Pd.FAILED),Ts(t=>t!==Pd.REDIRECTING),Kc(1)).subscribe(()=>{e()})}function $G(n){throw n}function qG(n,e,t){return e.parse("/")}const XG={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},YG={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Xn=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=Be(mT),this.isNgZoneEnabled=!1,this._events=new Or,this.options=Be(Bp,{optional:!0})||{},this.pendingTasks=Be(_T),this.errorHandler=this.options.errorHandler||$G,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||qG,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=Be(jG),this.routeReuseStrategy=Be(zG),this.titleStrategy=Be(zO),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=Be(ol,{optional:!0})?.flat()??[],this.navigationTransitions=Be(Up),this.urlSerializer=Be(pd),this.location=Be(Sv),this.componentInputBindingEnabled=!!Be(Rp,{optional:!0}),this.eventsSubscription=new $i,this.isNgZoneEnabled=Be(dn)instanceof dn&&dn.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Qc,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=yO(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(i=>{try{const{currentTransition:r}=this.navigationTransitions;if(null===r)return void(GO(i)&&this._events.next(i));if(i instanceof Op)VO(r.source)&&(this.browserUrlTree=r.extractedUrl);else if(i instanceof el)this.rawUrlTree=r.rawUrl;else if(i instanceof mO){if("eager"===this.urlUpdateStrategy){if(!r.extras.skipLocationChange){const o=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl);this.setBrowserUrl(o,r)}this.browserUrlTree=r.urlAfterRedirects}}else if(i instanceof ax)this.currentUrlTree=r.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl),this.routerState=r.targetRouterState,"deferred"===this.urlUpdateStrategy&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r),this.browserUrlTree=r.urlAfterRedirects);else if(i instanceof xd)0!==i.code&&1!==i.code&&(this.navigated=!0),(3===i.code||2===i.code)&&this.restoreHistory(r);else if(i instanceof cx){const o=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),s={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||VO(r.source)};this.scheduleNavigation(o,vd,null,s,{resolve:r.resolve,reject:r.reject,promise:r.promise})}i instanceof Dp&&this.restoreHistory(r,!0),i instanceof Wo&&(this.navigated=!0),GO(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),vd,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,i,t.state)},0)}))}navigateToSyncWithBrowser(t,i,r){const o={replaceUrl:!0},s=r?.navigationId?r:null;if(r){const c={...r};delete c.navigationId,delete c.\u0275routerPageId,0!==Object.keys(c).length&&(o.state=c)}const a=this.parseUrl(t);this.scheduleNavigation(a,i,s,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(mx),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){const{relativeTo:r,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:c}=i,l=c?this.currentUrlTree.fragment:s;let d,u=null;switch(a){case"merge":u={...this.currentUrlTree.queryParams,...o};break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=o||null}null!==u&&(u=this.removeEmptyProps(u));try{d=lO(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),d=this.currentUrlTree.root}return uO(d,t,u,l??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=ma(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,vd,null,i)}navigate(t,i={skipLocationChange:!1}){return function ZG(n){for(let e=0;e<n.length;e++)if(null==n[e])throw new de(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?{...XG}:!1===i?{...YG}:i,ma(t))return eO(this.currentUrlTree,t,r);const o=this.parseUrl(t);return eO(this.currentUrlTree,o,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const o=t[r];return null!=o&&(i[r]=o),i},{})}scheduleNavigation(t,i,r,o,s){if(this.disposed)return Promise.resolve(!1);let a,c,l;s?(a=s.resolve,c=s.reject,l=s.promise):l=new Promise((d,f)=>{a=d,c=f});const u=this.pendingTasks.add();return HO(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:t,extras:o,resolve:a,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(d=>Promise.reject(d))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const s={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",s)}else{const o={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId+1)};this.location.go(r,"",o)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-this.browserPageId;0!==o?this.location.historyGo(o):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===o&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function GO(n){return!(n instanceof ax||n instanceof cx)}class jO{}let QG=(()=>{class n{constructor(t,i,r,o,s){this.router=t,this.injector=r,this.preloadingStrategy=o,this.loader=s}setUpPreloading(){this.subscription=this.router.events.pipe(Ts(t=>t instanceof Wo),dd(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const o of i){o.providers&&!o._injector&&(o._injector=$0(o.providers,t,`Route: ${o.path}`));const s=o._injector??t,a=o._loadedInjector??s;(o.loadChildren&&!o._loadedRoutes&&void 0===o.canLoad||o.loadComponent&&!o._loadedComponent)&&r.push(this.preloadConfig(s,o)),(o.children||o._loadedRoutes)&&r.push(this.processRoutes(a,o.children??o._loadedRoutes))}return qn(r).pipe(Ka())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):ht(null);const o=r.pipe(Jn(s=>null===s?ht(void 0):(i._loadedRoutes=s.routes,i._loadedInjector=s.injector,this.processRoutes(s.injector??t,s.routes))));return i.loadComponent&&!i._loadedComponent?qn([o,this.loader.loadComponent(i)]).pipe(Ka()):o})}static{this.\u0275fac=function(i){return new(i||n)(ot(Xn),ot(vT),ot(mr),ot(jO),ot(yx))}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const bx=new Ve("");let WO=(()=>{class n{constructor(t,i,r,o,s={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=o,this.options=s,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},s.scrollPositionRestoration=s.scrollPositionRestoration||"disabled",s.anchorScrolling=s.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Op?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Wo?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof el&&0===t.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof _O&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new _O(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static{this.\u0275fac=function(i){!function pS(){throw new Error("invalid")}()}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac})}}return n})();function qo(n,e){return{\u0275kind:n,\u0275providers:e}}function qO(){const n=Be(tr);return e=>{const t=n.get(qc);if(e!==t.components[0])return;const i=n.get(Xn),r=n.get(XO);1===n.get(Cx)&&i.initialNavigation(),n.get(YO,null,Dt.Optional)?.setUpPreloading(),n.get(bx,null,Dt.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const XO=new Ve("",{factory:()=>new Or}),Cx=new Ve("",{providedIn:"root",factory:()=>1}),YO=new Ve("");function i7(n){return qo(0,[{provide:YO,useExisting:QG},{provide:jO,useExisting:n}])}const ZO=new Ve("ROUTER_FORROOT_GUARD"),o7=[Sv,{provide:pd,useClass:nx},Xn,yd,{provide:Os,useFactory:function $O(n){return n.routerState.root},deps:[Xn]},yx,[]];function s7(){return new ST("Router",Xn)}let KO=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[o7,[],{provide:ol,multi:!0,useValue:t},{provide:ZO,useFactory:u7,deps:[[Xn,new rh,new oh]]},{provide:Bp,useValue:i||{}},i?.useHash?{provide:fa,useClass:_H}:{provide:fa,useClass:nA},{provide:bx,useFactory:()=>{const n=Be(N8),e=Be(dn),t=Be(Bp),i=Be(Up),r=Be(pd);return t.scrollOffset&&n.setOffset(t.scrollOffset),new WO(r,i,n,e,t)}},i?.preloadingStrategy?i7(i.preloadingStrategy).\u0275providers:[],{provide:ST,multi:!0,useFactory:s7},i?.initialNavigation?d7(i):[],i?.bindToComponentInputs?qo(8,[wO,{provide:Rp,useExisting:wO}]).\u0275providers:[],[{provide:JO,useFactory:qO},{provide:gv,multi:!0,useExisting:JO}]]}}static forChild(t){return{ngModule:n,providers:[{provide:ol,multi:!0,useValue:t}]}}static{this.\u0275fac=function(i){return new(i||n)(ot(ZO,8))}}static{this.\u0275mod=Rr({type:n})}static{this.\u0275inj=fr({})}}return n})();function u7(n){return"guarded"}function d7(n){return["disabled"===n.initialNavigation?qo(3,[{provide:av,multi:!0,useFactory:()=>{const e=Be(Xn);return()=>{e.setUpLocationChangeListener()}}},{provide:Cx,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?qo(2,[{provide:Cx,useValue:0},{provide:av,multi:!0,deps:[tr],useFactory:e=>{const t=e.get(gH,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(Xn),o=e.get(XO);HO(r,()=>{i(!0)}),e.get(Up).afterPreactivation=()=>(i(!0),o.closed?ht(void 0):o),r.initialNavigation()}))}}]).\u0275providers:[]]}const JO=new Ve(""),Vp=[{id:"1",name:"GREEN CAMO HOODIE",description:"Urban camouflage hoodie with street style.",price:65,originalPrice:85,category:"TOPS",images:["assets/images/products/hoodie1.png"],sizes:["S","M","L","XL"],colors:["Green","Black"],brand:"FREPPING",rating:4.5,reviewCount:42,inStock:!0,tags:["streetwear","hoodie","camo"],material:"80% Cotton, 20% Polyester",isFeatured:!0,has3DModel:!1,discount:.24,isNew:!0},{id:"2",name:"DISTRESSED DENIM",description:"Vintage style distressed jeans with custom rips and fading.",price:89,originalPrice:120,category:"BOTTOMS",images:["assets/images/products/pant1.png"],sizes:["28","30","32","34"],colors:["Blue","Black"],brand:"FREPPING",rating:4.2,reviewCount:31,inStock:!0,tags:["jeans","vintage","distressed"],material:"100% Cotton Denim",isFeatured:!0,has3DModel:!1,discount:.26,isNew:!1},{id:"3",name:"NEON SNEAKERS",description:"High-top sneakers with neon accents and custom glow-in-the-dark details.",price:120,originalPrice:150,category:"SHOES",images:["assets/images/products/hoodie2.png"],sizes:["8","9","10","11","12"],colors:["Black/Green","White/Orange"],brand:"FREPPING",rating:4.8,reviewCount:56,inStock:!0,tags:["sneakers","high-top","glow"],material:"Leather/Synthetic",isFeatured:!0,has3DModel:!1,discount:.2,isNew:!0},{id:"4",name:"GIRL'S GRAPHIC TEE",description:"Stylish graphic t-shirt with modern design and comfortable fit.",price:45,originalPrice:60,category:"TOPS",images:["assets/images/products/tshert1.png"],sizes:["XS","S","M","L"],colors:["White","Pink","Black"],brand:"FREPPING",rating:4.6,reviewCount:28,inStock:!0,tags:["tshirt","graphic","casual","girls"],material:"100% Cotton",isFeatured:!0,has3DModel:!1,discount:.25,isNew:!1},{id:"5",name:"STREETWEAR CARGO PANTS",description:"Urban cargo pants with multiple pockets and tactical design.",price:79,originalPrice:99,category:"BOTTOMS",images:["assets/3dmodel/uploads_files_4988185_\u9ed1\u8272\u62fc\u63a5\u5bbd\u677e\u536b\u8863_obj/\u9ed1\u8272\u62fc\u63a5\u5bbd\u677e\u536b\u8863_obj.obj","assets/images/products/pants1.png"],sizes:["28","30","32","34","36"],colors:["Black","Olive Green","Gray"],brand:"FREPPING",rating:4.7,reviewCount:89,inStock:!0,tags:["pants","cargo","streetwear","tactical"],material:"100% Cotton Twill",isFeatured:!0,has3DModel:!0,discount:.2,isNew:!0},{id:"6",name:"3D HOODIE",description:"Modern hoodie with 3D model preview available.",price:75,originalPrice:95,category:"TOPS",images:["assets/3dmodel/tshert_girl.obj","assets/images/products/hoodie1.png"],sizes:["S","M","L","XL"],colors:["Black","Gray","Navy"],brand:"FREPPING",rating:4.9,reviewCount:63,inStock:!0,tags:["hoodie","3d","modern","streetwear"],material:"80% Cotton, 20% Polyester",isFeatured:!0,has3DModel:!0,discount:.21,isNew:!1},{id:"7",name:"DESIGNER JACKET",description:"Premium designer jacket with custom details.",price:145,originalPrice:180,category:"OUTERWEAR",images:["assets/3dmodel/uploads_files_5109932_\u7c73\u767d\u5370\u82b1\u536b\u8863/\u7c73\u767d\u5370\u82b1\u536b\u8863.obj"],sizes:["S","M","L","XL"],colors:["Black","Brown","Green"],brand:"FREPPING",rating:4.8,reviewCount:47,inStock:!0,tags:["jacket","designer","premium"],material:"Leather/Cotton Blend",isFeatured:!0,has3DModel:!1,discount:.19,isNew:!1},{id:"8",name:"RUNNING SHOES",description:"High-performance running shoes with comfort technology.",price:110,originalPrice:140,category:"SHOES",images:["assets/images/products/shumis1.png"],sizes:["7","8","9","10","11","12"],colors:["Black/White","Blue/White","Red/Black"],brand:"FREPPING",rating:4.6,reviewCount:72,inStock:!0,tags:["shoes","running","sports"],material:"Mesh/Synthetic",isFeatured:!0,has3DModel:!1,discount:.21,isNew:!0}],h7=[{id:"1",name:"TOPS",icon:"fas fa-tshirt"},{id:"2",name:"BOTTOMS",icon:"fas fa-vest"},{id:"3",name:"SHOES",icon:"fas fa-shoe-prints"},{id:"4",name:"ACCESSORIES",icon:"fas fa-gem"},{id:"5",name:"OUTERWEAR",icon:"fas fa-jacket"},{id:"6",name:"ALL",icon:"fas fa-store"}];let Ed=(()=>{class n{constructor(){this.cartItemsSubject=new Xi([]),this.cartItems$=this.cartItemsSubject.asObservable()}getSubtotal(){throw new Error("Method not implemented.")}getCartItems(){return this.cartItemsSubject.value}addToCart(t,i=1){const r=this.getCartItems(),o=r.findIndex(s=>s.product.id===t.id);o>-1?r[o].quantity+=i:r.push({product:t,quantity:i}),this.cartItemsSubject.next([...r])}removeFromCart(t){const i=this.getCartItems().filter(r=>r.product.id!==t);this.cartItemsSubject.next(i)}clearCart(){this.cartItemsSubject.next([])}updateQuantity(t,i){const r=this.getCartItems().map(o=>o.product.id===t?{...o,quantity:i}:o);this.cartItemsSubject.next(r)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function p7(n,e){if(1&n&&(M(0,"span",7),O(1),b()),2&n){const t=Q(2);Hc(t.badgeClass),L(1),Ye(" ",t.getBadgeText()," ")}}function g7(n,e){if(1&n){const t=tn();M(0,"div",3),ge("click",function(){const o=qe(t).$implicit;return Xe(Q().navigateTo(o.path))}),M(1,"div",4),U(2,"i"),M(3,"span",5),O(4),b(),ie(5,p7,2,3,"span",6),b()()}if(2&n){const t=e.$implicit,i=Q();L(1),bt("active",t.active),L(1),Hc(t.icon),L(2),xt(t.label),L(1),J("ngIf","CART"===t.label&&i.cartItemCount>0)}}let sl=(()=>{class n{constructor(t,i,r){this.router=t,this.cartService=i,this.cdRef=r,this.cartItemCount=0,this.badgeClass="",this.navItems=[{path:"/",icon:"fas fa-home",label:"HOME",active:!0},{path:"/shop",icon:"fas fa-store",label:"SHOP",active:!1},{path:"/try-on",icon:"fas fa-user",label:"TRY-ON",active:!1},{path:"/cart",icon:"fas fa-shopping-cart",label:"CART",active:!1},{path:"/mod",icon:"fas fa-user-circle",label:"PROFILE",active:!1}],this.updateActiveNav(),this.router.events.subscribe(()=>{this.updateActiveNav()})}ngOnInit(){this.cartSubscription=this.cartService.cartItems$.subscribe(t=>{const i=this.cartItemCount;this.cartItemCount=this.calculateTotalItems(t),this.updateBadgeClass(),i!==this.cartItemCount&&this.triggerBadgeAnimation(),this.cdRef.detectChanges()})}ngOnDestroy(){this.cartSubscription&&this.cartSubscription.unsubscribe()}updateActiveNav(){const t=this.router.url;this.navItems.forEach(i=>{i.active=t===i.path||"/"!==i.path&&t.startsWith(i.path)})}navigateTo(t){this.router.navigate([t])}calculateTotalItems(t){return t.reduce((i,r)=>i+r.quantity,0)}updateBadgeClass(){this.badgeClass=0===this.cartItemCount?"":this.cartItemCount>5&&this.cartItemCount<=9?"many-items":this.cartItemCount>9?"many-items many-many":""}triggerBadgeAnimation(){this.badgeClass+=" changing",setTimeout(()=>{this.badgeClass=this.badgeClass.replace(" changing",""),this.updateBadgeClass()},300)}getBadgeText(){return 0===this.cartItemCount?"":this.cartItemCount>99?"99+":this.cartItemCount.toString()}static{this.\u0275fac=function(i){return new(i||n)(te(Xn),te(Ed),te(Xc))}}static{this.\u0275cmp=Zi({type:n,selectors:[["app-bottom-nav"]],decls:3,vars:1,consts:[[1,"bottom-nav"],[1,"nav-list"],["class","nav-item",3,"click",4,"ngFor","ngForOf"],[1,"nav-item",3,"click"],[1,"nav-link"],[1,"nav-label"],["class","cart-badge",3,"class",4,"ngIf"],[1,"cart-badge"]],template:function(i,r){1&i&&(M(0,"nav",0)(1,"div",1),ie(2,g7,6,6,"div",2),b()()),2&i&&(L(2),J("ngForOf",r.navItems))},dependencies:[Ps,jo],styles:['.bottom-nav[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0;background:#000;border-top:3px solid #39ff14;z-index:1000;box-shadow:0 -8px 20px #000c;padding:8px 0 12px;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.bottom-nav[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:100%;background:linear-gradient(45deg,transparent 49%,rgba(57,255,20,.1) 50%,transparent 51%),linear-gradient(-45deg,transparent 49%,rgba(57,255,20,.1) 50%,transparent 51%);background-size:15px 15px;opacity:.3;pointer-events:none}.bottom-nav[_ngcontent-%COMP%]:after{content:"";position:absolute;top:-3px;left:0;right:0;height:3px;background:repeating-linear-gradient(90deg,#39ff14,#39ff14 10px,transparent 10px,transparent 20px);animation:_ngcontent-%COMP%_borderSlide 2s linear infinite}@keyframes _ngcontent-%COMP%_borderSlide{0%{background-position:0 0}to{background-position:40px 0}}.nav-list[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center;padding:0 10px;max-width:1200px;margin:0 auto}.nav-item[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:center;position:relative;cursor:pointer;transform:skew(-3deg);transition:all .3s cubic-bezier(.4,0,.2,1)}.nav-item[_ngcontent-%COMP%]:hover{transform:skew(-3deg) translateY(-5px)}.nav-item[_ngcontent-%COMP%]:hover   .nav-link[_ngcontent-%COMP%]{background:rgba(57,255,20,.1);border-color:#f90}.nav-item[_ngcontent-%COMP%]:hover   .nav-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#f90;transform:scale(1.2)}.nav-item[_ngcontent-%COMP%]:hover   .nav-link[_ngcontent-%COMP%]   .nav-label[_ngcontent-%COMP%]{color:#f90;text-shadow:0 0 10px rgba(255,153,0,.5)}.nav-item[_ngcontent-%COMP%]:active{transform:skew(-3deg) translateY(-2px)}.nav-item[_ngcontent-%COMP%]:active   .nav-link[_ngcontent-%COMP%]{background:rgba(57,255,20,.2);box-shadow:0 3px #000}.nav-link[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:4px;padding:10px 12px;background:rgba(0,0,0,.7);border:2px solid #39ff14;border-radius:0;width:80%;position:relative;transition:all .3s cubic-bezier(.4,0,.2,1);transform:skew(3deg);box-shadow:4px 4px #000}.nav-link[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(135deg,transparent 0%,rgba(57,255,20,.1) 50%,transparent 100%);opacity:0;transition:opacity .3s ease}.nav-link[_ngcontent-%COMP%]:hover:before{opacity:1}.nav-link.active[_ngcontent-%COMP%]{background:#39ff14;border-color:#000;box-shadow:6px 6px #000}.nav-link.active[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#000;animation:_ngcontent-%COMP%_iconPulse 2s infinite}.nav-link.active[_ngcontent-%COMP%]   .nav-label[_ngcontent-%COMP%]{color:#000;font-weight:900;text-shadow:1px 1px 0 rgba(255,255,255,.3)}.nav-link.active[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-12px;left:50%;transform:translate(-50%);width:60%;height:3px;background:#ff9900;border-radius:2px;animation:_ngcontent-%COMP%_activePulse 2s infinite}@keyframes _ngcontent-%COMP%_iconPulse{0%,to{transform:scale(1);filter:drop-shadow(0 0 0 rgba(255,153,0,0))}50%{transform:scale(1.1);filter:drop-shadow(0 0 8px rgba(255,153,0,.5))}}@keyframes _ngcontent-%COMP%_activePulse{0%,to{opacity:1;width:60%}50%{opacity:.7;width:80%}}.nav-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px;color:#39ff14;transition:all .3s ease;transform-origin:center}.nav-label[_ngcontent-%COMP%]{font-family:Street,Pricedown,sans-serif;font-size:10px;letter-spacing:1.5px;color:#39ff14;text-transform:uppercase;text-shadow:1px 1px 0 #000;transition:all .3s ease;font-weight:700;line-height:1}.cart-badge[_ngcontent-%COMP%]{position:absolute;top:5px;right:5px;background:linear-gradient(135deg,#ff3333,#ff6600);color:#fff;font-family:Street,Pricedown,sans-serif;font-size:10px;font-weight:900;min-width:18px;height:18px;border-radius:0;display:flex;align-items:center;justify-content:center;padding:0 4px;border:2px solid #000;box-shadow:2px 2px #000;transform:skew(-5deg);z-index:10;animation:_ngcontent-%COMP%_badgeGlow 2s infinite alternate}.cart-badge.many-items[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_badgeDanger 1s infinite alternate;background:linear-gradient(135deg,#ff0000,#ff3300);text-shadow:0 0 5px rgba(255,255,255,.5)}.cart-badge.many-items.many-many[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_badgeCritical .5s infinite alternate;background:linear-gradient(135deg,#ff0000,#990000);font-size:8px}@keyframes _ngcontent-%COMP%_badgeGlow{0%{box-shadow:2px 2px #000,0 0 #f330;transform:skew(-5deg) scale(1)}to{box-shadow:2px 2px #000,0 0 15px #f33c;transform:skew(-5deg) scale(1.1)}}@keyframes _ngcontent-%COMP%_badgeDanger{0%{box-shadow:2px 2px #000,0 0 #f330;transform:skew(-5deg) scale(1)}to{box-shadow:2px 2px #000,0 0 20px red;transform:skew(-5deg) scale(1.2)}}@keyframes _ngcontent-%COMP%_badgeCritical{0%{box-shadow:2px 2px #000,0 0 #f000;transform:skew(-5deg) scale(1);background:linear-gradient(135deg,#ff0000,#990000)}to{box-shadow:2px 2px #000,0 0 25px red,0 0 15px #f90c;transform:skew(-5deg) scale(1.3);background:linear-gradient(135deg,#ff3300,#cc0000)}}.cart-badge.changing[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_numberChange .3s ease-in-out}@keyframes _ngcontent-%COMP%_numberChange{0%{transform:skew(-5deg) scale(1) rotate(0)}25%{transform:skew(-5deg) scale(1.2) rotate(-10deg)}50%{transform:skew(-5deg) scale(1.3) rotate(10deg)}75%{transform:skew(-5deg) scale(1.2) rotate(-5deg)}to{transform:skew(-5deg) scale(1) rotate(0)}}.nav-item[_ngcontent-%COMP%]:has(.cart-badge)   .nav-link[_ngcontent-%COMP%]{position:relative}.nav-item[_ngcontent-%COMP%]:has(.cart-badge)   .nav-link[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:-5px;border-radius:inherit;background:radial-gradient(circle at 30% 30%,rgba(255,51,51,.2) 0%,transparent 50%);z-index:-1;opacity:0;transition:opacity .3s ease}.nav-item[_ngcontent-%COMP%]:has(.cart-badge)   .nav-link[_ngcontent-%COMP%]:hover:before{opacity:.5}@media (max-width: 768px){.bottom-nav[_ngcontent-%COMP%]{padding:6px 0 10px}.nav-link[_ngcontent-%COMP%]{padding:8px 6px;width:85%}.nav-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px}.nav-label[_ngcontent-%COMP%]{font-size:9px;letter-spacing:1px}.cart-badge[_ngcontent-%COMP%]{min-width:16px;height:16px;font-size:9px;top:3px;right:3px}}@media (max-width: 480px){.bottom-nav[_ngcontent-%COMP%]{padding:4px 0 8px}.nav-list[_ngcontent-%COMP%]{padding:0 5px}.nav-link[_ngcontent-%COMP%]{padding:6px 4px}.nav-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}.nav-label[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.5px}.cart-badge[_ngcontent-%COMP%]{min-width:14px;height:14px;font-size:8px;top:2px;right:2px}}@media (prefers-color-scheme: dark){.bottom-nav[_ngcontent-%COMP%]{background:rgba(0,0,0,.95);border-top:3px solid #39ff14}.nav-link[_ngcontent-%COMP%]{background:rgba(20,20,20,.9)}.nav-link.active[_ngcontent-%COMP%]{background:#39ff14}}.nav-link[_ngcontent-%COMP%]:focus-visible{outline:2px solid #ff9900;outline-offset:2px}.nav-item[_ngcontent-%COMP%]:focus-visible{outline:none}@media (hover: none) and (pointer: coarse){.nav-item[_ngcontent-%COMP%]:hover{transform:skew(-3deg)}.nav-item[_ngcontent-%COMP%]:hover   .nav-link[_ngcontent-%COMP%]{transform:skew(3deg)}.nav-link.active[_ngcontent-%COMP%]{background:#39ff14}}']})}}return n})();function QO(n,e,t,i,r,o,s){try{var a=n[o](s),c=a.value}catch(l){return void t(l)}a.done?e(c):Promise.resolve(c).then(i,r)}function ki(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var o=n.apply(e,t);function s(c){QO(o,i,r,s,a,"next",c)}function a(c){QO(o,i,r,s,a,"throw",c)}s(void 0)})}}const _o=0,dD="attached",Ds=1e3,Bi=1001,En=1003,ll=1005,on=1006,Hr=1008,rr=1009,fD=1010,hD=1011,Id=1012,kx=1013,Gr=1014,Vi=1015,Zo=1016,Ux=1017,Bx=1018,Rd=1020,pD=35902,gD=35899,mD=1021,_D=1022,zi=1023,Ko=1026,xa=1027,Vx=1028,Wp=1029,ul=1030,zx=1031,Hx=1033,$p=33776,qp=33777,Xp=33778,Yp=33779,Gx=35840,jx=35841,Wx=35842,$x=35843,qx=36196,Xx=37492,Yx=37496,Zx=37488,Kx=37489,Jx=37490,Qx=37491,ey=37808,ty=37809,ny=37810,iy=37811,ry=37812,oy=37813,sy=37814,ay=37815,cy=37816,ly=37817,uy=37818,dy=37819,fy=37820,hy=37821,py=36492,gy=36494,my=36495,_y=36283,vy=36284,xy=36285,yy=36286,Nd=2300,Ld=2301,vn="srgb",bi="srgb-linear",Kp="linear",Kt="srgb",hl=7680,MD="300 es",Mr=2e3;function bD(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function kd(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function J7(){const n=kd("canvas");return n.style.display="block",n}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const wD={};let Rs=null;function Qp(...n){const e="THREE."+n.shift();Rs?Rs("log",e,...n):console.log(e,...n)}function Se(...n){const e="THREE."+n.shift();Rs?Rs("warn",e,...n):console.warn(e,...n)}function Ze(...n){const e="THREE."+n.shift();Rs?Rs("error",e,...n):console.error(e,...n)}function Ud(...n){const e=n.join(" ");e in wD||(wD[e]=!0,Se(...n))}class Jo{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){const i=this._listeners;return void 0!==i&&void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){const i=this._listeners;if(void 0===i)return;const r=i[e];if(void 0!==r){const o=r.indexOf(t);-1!==o&&r.splice(o,1)}}dispatchEvent(e){const t=this._listeners;if(void 0===t)return;const i=t[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let o=0,s=r.length;o<s;o++)r[o].call(this,e);e.target=null}}}const li=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const Ma=Math.PI/180,gl=180/Math.PI;function or(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(li[255&n]+li[n>>8&255]+li[n>>16&255]+li[n>>24&255]+"-"+li[255&e]+li[e>>8&255]+"-"+li[e>>16&15|64]+li[e>>24&255]+"-"+li[63&t|128]+li[t>>8&255]+"-"+li[t>>16&255]+li[t>>24&255]+li[255&i]+li[i>>8&255]+li[i>>16&255]+li[i>>24&255]).toLowerCase()}function at(n,e,t){return Math.max(e,Math.min(t,n))}function Py(n,e){return(n%e+e)%e}function Bd(n,e,t){return(1-t)*n+t*e}function Ci(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function St(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(4294967295*n);case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int32Array:return Math.round(2147483647*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}}const mj_radToDeg=function dj(n){return n*gl};class re{constructor(e=0,t=0){re.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=at(this.x,e.x,t.x),this.y=at(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=at(this.x,e,t),this.y=at(this.y,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(at(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(at(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),o=this.x-e.x,s=this.y-e.y;return this.x=o*i-s*r+e.x,this.y=o*r+s*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class wi{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,o,s,a){let c=i[r+0],l=i[r+1],u=i[r+2],d=i[r+3],f=o[s+0],h=o[s+1],p=o[s+2],_=o[s+3];if(a<=0)return e[t+0]=c,e[t+1]=l,e[t+2]=u,void(e[t+3]=d);if(a>=1)return e[t+0]=f,e[t+1]=h,e[t+2]=p,void(e[t+3]=_);if(d!==_||c!==f||l!==h||u!==p){let m=c*f+l*h+u*p+d*_;m<0&&(f=-f,h=-h,p=-p,_=-_,m=-m);let g=1-a;if(m<.9995){const v=Math.acos(m),x=Math.sin(v);g=Math.sin(g*v)/x,c=c*g+f*(a=Math.sin(a*v)/x),l=l*g+h*a,u=u*g+p*a,d=d*g+_*a}else{c=c*g+f*a,l=l*g+h*a,u=u*g+p*a,d=d*g+_*a;const v=1/Math.sqrt(c*c+l*l+u*u+d*d);c*=v,l*=v,u*=v,d*=v}}e[t]=c,e[t+1]=l,e[t+2]=u,e[t+3]=d}static multiplyQuaternionsFlat(e,t,i,r,o,s){const a=i[r],c=i[r+1],l=i[r+2],u=i[r+3],d=o[s],f=o[s+1],h=o[s+2],p=o[s+3];return e[t]=a*p+u*d+c*h-l*f,e[t+1]=c*p+u*f+l*d-a*h,e[t+2]=l*p+u*h+a*f-c*d,e[t+3]=u*p-a*d-c*f-l*h,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,r=e._y,o=e._z,s=e._order,a=Math.cos,c=Math.sin,l=a(i/2),u=a(r/2),d=a(o/2),f=c(i/2),h=c(r/2),p=c(o/2);switch(s){case"XYZ":this._x=f*u*d+l*h*p,this._y=l*h*d-f*u*p,this._z=l*u*p+f*h*d,this._w=l*u*d-f*h*p;break;case"YXZ":this._x=f*u*d+l*h*p,this._y=l*h*d-f*u*p,this._z=l*u*p-f*h*d,this._w=l*u*d+f*h*p;break;case"ZXY":this._x=f*u*d-l*h*p,this._y=l*h*d+f*u*p,this._z=l*u*p+f*h*d,this._w=l*u*d-f*h*p;break;case"ZYX":this._x=f*u*d-l*h*p,this._y=l*h*d+f*u*p,this._z=l*u*p-f*h*d,this._w=l*u*d+f*h*p;break;case"YZX":this._x=f*u*d+l*h*p,this._y=l*h*d+f*u*p,this._z=l*u*p-f*h*d,this._w=l*u*d-f*h*p;break;case"XZY":this._x=f*u*d-l*h*p,this._y=l*h*d-f*u*p,this._z=l*u*p+f*h*d,this._w=l*u*d+f*h*p;break;default:Se("Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],o=t[8],s=t[1],a=t[5],c=t[9],l=t[2],u=t[6],d=t[10],f=i+a+d;if(f>0){const h=.5/Math.sqrt(f+1);this._w=.25/h,this._x=(u-c)*h,this._y=(o-l)*h,this._z=(s-r)*h}else if(i>a&&i>d){const h=2*Math.sqrt(1+i-a-d);this._w=(u-c)/h,this._x=.25*h,this._y=(r+s)/h,this._z=(o+l)/h}else if(a>d){const h=2*Math.sqrt(1+a-i-d);this._w=(o-l)/h,this._x=(r+s)/h,this._y=.25*h,this._z=(c+u)/h}else{const h=2*Math.sqrt(1+d-i-a);this._w=(s-r)/h,this._x=(o+l)/h,this._y=(c+u)/h,this._z=.25*h}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<1e-8?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(at(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,o=e._z,s=e._w,a=t._x,c=t._y,l=t._z,u=t._w;return this._x=i*u+s*a+r*l-o*c,this._y=r*u+s*c+o*a-i*l,this._z=o*u+s*l+i*c-r*a,this._w=s*u-i*a-r*c-o*l,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let i=e._x,r=e._y,o=e._z,s=e._w,a=this.dot(e);a<0&&(i=-i,r=-r,o=-o,s=-s,a=-a);let c=1-t;if(a<.9995){const l=Math.acos(a),u=Math.sin(l);c=Math.sin(c*l)/u,t=Math.sin(t*l)/u,this._x=this._x*c+i*t,this._y=this._y*c+r*t,this._z=this._z*c+o*t,this._w=this._w*c+s*t,this._onChangeCallback()}else this._x=this._x*c+i*t,this._y=this._y*c+r*t,this._z=this._z*c+o*t,this._w=this._w*c+s*t,this.normalize();return this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),o=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),o*Math.sin(t),o*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class R{constructor(e=0,t=0,i=0){R.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(PD.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(PD.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[3]*i+o[6]*r,this.y=o[1]*t+o[4]*i+o[7]*r,this.z=o[2]*t+o[5]*i+o[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,o=e.elements,s=1/(o[3]*t+o[7]*i+o[11]*r+o[15]);return this.x=(o[0]*t+o[4]*i+o[8]*r+o[12])*s,this.y=(o[1]*t+o[5]*i+o[9]*r+o[13])*s,this.z=(o[2]*t+o[6]*i+o[10]*r+o[14])*s,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,o=e.x,s=e.y,a=e.z,c=e.w,l=2*(s*r-a*i),u=2*(a*t-o*r),d=2*(o*i-s*t);return this.x=t+c*l+s*d-a*u,this.y=i+c*u+a*l-o*d,this.z=r+c*d+o*u-s*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r,this.y=o[1]*t+o[5]*i+o[9]*r,this.z=o[2]*t+o[6]*i+o[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=at(this.x,e.x,t.x),this.y=at(this.y,e.y,t.y),this.z=at(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=at(this.x,e,t),this.y=at(this.y,e,t),this.z=at(this.z,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(at(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,o=e.z,s=t.x,a=t.y,c=t.z;return this.x=r*c-o*a,this.y=o*s-i*c,this.z=i*a-r*s,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return Ey.copy(this).projectOnVector(e),this.sub(Ey)}reflect(e){return this.sub(Ey.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(at(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,i=Math.sqrt(1-t*t);return this.x=i*Math.cos(e),this.y=t,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Ey=new R,PD=new wi;class Pt{constructor(e,t,i,r,o,s,a,c,l){Pt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,i,r,o,s,a,c,l)}set(e,t,i,r,o,s,a,c,l){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=o,u[5]=c,u[6]=i,u[7]=s,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,o=this.elements,s=i[0],a=i[3],c=i[6],l=i[1],u=i[4],d=i[7],f=i[2],h=i[5],p=i[8],_=r[0],m=r[3],g=r[6],v=r[1],x=r[4],y=r[7],S=r[2],P=r[5],T=r[8];return o[0]=s*_+a*v+c*S,o[3]=s*m+a*x+c*P,o[6]=s*g+a*y+c*T,o[1]=l*_+u*v+d*S,o[4]=l*m+u*x+d*P,o[7]=l*g+u*y+d*T,o[2]=f*_+h*v+p*S,o[5]=f*m+h*x+p*P,o[8]=f*g+h*y+p*T,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],c=e[6],l=e[7],u=e[8];return t*s*u-t*a*l-i*o*u+i*a*c+r*o*l-r*s*c}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],c=e[6],l=e[7],u=e[8],d=u*s-a*l,f=a*c-u*o,h=l*o-s*c,p=t*d+i*f+r*h;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const _=1/p;return e[0]=d*_,e[1]=(r*l-u*i)*_,e[2]=(a*i-r*s)*_,e[3]=f*_,e[4]=(u*t-r*c)*_,e[5]=(r*o-a*t)*_,e[6]=h*_,e[7]=(i*c-l*t)*_,e[8]=(s*t-i*o)*_,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,o,s,a){const c=Math.cos(o),l=Math.sin(o);return this.set(i*c,i*l,-i*(c*s+l*a)+s+e,-r*l,r*c,-r*(-l*s+c*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(Ty.makeScale(e,t)),this}rotate(e){return this.premultiply(Ty.makeRotation(-e)),this}translate(e,t){return this.premultiply(Ty.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const Ty=new Pt,ED=(new Pt).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),TD=(new Pt).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function _j(){const n={enabled:!0,workingColorSpace:bi,spaces:{},convert:function(r,o,s){return!1===this.enabled||o===s||!o||!s||(this.spaces[o].transfer===Kt&&(r.r=Qo(r.r),r.g=Qo(r.g),r.b=Qo(r.b)),this.spaces[o].primaries!==this.spaces[s].primaries&&(r.applyMatrix3(this.spaces[o].toXYZ),r.applyMatrix3(this.spaces[s].fromXYZ)),this.spaces[s].transfer===Kt&&(r.r=ml(r.r),r.g=ml(r.g),r.b=ml(r.b))),r},workingToColorSpace:function(r,o){return this.convert(r,this.workingColorSpace,o)},colorSpaceToWorking:function(r,o){return this.convert(r,o,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return""===r?Kp:this.spaces[r].transfer},getToneMappingMode:function(r){return this.spaces[r].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(r,o=this.workingColorSpace){return r.fromArray(this.spaces[o].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,o,s){return r.copy(this.spaces[o].toXYZ).multiply(this.spaces[s].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(r,o){return Ud("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),n.workingToColorSpace(r,o)},toWorkingColorSpace:function(r,o){return Ud("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),n.colorSpaceToWorking(r,o)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],i=[.3127,.329];return n.define({[bi]:{primaries:e,whitePoint:i,transfer:Kp,toXYZ:ED,fromXYZ:TD,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:vn},outputColorSpaceConfig:{drawingBufferColorSpace:vn}},[vn]:{primaries:e,whitePoint:i,transfer:Kt,toXYZ:ED,fromXYZ:TD,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:vn}}}),n}const Tt=_j();function Qo(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function ml(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}let _l;class vj{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{void 0===_l&&(_l=kd("canvas")),_l.width=e.width,_l.height=e.height;const r=_l.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),i=_l}return i.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=kd("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),o=r.data;for(let s=0;s<o.length;s++)o[s]=255*Qo(o[s]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Qo(t[i]/255)):Qo(t[i]);return{data:t,width:e.width,height:e.height}}return Se("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let xj=0;class ba{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:xj++}),this.uuid=or(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):typeof VideoFrame<"u"&&t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):null!==t?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let o;if(Array.isArray(r)){o=[];for(let s=0,a=r.length;s<a;s++)o.push(Ay(r[s].isDataTexture?r[s].image:r[s]))}else o=Ay(r);i.url=o}return t||(e.images[this.uuid]=i),i}}function Ay(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?vj.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(Se("Texture: Unable to serialize Texture."),{})}let yj=0;const Oy=new R;let ui=(()=>{class n extends Jo{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=Bi,o=Bi,s=on,a=Hr,c=zi,l=rr,u=n.DEFAULT_ANISOTROPY,d=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:yj++}),this.uuid=or(),this.name="",this.source=new ba(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=r,this.wrapT=o,this.magFilter=s,this.minFilter=a,this.anisotropy=u,this.format=c,this.internalFormat=null,this.type=l,this.offset=new re(0,0),this.repeat=new re(1,1),this.center=new re(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Pt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=d,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(t&&t.depth&&t.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(Oy).x}get height(){return this.source.getSize(Oy).y}get depth(){return this.source.getSize(Oy).z}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(t,i){this.updateRanges.push({start:t,count:i})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.renderTarget=t.renderTarget,this.isRenderTargetTexture=t.isRenderTargetTexture,this.isArrayTexture=t.isArrayTexture,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}setValues(t){for(const i in t){const r=t[i];if(void 0===r){Se(`Texture.setValues(): parameter '${i}' has value of undefined.`);continue}const o=this[i];void 0!==o?o&&r&&o.isVector2&&r.isVector2||o&&r&&o.isVector3&&r.isVector3||o&&r&&o.isMatrix3&&r.isMatrix3?o.copy(r):this[i]=r:Se(`Texture.setValues(): property '${i}' does not exist.`)}}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Ds:t.x=t.x-Math.floor(t.x);break;case Bi:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Ds:t.y=t.y-Math.floor(t.y);break;case Bi:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){!0===t&&this.pmremVersion++}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n.DEFAULT_ANISOTROPY=1,n})();class pn{constructor(e=0,t=0,i=0,r=1){pn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,o=this.w,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r+s[12]*o,this.y=s[1]*t+s[5]*i+s[9]*r+s[13]*o,this.z=s[2]*t+s[6]*i+s[10]*r+s[14]*o,this.w=s[3]*t+s[7]*i+s[11]*r+s[15]*o,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,o;const c=e.elements,l=c[0],u=c[4],d=c[8],f=c[1],h=c[5],p=c[9],_=c[2],m=c[6],g=c[10];if(Math.abs(u-f)<.01&&Math.abs(d-_)<.01&&Math.abs(p-m)<.01){if(Math.abs(u+f)<.1&&Math.abs(d+_)<.1&&Math.abs(p+m)<.1&&Math.abs(l+h+g-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const x=(l+1)/2,y=(h+1)/2,S=(g+1)/2,P=(u+f)/4,T=(d+_)/4,I=(p+m)/4;return x>y&&x>S?x<.01?(i=0,r=.707106781,o=.707106781):(i=Math.sqrt(x),r=P/i,o=T/i):y>S?y<.01?(i=.707106781,r=0,o=.707106781):(r=Math.sqrt(y),i=P/r,o=I/r):S<.01?(i=.707106781,r=.707106781,o=0):(o=Math.sqrt(S),i=T/o,r=I/o),this.set(i,r,o,t),this}let v=Math.sqrt((m-p)*(m-p)+(d-_)*(d-_)+(f-u)*(f-u));return Math.abs(v)<.001&&(v=1),this.x=(m-p)/v,this.y=(d-_)/v,this.z=(f-u)/v,this.w=Math.acos((l+h+g-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=at(this.x,e.x,t.x),this.y=at(this.y,e.y,t.y),this.z=at(this.z,e.z,t.z),this.w=at(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=at(this.x,e,t),this.y=at(this.y,e,t),this.z=at(this.z,e,t),this.w=at(this.w,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(at(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class AD extends Jo{constructor(e=1,t=1,i={}){super(),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:on,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},i),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=i.depth,this.scissor=new pn(0,0,e,t),this.scissorTest=!1,this.viewport=new pn(0,0,e,t);const o=new ui({width:e,height:t,depth:i.depth});this.textures=[];const s=i.count;for(let a=0;a<s;a++)this.textures[a]=o.clone(),this.textures[a].isRenderTargetTexture=!0,this.textures[a].renderTarget=this;this._setTextureOptions(i),this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples,this.multiview=i.multiview}_setTextureOptions(e={}){const t={minFilter:on,generateMipmaps:!1,flipY:!1,internalFormat:null};void 0!==e.mapping&&(t.mapping=e.mapping),void 0!==e.wrapS&&(t.wrapS=e.wrapS),void 0!==e.wrapT&&(t.wrapT=e.wrapT),void 0!==e.wrapR&&(t.wrapR=e.wrapR),void 0!==e.magFilter&&(t.magFilter=e.magFilter),void 0!==e.minFilter&&(t.minFilter=e.minFilter),void 0!==e.format&&(t.format=e.format),void 0!==e.type&&(t.type=e.type),void 0!==e.anisotropy&&(t.anisotropy=e.anisotropy),void 0!==e.colorSpace&&(t.colorSpace=e.colorSpace),void 0!==e.flipY&&(t.flipY=e.flipY),void 0!==e.generateMipmaps&&(t.generateMipmaps=e.generateMipmaps),void 0!==e.internalFormat&&(t.internalFormat=e.internalFormat);for(let i=0;i<this.textures.length;i++)this.textures[i].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){null!==this._depthTexture&&(this._depthTexture.renderTarget=null),null!==e&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,o=this.textures.length;r<o;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=i,!0!==this.textures[r].isData3DTexture&&(this.textures[r].isArrayTexture=this.textures[r].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,i=e.textures.length;t<i;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const r=Object.assign({},e.textures[t].image);this.textures[t].source=new ba(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class br extends AD{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class Dy extends ui{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=En,this.minFilter=En,this.wrapR=Bi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Iy extends ui{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=En,this.minFilter=En,this.wrapR=Bi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Yn{constructor(e=new R(1/0,1/0,1/0),t=new R(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(jr.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(jr.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=jr.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i){const o=i.getAttribute("position");if(!0===t&&void 0!==o&&!0!==e.isInstancedMesh)for(let s=0,a=o.count;s<a;s++)!0===e.isMesh?e.getVertexPosition(s,jr):jr.fromBufferAttribute(o,s),jr.applyMatrix4(e.matrixWorld),this.expandByPoint(jr);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),eg.copy(e.boundingBox)):(null===i.boundingBox&&i.computeBoundingBox(),eg.copy(i.boundingBox)),eg.applyMatrix4(e.matrixWorld),this.union(eg)}const r=e.children;for(let o=0,s=r.length;o<s;o++)this.expandByObject(r[o],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,jr),jr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Vd),tg.subVectors(this.max,Vd),vl.subVectors(e.a,Vd),xl.subVectors(e.b,Vd),yl.subVectors(e.c,Vd),Ns.subVectors(xl,vl),Ls.subVectors(yl,xl),Ca.subVectors(vl,yl);let t=[0,-Ns.z,Ns.y,0,-Ls.z,Ls.y,0,-Ca.z,Ca.y,Ns.z,0,-Ns.x,Ls.z,0,-Ls.x,Ca.z,0,-Ca.x,-Ns.y,Ns.x,0,-Ls.y,Ls.x,0,-Ca.y,Ca.x,0];return!(!Ry(t,vl,xl,yl,tg)||(t=[1,0,0,0,1,0,0,0,1],!Ry(t,vl,xl,yl,tg)))&&(ng.crossVectors(Ns,Ls),t=[ng.x,ng.y,ng.z],Ry(t,vl,xl,yl,tg))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,jr).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(jr).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(es[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),es[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),es[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),es[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),es[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),es[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),es[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),es[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(es)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const es=[new R,new R,new R,new R,new R,new R,new R,new R],jr=new R,eg=new Yn,vl=new R,xl=new R,yl=new R,Ns=new R,Ls=new R,Ca=new R,Vd=new R,tg=new R,ng=new R,wa=new R;function Ry(n,e,t,i,r){for(let o=0,s=n.length-3;o<=s;o+=3){wa.fromArray(n,o);const a=r.x*Math.abs(wa.x)+r.y*Math.abs(wa.y)+r.z*Math.abs(wa.z),c=e.dot(wa),l=t.dot(wa),u=i.dot(wa);if(Math.max(-Math.max(c,l,u),Math.min(c,l,u))>a)return!1}return!0}const Mj=new Yn,zd=new R,Ny=new R;class ri{constructor(e=new R,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):Mj.setFromPoints(e).getCenter(i);let r=0;for(let o=0,s=e.length;o<s;o++)r=Math.max(r,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;zd.subVectors(e,this.center);const t=zd.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.addScaledVector(zd,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(Ny.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(zd.copy(e.center).add(Ny)),this.expandByPoint(zd.copy(e.center).sub(Ny))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const ts=new R,Ly=new R,ig=new R,Fs=new R,Fy=new R,rg=new R,ky=new R;class Hd{constructor(e=new R,t=new R(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ts)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=ts.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ts.copy(this.origin).addScaledVector(this.direction,t),ts.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){Ly.copy(e).add(t).multiplyScalar(.5),ig.copy(t).sub(e).normalize(),Fs.copy(this.origin).sub(Ly);const o=.5*e.distanceTo(t),s=-this.direction.dot(ig),a=Fs.dot(this.direction),c=-Fs.dot(ig),l=Fs.lengthSq(),u=Math.abs(1-s*s);let d,f,h,p;if(u>0)if(d=s*c-a,f=s*a-c,p=o*u,d>=0)if(f>=-p)if(f<=p){const _=1/u;d*=_,f*=_,h=d*(d+s*f+2*a)+f*(s*d+f+2*c)+l}else f=o,d=Math.max(0,-(s*f+a)),h=-d*d+f*(f+2*c)+l;else f=-o,d=Math.max(0,-(s*f+a)),h=-d*d+f*(f+2*c)+l;else f<=-p?(d=Math.max(0,-(-s*o+a)),f=d>0?-o:Math.min(Math.max(-o,-c),o),h=-d*d+f*(f+2*c)+l):f<=p?(d=0,f=Math.min(Math.max(-o,-c),o),h=f*(f+2*c)+l):(d=Math.max(0,-(s*o+a)),f=d>0?o:Math.min(Math.max(-o,-c),o),h=-d*d+f*(f+2*c)+l);else f=s>0?-o:o,d=Math.max(0,-(s*f+a)),h=-d*d+f*(f+2*c)+l;return i&&i.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy(Ly).addScaledVector(ig,f),h}intersectSphere(e,t){ts.subVectors(e.center,this.origin);const i=ts.dot(this.direction),r=ts.dot(ts)-i*i,o=e.radius*e.radius;if(r>o)return null;const s=Math.sqrt(o-r),a=i-s,c=i+s;return c<0?null:this.at(a<0?c:a,t)}intersectsSphere(e){return!(e.radius<0)&&this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,o,s,a,c;const l=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,f=this.origin;return l>=0?(i=(e.min.x-f.x)*l,r=(e.max.x-f.x)*l):(i=(e.max.x-f.x)*l,r=(e.min.x-f.x)*l),u>=0?(o=(e.min.y-f.y)*u,s=(e.max.y-f.y)*u):(o=(e.max.y-f.y)*u,s=(e.min.y-f.y)*u),i>s||o>r||((o>i||isNaN(i))&&(i=o),(s<r||isNaN(r))&&(r=s),d>=0?(a=(e.min.z-f.z)*d,c=(e.max.z-f.z)*d):(a=(e.max.z-f.z)*d,c=(e.min.z-f.z)*d),i>c||a>r)||((a>i||i!=i)&&(i=a),(c<r||r!=r)&&(r=c),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,ts)}intersectTriangle(e,t,i,r,o){Fy.subVectors(t,e),rg.subVectors(i,e),ky.crossVectors(Fy,rg);let a,s=this.direction.dot(ky);if(s>0){if(r)return null;a=1}else{if(!(s<0))return null;a=-1,s=-s}Fs.subVectors(this.origin,e);const c=a*this.direction.dot(rg.crossVectors(Fs,rg));if(c<0)return null;const l=a*this.direction.dot(Fy.cross(Fs));if(l<0||c+l>s)return null;const u=-a*Fs.dot(ky);return u<0?null:this.at(u/s,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class it{constructor(e,t,i,r,o,s,a,c,l,u,d,f,h,p,_,m){it.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,i,r,o,s,a,c,l,u,d,f,h,p,_,m)}set(e,t,i,r,o,s,a,c,l,u,d,f,h,p,_,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=i,g[12]=r,g[1]=o,g[5]=s,g[9]=a,g[13]=c,g[2]=l,g[6]=u,g[10]=d,g[14]=f,g[3]=h,g[7]=p,g[11]=_,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new it).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return 0===this.determinant()?(e.set(1,0,0),t.set(0,1,0),i.set(0,0,1),this):(e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this)}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){if(0===e.determinant())return this.identity();const t=this.elements,i=e.elements,r=1/Ml.setFromMatrixColumn(e,0).length(),o=1/Ml.setFromMatrixColumn(e,1).length(),s=1/Ml.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*o,t[5]=i[5]*o,t[6]=i[6]*o,t[7]=0,t[8]=i[8]*s,t[9]=i[9]*s,t[10]=i[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,o=e.z,s=Math.cos(i),a=Math.sin(i),c=Math.cos(r),l=Math.sin(r),u=Math.cos(o),d=Math.sin(o);if("XYZ"===e.order){const f=s*u,h=s*d,p=a*u,_=a*d;t[0]=c*u,t[4]=-c*d,t[8]=l,t[1]=h+p*l,t[5]=f-_*l,t[9]=-a*c,t[2]=_-f*l,t[6]=p+h*l,t[10]=s*c}else if("YXZ"===e.order){const f=c*u,h=c*d,p=l*u,_=l*d;t[0]=f+_*a,t[4]=p*a-h,t[8]=s*l,t[1]=s*d,t[5]=s*u,t[9]=-a,t[2]=h*a-p,t[6]=_+f*a,t[10]=s*c}else if("ZXY"===e.order){const f=c*u,h=c*d,p=l*u,_=l*d;t[0]=f-_*a,t[4]=-s*d,t[8]=p+h*a,t[1]=h+p*a,t[5]=s*u,t[9]=_-f*a,t[2]=-s*l,t[6]=a,t[10]=s*c}else if("ZYX"===e.order){const f=s*u,h=s*d,p=a*u,_=a*d;t[0]=c*u,t[4]=p*l-h,t[8]=f*l+_,t[1]=c*d,t[5]=_*l+f,t[9]=h*l-p,t[2]=-l,t[6]=a*c,t[10]=s*c}else if("YZX"===e.order){const f=s*c,h=s*l,p=a*c,_=a*l;t[0]=c*u,t[4]=_-f*d,t[8]=p*d+h,t[1]=d,t[5]=s*u,t[9]=-a*u,t[2]=-l*u,t[6]=h*d+p,t[10]=f-_*d}else if("XZY"===e.order){const f=s*c,h=s*l,p=a*c,_=a*l;t[0]=c*u,t[4]=-d,t[8]=l*u,t[1]=f*d+_,t[5]=s*u,t[9]=h*d-p,t[2]=p*d-h,t[6]=a*u,t[10]=_*d+f}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(bj,e,Cj)}lookAt(e,t,i){const r=this.elements;return sr.subVectors(e,t),0===sr.lengthSq()&&(sr.z=1),sr.normalize(),ks.crossVectors(i,sr),0===ks.lengthSq()&&(1===Math.abs(i.z)?sr.x+=1e-4:sr.z+=1e-4,sr.normalize(),ks.crossVectors(i,sr)),ks.normalize(),og.crossVectors(sr,ks),r[0]=ks.x,r[4]=og.x,r[8]=sr.x,r[1]=ks.y,r[5]=og.y,r[9]=sr.y,r[2]=ks.z,r[6]=og.z,r[10]=sr.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,o=this.elements,s=i[0],a=i[4],c=i[8],l=i[12],u=i[1],d=i[5],f=i[9],h=i[13],p=i[2],_=i[6],m=i[10],g=i[14],v=i[3],x=i[7],y=i[11],S=i[15],P=r[0],T=r[4],I=r[8],C=r[12],E=r[1],F=r[5],z=r[9],H=r[13],W=r[2],Y=r[6],j=r[10],X=r[14],ce=r[3],ye=r[7],_e=r[11],Me=r[15];return o[0]=s*P+a*E+c*W+l*ce,o[4]=s*T+a*F+c*Y+l*ye,o[8]=s*I+a*z+c*j+l*_e,o[12]=s*C+a*H+c*X+l*Me,o[1]=u*P+d*E+f*W+h*ce,o[5]=u*T+d*F+f*Y+h*ye,o[9]=u*I+d*z+f*j+h*_e,o[13]=u*C+d*H+f*X+h*Me,o[2]=p*P+_*E+m*W+g*ce,o[6]=p*T+_*F+m*Y+g*ye,o[10]=p*I+_*z+m*j+g*_e,o[14]=p*C+_*H+m*X+g*Me,o[3]=v*P+x*E+y*W+S*ce,o[7]=v*T+x*F+y*Y+S*ye,o[11]=v*I+x*z+y*j+S*_e,o[15]=v*C+x*H+y*X+S*Me,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,s=e[1],a=e[5],c=e[9],l=e[13],u=e[2],d=e[6],f=e[10],h=e[14],p=e[3],_=e[7],m=e[11],g=e[15],v=c*h-l*f,x=a*h-l*d,y=a*f-c*d,S=s*h-l*u,P=s*f-c*u,T=s*d-a*u;return e[0]*(_*v-m*x+g*y)-e[4]*(p*v-m*S+g*P)+e[8]*(p*x-_*S+g*T)-e[12]*(p*y-_*P+m*T)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],c=e[6],l=e[7],u=e[8],d=e[9],f=e[10],h=e[11],p=e[12],_=e[13],m=e[14],g=e[15],v=d*m*l-_*f*l+_*c*h-a*m*h-d*c*g+a*f*g,x=p*f*l-u*m*l-p*c*h+s*m*h+u*c*g-s*f*g,y=u*_*l-p*d*l+p*a*h-s*_*h-u*a*g+s*d*g,S=p*d*c-u*_*c-p*a*f+s*_*f+u*a*m-s*d*m,P=t*v+i*x+r*y+o*S;if(0===P)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const T=1/P;return e[0]=v*T,e[1]=(_*f*o-d*m*o-_*r*h+i*m*h+d*r*g-i*f*g)*T,e[2]=(a*m*o-_*c*o+_*r*l-i*m*l-a*r*g+i*c*g)*T,e[3]=(d*c*o-a*f*o-d*r*l+i*f*l+a*r*h-i*c*h)*T,e[4]=x*T,e[5]=(u*m*o-p*f*o+p*r*h-t*m*h-u*r*g+t*f*g)*T,e[6]=(p*c*o-s*m*o-p*r*l+t*m*l+s*r*g-t*c*g)*T,e[7]=(s*f*o-u*c*o+u*r*l-t*f*l-s*r*h+t*c*h)*T,e[8]=y*T,e[9]=(p*d*o-u*_*o-p*i*h+t*_*h+u*i*g-t*d*g)*T,e[10]=(s*_*o-p*a*o+p*i*l-t*_*l-s*i*g+t*a*g)*T,e[11]=(u*a*o-s*d*o-u*i*l+t*d*l+s*i*h-t*a*h)*T,e[12]=S*T,e[13]=(u*_*r-p*d*r+p*i*f-t*_*f-u*i*m+t*d*m)*T,e[14]=(p*a*r-s*_*r-p*i*c+t*_*c+s*i*m-t*a*m)*T,e[15]=(s*d*r-u*a*r+u*i*c-t*d*c-s*i*f+t*a*f)*T,this}scale(e){const t=this.elements,i=e.x,r=e.y,o=e.z;return t[0]*=i,t[4]*=r,t[8]*=o,t[1]*=i,t[5]*=r,t[9]*=o,t[2]*=i,t[6]*=r,t[10]*=o,t[3]*=i,t[7]*=r,t[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),o=1-i,s=e.x,a=e.y,c=e.z,l=o*s,u=o*a;return this.set(l*s+i,l*a-r*c,l*c+r*a,0,l*a+r*c,u*a+i,u*c-r*s,0,l*c-r*a,u*c+r*s,o*c*c+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,o,s){return this.set(1,i,o,0,e,1,s,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,o=t._x,s=t._y,a=t._z,c=t._w,l=o+o,u=s+s,d=a+a,f=o*l,h=o*u,p=o*d,_=s*u,m=s*d,g=a*d,v=c*l,x=c*u,y=c*d,S=i.x,P=i.y,T=i.z;return r[0]=(1-(_+g))*S,r[1]=(h+y)*S,r[2]=(p-x)*S,r[3]=0,r[4]=(h-y)*P,r[5]=(1-(f+g))*P,r[6]=(m+v)*P,r[7]=0,r[8]=(p+x)*T,r[9]=(m-v)*T,r[10]=(1-(f+_))*T,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;if(e.x=r[12],e.y=r[13],e.z=r[14],0===this.determinant())return i.set(1,1,1),t.identity(),this;let o=Ml.set(r[0],r[1],r[2]).length();const s=Ml.set(r[4],r[5],r[6]).length(),a=Ml.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),Wr.copy(this);const l=1/o,u=1/s,d=1/a;return Wr.elements[0]*=l,Wr.elements[1]*=l,Wr.elements[2]*=l,Wr.elements[4]*=u,Wr.elements[5]*=u,Wr.elements[6]*=u,Wr.elements[8]*=d,Wr.elements[9]*=d,Wr.elements[10]*=d,t.setFromRotationMatrix(Wr),i.x=o,i.y=s,i.z=a,this}makePerspective(e,t,i,r,o,s,a=Mr,c=!1){const l=this.elements,u=2*o/(t-e),d=2*o/(i-r),f=(t+e)/(t-e),h=(i+r)/(i-r);let p,_;if(c)p=o/(s-o),_=s*o/(s-o);else if(a===Mr)p=-(s+o)/(s-o),_=-2*s*o/(s-o);else{if(2001!==a)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);p=-s/(s-o),_=-s*o/(s-o)}return l[0]=u,l[4]=0,l[8]=f,l[12]=0,l[1]=0,l[5]=d,l[9]=h,l[13]=0,l[2]=0,l[6]=0,l[10]=p,l[14]=_,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,o,s,a=Mr,c=!1){const l=this.elements,u=2/(t-e),d=2/(i-r),f=-(t+e)/(t-e),h=-(i+r)/(i-r);let p,_;if(c)p=1/(s-o),_=s/(s-o);else if(a===Mr)p=-2/(s-o),_=-(s+o)/(s-o);else{if(2001!==a)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);p=-1/(s-o),_=-o/(s-o)}return l[0]=u,l[4]=0,l[8]=0,l[12]=f,l[1]=0,l[5]=d,l[9]=0,l[13]=h,l[2]=0,l[6]=0,l[10]=p,l[14]=_,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const Ml=new R,Wr=new it,bj=new R(0,0,0),Cj=new R(1,1,1),ks=new R,og=new R,sr=new R,OD=new it,DD=new wi;let ns=(()=>{class n{constructor(t=0,i=0,r=0,o=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=o}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,o=this._order){return this._x=t,this._y=i,this._z=r,this._order=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const o=t.elements,s=o[0],a=o[4],c=o[8],l=o[1],u=o[5],d=o[9],f=o[2],h=o[6],p=o[10];switch(i){case"XYZ":this._y=Math.asin(at(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,p),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(h,u),this._z=0);break;case"YXZ":this._x=Math.asin(-at(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(c,p),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-f,s),this._z=0);break;case"ZXY":this._x=Math.asin(at(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-f,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-at(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(h,p),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(at(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-f,s)):(this._x=0,this._y=Math.atan2(c,p));break;case"XZY":this._z=Math.asin(-at(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(h,u),this._y=Math.atan2(c,s)):(this._x=Math.atan2(-d,p),this._y=0);break;default:Se("Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return OD.makeRotationFromQuaternion(t),this.setFromRotationMatrix(OD,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return DD.setFromEuler(this),this.setFromQuaternion(DD,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})();class Uy{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let wj=0;const ID=new R,bl=new wi,is=new it,sg=new R,Gd=new R,Sj=new R,Pj=new wi,RD=new R(1,0,0),ND=new R(0,1,0),LD=new R(0,0,1),FD={type:"added"},Ej={type:"removed"},Cl={type:"childadded",child:null},By={type:"childremoved",child:null};let sn=(()=>{class n extends Jo{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:wj++}),this.uuid=or(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();const t=new R,i=new ns,r=new wi,o=new R(1,1,1);i._onChange(function s(){r.setFromEuler(i,!1)}),r._onChange(function a(){i.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new it},normalMatrix:{value:new Pt}}),this.matrix=new it,this.matrixWorld=new it,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Uy,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return bl.setFromAxisAngle(t,i),this.quaternion.multiply(bl),this}rotateOnWorldAxis(t,i){return bl.setFromAxisAngle(t,i),this.quaternion.premultiply(bl),this}rotateX(t){return this.rotateOnAxis(RD,t)}rotateY(t){return this.rotateOnAxis(ND,t)}rotateZ(t){return this.rotateOnAxis(LD,t)}translateOnAxis(t,i){return ID.copy(t).applyQuaternion(this.quaternion),this.position.add(ID.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(RD,t)}translateY(t){return this.translateOnAxis(ND,t)}translateZ(t){return this.translateOnAxis(LD,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(is.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?sg.copy(t):sg.set(t,i,r);const o=this.parent;this.updateWorldMatrix(!0,!1),Gd.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?is.lookAt(Gd,sg,this.up):is.lookAt(sg,Gd,this.up),this.quaternion.setFromRotationMatrix(is),o&&(is.extractRotation(o.matrixWorld),bl.setFromRotationMatrix(is),this.quaternion.premultiply(bl.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(Ze("Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(FD),Cl.child=t,this.dispatchEvent(Cl),Cl.child=null):Ze("Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(Ej),By.child=t,this.dispatchEvent(By),By.child=null),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),is.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),is.multiply(t.parent.matrixWorld)),t.applyMatrix4(is),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(FD),Cl.child=t,this.dispatchEvent(Cl),Cl.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,o=this.children.length;r<o;r++){const a=this.children[r].getObjectByProperty(t,i);if(void 0!==a)return a}}getObjectsByProperty(t,i,r=[]){this[t]===i&&r.push(this);const o=this.children;for(let s=0,a=o.length;s<a;s++)o[s].getObjectsByProperty(t,i,r);return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Gd,t,Sj),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Gd,Pj,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let r=0,o=i.length;r<o;r++)i[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let r=0,o=i.length;r<o;r++)i[r].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let r=0,o=i.length;r<o;r++)i[r].updateMatrixWorld(t)}updateWorldMatrix(t,i){const r=this.parent;if(!0===t&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===i){const o=this.children;for(let s=0,a=o.length;s<a;s++)o[s].updateWorldMatrix(!1,!0)}}toJSON(t){const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const o={};function s(c,l){return void 0===c[l.uuid]&&(c[l.uuid]=l.toJSON(t)),l.uuid}if(o.uuid=this.uuid,o.type=this.type,""!==this.name&&(o.name=this.name),!0===this.castShadow&&(o.castShadow=!0),!0===this.receiveShadow&&(o.receiveShadow=!0),!1===this.visible&&(o.visible=!1),!1===this.frustumCulled&&(o.frustumCulled=!1),0!==this.renderOrder&&(o.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),o.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(o.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(o.type="BatchedMesh",o.perObjectFrustumCulled=this.perObjectFrustumCulled,o.sortObjects=this.sortObjects,o.drawRanges=this._drawRanges,o.reservedRanges=this._reservedRanges,o.geometryInfo=this._geometryInfo.map(c=>({...c,boundingBox:c.boundingBox?c.boundingBox.toJSON():void 0,boundingSphere:c.boundingSphere?c.boundingSphere.toJSON():void 0})),o.instanceInfo=this._instanceInfo.map(c=>({...c})),o.availableInstanceIds=this._availableInstanceIds.slice(),o.availableGeometryIds=this._availableGeometryIds.slice(),o.nextIndexStart=this._nextIndexStart,o.nextVertexStart=this._nextVertexStart,o.geometryCount=this._geometryCount,o.maxInstanceCount=this._maxInstanceCount,o.maxVertexCount=this._maxVertexCount,o.maxIndexCount=this._maxIndexCount,o.geometryInitialized=this._geometryInitialized,o.matricesTexture=this._matricesTexture.toJSON(t),o.indirectTexture=this._indirectTexture.toJSON(t),null!==this._colorsTexture&&(o.colorsTexture=this._colorsTexture.toJSON(t)),null!==this.boundingSphere&&(o.boundingSphere=this.boundingSphere.toJSON()),null!==this.boundingBox&&(o.boundingBox=this.boundingBox.toJSON())),this.isScene)this.background&&(this.background.isColor?o.background=this.background.toJSON():this.background.isTexture&&(o.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(o.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){o.geometry=s(t.geometries,this.geometry);const c=this.geometry.parameters;if(void 0!==c&&void 0!==c.shapes){const l=c.shapes;if(Array.isArray(l))for(let u=0,d=l.length;u<d;u++)s(t.shapes,l[u]);else s(t.shapes,l)}}if(this.isSkinnedMesh&&(o.bindMode=this.bindMode,o.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(s(t.skeletons,this.skeleton),o.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const c=[];for(let l=0,u=this.material.length;l<u;l++)c.push(s(t.materials,this.material[l]));o.material=c}else o.material=s(t.materials,this.material);if(this.children.length>0){o.children=[];for(let c=0;c<this.children.length;c++)o.children.push(this.children[c].toJSON(t).object)}if(this.animations.length>0){o.animations=[];for(let c=0;c<this.animations.length;c++)o.animations.push(s(t.animations,this.animations[c]))}if(i){const c=a(t.geometries),l=a(t.materials),u=a(t.textures),d=a(t.images),f=a(t.shapes),h=a(t.skeletons),p=a(t.animations),_=a(t.nodes);c.length>0&&(r.geometries=c),l.length>0&&(r.materials=l),u.length>0&&(r.textures=u),d.length>0&&(r.images=d),f.length>0&&(r.shapes=f),h.length>0&&(r.skeletons=h),p.length>0&&(r.animations=p),_.length>0&&(r.nodes=_)}return r.object=o,r;function a(c){const l=[];for(const u in c){const d=c[u];delete d.metadata,l.push(d)}return l}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return n.DEFAULT_UP=new R(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})();const $r=new R,rs=new R,Vy=new R,os=new R,wl=new R,Sl=new R,kD=new R,zy=new R,Hy=new R,Gy=new R,jy=new pn,Wy=new pn,$y=new pn;class ar{constructor(e=new R,t=new R,i=new R){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),$r.subVectors(e,t),r.cross($r);const o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}static getBarycoord(e,t,i,r,o){$r.subVectors(r,t),rs.subVectors(i,t),Vy.subVectors(e,t);const s=$r.dot($r),a=$r.dot(rs),c=$r.dot(Vy),l=rs.dot(rs),u=rs.dot(Vy),d=s*l-a*a;if(0===d)return o.set(0,0,0),null;const f=1/d,h=(l*c-a*u)*f,p=(s*u-a*c)*f;return o.set(1-h-p,p,h)}static containsPoint(e,t,i,r){return null!==this.getBarycoord(e,t,i,r,os)&&os.x>=0&&os.y>=0&&os.x+os.y<=1}static getInterpolation(e,t,i,r,o,s,a,c){return null===this.getBarycoord(e,t,i,r,os)?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(o,os.x),c.addScaledVector(s,os.y),c.addScaledVector(a,os.z),c)}static getInterpolatedAttribute(e,t,i,r,o,s){return jy.setScalar(0),Wy.setScalar(0),$y.setScalar(0),jy.fromBufferAttribute(e,t),Wy.fromBufferAttribute(e,i),$y.fromBufferAttribute(e,r),s.setScalar(0),s.addScaledVector(jy,o.x),s.addScaledVector(Wy,o.y),s.addScaledVector($y,o.z),s}static isFrontFacing(e,t,i,r){return $r.subVectors(i,t),rs.subVectors(e,t),$r.cross(rs).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return $r.subVectors(this.c,this.b),rs.subVectors(this.a,this.b),.5*$r.cross(rs).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ar.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ar.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,i,r,o){return ar.getInterpolation(e,this.a,this.b,this.c,t,i,r,o)}containsPoint(e){return ar.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ar.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,o=this.c;let s,a;wl.subVectors(r,i),Sl.subVectors(o,i),zy.subVectors(e,i);const c=wl.dot(zy),l=Sl.dot(zy);if(c<=0&&l<=0)return t.copy(i);Hy.subVectors(e,r);const u=wl.dot(Hy),d=Sl.dot(Hy);if(u>=0&&d<=u)return t.copy(r);const f=c*d-u*l;if(f<=0&&c>=0&&u<=0)return s=c/(c-u),t.copy(i).addScaledVector(wl,s);Gy.subVectors(e,o);const h=wl.dot(Gy),p=Sl.dot(Gy);if(p>=0&&h<=p)return t.copy(o);const _=h*l-c*p;if(_<=0&&l>=0&&p<=0)return a=l/(l-p),t.copy(i).addScaledVector(Sl,a);const m=u*p-h*d;if(m<=0&&d-u>=0&&h-p>=0)return kD.subVectors(o,r),a=(d-u)/(d-u+(h-p)),t.copy(r).addScaledVector(kD,a);const g=1/(m+_+f);return s=_*g,a=f*g,t.copy(i).addScaledVector(wl,s).addScaledVector(Sl,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const UD={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Us={h:0,s:0,l:0},ag={h:0,s:0,l:0};function qy(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}class xe{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(void 0===t&&void 0===i){const r=e;r&&r.isColor?this.copy(r):"number"==typeof r?this.setHex(r):"string"==typeof r&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=vn){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Tt.colorSpaceToWorking(this,t),this}setRGB(e,t,i,r=Tt.workingColorSpace){return this.r=e,this.g=t,this.b=i,Tt.colorSpaceToWorking(this,r),this}setHSL(e,t,i,r=Tt.workingColorSpace){if(e=Py(e,1),t=at(t,0,1),i=at(i,0,1),0===t)this.r=this.g=this.b=i;else{const o=i<=.5?i*(1+t):i+t-i*t,s=2*i-o;this.r=qy(s,o,e+1/3),this.g=qy(s,o,e),this.b=qy(s,o,e-1/3)}return Tt.colorSpaceToWorking(this,r),this}setStyle(e,t=vn){function i(o){void 0!==o&&parseFloat(o)<1&&Se("Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let o;const a=r[2];switch(r[1]){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,t);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,t);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,t);break;default:Se("Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const o=r[1],s=o.length;if(3===s)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,t);if(6===s)return this.setHex(parseInt(o,16),t);Se("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=vn){const i=UD[e.toLowerCase()];return void 0!==i?this.setHex(i,t):Se("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Qo(e.r),this.g=Qo(e.g),this.b=Qo(e.b),this}copyLinearToSRGB(e){return this.r=ml(e.r),this.g=ml(e.g),this.b=ml(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=vn){return Tt.workingToColorSpace(di.copy(this),e),65536*Math.round(at(255*di.r,0,255))+256*Math.round(at(255*di.g,0,255))+Math.round(at(255*di.b,0,255))}getHexString(e=vn){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Tt.workingColorSpace){Tt.workingToColorSpace(di.copy(this),t);const i=di.r,r=di.g,o=di.b,s=Math.max(i,r,o),a=Math.min(i,r,o);let c,l;const u=(a+s)/2;if(a===s)c=0,l=0;else{const d=s-a;switch(l=u<=.5?d/(s+a):d/(2-s-a),s){case i:c=(r-o)/d+(r<o?6:0);break;case r:c=(o-i)/d+2;break;case o:c=(i-r)/d+4}c/=6}return e.h=c,e.s=l,e.l=u,e}getRGB(e,t=Tt.workingColorSpace){return Tt.workingToColorSpace(di.copy(this),t),e.r=di.r,e.g=di.g,e.b=di.b,e}getStyle(e=vn){Tt.workingToColorSpace(di.copy(this),e);const t=di.r,i=di.g,r=di.b;return e!==vn?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*i)},${Math.round(255*r)})`}offsetHSL(e,t,i){return this.getHSL(Us),this.setHSL(Us.h+e,Us.s+t,Us.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Us),e.getHSL(ag);const i=Bd(Us.h,ag.h,t),r=Bd(Us.s,ag.s,t),o=Bd(Us.l,ag.l,t);return this.setHSL(i,r,o),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,o=e.elements;return this.r=o[0]*t+o[3]*i+o[6]*r,this.g=o[1]*t+o[4]*i+o[7]*r,this.b=o[2]*t+o[5]*i+o[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const di=new xe;xe.NAMES=UD;let Tj=0;class Un extends Jo{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Tj++}),this.uuid=or(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new xe(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=hl,this.stencilZFail=hl,this.stencilZPass=hl,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){Se(`Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:Se(`Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};function r(o){const s=[];for(const a in o){const c=o[a];delete c.metadata,s.push(c)}return s}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(i.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(i.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),void 0!==this.dispersion&&(i.dispersion=this.dispersion),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapRotation&&(i.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),!0===this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=!0),204!==this.blendSrc&&(i.blendSrc=this.blendSrc),205!==this.blendDst&&(i.blendDst=this.blendDst),100!==this.blendEquation&&(i.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(i.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(i.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(i.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(i.depthFunc=this.depthFunc),!1===this.depthTest&&(i.depthTest=this.depthTest),!1===this.depthWrite&&(i.depthWrite=this.depthWrite),!1===this.colorWrite&&(i.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(i.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(i.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(i.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==hl&&(i.stencilFail=this.stencilFail),this.stencilZFail!==hl&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==hl&&(i.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(i.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=!0),!0===this.alphaToCoverage&&(i.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=!0),!0===this.forceSinglePass&&(i.forceSinglePass=!0),!1===this.allowOverride&&(i.allowOverride=!1),!0===this.wireframe&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const o=r(e.textures),s=r(e.images);o.length>0&&(i.textures=o),s.length>0&&(i.images=s)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let o=0;o!==r;++o)i[o]=t[o].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class Cr extends Un{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new xe(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ns,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Bn=new R,cg=new re;let Oj=0;class Wt{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:Oj++}),this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this.updateRanges=[],this.gpuType=Vi,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,o=this.itemSize;r<o;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)cg.fromBufferAttribute(this,t),cg.applyMatrix3(e),this.setXY(t,cg.x,cg.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)Bn.fromBufferAttribute(this,t),Bn.applyMatrix3(e),this.setXYZ(t,Bn.x,Bn.y,Bn.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Bn.fromBufferAttribute(this,t),Bn.applyMatrix4(e),this.setXYZ(t,Bn.x,Bn.y,Bn.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Bn.fromBufferAttribute(this,t),Bn.applyNormalMatrix(e),this.setXYZ(t,Bn.x,Bn.y,Bn.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Bn.fromBufferAttribute(this,t),Bn.transformDirection(e),this.setXYZ(t,Bn.x,Bn.y,Bn.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Ci(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=St(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Ci(t,this.array)),t}setX(e,t){return this.normalized&&(t=St(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Ci(t,this.array)),t}setY(e,t){return this.normalized&&(t=St(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Ci(t,this.array)),t}setZ(e,t){return this.normalized&&(t=St(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Ci(t,this.array)),t}setW(e,t){return this.normalized&&(t=St(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=St(t,this.array),i=St(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=St(t,this.array),i=St(i,this.array),r=St(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,o){return e*=this.itemSize,this.normalized&&(t=St(t,this.array),i=St(i,this.array),r=St(r,this.array),o=St(o,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),e}}class BD extends Wt{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class VD extends Wt{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Ne extends Wt{constructor(e,t,i){super(new Float32Array(e),t,i)}}let Dj=0;const wr=new it,Xy=new sn,Pl=new R,cr=new Yn,Wd=new Yn,Zn=new R;class pt extends Jo{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Dj++}),this.uuid=or(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(bD(e)?VD:BD)(e,1):e,this}setIndirect(e,t=0){return this.indirect=e,this.indirectOffset=t,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const o=(new Pt).getNormalMatrix(e);i.applyNormalMatrix(o),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return wr.makeRotationFromQuaternion(e),this.applyMatrix4(wr),this}rotateX(e){return wr.makeRotationX(e),this.applyMatrix4(wr),this}rotateY(e){return wr.makeRotationY(e),this.applyMatrix4(wr),this}rotateZ(e){return wr.makeRotationZ(e),this.applyMatrix4(wr),this}translate(e,t,i){return wr.makeTranslation(e,t,i),this.applyMatrix4(wr),this}scale(e,t,i){return wr.makeScale(e,t,i),this.applyMatrix4(wr),this}lookAt(e){return Xy.lookAt(e),Xy.updateMatrix(),this.applyMatrix4(Xy.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Pl).negate(),this.translate(Pl.x,Pl.y,Pl.z),this}setFromPoints(e){const t=this.getAttribute("position");if(void 0===t){const i=[];for(let r=0,o=e.length;r<o;r++){const s=e[r];i.push(s.x,s.y,s.z||0)}this.setAttribute("position",new Ne(i,3))}else{const i=Math.min(e.length,t.count);for(let r=0;r<i;r++){const o=e[r];t.setXYZ(r,o.x,o.y,o.z||0)}e.length>t.count&&Se("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Yn);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return Ze("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new R(-1/0,-1/0,-1/0),new R(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)cr.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(Zn.addVectors(this.boundingBox.min,cr.min),this.boundingBox.expandByPoint(Zn),Zn.addVectors(this.boundingBox.max,cr.max),this.boundingBox.expandByPoint(Zn)):(this.boundingBox.expandByPoint(cr.min),this.boundingBox.expandByPoint(cr.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&Ze('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new ri);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return Ze("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new R,1/0);if(e){const i=this.boundingSphere.center;if(cr.setFromBufferAttribute(e),t)for(let o=0,s=t.length;o<s;o++)Wd.setFromBufferAttribute(t[o]),this.morphTargetsRelative?(Zn.addVectors(cr.min,Wd.min),cr.expandByPoint(Zn),Zn.addVectors(cr.max,Wd.max),cr.expandByPoint(Zn)):(cr.expandByPoint(Wd.min),cr.expandByPoint(Wd.max));cr.getCenter(i);let r=0;for(let o=0,s=e.count;o<s;o++)Zn.fromBufferAttribute(e,o),r=Math.max(r,i.distanceToSquared(Zn));if(t)for(let o=0,s=t.length;o<s;o++){const a=t[o],c=this.morphTargetsRelative;for(let l=0,u=a.count;l<u;l++)Zn.fromBufferAttribute(a,l),c&&(Pl.fromBufferAttribute(e,l),Zn.add(Pl)),r=Math.max(r,i.distanceToSquared(Zn))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&Ze('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void Ze("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=t.position,r=t.normal,o=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Wt(new Float32Array(4*i.count),4));const s=this.getAttribute("tangent"),a=[],c=[];for(let I=0;I<i.count;I++)a[I]=new R,c[I]=new R;const l=new R,u=new R,d=new R,f=new re,h=new re,p=new re,_=new R,m=new R;function g(I,C,E){l.fromBufferAttribute(i,I),u.fromBufferAttribute(i,C),d.fromBufferAttribute(i,E),f.fromBufferAttribute(o,I),h.fromBufferAttribute(o,C),p.fromBufferAttribute(o,E),u.sub(l),d.sub(l),h.sub(f),p.sub(f);const F=1/(h.x*p.y-p.x*h.y);isFinite(F)&&(_.copy(u).multiplyScalar(p.y).addScaledVector(d,-h.y).multiplyScalar(F),m.copy(d).multiplyScalar(h.x).addScaledVector(u,-p.x).multiplyScalar(F),a[I].add(_),a[C].add(_),a[E].add(_),c[I].add(m),c[C].add(m),c[E].add(m))}let v=this.groups;0===v.length&&(v=[{start:0,count:e.count}]);for(let I=0,C=v.length;I<C;++I){const E=v[I],F=E.start;for(let H=F,W=F+E.count;H<W;H+=3)g(e.getX(H+0),e.getX(H+1),e.getX(H+2))}const x=new R,y=new R,S=new R,P=new R;function T(I){S.fromBufferAttribute(r,I),P.copy(S);const C=a[I];x.copy(C),x.sub(S.multiplyScalar(S.dot(C))).normalize(),y.crossVectors(P,C);const F=y.dot(c[I])<0?-1:1;s.setXYZW(I,x.x,x.y,x.z,F)}for(let I=0,C=v.length;I<C;++I){const E=v[I],F=E.start;for(let H=F,W=F+E.count;H<W;H+=3)T(e.getX(H+0)),T(e.getX(H+1)),T(e.getX(H+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new Wt(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let f=0,h=i.count;f<h;f++)i.setXYZ(f,0,0,0);const r=new R,o=new R,s=new R,a=new R,c=new R,l=new R,u=new R,d=new R;if(e)for(let f=0,h=e.count;f<h;f+=3){const p=e.getX(f+0),_=e.getX(f+1),m=e.getX(f+2);r.fromBufferAttribute(t,p),o.fromBufferAttribute(t,_),s.fromBufferAttribute(t,m),u.subVectors(s,o),d.subVectors(r,o),u.cross(d),a.fromBufferAttribute(i,p),c.fromBufferAttribute(i,_),l.fromBufferAttribute(i,m),a.add(u),c.add(u),l.add(u),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(_,c.x,c.y,c.z),i.setXYZ(m,l.x,l.y,l.z)}else for(let f=0,h=t.count;f<h;f+=3)r.fromBufferAttribute(t,f+0),o.fromBufferAttribute(t,f+1),s.fromBufferAttribute(t,f+2),u.subVectors(s,o),d.subVectors(r,o),u.cross(d),i.setXYZ(f+0,u.x,u.y,u.z),i.setXYZ(f+1,u.x,u.y,u.z),i.setXYZ(f+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Zn.fromBufferAttribute(e,t),Zn.normalize(),e.setXYZ(t,Zn.x,Zn.y,Zn.z)}toNonIndexed(){function e(a,c){const l=a.array,u=a.itemSize,d=a.normalized,f=new l.constructor(c.length*u);let h=0,p=0;for(let _=0,m=c.length;_<m;_++){h=a.isInterleavedBufferAttribute?c[_]*a.data.stride+a.offset:c[_]*u;for(let g=0;g<u;g++)f[p++]=l[h++]}return new Wt(f,u,d)}if(null===this.index)return Se("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new pt,i=this.index.array,r=this.attributes;for(const a in r){const l=e(r[a],i);t.setAttribute(a,l)}const o=this.morphAttributes;for(const a in o){const c=[],l=o[a];for(let u=0,d=l.length;u<d;u++){const h=e(l[u],i);c.push(h)}t.morphAttributes[a]=c}t.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let a=0,c=s.length;a<c;a++){const l=s[a];t.addGroup(l.start,l.count,l.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const c=this.parameters;for(const l in c)void 0!==c[l]&&(e[l]=c[l]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const c in i)e.data.attributes[c]=i[c].toJSON(e.data);const r={};let o=!1;for(const c in this.morphAttributes){const l=this.morphAttributes[c],u=[];for(let d=0,f=l.length;d<f;d++)u.push(l[d].toJSON(e.data));u.length>0&&(r[c]=u,o=!0)}o&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere=a.toJSON()),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone());const r=e.attributes;for(const l in r)this.setAttribute(l,r[l].clone(t));const o=e.morphAttributes;for(const l in o){const u=[],d=o[l];for(let f=0,h=d.length;f<h;f++)u.push(d[f].clone(t));this.morphAttributes[l]=u}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let l=0,u=s.length;l<u;l++){const d=s[l];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const c=e.boundingSphere;return null!==c&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const zD=new it,Sa=new Hd,lg=new ri,HD=new R,ug=new R,dg=new R,fg=new R,Yy=new R,hg=new R,GD=new R,pg=new R;class Gt extends sn{constructor(e=new pt,t=new Cr){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){const a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}getVertexPosition(e,t){const i=this.geometry,o=i.morphAttributes.position,s=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const a=this.morphTargetInfluences;if(o&&a){hg.set(0,0,0);for(let c=0,l=o.length;c<l;c++){const u=a[c];0!==u&&(Yy.fromBufferAttribute(o[c],e),hg.addScaledVector(s?Yy:Yy.sub(t),u))}t.add(hg)}return t}raycast(e,t){const i=this.geometry,o=this.matrixWorld;void 0!==this.material&&(null===i.boundingSphere&&i.computeBoundingSphere(),lg.copy(i.boundingSphere),lg.applyMatrix4(o),Sa.copy(e.ray).recast(e.near),(!1!==lg.containsPoint(Sa.origin)||!(null===Sa.intersectSphere(lg,HD)||Sa.origin.distanceToSquared(HD)>(e.far-e.near)**2))&&(zD.copy(o).invert(),Sa.copy(e.ray).applyMatrix4(zD),(null===i.boundingBox||!1!==Sa.intersectsBox(i.boundingBox))&&this._computeIntersections(e,t,Sa)))}_computeIntersections(e,t,i){let r;const o=this.geometry,s=this.material,a=o.index,c=o.attributes.position,l=o.attributes.uv,u=o.attributes.uv1,d=o.attributes.normal,f=o.groups,h=o.drawRange;if(null!==a)if(Array.isArray(s))for(let p=0,_=f.length;p<_;p++){const m=f[p],g=s[m.materialIndex];for(let y=Math.max(m.start,h.start),S=Math.min(a.count,Math.min(m.start+m.count,h.start+h.count));y<S;y+=3)r=gg(this,g,e,i,l,u,d,a.getX(y),a.getX(y+1),a.getX(y+2)),r&&(r.faceIndex=Math.floor(y/3),r.face.materialIndex=m.materialIndex,t.push(r))}else for(let m=Math.max(0,h.start),g=Math.min(a.count,h.start+h.count);m<g;m+=3)r=gg(this,s,e,i,l,u,d,a.getX(m),a.getX(m+1),a.getX(m+2)),r&&(r.faceIndex=Math.floor(m/3),t.push(r));else if(void 0!==c)if(Array.isArray(s))for(let p=0,_=f.length;p<_;p++){const m=f[p],g=s[m.materialIndex];for(let y=Math.max(m.start,h.start),S=Math.min(c.count,Math.min(m.start+m.count,h.start+h.count));y<S;y+=3)r=gg(this,g,e,i,l,u,d,y,y+1,y+2),r&&(r.faceIndex=Math.floor(y/3),r.face.materialIndex=m.materialIndex,t.push(r))}else for(let m=Math.max(0,h.start),g=Math.min(c.count,h.start+h.count);m<g;m+=3)r=gg(this,s,e,i,l,u,d,m,m+1,m+2),r&&(r.faceIndex=Math.floor(m/3),t.push(r))}}function gg(n,e,t,i,r,o,s,a,c,l){n.getVertexPosition(a,ug),n.getVertexPosition(c,dg),n.getVertexPosition(l,fg);const u=function Ij(n,e,t,i,r,o,s,a){let c;if(c=1===e.side?i.intersectTriangle(s,o,r,!0,a):i.intersectTriangle(r,o,s,0===e.side,a),null===c)return null;pg.copy(a),pg.applyMatrix4(n.matrixWorld);const l=t.ray.origin.distanceTo(pg);return l<t.near||l>t.far?null:{distance:l,point:pg.clone(),object:n}}(n,e,t,i,ug,dg,fg,GD);if(u){const d=new R;ar.getBarycoord(GD,ug,dg,fg,d),r&&(u.uv=ar.getInterpolatedAttribute(r,a,c,l,d,new re)),o&&(u.uv1=ar.getInterpolatedAttribute(o,a,c,l,d,new re)),s&&(u.normal=ar.getInterpolatedAttribute(s,a,c,l,d,new R),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const f={a,b:c,c:l,normal:new R,materialIndex:0};ar.getNormal(ug,dg,fg,f.normal),u.face=f,u.barycoord=d}return u}class Bs extends pt{constructor(e=1,t=1,i=1,r=1,o=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:o,depthSegments:s};const a=this;r=Math.floor(r),o=Math.floor(o),s=Math.floor(s);const c=[],l=[],u=[],d=[];let f=0,h=0;function p(_,m,g,v,x,y,S,P,T,I,C){const E=y/T,F=S/I,z=y/2,H=S/2,W=P/2,Y=T+1,j=I+1;let X=0,ce=0;const ye=new R;for(let _e=0;_e<j;_e++){const Me=_e*F-H;for(let _t=0;_t<Y;_t++)ye[_]=(_t*E-z)*v,ye[m]=Me*x,ye[g]=W,l.push(ye.x,ye.y,ye.z),ye[_]=0,ye[m]=0,ye[g]=P>0?1:-1,u.push(ye.x,ye.y,ye.z),d.push(_t/T),d.push(1-_e/I),X+=1}for(let _e=0;_e<I;_e++)for(let Me=0;Me<T;Me++){const Je=f+Me+Y*(_e+1),Lt=f+(Me+1)+Y*(_e+1),Ft=f+(Me+1)+Y*_e;c.push(f+Me+Y*_e,Je,Ft),c.push(Je,Lt,Ft),ce+=6}a.addGroup(h,ce,C),h+=ce,f+=X}p("z","y","x",-1,-1,i,t,e,s,o,0),p("z","y","x",1,-1,i,t,-e,s,o,1),p("x","z","y",1,1,e,i,t,r,s,2),p("x","z","y",1,-1,e,i,-t,r,s,3),p("x","y","z",1,-1,e,t,i,r,o,4),p("x","y","z",-1,-1,e,t,-i,r,o,5),this.setIndex(c),this.setAttribute("position",new Ne(l,3)),this.setAttribute("normal",new Ne(u,3)),this.setAttribute("uv",new Ne(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Bs(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function El(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(Se("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():e[t][i]=Array.isArray(r)?r.slice():r}}return e}function Si(n){const e={};for(let t=0;t<n.length;t++){const i=El(n[t]);for(const r in i)e[r]=i[r]}return e}function jD(n){const e=n.getRenderTarget();return null===e?n.outputColorSpace:!0===e.isXRRenderTarget?e.texture.colorSpace:Tt.workingColorSpace}const Nj={clone:El,merge:Si};class qr extends Un{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=El(e.uniforms),this.uniformsGroups=function Rj(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const s=this.uniforms[r].value;t.uniforms[r]=s&&s.isTexture?{type:"t",value:s.toJSON(e).uuid}:s&&s.isColor?{type:"c",value:s.getHex()}:s&&s.isVector2?{type:"v2",value:s.toArray()}:s&&s.isVector3?{type:"v3",value:s.toArray()}:s&&s.isVector4?{type:"v4",value:s.toArray()}:s&&s.isMatrix3?{type:"m3",value:s.toArray()}:s&&s.isMatrix4?{type:"m4",value:s.toArray()}:{value:s}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class Zy extends sn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new it,this.projectionMatrix=new it,this.projectionMatrixInverse=new it,this.coordinateSystem=Mr,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const Vs=new R,WD=new re,$D=new re;class jn extends Zy{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*gl*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Ma*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*gl*Math.atan(Math.tan(.5*Ma*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,i){Vs.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Vs.x,Vs.y).multiplyScalar(-e/Vs.z),Vs.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Vs.x,Vs.y).multiplyScalar(-e/Vs.z)}getViewSize(e,t){return this.getViewBounds(e,WD,$D),t.subVectors($D,WD)}setViewOffset(e,t,i,r,o,s){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Ma*this.fov)/this.zoom,i=2*t,r=this.aspect*i,o=-.5*r;const s=this.view;if(null!==this.view&&this.view.enabled){const c=s.fullWidth,l=s.fullHeight;o+=s.offsetX*r/c,t-=s.offsetY*i/l,r*=s.width/c,i*=s.height/l}const a=this.filmOffset;0!==a&&(o+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+r,t,t-i,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class kj extends sn{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new jn(-90,1,e,t);r.layers=this.layers,this.add(r);const o=new jn(-90,1,e,t);o.layers=this.layers,this.add(o);const s=new jn(-90,1,e,t);s.layers=this.layers,this.add(s);const a=new jn(-90,1,e,t);a.layers=this.layers,this.add(a);const c=new jn(-90,1,e,t);c.layers=this.layers,this.add(c);const l=new jn(-90,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,o,s,a,c]=t;for(const l of t)this.remove(l);if(e===Mr)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),s.up.set(0,0,1),s.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),s.up.set(0,0,-1),s.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1)}for(const l of t)this.add(l),l.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[o,s,a,c,l,u]=this.children,d=e.getRenderTarget(),f=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const _=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,o),e.setRenderTarget(i,1,r),e.render(t,s),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,c),e.setRenderTarget(i,4,r),e.render(t,l),i.texture.generateMipmaps=_,e.setRenderTarget(i,5,r),e.render(t,u),e.setRenderTarget(d,f,h),e.xr.enabled=p,i.texture.needsPMREMUpdate=!0}}class mg extends ui{constructor(e=[],t=301,i,r,o,s,a,c,l,u){super(e,t,i,r,o,s,a,c,l,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class qD extends br{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1};this.texture=new mg([i,i,i,i,i,i]),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new Bs(5,5,5),o=new qr({name:"CubemapFromEquirect",uniforms:El(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});o.uniforms.tEquirect.value=t;const s=new Gt(r,o),a=t.minFilter;return t.minFilter===Hr&&(t.minFilter=on),new kj(1,10,this).update(e,s),t.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(e,t=!0,i=!0,r=!0){const o=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,i,r);e.setRenderTarget(o)}}class as extends sn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Uj={type:"move"};class Ky{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new as,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new as,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new R,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new R),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new as,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new R,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new R),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,o=null,s=null;const a=this._targetRay,c=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){s=!0;for(const _ of e.hand.values()){const m=t.getJointPose(_,i),g=this._getHandJoint(l,_);null!==m&&(g.matrix.fromArray(m.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.matrixWorldNeedsUpdate=!0,g.jointRadius=m.radius),g.visible=null!==m}const f=l.joints["index-finger-tip"].position.distanceTo(l.joints["thumb-tip"].position),h=.02,p=.005;l.inputState.pinching&&f>h+p?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&f<=h-p&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==c&&e.gripSpace&&(o=t.getPose(e.gripSpace,i),null!==o&&(c.matrix.fromArray(o.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,o.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(o.linearVelocity)):c.hasLinearVelocity=!1,o.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(o.angularVelocity)):c.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,i),null===r&&null!==o&&(r=o),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Uj)))}return null!==a&&(a.visible=null!==r),null!==c&&(c.visible=null!==o),null!==l&&(l.visible=null!==s),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new as;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class eM extends sn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ns,this.environmentIntensity=1,this.environmentRotation=new ns,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class _g{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRanges=[],this.version=0,this.uuid=or()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,o=this.stride;r<o;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=or()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=or()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Pi=new R;class Pa{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Pi.fromBufferAttribute(this,t),Pi.applyMatrix4(e),this.setXYZ(t,Pi.x,Pi.y,Pi.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Pi.fromBufferAttribute(this,t),Pi.applyNormalMatrix(e),this.setXYZ(t,Pi.x,Pi.y,Pi.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Pi.fromBufferAttribute(this,t),Pi.transformDirection(e),this.setXYZ(t,Pi.x,Pi.y,Pi.z);return this}getComponent(e,t){let i=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(i=Ci(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=St(i,this.array)),this.data.array[e*this.data.stride+this.offset+t]=i,this}setX(e,t){return this.normalized&&(t=St(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=St(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=St(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=St(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Ci(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Ci(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Ci(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Ci(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=St(t,this.array),i=St(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=St(t,this.array),i=St(i,this.array),r=St(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,o){return e=e*this.data.stride+this.offset,this.normalized&&(t=St(t,this.array),i=St(i,this.array),r=St(r,this.array),o=St(o,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=o,this}clone(e){if(void 0===e){Qp("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[r+o])}return new Wt(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Pa(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){Qp("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[r+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const QD=new R,eI=new pn,tI=new pn,zj=new R,nI=new it,bg=new R,nM=new ri,iI=new it,iM=new Hd;class rI extends Gt{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=dD,this.bindMatrix=new it,this.bindMatrixInverse=new it,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new Yn),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,bg),this.boundingBox.expandByPoint(bg)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new ri),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,bg),this.boundingSphere.expandByPoint(bg)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.matrixWorld;void 0!==this.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),nM.copy(this.boundingSphere),nM.applyMatrix4(r),!1!==e.ray.intersectsSphere(nM)&&(iI.copy(r).invert(),iM.copy(e.ray).applyMatrix4(iI),(null===this.boundingBox||!1!==iM.intersectsBox(this.boundingBox))&&this._computeIntersections(e,t,iM)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new pn,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===dD?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():Se("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;eI.fromBufferAttribute(r.attributes.skinIndex,e),tI.fromBufferAttribute(r.attributes.skinWeight,e),QD.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let o=0;o<4;o++){const s=tI.getComponent(o);if(0!==s){const a=eI.getComponent(o);nI.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(zj.copy(QD).applyMatrix4(nI),s)}}return t.applyMatrix4(this.bindMatrixInverse)}}class rM extends sn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class vo extends ui{constructor(e=null,t=1,i=1,r,o,s,a,c,l=En,u=En,d,f){super(null,s,a,c,l,u,r,o,d,f),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const oI=new it,Hj=new it;class Cg{constructor(e=[],t=[]){this.uuid=or(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.previousBoneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){Se("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new it)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new it;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let o=0,s=e.length;o<s;o++)oI.multiplyMatrices(e[o]?e[o].matrixWorld:Hj,t[o]),oI.toArray(i,16*o);null!==r&&(r.needsUpdate=!0)}clone(){return new Cg(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new vo(t,e,e,zi,Vi);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const o=e.bones[i];let s=t[o];void 0===s&&(Se("Skeleton: No bone found with UUID:",o),s=new rM),this.bones.push(s),this.boneInverses.push((new it).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,o=t.length;r<o;r++)e.bones.push(t[r].uuid),e.boneInverses.push(i[r].toArray());return e}}class Nl extends Wt{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Ll=new it,sI=new it,wg=[],aI=new Yn,Gj=new it,Yd=new Gt,Zd=new ri;class cI extends Gt{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Nl(new Float32Array(16*i),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,Gj)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new Yn),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,Ll),aI.copy(e.boundingBox).applyMatrix4(Ll),this.boundingBox.union(aI)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new ri),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,Ll),Zd.copy(e.boundingSphere).applyMatrix4(Ll),this.boundingSphere.union(Zd)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.morphTexture&&(this.morphTexture=e.morphTexture.clone()),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}getMorphAt(e,t){const i=t.morphTargetInfluences,r=this.morphTexture.source.data.data,s=e*(i.length+1)+1;for(let a=0;a<i.length;a++)i[a]=r[s+a]}raycast(e,t){const i=this.matrixWorld,r=this.count;if(Yd.geometry=this.geometry,Yd.material=this.material,void 0!==Yd.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),Zd.copy(this.boundingSphere),Zd.applyMatrix4(i),!1!==e.ray.intersectsSphere(Zd)))for(let o=0;o<r;o++){this.getMatrixAt(o,Ll),sI.multiplyMatrices(i,Ll),Yd.matrixWorld=sI,Yd.raycast(e,wg);for(let s=0,a=wg.length;s<a;s++){const c=wg[s];c.instanceId=o,c.object=this,t.push(c)}wg.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Nl(new Float32Array(3*this.instanceMatrix.count).fill(1),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}setMorphAt(e,t){const i=t.morphTargetInfluences,r=i.length+1;null===this.morphTexture&&(this.morphTexture=new vo(new Float32Array(r*this.count),r,this.count,Vx,Vi));const o=this.morphTexture.source.data.data;let s=0;for(let l=0;l<i.length;l++)s+=i[l];const c=r*e;o[c]=this.geometry.morphTargetsRelative?1:1-s,o.set(i,c+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),null!==this.morphTexture&&(this.morphTexture.dispose(),this.morphTexture=null)}}const oM=new R,jj=new R,Wj=new Pt;class Ea{constructor(e=new R(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=oM.subVectors(i,t).cross(jj.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(oM),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/r;return o<0||o>1?null:t.copy(e.start).addScaledVector(i,o)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||Wj.getNormalMatrix(e),r=this.coplanarPoint(oM).applyMatrix4(e),o=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Ta=new ri,$j=new re(.5,.5),Sg=new R;class Kd{constructor(e=new Ea,t=new Ea,i=new Ea,r=new Ea,o=new Ea,s=new Ea){this.planes=[e,t,i,r,o,s]}set(e,t,i,r,o,s){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(o),a[5].copy(s),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=Mr,i=!1){const r=this.planes,o=e.elements,s=o[0],a=o[1],c=o[2],l=o[3],u=o[4],d=o[5],f=o[6],h=o[7],p=o[8],_=o[9],m=o[10],g=o[11],v=o[12],x=o[13],y=o[14],S=o[15];if(r[0].setComponents(l-s,h-u,g-p,S-v).normalize(),r[1].setComponents(l+s,h+u,g+p,S+v).normalize(),r[2].setComponents(l+a,h+d,g+_,S+x).normalize(),r[3].setComponents(l-a,h-d,g-_,S-x).normalize(),i)r[4].setComponents(c,f,m,y).normalize(),r[5].setComponents(l-c,h-f,g-m,S-y).normalize();else if(r[4].setComponents(l-c,h-f,g-m,S-y).normalize(),t===Mr)r[5].setComponents(l+c,h+f,g+m,S+y).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);r[5].setComponents(c,f,m,y).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),Ta.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),Ta.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Ta)}intersectsSprite(e){Ta.center.set(0,0,0);const t=$j.distanceTo(e.center);return Ta.radius=.7071067811865476+t,Ta.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ta)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let o=0;o<6;o++)if(t[o].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(Sg.x=r.normal.x>0?e.max.x:e.min.x,Sg.y=r.normal.y>0?e.max.y:e.min.y,Sg.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Sg)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}class Kn extends Un{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new xe(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Tg=new R,Ag=new R,dI=new it,Qd=new Hd,Og=new ri,lM=new R,fI=new R;class zs extends sn{constructor(e=new pt,t=new Kn){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[0];for(let r=1,o=t.count;r<o;r++)Tg.fromBufferAttribute(t,r-1),Ag.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=Tg.distanceTo(Ag);e.setAttribute("lineDistance",new Ne(i,1))}else Se("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,o=e.params.Line.threshold,s=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),Og.copy(i.boundingSphere),Og.applyMatrix4(r),Og.radius+=o,!1===e.ray.intersectsSphere(Og))return;dI.copy(r).invert(),Qd.copy(e.ray).applyMatrix4(dI);const a=o/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,l=this.isLineSegments?2:1,u=i.index,f=i.attributes.position;if(null!==u){const h=Math.max(0,s.start),p=Math.min(u.count,s.start+s.count);for(let _=h,m=p-1;_<m;_+=l){const g=u.getX(_),v=u.getX(_+1),x=Dg(this,e,Qd,c,g,v,_);x&&t.push(x)}if(this.isLineLoop){const _=u.getX(p-1),m=u.getX(h),g=Dg(this,e,Qd,c,_,m,p-1);g&&t.push(g)}}else{const h=Math.max(0,s.start),p=Math.min(f.count,s.start+s.count);for(let _=h,m=p-1;_<m;_+=l){const g=Dg(this,e,Qd,c,_,_+1,_);g&&t.push(g)}if(this.isLineLoop){const _=Dg(this,e,Qd,c,p-1,h,p-1);_&&t.push(_)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){const a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}}function Dg(n,e,t,i,r,o,s){const a=n.geometry.attributes.position;if(Tg.fromBufferAttribute(a,r),Ag.fromBufferAttribute(a,o),t.distanceSqToSegment(Tg,Ag,lM,fI)>i)return;lM.applyMatrix4(n.matrixWorld);const l=e.ray.origin.distanceTo(lM);return l<e.near||l>e.far?void 0:{distance:l,point:fI.clone().applyMatrix4(n.matrixWorld),index:s,face:null,faceIndex:null,barycoord:null,object:n}}const hI=new R,pI=new R;class Sr extends zs{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[];for(let r=0,o=t.count;r<o;r+=2)hI.fromBufferAttribute(t,r),pI.fromBufferAttribute(t,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+hI.distanceTo(pI);e.setAttribute("lineDistance",new Ne(i,1))}else Se("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class gI extends zs{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Da extends Un{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new xe(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const mI=new it,uM=new Hd,Ig=new ri,Rg=new R;class ef extends sn{constructor(e=new pt,t=new Da){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,o=e.params.Points.threshold,s=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),Ig.copy(i.boundingSphere),Ig.applyMatrix4(r),Ig.radius+=o,!1===e.ray.intersectsSphere(Ig))return;mI.copy(r).invert(),uM.copy(e.ray).applyMatrix4(mI);const a=o/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,l=i.index,d=i.attributes.position;if(null!==l)for(let p=Math.max(0,s.start),_=Math.min(l.count,s.start+s.count);p<_;p++){const m=l.getX(p);Rg.fromBufferAttribute(d,m),_I(Rg,m,c,r,e,t,this)}else for(let p=Math.max(0,s.start),_=Math.min(d.count,s.start+s.count);p<_;p++)Rg.fromBufferAttribute(d,p),_I(Rg,p,c,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){const a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}}function _I(n,e,t,i,r,o,s){const a=uM.distanceSqToPoint(n);if(a<t){const c=new R;uM.closestPointToPoint(n,c),c.applyMatrix4(i);const l=r.ray.origin.distanceTo(c);if(l<r.near||l>r.far)return;o.push({distance:l,distanceToRay:Math.sqrt(a),point:c,index:e,face:null,faceIndex:null,barycoord:null,object:s})}}class nW extends ui{constructor(e,t,i,r,o,s,a,c,l){super(e,t,i,r,o,s,a,c,l),this.isCanvasTexture=!0,this.needsUpdate=!0}}class tf extends ui{constructor(e,t,i=Gr,r,o,s,a=En,c=En,l,u=Ko,d=1){if(u!==Ko&&u!==xa)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super({width:e,height:t,depth:d},r,o,s,a,c,u,i,l),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new ba(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class iW extends tf{constructor(e,t=Gr,i=301,r,o,s=En,a=En,c,l=Ko){const u={width:e,height:e,depth:1},d=[u,u,u,u,u,u];super(e,e,t,i,r,o,s,a,c,l),this.image=d,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}}class vI extends ui{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class Hs extends pt{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const o=e/2,s=t/2,a=Math.floor(i),c=Math.floor(r),l=a+1,u=c+1,d=e/a,f=t/c,h=[],p=[],_=[],m=[];for(let g=0;g<u;g++){const v=g*f-s;for(let x=0;x<l;x++)p.push(x*d-o,-v,0),_.push(0,0,1),m.push(x/a),m.push(1-g/c)}for(let g=0;g<c;g++)for(let v=0;v<a;v++){const y=v+l*(g+1),S=v+1+l*(g+1),P=v+1+l*g;h.push(v+l*g,y,P),h.push(y,S,P)}this.setIndex(h),this.setAttribute("position",new Ne(p,3)),this.setAttribute("normal",new Ne(_,3)),this.setAttribute("uv",new Ne(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Hs(e.width,e.height,e.widthSegments,e.heightSegments)}}class NI extends qr{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Co extends Un{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new xe(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new re(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ns,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Xr extends Co{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new re(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return at(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new xe(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new xe(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new xe(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class RM extends Un{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new xe(16777215),this.specular=new xe(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new re(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ns,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class LI extends Un{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class FI extends Un{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function Na(n,e){return n&&n.constructor!==e?"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n):n}function kI(n){const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(function e(r,o){return n[r]-n[o]}),i}function NM(n,e,t){const i=n.length,r=new n.constructor(i);for(let o=0,s=0;s!==i;++o){const a=t[o]*e;for(let c=0;c!==e;++c)r[s++]=n[a+c]}return r}function LM(n,e,t,i){let r=1,o=n[0];for(;void 0!==o&&void 0===o[i];)o=n[r++];if(void 0===o)return;let s=o[i];if(void 0!==s)if(Array.isArray(s))do{s=o[i],void 0!==s&&(e.push(o.time),t.push(...s)),o=n[r++]}while(void 0!==o);else if(void 0!==s.toArray)do{s=o[i],void 0!==s&&(e.push(o.time),s.toArray(t,t.length)),o=n[r++]}while(void 0!==o);else do{s=o[i],void 0!==s&&(e.push(o.time),t.push(s)),o=n[r++]}while(void 0!==o)}class uf{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],o=t[i-1];e:{t:{let s;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<o)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(o=r,r=t[++i],e<r)break t}s=t.length;break n}if(e>=o)break e;{const a=t[1];e<a&&(i=2,o=a);for(let c=i-2;;){if(void 0===o)return this._cachedIndex=0,this.copySampleValue_(0);if(i===c)break;if(r=o,o=t[--i-1],e>=o)break t}s=i,i=0}}for(;i<s;){const a=i+s>>>1;e<t[a]?s=a:i=a+1}if(r=t[i],o=t[i-1],void 0===o)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,o,r)}return this.interpolate_(i,o,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,o=e*r;for(let s=0;s!==r;++s)t[s]=i[o+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class qW extends uf{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const r=this.parameterPositions;let o=e-2,s=e+1,a=r[o],c=r[s];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:o=e,a=2*t-i;break;case 2402:o=r.length-2,a=t+r[o]-r[o+1];break;default:o=e,a=i}if(void 0===c)switch(this.getSettings_().endingEnd){case 2401:s=e,c=2*i-t;break;case 2402:s=1,c=i+r[1]-r[0];break;default:s=e-1,c=t}const l=.5*(i-t),u=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(c-i),this._offsetPrev=o*u,this._offsetNext=s*u}interpolate_(e,t,i,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=this._offsetPrev,d=this._offsetNext,f=this._weightPrev,h=this._weightNext,p=(i-t)/(r-t),_=p*p,m=_*p,g=-f*m+2*f*_-f*p,v=(1+f)*m+(-1.5-2*f)*_+(-.5+f)*p+1,x=(-1-h)*m+(1.5+h)*_+.5*p,y=h*m-h*_;for(let S=0;S!==a;++S)o[S]=g*s[u+S]+v*s[l+S]+x*s[c+S]+y*s[d+S];return o}}class UI extends uf{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=(i-t)/(r-t),d=1-u;for(let f=0;f!==a;++f)o[f]=s[l+f]*d+s[c+f]*u;return o}}class XW extends uf{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Yr{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Na(t,this.TimeBufferType),this.values=Na(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Na(e.times,Array),values:Na(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new XW(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new UI(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new qW(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Nd:t=this.InterpolantFactoryMethodDiscrete;break;case Ld:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return Se("KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Nd;case this.InterpolantFactoryMethodLinear:return Ld;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let o=0,s=r-1;for(;o!==r&&i[o]<e;)++o;for(;-1!==s&&i[s]>t;)--s;if(++s,0!==o||s!==r){o>=s&&(s=Math.max(s,1),o=s-1);const a=this.getValueSize();this.times=i.slice(o,s),this.values=this.values.slice(o*a,s*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(Ze("KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,o=i.length;0===o&&(Ze("KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let a=0;a!==o;a++){const c=i[a];if("number"==typeof c&&isNaN(c)){Ze("KeyframeTrack: Time is not a valid number.",this,a,c),e=!1;break}if(null!==s&&s>c){Ze("KeyframeTrack: Out of order keys.",this,a,c,s),e=!1;break}s=c}if(void 0!==r&&function CD(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}(r))for(let a=0,c=r.length;a!==c;++a){const l=r[a];if(isNaN(l)){Ze("KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=2302===this.getInterpolation(),o=e.length-1;let s=1;for(let a=1;a<o;++a){let c=!1;const l=e[a];if(l!==e[a+1]&&(1!==a||l!==e[0]))if(r)c=!0;else{const d=a*i,f=d-i,h=d+i;for(let p=0;p!==i;++p){const _=t[d+p];if(_!==t[f+p]||_!==t[h+p]){c=!0;break}}}if(c){if(a!==s){e[s]=e[a];const d=a*i,f=s*i;for(let h=0;h!==i;++h)t[f+h]=t[d+h]}++s}}if(o>0){e[s]=e[o];for(let a=o*i,c=s*i,l=0;l!==i;++l)t[c+l]=t[a+l];++s}return s!==e.length?(this.times=e.slice(0,s),this.values=t.slice(0,s*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Yr.prototype.ValueTypeName="",Yr.prototype.TimeBufferType=Float32Array,Yr.prototype.ValueBufferType=Float32Array,Yr.prototype.DefaultInterpolation=Ld;class Ul extends Yr{constructor(e,t,i){super(e,t,i)}}Ul.prototype.ValueTypeName="bool",Ul.prototype.ValueBufferType=Array,Ul.prototype.DefaultInterpolation=Nd,Ul.prototype.InterpolantFactoryMethodLinear=void 0,Ul.prototype.InterpolantFactoryMethodSmooth=void 0;class BI extends Yr{constructor(e,t,i,r){super(e,t,i,r)}}BI.prototype.ValueTypeName="color";class Bl extends Yr{constructor(e,t,i,r){super(e,t,i,r)}}Bl.prototype.ValueTypeName="number";class YW extends uf{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,c=(i-t)/(r-t);let l=e*a;for(let u=l+a;l!==u;l+=4)wi.slerpFlat(o,0,s,l-a,s,l,c);return o}}class Vl extends Yr{constructor(e,t,i,r){super(e,t,i,r)}InterpolantFactoryMethodLinear(e){return new YW(this.times,this.values,this.getValueSize(),e)}}Vl.prototype.ValueTypeName="quaternion",Vl.prototype.InterpolantFactoryMethodSmooth=void 0;class zl extends Yr{constructor(e,t,i){super(e,t,i)}}zl.prototype.ValueTypeName="string",zl.prototype.ValueBufferType=Array,zl.prototype.DefaultInterpolation=Nd,zl.prototype.InterpolantFactoryMethodLinear=void 0,zl.prototype.InterpolantFactoryMethodSmooth=void 0;class Hl extends Yr{constructor(e,t,i,r){super(e,t,i,r)}}Hl.prototype.ValueTypeName="vector";class df{constructor(e="",t=-1,i=[],r=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=or(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let s=0,a=i.length;s!==a;++s)t.push(KW(i[s]).scale(r));const o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o.userData=JSON.parse(e.userData||"{}"),o}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let o=0,s=i.length;o!==s;++o)t.push(Yr.toJSON(i[o]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const o=t.length,s=[];for(let a=0;a<o;a++){let c=[],l=[];c.push((a+o-1)%o,a,(a+1)%o),l.push(0,1,0);const u=kI(c);c=NM(c,1,u),l=NM(l,1,u),!r&&0===c[0]&&(c.push(o),l.push(l[0])),s.push(new Bl(".morphTargetInfluences["+t[a].name+"]",c,l).scale(1/i))}return new this(e,-1,s)}static findByName(e,t){let i=e;Array.isArray(e)||(i=e.geometry&&e.geometry.animations||e.animations);for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},o=/^([\w-]*?)([\d]+)$/;for(let a=0,c=e.length;a<c;a++){const l=e[a],u=l.name.match(o);if(u&&u.length>1){const d=u[1];let f=r[d];f||(r[d]=f=[]),f.push(l)}}const s=[];for(const a in r)s.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return s}static parseAnimation(e,t){if(Se("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return Ze("AnimationClip: No animation in JSONLoader data."),null;const i=function(d,f,h,p,_){if(0!==h.length){const m=[],g=[];LM(h,m,g,p),0!==m.length&&_.push(new d(f,m,g))}},r=[],o=e.name||"default",s=e.fps||30,a=e.blendMode;let c=e.length||-1;const l=e.hierarchy||[];for(let d=0;d<l.length;d++){const f=l[d].keys;if(f&&0!==f.length)if(f[0].morphTargets){const h={};let p;for(p=0;p<f.length;p++)if(f[p].morphTargets)for(let _=0;_<f[p].morphTargets.length;_++)h[f[p].morphTargets[_]]=-1;for(const _ in h){const m=[],g=[];for(let v=0;v!==f[p].morphTargets.length;++v){const x=f[p];m.push(x.time),g.push(x.morphTarget===_?1:0)}r.push(new Bl(".morphTargetInfluence["+_+"]",m,g))}c=h.length*s}else{const h=".bones["+t[d].name+"]";i(Hl,h+".position",f,"pos",r),i(Vl,h+".quaternion",f,"rot",r),i(Hl,h+".scale",f,"scl",r)}}return 0===r.length?null:new this(o,c,r,a)}resetDuration(){let t=0;for(let i=0,r=this.tracks.length;i!==r;++i){const o=this.tracks[i];t=Math.max(t,o.times[o.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let i=0;i<this.tracks.length;i++)e.push(this.tracks[i].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function KW(n){if(void 0===n.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function ZW(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Bl;case"vector":case"vector2":case"vector3":case"vector4":return Hl;case"color":return BI;case"quaternion":return Vl;case"bool":case"boolean":return Ul;case"string":return zl}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}(n.type);if(void 0===n.times){const t=[],i=[];LM(n.keys,t,i,"value"),n.times=t,n.values=i}return void 0!==e.parse?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const cs={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class VI{constructor(e,t,i){const r=this;let c,o=!1,s=0,a=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this._abortController=null,this.itemStart=function(u){a++,!1===o&&void 0!==r.onStart&&r.onStart(u,s,a),o=!0},this.itemEnd=function(u){s++,void 0!==r.onProgress&&r.onProgress(u,s,a),s===a&&(o=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(u){void 0!==r.onError&&r.onError(u)},this.resolveURL=function(u){return c?c(u):u},this.setURLModifier=function(u){return c=u,this},this.addHandler=function(u,d){return l.push(u,d),this},this.removeHandler=function(u){const d=l.indexOf(u);return-1!==d&&l.splice(d,2),this},this.getHandler=function(u){for(let d=0,f=l.length;d<f;d+=2){const h=l[d],p=l[d+1];if(h.global&&(h.lastIndex=0),h.test(u))return p}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const zI=new VI;let Ei=(()=>{class n{constructor(t){this.manager=void 0!==t?t:zI,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,i){const r=this;return new Promise(function(o,s){r.load(t,o,i,s)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}abort(){return this}}return n.DEFAULT_MATERIAL_NAME="__DEFAULT",n})();const ls={};class JW extends Error{constructor(e,t){super(e),this.response=t}}class Pr extends Ei{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const o=cs.get(`file:${e}`);if(void 0!==o)return this.manager.itemStart(e),setTimeout(()=>{t&&t(o),this.manager.itemEnd(e)},0),o;if(void 0!==ls[e])return void ls[e].push({onLoad:t,onProgress:i,onError:r});ls[e]=[],ls[e].push({onLoad:t,onProgress:i,onError:r});const s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:"function"==typeof AbortSignal.any?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),a=this.mimeType,c=this.responseType;fetch(s).then(l=>{if(200===l.status||0===l.status){if(0===l.status&&Se("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===l.body||void 0===l.body.getReader)return l;const u=ls[e],d=l.body.getReader(),f=l.headers.get("X-File-Size")||l.headers.get("Content-Length"),h=f?parseInt(f):0,p=0!==h;let _=0;const m=new ReadableStream({start(g){!function v(){d.read().then(({done:x,value:y})=>{if(x)g.close();else{_+=y.byteLength;const S=new ProgressEvent("progress",{lengthComputable:p,loaded:_,total:h});for(let P=0,T=u.length;P<T;P++){const I=u[P];I.onProgress&&I.onProgress(S)}g.enqueue(y),v()}},x=>{g.error(x)})}()}});return new Response(m)}throw new JW(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(c){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(u=>(new DOMParser).parseFromString(u,a));case"json":return l.json();default:if(""===a)return l.text();{const d=/charset="?([^;"\s]*)"?/i.exec(a),f=d&&d[1]?d[1].toLowerCase():void 0,h=new TextDecoder(f);return l.arrayBuffer().then(p=>h.decode(p))}}}).then(l=>{cs.add(`file:${e}`,l);const u=ls[e];delete ls[e];for(let d=0,f=u.length;d<f;d++){const h=u[d];h.onLoad&&h.onLoad(l)}}).catch(l=>{const u=ls[e];if(void 0===u)throw this.manager.itemError(e),l;delete ls[e];for(let d=0,f=u.length;d<f;d++){const h=u[d];h.onError&&h.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}const Gl=new WeakMap;class Wg extends Ei{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,s=cs.get(`image:${e}`);if(void 0!==s){if(!0===s.complete)o.manager.itemStart(e),setTimeout(function(){t&&t(s),o.manager.itemEnd(e)},0);else{let d=Gl.get(s);void 0===d&&(d=[],Gl.set(s,d)),d.push({onLoad:t,onError:r})}return s}const a=kd("img");function c(){u(),t&&t(this);const d=Gl.get(this)||[];for(let f=0;f<d.length;f++){const h=d[f];h.onLoad&&h.onLoad(this)}Gl.delete(this),o.manager.itemEnd(e)}function l(d){u(),r&&r(d),cs.remove(`image:${e}`);const f=Gl.get(this)||[];for(let h=0;h<f.length;h++){const p=f[h];p.onError&&p.onError(d)}Gl.delete(this),o.manager.itemError(e),o.manager.itemEnd(e)}function u(){a.removeEventListener("load",c,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",c,!1),a.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),cs.add(`image:${e}`,a),o.manager.itemStart(e),a.src=e,a}}class HI extends Ei{constructor(e){super(e)}load(e,t,i,r){const o=new ui,s=new Wg(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,function(a){o.image=a,o.needsUpdate=!0,void 0!==t&&t(o)},i,r),o}}class La extends sn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new xe(e),this.intensity=t}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t}}const FM=new it,GI=new R,jI=new R;class kM{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new re(512,512),this.mapType=rr,this.map=null,this.mapPass=null,this.matrix=new it,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Kd,this._frameExtents=new re(1,1),this._viewportCount=1,this._viewports=[new pn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;GI.setFromMatrixPosition(e.matrixWorld),t.position.copy(GI),jI.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(jI),t.updateMatrixWorld(),FM.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(FM,t.coordinateSystem,t.reversedDepth),t.reversedDepth?i.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(FM)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 1!==this.intensity&&(e.intensity=this.intensity),0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class e$ extends kM{constructor(){super(new jn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,i=2*gl*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,o=e.distance||t.far;(i!==t.fov||r!==t.aspect||o!==t.far)&&(t.fov=i,t.aspect=r,t.far=o,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class WI extends La{constructor(e,t,i=0,r=Math.PI/3,o=0,s=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(sn.DEFAULT_UP),this.updateMatrix(),this.target=new sn,this.distance=i,this.angle=r,this.penumbra=o,this.decay=s,this.map=null,this.shadow=new e$}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.map=e.map,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.angle=this.angle,t.object.decay=this.decay,t.object.penumbra=this.penumbra,t.object.target=this.target.uuid,this.map&&this.map.isTexture&&(t.object.map=this.map.toJSON(e).uuid),t.object.shadow=this.shadow.toJSON(),t}}class t$ extends kM{constructor(){super(new jn(90,1,.5,500)),this.isPointLightShadow=!0}}class $I extends La{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new t$}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.decay=this.decay,t.object.shadow=this.shadow.toJSON(),t}}class ff extends Zy{constructor(e=-1,t=1,i=1,r=-1,o=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=o,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,o,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let o=i-e,s=i+e,a=r+t,c=r-t;if(null!==this.view&&this.view.enabled){const l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=l*this.view.offsetX,s=o+l*this.view.width,a-=u*this.view.offsetY,c=a-u*this.view.height}this.projectionMatrix.makeOrthographic(o,s,a,c,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}class n$ extends kM{constructor(){super(new ff(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class jl extends La{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(sn.DEFAULT_UP),this.updateMatrix(),this.target=new sn,this.shadow=new n$}dispose(){super.dispose(),this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.shadow=this.shadow.toJSON(),t.object.target=this.target.uuid,t}}class UM extends La{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Gs{static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}const VM=new WeakMap;class c$ extends Ei{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&Se("ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&Se("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,s=cs.get(`image-bitmap:${e}`);if(void 0!==s)return o.manager.itemStart(e),s.then?void s.then(l=>{if(!0!==VM.has(s))return t&&t(l),o.manager.itemEnd(e),l;r&&r(VM.get(s)),o.manager.itemError(e),o.manager.itemEnd(e)}):(setTimeout(function(){t&&t(s),o.manager.itemEnd(e)},0),s);const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,a.signal="function"==typeof AbortSignal.any?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const c=fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(o.options,{colorSpaceConversion:"none"}))}).then(function(l){return cs.add(`image-bitmap:${e}`,l),t&&t(l),o.manager.itemEnd(e),l}).catch(function(l){r&&r(l),VM.set(c,l),cs.remove(`image-bitmap:${e}`),o.manager.itemError(e),o.manager.itemEnd(e)});cs.add(`image-bitmap:${e}`,c),o.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class l$ extends jn{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}const HM="\\[\\]\\.:\\/",g$=new RegExp("["+HM+"]","g"),GM="[^"+HM+"]",m$="[^"+HM.replace("\\.","")+"]",M$=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",GM)+/(WCOD+)?/.source.replace("WCOD",m$)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",GM)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",GM)+"$"),b$=["material","materials","bones","map"];class C${constructor(e,t,i){const r=i||gn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,o=i.length;r!==o;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let gn=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(g$,"")}static parseTrackName(t){const i=M$.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},o=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==o&&-1!==o){const s=r.nodeName.substring(o+1);-1!==b$.indexOf(s)&&(r.nodeName=r.nodeName.substring(0,o),r.objectName=s)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(s){for(let a=0;a<s.length;a++){const c=s[a];if(c.name===i||c.uuid===i)return c;const l=r(c.children);if(l)return l}return null},o=r(t.children);if(o)return o}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let o=0,s=r.length;o!==s;++o)t[i++]=r[o]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let o=0,s=r.length;o!==s;++o)r[o]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let o=0,s=r.length;o!==s;++o)r[o]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let o=0,s=r.length;o!==s;++o)r[o]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,o=i.propertyName;let s=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void Se("PropertyBinding: No target node found for track: "+this.path+".");if(r){let u=i.objectIndex;switch(r){case"materials":if(!t.material)return void Ze("PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void Ze("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void Ze("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let d=0;d<t.length;d++)if(t[d].name===u){u=d;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void Ze("PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void Ze("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void Ze("PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==u){if(void 0===t[u])return void Ze("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[u]}}const a=t[o];if(void 0===a)return void Ze("PropertyBinding: Trying to update property for track: "+i.nodeName+"."+o+" but it wasn't found.",t);let c=this.Versioning.None;this.targetObject=t,!0===t.isMaterial?c=this.Versioning.NeedsUpdate:!0===t.isObject3D&&(c=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(void 0!==s){if("morphTargetInfluences"===o){if(!t.geometry)return void Ze("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void Ze("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[s]&&(s=t.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else void 0!==a.fromArray&&void 0!==a.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(l=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=o;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=C$,n})();function XM(n,e,t,i){const r=function N$(n){switch(n){case rr:case fD:return{byteLength:1,components:1};case Id:case hD:case Zo:return{byteLength:2,components:1};case Ux:case Bx:return{byteLength:2,components:4};case Gr:case kx:case Vi:return{byteLength:4,components:1};case pD:case gD:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}(i);switch(t){case mD:return n*e;case Vx:case Wp:return n*e/r.components*r.byteLength;case ul:case zx:return n*e*2/r.components*r.byteLength;case _D:return n*e*3/r.components*r.byteLength;case zi:case Hx:return n*e*4/r.components*r.byteLength;case $p:case qp:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case Xp:case Yp:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case jx:case $x:return Math.max(n,16)*Math.max(e,8)/4;case Gx:case Wx:return Math.max(n,8)*Math.max(e,8)/2;case qx:case Xx:case Zx:case Kx:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case Yx:case Jx:case Qx:case ey:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case ty:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case ny:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case iy:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case ry:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case oy:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case sy:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case ay:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case cy:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case ly:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case uy:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case dy:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case fy:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case hy:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case py:case gy:case my:return Math.ceil(n/4)*Math.ceil(e/4)*16;case _y:case vy:return Math.ceil(n/4)*Math.ceil(e/4)*8;case xy:case yy:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function h2(){let n=null,e=!1,t=null,i=null;function r(o,s){t(o,s),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(o){t=o},setContext:function(o){n=o}}}function L$(n){const e=new WeakMap;return{get:function r(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)},remove:function o(a){a.isInterleavedBufferAttribute&&(a=a.data);const c=e.get(a);c&&(n.deleteBuffer(c.buffer),e.delete(a))},update:function s(a,c){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){const u=e.get(a);return void((!u||u.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version}))}const l=e.get(a);if(void 0===l)e.set(a,function t(a,c){const l=a.array,u=a.usage,d=l.byteLength,f=n.createBuffer();let h;if(n.bindBuffer(c,f),n.bufferData(c,l,u),a.onUploadCallback(),l instanceof Float32Array)h=n.FLOAT;else if(typeof Float16Array<"u"&&l instanceof Float16Array)h=n.HALF_FLOAT;else if(l instanceof Uint16Array)h=a.isFloat16BufferAttribute?n.HALF_FLOAT:n.UNSIGNED_SHORT;else if(l instanceof Int16Array)h=n.SHORT;else if(l instanceof Uint32Array)h=n.UNSIGNED_INT;else if(l instanceof Int32Array)h=n.INT;else if(l instanceof Int8Array)h=n.BYTE;else if(l instanceof Uint8Array)h=n.UNSIGNED_BYTE;else{if(!(l instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+l);h=n.UNSIGNED_BYTE}return{buffer:f,type:h,bytesPerElement:l.BYTES_PER_ELEMENT,version:a.version,size:d}}(a,c));else if(l.version<a.version){if(l.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");(function i(a,c,l){const u=c.array,d=c.updateRanges;if(n.bindBuffer(l,a),0===d.length)n.bufferSubData(l,0,u);else{d.sort((h,p)=>h.start-p.start);let f=0;for(let h=1;h<d.length;h++){const p=d[f],_=d[h];_.start<=p.start+p.count+1?p.count=Math.max(p.count,_.start+_.count-p.start):(++f,d[f]=_)}d.length=f+1;for(let h=0,p=d.length;h<p;h++){const _=d[h];n.bufferSubData(l,_.start*u.BYTES_PER_ELEMENT,u,_.start,_.count)}c.clearUpdateRanges()}c.onUploadCallback()})(l.buffer,a,c),l.version=a.version}}}}gn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},gn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},gn.prototype.GetterByBindingType=[gn.prototype._getValue_direct,gn.prototype._getValue_array,gn.prototype._getValue_arrayElement,gn.prototype._getValue_toArray],gn.prototype.SetterByBindingTypeAndVersioning=[[gn.prototype._setValue_direct,gn.prototype._setValue_direct_setNeedsUpdate,gn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[gn.prototype._setValue_array,gn.prototype._setValue_array_setNeedsUpdate,gn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[gn.prototype._setValue_arrayElement,gn.prototype._setValue_arrayElement_setNeedsUpdate,gn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[gn.prototype._setValue_fromArray,gn.prototype._setValue_fromArray_setNeedsUpdate,gn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1),typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"182"}})),typeof window<"u"&&(window.__THREE__?Se("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="182");const Et={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.metalness = metalnessFactor;\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;\n\tmaterial.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = vec3( 0.04 );\n\tmaterial.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"uniform sampler2D dfgLUT;\nstruct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tvec3 diffuseContribution;\n\tvec3 specularColor;\n\tvec3 specularColorBlended;\n\tfloat roughness;\n\tfloat metalness;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t\tvec3 iridescenceFresnelDielectric;\n\t\tvec3 iridescenceFresnelMetallic;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn v;\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColorBlended;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transpose( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat rInv = 1.0 / ( roughness + 0.1 );\n\tfloat a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;\n\tfloat b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;\n\tfloat DG = exp( a * dotNV + b );\n\treturn saturate( DG );\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nvec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;\n\tvec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;\n\tvec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;\n\tvec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;\n\tfloat Ess_V = dfgV.x + dfgV.y;\n\tfloat Ess_L = dfgL.x + dfgL.y;\n\tfloat Ems_V = 1.0 - Ess_V;\n\tfloat Ems_L = 1.0 - Ess_L;\n\tvec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;\n\tvec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );\n\tfloat compensationFactor = Ems_V * Ems_L;\n\tvec3 multiScatter = Fms * compensationFactor;\n\treturn singleScatter + multiScatter;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n \n \t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n \n \t\tfloat sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n \t\tfloat sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );\n \n \t\tfloat sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );\n \n \t\tirradiance *= sheenEnergyComp;\n \n \t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );\n\t#ifdef USE_SHEEN\n\t\tfloat sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t\tfloat sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;\n\t\tdiffuse *= sheenEnergyComp;\n\t#endif\n\treflectedLight.indirectDiffuse += diffuse;\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;\n \t#endif\n\tvec3 singleScatteringDielectric = vec3( 0.0 );\n\tvec3 multiScatteringDielectric = vec3( 0.0 );\n\tvec3 singleScatteringMetallic = vec3( 0.0 );\n\tvec3 multiScatteringMetallic = vec3( 0.0 );\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );\n\t#endif\n\tvec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );\n\tvec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );\n\tvec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;\n\tvec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tvec3 indirectSpecular = radiance * singleScattering;\n\tindirectSpecular += multiScattering * cosineWeightedIrradiance;\n\tvec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t\tfloat sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;\n\t\tindirectSpecular *= sheenEnergyComp;\n\t\tindirectDiffuse *= sheenEnergyComp;\n\t#endif\n\treflectedLight.indirectSpecular += indirectSpecular;\n\treflectedLight.indirectDiffuse += indirectDiffuse;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );\n\t\tmaterial.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tuniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\t#else\n\t\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\t#endif\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tuniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\t#else\n\t\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\t#endif\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tuniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\t#elif defined( SHADOWMAP_TYPE_BASIC )\n\t\t\tuniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\t#endif\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\tfloat interleavedGradientNoise( vec2 position ) {\n\t\t\treturn fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );\n\t\t}\n\t\tvec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {\n\t\t\tconst float goldenAngle = 2.399963229728653;\n\t\t\tfloat r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );\n\t\t\tfloat theta = float( sampleIndex ) * goldenAngle + phi;\n\t\t\treturn vec2( cos( theta ), sin( theta ) ) * r;\n\t\t}\n\t#endif\n\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\tfloat getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\t\tfloat shadow = 1.0;\n\t\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\t\tshadowCoord.z += shadowBias;\n\t\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\t\tif ( frustumTest ) {\n\t\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\t\tfloat radius = shadowRadius * texelSize.x;\n\t\t\t\tfloat phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )\n\t\t\t\t) * 0.2;\n\t\t\t}\n\t\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t\t}\n\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\t\tfloat shadow = 1.0;\n\t\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\t\tshadowCoord.z += shadowBias;\n\t\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\t\tif ( frustumTest ) {\n\t\t\t\tvec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;\n\t\t\t\tfloat mean = distribution.x;\n\t\t\t\tfloat variance = distribution.y * distribution.y;\n\t\t\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\t\t\tfloat hard_shadow = step( mean, shadowCoord.z );\n\t\t\t\t#else\n\t\t\t\t\tfloat hard_shadow = step( shadowCoord.z, mean );\n\t\t\t\t#endif\n\t\t\t\tif ( hard_shadow == 1.0 ) {\n\t\t\t\t\tshadow = 1.0;\n\t\t\t\t} else {\n\t\t\t\t\tvariance = max( variance, 0.0000001 );\n\t\t\t\t\tfloat d = shadowCoord.z - mean;\n\t\t\t\t\tfloat p_max = variance / ( variance + d * d );\n\t\t\t\t\tp_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );\n\t\t\t\t\tshadow = max( hard_shadow, p_max );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t\t}\n\t#else\n\t\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\t\tfloat shadow = 1.0;\n\t\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\t\tshadowCoord.z += shadowBias;\n\t\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\t\tif ( frustumTest ) {\n\t\t\t\tfloat depth = texture2D( shadowMap, shadowCoord.xy ).r;\n\t\t\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\t\t\tshadow = step( depth, shadowCoord.z );\n\t\t\t\t#else\n\t\t\t\t\tshadow = step( shadowCoord.z, depth );\n\t\t\t\t#endif\n\t\t\t}\n\t\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t\t}\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#if defined( SHADOWMAP_TYPE_PCF )\n\tfloat getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tvec3 absVec = abs( lightToPosition );\n\t\tfloat viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );\n\t\tif ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );\n\t\t\tdp += shadowBias;\n\t\t\tfloat texelSize = shadowRadius / shadowMapSize.x;\n\t\t\tvec3 absDir = abs( bd3D );\n\t\t\tvec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );\n\t\t\ttangent = normalize( cross( bd3D, tangent ) );\n\t\t\tvec3 bitangent = cross( bd3D, tangent );\n\t\t\tfloat phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;\n\t\t\tshadow = (\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )\n\t\t\t) * 0.2;\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\t#elif defined( SHADOWMAP_TYPE_BASIC )\n\tfloat getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tvec3 absVec = abs( lightToPosition );\n\t\tfloat viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );\n\t\tif ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );\n\t\t\tdp += shadowBias;\n\t\t\tfloat depth = textureCube( shadowMap, bd3D ).r;\n\t\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\t\tshadow = step( depth, dp );\n\t\t\t#else\n\t\t\t\tshadow = step( dp, depth );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\t#endif\n\t#endif\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t#else\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\tfloat fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];\n\t#else\n\t\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;\n\t#endif\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distance_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distance_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n \n\t\toutgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;\n \n \t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},Te={common:{diffuse:{value:new xe(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Pt},alphaMap:{value:null},alphaMapTransform:{value:new Pt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Pt}},envmap:{envMap:{value:null},envMapRotation:{value:new Pt},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Pt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Pt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Pt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Pt},normalScale:{value:new re(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Pt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Pt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Pt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Pt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new xe(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new xe(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Pt},alphaTest:{value:0},uvTransform:{value:new Pt}},sprite:{diffuse:{value:new xe(16777215)},opacity:{value:1},center:{value:new re(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Pt},alphaMap:{value:null},alphaMapTransform:{value:new Pt},alphaTest:{value:0}}},wo={basic:{uniforms:Si([Te.common,Te.specularmap,Te.envmap,Te.aomap,Te.lightmap,Te.fog]),vertexShader:Et.meshbasic_vert,fragmentShader:Et.meshbasic_frag},lambert:{uniforms:Si([Te.common,Te.specularmap,Te.envmap,Te.aomap,Te.lightmap,Te.emissivemap,Te.bumpmap,Te.normalmap,Te.displacementmap,Te.fog,Te.lights,{emissive:{value:new xe(0)}}]),vertexShader:Et.meshlambert_vert,fragmentShader:Et.meshlambert_frag},phong:{uniforms:Si([Te.common,Te.specularmap,Te.envmap,Te.aomap,Te.lightmap,Te.emissivemap,Te.bumpmap,Te.normalmap,Te.displacementmap,Te.fog,Te.lights,{emissive:{value:new xe(0)},specular:{value:new xe(1118481)},shininess:{value:30}}]),vertexShader:Et.meshphong_vert,fragmentShader:Et.meshphong_frag},standard:{uniforms:Si([Te.common,Te.envmap,Te.aomap,Te.lightmap,Te.emissivemap,Te.bumpmap,Te.normalmap,Te.displacementmap,Te.roughnessmap,Te.metalnessmap,Te.fog,Te.lights,{emissive:{value:new xe(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Et.meshphysical_vert,fragmentShader:Et.meshphysical_frag},toon:{uniforms:Si([Te.common,Te.aomap,Te.lightmap,Te.emissivemap,Te.bumpmap,Te.normalmap,Te.displacementmap,Te.gradientmap,Te.fog,Te.lights,{emissive:{value:new xe(0)}}]),vertexShader:Et.meshtoon_vert,fragmentShader:Et.meshtoon_frag},matcap:{uniforms:Si([Te.common,Te.bumpmap,Te.normalmap,Te.displacementmap,Te.fog,{matcap:{value:null}}]),vertexShader:Et.meshmatcap_vert,fragmentShader:Et.meshmatcap_frag},points:{uniforms:Si([Te.points,Te.fog]),vertexShader:Et.points_vert,fragmentShader:Et.points_frag},dashed:{uniforms:Si([Te.common,Te.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Et.linedashed_vert,fragmentShader:Et.linedashed_frag},depth:{uniforms:Si([Te.common,Te.displacementmap]),vertexShader:Et.depth_vert,fragmentShader:Et.depth_frag},normal:{uniforms:Si([Te.common,Te.bumpmap,Te.normalmap,Te.displacementmap,{opacity:{value:1}}]),vertexShader:Et.meshnormal_vert,fragmentShader:Et.meshnormal_frag},sprite:{uniforms:Si([Te.sprite,Te.fog]),vertexShader:Et.sprite_vert,fragmentShader:Et.sprite_frag},background:{uniforms:{uvTransform:{value:new Pt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Et.background_vert,fragmentShader:Et.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Pt}},vertexShader:Et.backgroundCube_vert,fragmentShader:Et.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Et.cube_vert,fragmentShader:Et.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Et.equirect_vert,fragmentShader:Et.equirect_frag},distance:{uniforms:Si([Te.common,Te.displacementmap,{referencePosition:{value:new R},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Et.distance_vert,fragmentShader:Et.distance_frag},shadow:{uniforms:Si([Te.lights,Te.fog,{color:{value:new xe(0)},opacity:{value:1}}]),vertexShader:Et.shadow_vert,fragmentShader:Et.shadow_frag}};wo.physical={uniforms:Si([wo.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Pt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Pt},clearcoatNormalScale:{value:new re(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Pt},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Pt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Pt},sheen:{value:0},sheenColor:{value:new xe(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Pt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Pt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Pt},transmissionSamplerSize:{value:new re},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Pt},attenuationDistance:{value:0},attenuationColor:{value:new xe(0)},specularColor:{value:new xe(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Pt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Pt},anisotropyVector:{value:new re},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Pt}}]),vertexShader:Et.meshphysical_vert,fragmentShader:Et.meshphysical_frag};const Qg={r:0,b:0,g:0},Ha=new ns,LX=new it;function FX(n,e,t,i,r,o,s){const a=new xe(0);let l,u,c=!0===o?0:1,d=null,f=0,h=null;function p(x){let y=!0===x.isScene?x.background:null;return y&&y.isTexture&&(y=(x.backgroundBlurriness>0?t:e).get(y)),y}function g(x,y){x.getRGB(Qg,jD(n)),i.buffers.color.setClear(Qg.r,Qg.g,Qg.b,y,s)}return{getClearColor:function(){return a},setClearColor:function(x,y=1){a.set(x),c=y,g(a,c)},getClearAlpha:function(){return c},setClearAlpha:function(x){c=x,g(a,c)},render:function _(x){let y=!1;const S=p(x);null===S?g(a,c):S&&S.isColor&&(g(S,1),y=!0);const P=n.xr.getEnvironmentBlendMode();"additive"===P?i.buffers.color.setClear(0,0,0,1,s):"alpha-blend"===P&&i.buffers.color.setClear(0,0,0,0,s),(n.autoClear||y)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))},addToRenderList:function m(x,y){const S=p(y);S&&(S.isCubeTexture||306===S.mapping)?(void 0===u&&(u=new Gt(new Bs(1,1,1),new qr({name:"BackgroundCubeMaterial",uniforms:El(wo.backgroundCube.uniforms),vertexShader:wo.backgroundCube.vertexShader,fragmentShader:wo.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(P,T,I){this.matrixWorld.copyPosition(I.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),Ha.copy(y.backgroundRotation),Ha.x*=-1,Ha.y*=-1,Ha.z*=-1,S.isCubeTexture&&!1===S.isRenderTargetTexture&&(Ha.y*=-1,Ha.z*=-1),u.material.uniforms.envMap.value=S,u.material.uniforms.flipEnvMap.value=S.isCubeTexture&&!1===S.isRenderTargetTexture?-1:1,u.material.uniforms.backgroundBlurriness.value=y.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,u.material.uniforms.backgroundRotation.value.setFromMatrix4(LX.makeRotationFromEuler(Ha)),u.material.toneMapped=Tt.getTransfer(S.colorSpace)!==Kt,(d!==S||f!==S.version||h!==n.toneMapping)&&(u.material.needsUpdate=!0,d=S,f=S.version,h=n.toneMapping),u.layers.enableAll(),x.unshift(u,u.geometry,u.material,0,0,null)):S&&S.isTexture&&(void 0===l&&(l=new Gt(new Hs(2,2),new qr({name:"BackgroundMaterial",uniforms:El(wo.background.uniforms),vertexShader:wo.background.vertexShader,fragmentShader:wo.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=S,l.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,l.material.toneMapped=Tt.getTransfer(S.colorSpace)!==Kt,!0===S.matrixAutoUpdate&&S.updateMatrix(),l.material.uniforms.uvTransform.value.copy(S.matrix),(d!==S||f!==S.version||h!==n.toneMapping)&&(l.material.needsUpdate=!0,d=S,f=S.version,h=n.toneMapping),l.layers.enableAll(),x.unshift(l,l.geometry,l.material,0,0,null))},dispose:function v(){void 0!==u&&(u.geometry.dispose(),u.material.dispose(),u=void 0),void 0!==l&&(l.geometry.dispose(),l.material.dispose(),l=void 0)}}}function kX(n,e){const t=n.getParameter(n.MAX_VERTEX_ATTRIBS),i={},r=f(null);let o=r,s=!1;function l(E){return n.bindVertexArray(E)}function u(E){return n.deleteVertexArray(E)}function f(E){const F=[],z=[],H=[];for(let W=0;W<t;W++)F[W]=0,z[W]=0,H[W]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:F,enabledAttributes:z,attributeDivisors:H,object:E,attributes:{},index:null}}function _(){const E=o.newAttributes;for(let F=0,z=E.length;F<z;F++)E[F]=0}function m(E){g(E,0)}function g(E,F){const H=o.enabledAttributes,W=o.attributeDivisors;o.newAttributes[E]=1,0===H[E]&&(n.enableVertexAttribArray(E),H[E]=1),W[E]!==F&&(n.vertexAttribDivisor(E,F),W[E]=F)}function v(){const E=o.newAttributes,F=o.enabledAttributes;for(let z=0,H=F.length;z<H;z++)F[z]!==E[z]&&(n.disableVertexAttribArray(z),F[z]=0)}function x(E,F,z,H,W,Y,j){!0===j?n.vertexAttribIPointer(E,F,z,W,Y):n.vertexAttribPointer(E,F,z,H,W,Y)}function I(){C(),s=!0,o!==r&&(o=r,l(o.object))}function C(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:function a(E,F,z,H,W){let Y=!1;const j=function d(E,F,z){const H=!0===z.wireframe;let W=i[E.id];void 0===W&&(W={},i[E.id]=W);let Y=W[F.id];void 0===Y&&(Y={},W[F.id]=Y);let j=Y[H];return void 0===j&&(j=f(function c(){return n.createVertexArray()}()),Y[H]=j),j}(H,z,F);o!==j&&(o=j,l(o.object)),Y=function h(E,F,z,H){const W=o.attributes,Y=F.attributes;let j=0;const X=z.getAttributes();for(const ce in X)if(X[ce].location>=0){const _e=W[ce];let Me=Y[ce];if(void 0===Me&&("instanceMatrix"===ce&&E.instanceMatrix&&(Me=E.instanceMatrix),"instanceColor"===ce&&E.instanceColor&&(Me=E.instanceColor)),void 0===_e||_e.attribute!==Me||Me&&_e.data!==Me.data)return!0;j++}return o.attributesNum!==j||o.index!==H}(E,H,z,W),Y&&function p(E,F,z,H){const W={},Y=F.attributes;let j=0;const X=z.getAttributes();for(const ce in X)if(X[ce].location>=0){let _e=Y[ce];void 0===_e&&("instanceMatrix"===ce&&E.instanceMatrix&&(_e=E.instanceMatrix),"instanceColor"===ce&&E.instanceColor&&(_e=E.instanceColor));const Me={};Me.attribute=_e,_e&&_e.data&&(Me.data=_e.data),W[ce]=Me,j++}o.attributes=W,o.attributesNum=j,o.index=H}(E,H,z,W),null!==W&&e.update(W,n.ELEMENT_ARRAY_BUFFER),(Y||s)&&(s=!1,function y(E,F,z,H){_();const W=H.attributes,Y=z.getAttributes(),j=F.defaultAttributeValues;for(const X in Y){const ce=Y[X];if(ce.location>=0){let ye=W[X];if(void 0===ye&&("instanceMatrix"===X&&E.instanceMatrix&&(ye=E.instanceMatrix),"instanceColor"===X&&E.instanceColor&&(ye=E.instanceColor)),void 0!==ye){const _e=ye.normalized,Me=ye.itemSize,_t=e.get(ye);if(void 0===_t)continue;const Je=_t.buffer,Lt=_t.type,Ft=_t.bytesPerElement,ee=Lt===n.INT||Lt===n.UNSIGNED_INT||ye.gpuType===kx;if(ye.isInterleavedBufferAttribute){const le=ye.data,Ue=le.stride,Ke=ye.offset;if(le.isInstancedInterleavedBuffer){for(let Ie=0;Ie<ce.locationSize;Ie++)g(ce.location+Ie,le.meshPerAttribute);!0!==E.isInstancedMesh&&void 0===H._maxInstanceCount&&(H._maxInstanceCount=le.meshPerAttribute*le.count)}else for(let Ie=0;Ie<ce.locationSize;Ie++)m(ce.location+Ie);n.bindBuffer(n.ARRAY_BUFFER,Je);for(let Ie=0;Ie<ce.locationSize;Ie++)x(ce.location+Ie,Me/ce.locationSize,Lt,_e,Ue*Ft,(Ke+Me/ce.locationSize*Ie)*Ft,ee)}else{if(ye.isInstancedBufferAttribute){for(let le=0;le<ce.locationSize;le++)g(ce.location+le,ye.meshPerAttribute);!0!==E.isInstancedMesh&&void 0===H._maxInstanceCount&&(H._maxInstanceCount=ye.meshPerAttribute*ye.count)}else for(let le=0;le<ce.locationSize;le++)m(ce.location+le);n.bindBuffer(n.ARRAY_BUFFER,Je);for(let le=0;le<ce.locationSize;le++)x(ce.location+le,Me/ce.locationSize,Lt,_e,Me*Ft,Me/ce.locationSize*le*Ft,ee)}}else if(void 0!==j){const _e=j[X];if(void 0!==_e)switch(_e.length){case 2:n.vertexAttrib2fv(ce.location,_e);break;case 3:n.vertexAttrib3fv(ce.location,_e);break;case 4:n.vertexAttrib4fv(ce.location,_e);break;default:n.vertexAttrib1fv(ce.location,_e)}}}}v()}(E,F,z,H),null!==W&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(W).buffer))},reset:I,resetDefaultState:C,dispose:function S(){I();for(const E in i){const F=i[E];for(const z in F){const H=F[z];for(const W in H)u(H[W].object),delete H[W];delete F[z]}delete i[E]}},releaseStatesOfGeometry:function P(E){if(void 0===i[E.id])return;const F=i[E.id];for(const z in F){const H=F[z];for(const W in H)u(H[W].object),delete H[W];delete F[z]}delete i[E.id]},releaseStatesOfProgram:function T(E){for(const F in i){const z=i[F];if(void 0===z[E.id])continue;const H=z[E.id];for(const W in H)u(H[W].object),delete H[W];delete z[E.id]}},initAttributes:_,enableAttribute:m,disableUnusedAttributes:v}}function UX(n,e,t){let i;function s(l,u,d){0!==d&&(n.drawArraysInstanced(i,l,u,d),t.update(u,i,d))}this.setMode=function r(l){i=l},this.render=function o(l,u){n.drawArrays(i,l,u),t.update(u,i,1)},this.renderInstances=s,this.renderMultiDraw=function a(l,u,d){if(0===d)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,l,0,u,0,d);let h=0;for(let p=0;p<d;p++)h+=u[p];t.update(h,i,1)},this.renderMultiDrawInstances=function c(l,u,d,f){if(0===d)return;const h=e.get("WEBGL_multi_draw");if(null===h)for(let p=0;p<l.length;p++)s(l[p],u[p],f[p]);else{h.multiDrawArraysInstancedWEBGL(i,l,0,u,0,f,0,d);let p=0;for(let _=0;_<d;_++)p+=u[_]*f[_];t.update(p,i,1)}}}function BX(n,e,t,i){let r;function c(T){if("highp"===T){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";T="mediump"}return"mediump"===T&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let l=void 0!==t.precision?t.precision:"highp";const u=c(l);return u!==l&&(Se("WebGLRenderer:",l,"not supported, using",u,"instead."),l=u),{isWebGL2:!0,getMaxAnisotropy:function o(){if(void 0!==r)return r;if(!0===e.has("EXT_texture_filter_anisotropic")){const T=e.get("EXT_texture_filter_anisotropic");r=n.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:c,textureFormatReadable:function s(T){return!(T!==zi&&i.convert(T)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))},textureTypeReadable:function a(T){const I=T===Zo&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(T!==rr&&i.convert(T)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&T!==Vi&&!I)},precision:l,logarithmicDepthBuffer:!0===t.logarithmicDepthBuffer,reversedDepthBuffer:!0===t.reversedDepthBuffer&&e.has("EXT_clip_control"),maxTextures:n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),maxVertexTextures:n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxTextureSize:n.getParameter(n.MAX_TEXTURE_SIZE),maxCubemapSize:n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:n.getParameter(n.MAX_VERTEX_ATTRIBS),maxVertexUniforms:n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:n.getParameter(n.MAX_VARYING_VECTORS),maxFragmentUniforms:n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),maxSamples:n.getParameter(n.MAX_SAMPLES),samples:n.getParameter(n.SAMPLES)}}function VX(n){const e=this;let t=null,i=0,r=!1,o=!1;const s=new Ea,a=new Pt,c={value:null,needsUpdate:!1};function u(d,f,h,p){const _=null!==d?d.length:0;let m=null;if(0!==_){if(m=c.value,!0!==p||null===m){const g=h+4*_,v=f.matrixWorldInverse;a.getNormalMatrix(v),(null===m||m.length<g)&&(m=new Float32Array(g));for(let x=0,y=h;x!==_;++x,y+=4)s.copy(d[x]).applyMatrix4(v,a),s.normal.toArray(m,y),m[y+3]=s.constant}c.value=m,c.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,m}this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(d,f){const h=0!==d.length||f||0!==i||r;return r=f,i=d.length,h},this.beginShadows=function(){o=!0,u(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(d,f){t=u(d,f,0)},this.setState=function(d,f,h){const p=d.clippingPlanes,_=d.clipIntersection,m=d.clipShadows,g=n.get(d);if(!r||null===p||0===p.length||o&&!m)o?u(null):function l(){c.value!==t&&(c.value=t,c.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const v=o?0:i,x=4*v;let y=g.clippingState||null;c.value=y,y=u(p,f,x,h);for(let S=0;S!==x;++S)y[S]=t[S];g.clippingState=y,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=v}}}function zX(n){let e=new WeakMap;function t(s,a){return 303===a?s.mapping=301:304===a&&(s.mapping=302),s}function r(s){const a=s.target;a.removeEventListener("dispose",r);const c=e.get(a);void 0!==c&&(e.delete(a),c.dispose())}return{get:function i(s){if(s&&s.isTexture){const a=s.mapping;if(303===a||304===a){if(e.has(s))return t(e.get(s).texture,s.mapping);{const c=s.image;if(c&&c.height>0){const l=new qD(c.height);return l.fromEquirectangularTexture(n,s),e.set(s,l),s.addEventListener("dispose",r),t(l.texture,s.mapping)}return null}}}return s},dispose:function o(){e=new WeakMap}}}const p2=[.125,.215,.35,.446,.526,.582],hf=new ff,g2=new xe;let YM=null,ZM=0,KM=0,JM=!1;const GX=new R;class m2{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,i=.1,r=100,o={}){const{size:s=256,position:a=GX}=o;YM=this._renderer.getRenderTarget(),ZM=this._renderer.getActiveCubeFace(),KM=this._renderer.getActiveMipmapLevel(),JM=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(s);const c=this._allocateTargets();return c.depthBuffer=!0,this._sceneToCubeUV(e,i,r,c,a),t>0&&this._blur(c,0,0,t),this._applyPMREM(c),this._cleanup(c),c}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=x2(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=v2(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose(),null!==this._backgroundBox&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._ggxMaterial&&this._ggxMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(YM,ZM,KM),this._renderer.xr.enabled=JM,e.scissorTest=!1,ql(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(301===e.mapping||302===e.mapping?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),YM=this._renderer.getRenderTarget(),ZM=this._renderer.getActiveCubeFace(),KM=this._renderer.getActiveMipmapLevel(),JM=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:on,minFilter:on,generateMipmaps:!1,type:Zo,format:zi,colorSpace:bi,depthBuffer:!1},r=_2(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=_2(e,t,i);const{_lodMax:o}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=function jX(n){const e=[],t=[],i=[];let r=n;const o=n-4+1+p2.length;for(let s=0;s<o;s++){const a=Math.pow(2,r);e.push(a);let c=1/a;s>n-4?c=p2[s-n+4-1]:0===s&&(c=0),t.push(c);const l=1/(a-2),u=-l,d=1+l,f=[u,u,d,u,d,d,u,u,d,d,u,d],h=6,p=6,_=3,m=2,g=1,v=new Float32Array(_*p*h),x=new Float32Array(m*p*h),y=new Float32Array(g*p*h);for(let P=0;P<h;P++){const T=P%3*2/3-1,I=P>2?0:-1;v.set([T,I,0,T+2/3,I,0,T+2/3,I+1,0,T,I,0,T+2/3,I+1,0,T,I+1,0],_*p*P),x.set(f,m*p*P),y.set([P,P,P,P,P,P],g*p*P)}const S=new pt;S.setAttribute("position",new Wt(v,_)),S.setAttribute("uv",new Wt(x,m)),S.setAttribute("faceIndex",new Wt(y,g)),i.push(new Gt(S,null)),r>4&&r--}return{lodMeshes:i,sizeLods:e,sigmas:t}}(o)),this._blurMaterial=function $X(n,e,t){const i=new Float32Array(20),r=new R(0,1,0);return new qr({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(o,e,t),this._ggxMaterial=function WX(n,e,t){return new qr({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:256,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:'\n\n\t\t\tprecision highp float;\n\t\t\tprecision highp int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform float roughness;\n\t\t\tuniform float mipInt;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\t#define PI 3.14159265359\n\n\t\t\t// Van der Corput radical inverse\n\t\t\tfloat radicalInverse_VdC(uint bits) {\n\t\t\t\tbits = (bits << 16u) | (bits >> 16u);\n\t\t\t\tbits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);\n\t\t\t\tbits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);\n\t\t\t\tbits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);\n\t\t\t\tbits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);\n\t\t\t\treturn float(bits) * 2.3283064365386963e-10; // / 0x100000000\n\t\t\t}\n\n\t\t\t// Hammersley sequence\n\t\t\tvec2 hammersley(uint i, uint N) {\n\t\t\t\treturn vec2(float(i) / float(N), radicalInverse_VdC(i));\n\t\t\t}\n\n\t\t\t// GGX VNDF importance sampling (Eric Heitz 2018)\n\t\t\t// "Sampling the GGX Distribution of Visible Normals"\n\t\t\t// https://jcgt.org/published/0007/04/01/\n\t\t\tvec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {\n\t\t\t\tfloat alpha = roughness * roughness;\n\n\t\t\t\t// Section 3.2: Transform view direction to hemisphere configuration\n\t\t\t\tvec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));\n\n\t\t\t\t// Section 4.1: Orthonormal basis\n\t\t\t\tfloat lensq = Vh.x * Vh.x + Vh.y * Vh.y;\n\t\t\t\tvec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);\n\t\t\t\tvec3 T2 = cross(Vh, T1);\n\n\t\t\t\t// Section 4.2: Parameterization of projected area\n\t\t\t\tfloat r = sqrt(Xi.x);\n\t\t\t\tfloat phi = 2.0 * PI * Xi.y;\n\t\t\t\tfloat t1 = r * cos(phi);\n\t\t\t\tfloat t2 = r * sin(phi);\n\t\t\t\tfloat s = 0.5 * (1.0 + Vh.z);\n\t\t\t\tt2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;\n\n\t\t\t\t// Section 4.3: Reprojection onto hemisphere\n\t\t\t\tvec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;\n\n\t\t\t\t// Section 3.4: Transform back to ellipsoid configuration\n\t\t\t\treturn normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));\n\t\t\t}\n\n\t\t\tvoid main() {\n\t\t\t\tvec3 N = normalize(vOutputDirection);\n\t\t\t\tvec3 V = N; // Assume view direction equals normal for pre-filtering\n\n\t\t\t\tvec3 prefilteredColor = vec3(0.0);\n\t\t\t\tfloat totalWeight = 0.0;\n\n\t\t\t\t// For very low roughness, just sample the environment directly\n\t\t\t\tif (roughness < 0.001) {\n\t\t\t\t\tgl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Tangent space basis for VNDF sampling\n\t\t\t\tvec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\n\t\t\t\tvec3 tangent = normalize(cross(up, N));\n\t\t\t\tvec3 bitangent = cross(N, tangent);\n\n\t\t\t\tfor(uint i = 0u; i < uint(GGX_SAMPLES); i++) {\n\t\t\t\t\tvec2 Xi = hammersley(i, uint(GGX_SAMPLES));\n\n\t\t\t\t\t// For PMREM, V = N, so in tangent space V is always (0, 0, 1)\n\t\t\t\t\tvec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);\n\n\t\t\t\t\t// Transform H back to world space\n\t\t\t\t\tvec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);\n\t\t\t\t\tvec3 L = normalize(2.0 * dot(V, H) * H - V);\n\n\t\t\t\t\tfloat NdotL = max(dot(N, L), 0.0);\n\n\t\t\t\t\tif(NdotL > 0.0) {\n\t\t\t\t\t\t// Sample environment at fixed mip level\n\t\t\t\t\t\t// VNDF importance sampling handles the distribution filtering\n\t\t\t\t\t\tvec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);\n\n\t\t\t\t\t\t// Weight by NdotL for the split-sum approximation\n\t\t\t\t\t\t// VNDF PDF naturally accounts for the visible microfacet distribution\n\t\t\t\t\t\tprefilteredColor += sampleColor * NdotL;\n\t\t\t\t\t\ttotalWeight += NdotL;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (totalWeight > 0.0) {\n\t\t\t\t\tprefilteredColor = prefilteredColor / totalWeight;\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = vec4(prefilteredColor, 1.0);\n\t\t\t}\n\t\t',blending:0,depthTest:!1,depthWrite:!1})}(o,e,t)}return r}_compileMaterial(e){const t=new Gt(new pt,e);this._renderer.compile(t,hf)}_sceneToCubeUV(e,t,i,r,o){const c=new jn(90,1,t,i),l=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],d=this._renderer,f=d.autoClear,h=d.toneMapping;d.getClearColor(g2),d.toneMapping=_o,d.autoClear=!1,d.state.buffers.depth.getReversed()&&(d.setRenderTarget(r),d.clearDepth(),d.setRenderTarget(null)),null===this._backgroundBox&&(this._backgroundBox=new Gt(new Bs,new Cr({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1})));const _=this._backgroundBox,m=_.material;let g=!1;const v=e.background;v?v.isColor&&(m.color.copy(v),e.background=null,g=!0):(m.color.copy(g2),g=!0);for(let x=0;x<6;x++){const y=x%3;0===y?(c.up.set(0,l[x],0),c.position.set(o.x,o.y,o.z),c.lookAt(o.x+u[x],o.y,o.z)):1===y?(c.up.set(0,0,l[x]),c.position.set(o.x,o.y,o.z),c.lookAt(o.x,o.y+u[x],o.z)):(c.up.set(0,l[x],0),c.position.set(o.x,o.y,o.z),c.lookAt(o.x,o.y,o.z+u[x]));const S=this._cubeSize;ql(r,y*S,x>2?S:0,S,S),d.setRenderTarget(r),g&&d.render(_,c),d.render(e,c)}d.toneMapping=h,d.autoClear=f,e.background=v}_textureToCubeUV(e,t){const i=this._renderer,r=301===e.mapping||302===e.mapping;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=x2()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=v2());const o=r?this._cubemapMaterial:this._equirectMaterial,s=this._lodMeshes[0];s.material=o,o.uniforms.envMap.value=e;const c=this._cubeSize;ql(t,0,0,3*c,2*c),i.setRenderTarget(t),i.render(s,hf)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;const r=this._lodMeshes.length;for(let o=1;o<r;o++)this._applyGGXFilter(e,o-1,o);t.autoClear=i}_applyGGXFilter(e,t,i){const r=this._renderer,o=this._pingPongRenderTarget,s=this._ggxMaterial,a=this._lodMeshes[i];a.material=s;const c=s.uniforms,l=i/(this._lodMeshes.length-1),u=t/(this._lodMeshes.length-1),h=Math.sqrt(l*l-u*u)*(0+1.25*l),{_lodMax:p}=this,_=this._sizeLods[i],m=3*_*(i>p-4?i-p+4:0),g=4*(this._cubeSize-_);c.envMap.value=e.texture,c.roughness.value=h,c.mipInt.value=p-t,ql(o,m,g,3*_,2*_),r.setRenderTarget(o),r.render(a,hf),c.envMap.value=o.texture,c.roughness.value=0,c.mipInt.value=p-i,ql(e,m,g,3*_,2*_),r.setRenderTarget(e),r.render(a,hf)}_blur(e,t,i,r,o){const s=this._pingPongRenderTarget;this._halfBlur(e,s,t,i,r,"latitudinal",o),this._halfBlur(s,e,i,i,r,"longitudinal",o)}_halfBlur(e,t,i,r,o,s,a){const c=this._renderer,l=this._blurMaterial;"latitudinal"!==s&&"longitudinal"!==s&&Ze("blur direction must be either latitudinal or longitudinal!");const d=this._lodMeshes[r];d.material=l;const f=l.uniforms,h=this._sizeLods[i]-1,p=isFinite(o)?Math.PI/(2*h):2*Math.PI/39,_=o/p,m=isFinite(o)?1+Math.floor(3*_):20;m>20&&Se(`sigmaRadians, ${o}, is too large and will clip, as it requested ${m} samples when the maximum is set to 20`);const g=[];let v=0;for(let T=0;T<20;++T){const I=T/_,C=Math.exp(-I*I/2);g.push(C),0===T?v+=C:T<m&&(v+=2*C)}for(let T=0;T<g.length;T++)g[T]=g[T]/v;f.envMap.value=e.texture,f.samples.value=m,f.weights.value=g,f.latitudinal.value="latitudinal"===s,a&&(f.poleAxis.value=a);const{_lodMax:x}=this;f.dTheta.value=p,f.mipInt.value=x-i;const y=this._sizeLods[r];ql(t,3*y*(r>x-4?r-x+4:0),4*(this._cubeSize-y),3*y,2*y),c.setRenderTarget(t),c.render(d,hf)}}function _2(n,e,t){const i=new br(n,e,t);return i.texture.mapping=306,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function ql(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function v2(){return new qr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function x2(){return new qr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function qX(n){let e=new WeakMap,t=null;function o(a){const c=a.target;c.removeEventListener("dispose",o);const l=e.get(c);void 0!==l&&(e.delete(c),l.dispose())}return{get:function i(a){if(a&&a.isTexture){const c=a.mapping,l=303===c||304===c,u=301===c||302===c;if(l||u){let d=e.get(a);if(a.isRenderTargetTexture&&a.pmremVersion!==(void 0!==d?d.texture.pmremVersion:0))return null===t&&(t=new m2(n)),d=l?t.fromEquirectangular(a,d):t.fromCubemap(a,d),d.texture.pmremVersion=a.pmremVersion,e.set(a,d),d.texture;if(void 0!==d)return d.texture;{const h=a.image;return l&&h&&h.height>0||u&&h&&function r(a){let c=0;for(let u=0;u<6;u++)void 0!==a[u]&&c++;return 6===c}(h)?(null===t&&(t=new m2(n)),d=l?t.fromEquirectangular(a):t.fromCubemap(a),d.texture.pmremVersion=a.pmremVersion,e.set(a,d),a.addEventListener("dispose",o),d.texture):null}}}return a},dispose:function s(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function XX(n){const e={};function t(i){if(void 0!==e[i])return e[i];const r=n.getExtension(i);return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(i){const r=t(i);return null===r&&Ud("WebGLRenderer: "+i+" extension not supported."),r}}}function YX(n,e,t,i){const r={},o=new WeakMap;function s(d){const f=d.target;null!==f.index&&e.remove(f.index);for(const p in f.attributes)e.remove(f.attributes[p]);f.removeEventListener("dispose",s),delete r[f.id];const h=o.get(f);h&&(e.remove(h),o.delete(f)),i.releaseStatesOfGeometry(f),!0===f.isInstancedBufferGeometry&&delete f._maxInstanceCount,t.memory.geometries--}function l(d){const f=[],h=d.index,p=d.attributes.position;let _=0;if(null!==h){const v=h.array;_=h.version;for(let x=0,y=v.length;x<y;x+=3){const S=v[x+0],P=v[x+1],T=v[x+2];f.push(S,P,P,T,T,S)}}else{if(void 0===p)return;_=p.version;for(let x=0,y=p.array.length/3-1;x<y;x+=3){const S=x+0,P=x+1,T=x+2;f.push(S,P,P,T,T,S)}}const m=new(bD(f)?VD:BD)(f,1);m.version=_;const g=o.get(d);g&&e.remove(g),o.set(d,m)}return{get:function a(d,f){return!0===r[f.id]||(f.addEventListener("dispose",s),r[f.id]=!0,t.memory.geometries++),f},update:function c(d){const f=d.attributes;for(const h in f)e.update(f[h],n.ARRAY_BUFFER)},getWireframeAttribute:function u(d){const f=o.get(d);if(f){const h=d.index;null!==h&&f.version<h.version&&l(d)}else l(d);return o.get(d)}}}function ZX(n,e,t){let i,o,s;function l(f,h,p){0!==p&&(n.drawElementsInstanced(i,h,o,f*s,p),t.update(h,i,p))}this.setMode=function r(f){i=f},this.setIndex=function a(f){o=f.type,s=f.bytesPerElement},this.render=function c(f,h){n.drawElements(i,h,o,f*s),t.update(h,i,1)},this.renderInstances=l,this.renderMultiDraw=function u(f,h,p){if(0===p)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,h,0,o,f,0,p);let m=0;for(let g=0;g<p;g++)m+=h[g];t.update(m,i,1)},this.renderMultiDrawInstances=function d(f,h,p,_){if(0===p)return;const m=e.get("WEBGL_multi_draw");if(null===m)for(let g=0;g<f.length;g++)l(f[g]/s,h[g],_[g]);else{m.multiDrawElementsInstancedWEBGL(i,h,0,o,f,0,_,0,p);let g=0;for(let v=0;v<p;v++)g+=h[v]*_[v];t.update(g,i,1)}}}function KX(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(o,s,a){switch(t.calls++,s){case n.TRIANGLES:t.triangles+=a*(o/3);break;case n.LINES:t.lines+=a*(o/2);break;case n.LINE_STRIP:t.lines+=a*(o-1);break;case n.LINE_LOOP:t.lines+=a*o;break;case n.POINTS:t.points+=a*o;break;default:Ze("WebGLInfo: Unknown draw mode:",s)}}}}function JX(n,e,t){const i=new WeakMap,r=new pn;return{update:function o(s,a,c){const l=s.morphTargetInfluences,u=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,d=void 0!==u?u.length:0;let f=i.get(a);if(void 0===f||f.count!==d){let C=function(){T.dispose(),i.delete(a),a.removeEventListener("dispose",C)};void 0!==f&&f.texture.dispose();const h=void 0!==a.morphAttributes.position,p=void 0!==a.morphAttributes.normal,_=void 0!==a.morphAttributes.color,m=a.morphAttributes.position||[],g=a.morphAttributes.normal||[],v=a.morphAttributes.color||[];let x=0;!0===h&&(x=1),!0===p&&(x=2),!0===_&&(x=3);let y=a.attributes.position.count*x,S=1;y>e.maxTextureSize&&(S=Math.ceil(y/e.maxTextureSize),y=e.maxTextureSize);const P=new Float32Array(y*S*4*d),T=new Dy(P,y,S,d);T.type=Vi,T.needsUpdate=!0;const I=4*x;for(let E=0;E<d;E++){const F=m[E],z=g[E],H=v[E],W=y*S*4*E;for(let Y=0;Y<F.count;Y++){const j=Y*I;!0===h&&(r.fromBufferAttribute(F,Y),P[W+j+0]=r.x,P[W+j+1]=r.y,P[W+j+2]=r.z,P[W+j+3]=0),!0===p&&(r.fromBufferAttribute(z,Y),P[W+j+4]=r.x,P[W+j+5]=r.y,P[W+j+6]=r.z,P[W+j+7]=0),!0===_&&(r.fromBufferAttribute(H,Y),P[W+j+8]=r.x,P[W+j+9]=r.y,P[W+j+10]=r.z,P[W+j+11]=4===H.itemSize?r.w:1)}}f={count:d,texture:T,size:new re(y,S)},i.set(a,f),a.addEventListener("dispose",C)}if(!0===s.isInstancedMesh&&null!==s.morphTexture)c.getUniforms().setValue(n,"morphTexture",s.morphTexture,t);else{let h=0;for(let _=0;_<l.length;_++)h+=l[_];const p=a.morphTargetsRelative?1:1-h;c.getUniforms().setValue(n,"morphTargetBaseInfluence",p),c.getUniforms().setValue(n,"morphTargetInfluences",l)}c.getUniforms().setValue(n,"morphTargetsTexture",f.texture,t),c.getUniforms().setValue(n,"morphTargetsTextureSize",f.size)}}}function QX(n,e,t,i){let r=new WeakMap;function a(c){const l=c.target;l.removeEventListener("dispose",a),t.remove(l.instanceMatrix),null!==l.instanceColor&&t.remove(l.instanceColor)}return{update:function o(c){const l=i.render.frame,d=e.get(c,c.geometry);if(r.get(d)!==l&&(e.update(d),r.set(d,l)),c.isInstancedMesh&&(!1===c.hasEventListener("dispose",a)&&c.addEventListener("dispose",a),r.get(c)!==l&&(t.update(c.instanceMatrix,n.ARRAY_BUFFER),null!==c.instanceColor&&t.update(c.instanceColor,n.ARRAY_BUFFER),r.set(c,l))),c.isSkinnedMesh){const f=c.skeleton;r.get(f)!==l&&(f.update(),r.set(f,l))}return d},dispose:function s(){r=new WeakMap}}}const eY={1:"LINEAR_TONE_MAPPING",2:"REINHARD_TONE_MAPPING",3:"CINEON_TONE_MAPPING",4:"ACES_FILMIC_TONE_MAPPING",6:"AGX_TONE_MAPPING",7:"NEUTRAL_TONE_MAPPING",5:"CUSTOM_TONE_MAPPING"};function tY(n,e,t,i,r){const o=new br(e,t,{type:n,depthBuffer:i,stencilBuffer:r}),s=new br(e,t,{type:Zo,depthBuffer:!1,stencilBuffer:!1}),a=new pt;a.setAttribute("position",new Ne([-1,3,0,-1,-1,0,3,-1,0],3)),a.setAttribute("uv",new Ne([0,2,0,0,2,0],2));const c=new NI({uniforms:{tDiffuse:{value:null}},vertexShader:"\n\t\t\tprecision highp float;\n\n\t\t\tuniform mat4 modelViewMatrix;\n\t\t\tuniform mat4 projectionMatrix;\n\n\t\t\tattribute vec3 position;\n\t\t\tattribute vec2 uv;\n\n\t\t\tvarying vec2 vUv;\n\n\t\t\tvoid main() {\n\t\t\t\tvUv = uv;\n\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t}",fragmentShader:"\n\t\t\tprecision highp float;\n\n\t\t\tuniform sampler2D tDiffuse;\n\n\t\t\tvarying vec2 vUv;\n\n\t\t\t#include <tonemapping_pars_fragment>\n\t\t\t#include <colorspace_pars_fragment>\n\n\t\t\tvoid main() {\n\t\t\t\tgl_FragColor = texture2D( tDiffuse, vUv );\n\n\t\t\t\t#ifdef LINEAR_TONE_MAPPING\n\t\t\t\t\tgl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( REINHARD_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( CINEON_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( ACES_FILMIC_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( AGX_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( NEUTRAL_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( CUSTOM_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );\n\t\t\t\t#endif\n\n\t\t\t\t#ifdef SRGB_TRANSFER\n\t\t\t\t\tgl_FragColor = sRGBTransferOETF( gl_FragColor );\n\t\t\t\t#endif\n\t\t\t}",depthTest:!1,depthWrite:!1}),l=new Gt(a,c),u=new ff(-1,1,1,-1,0,1);let p,d=null,f=null,h=!1,_=null,m=[],g=!1;this.setSize=function(v,x){o.setSize(v,x),s.setSize(v,x);for(let y=0;y<m.length;y++){const S=m[y];S.setSize&&S.setSize(v,x)}},this.setEffects=function(v){m=v,g=m.length>0&&!0===m[0].isRenderPass;const x=o.width,y=o.height;for(let S=0;S<m.length;S++){const P=m[S];P.setSize&&P.setSize(x,y)}},this.begin=function(v,x){if(h||v.toneMapping===_o&&0===m.length)return!1;if(_=x,null!==x){const y=x.width,S=x.height;(o.width!==y||o.height!==S)&&this.setSize(y,S)}return!1===g&&v.setRenderTarget(o),p=v.toneMapping,v.toneMapping=_o,!0},this.hasRenderPass=function(){return g},this.end=function(v,x){v.toneMapping=p,h=!0;let y=o,S=s;for(let P=0;P<m.length;P++){const T=m[P];if(!1!==T.enabled&&(T.render(v,S,y,x),!1!==T.needsSwap)){const I=y;y=S,S=I}}if(d!==v.outputColorSpace||f!==v.toneMapping){d=v.outputColorSpace,f=v.toneMapping,c.defines={},Tt.getTransfer(d)===Kt&&(c.defines.SRGB_TRANSFER="");const P=eY[f];P&&(c.defines[P]=""),c.needsUpdate=!0}c.uniforms.tDiffuse.value=y.texture,v.setRenderTarget(_),v.render(l,u),_=null,h=!1},this.isCompositing=function(){return h},this.dispose=function(){o.dispose(),s.dispose(),a.dispose(),c.dispose()}}const y2=new ui,QM=new tf(1,1),M2=new Dy,b2=new Iy,C2=new mg,w2=[],S2=[],P2=new Float32Array(16),E2=new Float32Array(9),T2=new Float32Array(4);function Xl(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let o=w2[r];if(void 0===o&&(o=new Float32Array(r),w2[r]=o),0!==e){i.toArray(o,0);for(let s=1,a=0;s!==e;++s)a+=t,n[s].toArray(o,a)}return o}function Wn(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function $n(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function tm(n,e){let t=S2[e];void 0===t&&(t=new Int32Array(e),S2[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function nY(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function iY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Wn(t,e))return;n.uniform2fv(this.addr,e),$n(t,e)}}function rY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Wn(t,e))return;n.uniform3fv(this.addr,e),$n(t,e)}}function oY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Wn(t,e))return;n.uniform4fv(this.addr,e),$n(t,e)}}function sY(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Wn(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),$n(t,e)}else{if(Wn(t,i))return;T2.set(i),n.uniformMatrix2fv(this.addr,!1,T2),$n(t,i)}}function aY(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Wn(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),$n(t,e)}else{if(Wn(t,i))return;E2.set(i),n.uniformMatrix3fv(this.addr,!1,E2),$n(t,i)}}function cY(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Wn(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),$n(t,e)}else{if(Wn(t,i))return;P2.set(i),n.uniformMatrix4fv(this.addr,!1,P2),$n(t,i)}}function lY(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function uY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Wn(t,e))return;n.uniform2iv(this.addr,e),$n(t,e)}}function dY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Wn(t,e))return;n.uniform3iv(this.addr,e),$n(t,e)}}function fY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Wn(t,e))return;n.uniform4iv(this.addr,e),$n(t,e)}}function hY(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function pY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Wn(t,e))return;n.uniform2uiv(this.addr,e),$n(t,e)}}function gY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Wn(t,e))return;n.uniform3uiv(this.addr,e),$n(t,e)}}function mY(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Wn(t,e))return;n.uniform4uiv(this.addr,e),$n(t,e)}}function _Y(n,e,t){const i=this.cache,r=t.allocateTextureUnit();let o;i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),this.type===n.SAMPLER_2D_SHADOW?(QM.compareFunction=t.isReversedDepthBuffer()?518:515,o=QM):o=y2,t.setTexture2D(e||o,r)}function vY(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||b2,r)}function xY(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||C2,r)}function yY(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||M2,r)}function bY(n,e){n.uniform1fv(this.addr,e)}function CY(n,e){const t=Xl(e,this.size,2);n.uniform2fv(this.addr,t)}function wY(n,e){const t=Xl(e,this.size,3);n.uniform3fv(this.addr,t)}function SY(n,e){const t=Xl(e,this.size,4);n.uniform4fv(this.addr,t)}function PY(n,e){const t=Xl(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function EY(n,e){const t=Xl(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function TY(n,e){const t=Xl(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function AY(n,e){n.uniform1iv(this.addr,e)}function OY(n,e){n.uniform2iv(this.addr,e)}function DY(n,e){n.uniform3iv(this.addr,e)}function IY(n,e){n.uniform4iv(this.addr,e)}function RY(n,e){n.uniform1uiv(this.addr,e)}function NY(n,e){n.uniform2uiv(this.addr,e)}function LY(n,e){n.uniform3uiv(this.addr,e)}function FY(n,e){n.uniform4uiv(this.addr,e)}function kY(n,e,t){const i=this.cache,r=e.length,o=tm(t,r);let s;Wn(i,o)||(n.uniform1iv(this.addr,o),$n(i,o)),s=this.type===n.SAMPLER_2D_SHADOW?QM:y2;for(let a=0;a!==r;++a)t.setTexture2D(e[a]||s,o[a])}function UY(n,e,t){const i=this.cache,r=e.length,o=tm(t,r);Wn(i,o)||(n.uniform1iv(this.addr,o),$n(i,o));for(let s=0;s!==r;++s)t.setTexture3D(e[s]||b2,o[s])}function BY(n,e,t){const i=this.cache,r=e.length,o=tm(t,r);Wn(i,o)||(n.uniform1iv(this.addr,o),$n(i,o));for(let s=0;s!==r;++s)t.setTextureCube(e[s]||C2,o[s])}function VY(n,e,t){const i=this.cache,r=e.length,o=tm(t,r);Wn(i,o)||(n.uniform1iv(this.addr,o),$n(i,o));for(let s=0;s!==r;++s)t.setTexture2DArray(e[s]||M2,o[s])}class HY{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=function MY(n){switch(n){case 5126:return nY;case 35664:return iY;case 35665:return rY;case 35666:return oY;case 35674:return sY;case 35675:return aY;case 35676:return cY;case 5124:case 35670:return lY;case 35667:case 35671:return uY;case 35668:case 35672:return dY;case 35669:case 35673:return fY;case 5125:return hY;case 36294:return pY;case 36295:return gY;case 36296:return mY;case 35678:case 36198:case 36298:case 36306:case 35682:return _Y;case 35679:case 36299:case 36307:return vY;case 35680:case 36300:case 36308:case 36293:return xY;case 36289:case 36303:case 36311:case 36292:return yY}}(t.type)}}class GY{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function zY(n){switch(n){case 5126:return bY;case 35664:return CY;case 35665:return wY;case 35666:return SY;case 35674:return PY;case 35675:return EY;case 35676:return TY;case 5124:case 35670:return AY;case 35667:case 35671:return OY;case 35668:case 35672:return DY;case 35669:case 35673:return IY;case 5125:return RY;case 36294:return NY;case 36295:return LY;case 36296:return FY;case 35678:case 36198:case 36298:case 36306:case 35682:return kY;case 35679:case 36299:case 36307:return UY;case 35680:case 36300:case 36308:case 36293:return BY;case 36289:case 36303:case 36311:case 36292:return VY}}(t.type)}}class jY{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let o=0,s=r.length;o!==s;++o){const a=r[o];a.setValue(e,t[a.id],i)}}}const eb=/(\w+)(\])?(\[|\.)?/g;function A2(n,e){n.seq.push(e),n.map[e.id]=e}function WY(n,e,t){const i=n.name,r=i.length;for(eb.lastIndex=0;;){const o=eb.exec(i);let a=o[1];const l=o[3];if("]"===o[2]&&(a|=0),void 0===l||"["===l&&eb.lastIndex+2===r){A2(t,void 0===l?new HY(a,n,e):new GY(a,n,e));break}{let d=t.map[a];void 0===d&&(d=new jY(a),A2(t,d)),t=d}}}class nm{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<i;++s){const a=e.getActiveUniform(t,s);WY(a,e.getUniformLocation(t,a.name),this)}const r=[],o=[];for(const s of this.seq)s.type===e.SAMPLER_2D_SHADOW||s.type===e.SAMPLER_CUBE_SHADOW||s.type===e.SAMPLER_2D_ARRAY_SHADOW?r.push(s):o.push(s);r.length>0&&(this.seq=r.concat(o))}setValue(e,t,i,r){const o=this.map[t];void 0!==o&&o.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let o=0,s=t.length;o!==s;++o){const a=t[o],c=i[a.id];!1!==c.needsUpdate&&a.setValue(e,c.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,o=e.length;r!==o;++r){const s=e[r];s.id in t&&i.push(s)}return i}}function O2(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}const $Y=37297;let qY=0;const D2=new Pt;function I2(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),o=(n.getShaderInfoLog(e)||"").trim();if(i&&""===o)return"";const s=/ERROR: 0:(\d+)/.exec(o);if(s){const a=parseInt(s[1]);return t.toUpperCase()+"\n\n"+o+"\n\n"+function XY(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),o=Math.min(e+6,t.length);for(let s=r;s<o;s++){const a=s+1;i.push(`${a===e?">":" "} ${a}: ${t[s]}`)}return i.join("\n")}(n.getShaderSource(e),a)}return o}function ZY(n,e){const t=function YY(n){Tt._getMatrix(D2,Tt.workingColorSpace,n);const e=`mat3( ${D2.elements.map(t=>t.toFixed(4))} )`;switch(Tt.getTransfer(n)){case Kp:return[e,"LinearTransferOETF"];case Kt:return[e,"sRGBTransferOETF"];default:return Se("WebGLProgram: Unsupported color space: ",n),[e,"LinearTransferOETF"]}}(e);return[`vec4 ${n}( vec4 value ) {`,`\treturn ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join("\n")}const KY={1:"Linear",2:"Reinhard",3:"Cineon",4:"ACESFilmic",6:"AgX",7:"Neutral",5:"Custom"};function JY(n,e){const t=KY[e];return void 0===t?(Se("WebGLProgram: Unsupported toneMapping:",e),"vec3 "+n+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const im=new R;function pf(n){return""!==n}function R2(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function N2(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const iZ=/^[ \t]*#include +<([\w\d./]+)>/gm;function tb(n){return n.replace(iZ,oZ)}const rZ=new Map;function oZ(n,e){let t=Et[e];if(void 0===t){const i=rZ.get(e);if(void 0===i)throw new Error("Can not resolve #include <"+e+">");t=Et[i],Se('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i)}return tb(t)}const sZ=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function L2(n){return n.replace(sZ,aZ)}function aZ(n,e,t,i){let r="";for(let o=parseInt(e);o<parseInt(t);o++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return r}function F2(n){let e=`precision ${n.precision} float;\n\tprecision ${n.precision} int;\n\tprecision ${n.precision} sampler2D;\n\tprecision ${n.precision} samplerCube;\n\tprecision ${n.precision} sampler3D;\n\tprecision ${n.precision} sampler2DArray;\n\tprecision ${n.precision} sampler2DShadow;\n\tprecision ${n.precision} samplerCubeShadow;\n\tprecision ${n.precision} sampler2DArrayShadow;\n\tprecision ${n.precision} isampler2D;\n\tprecision ${n.precision} isampler3D;\n\tprecision ${n.precision} isamplerCube;\n\tprecision ${n.precision} isampler2DArray;\n\tprecision ${n.precision} usampler2D;\n\tprecision ${n.precision} usampler3D;\n\tprecision ${n.precision} usamplerCube;\n\tprecision ${n.precision} usampler2DArray;\n\t`;return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}const cZ={1:"SHADOWMAP_TYPE_PCF",3:"SHADOWMAP_TYPE_VSM"},uZ={301:"ENVMAP_TYPE_CUBE",302:"ENVMAP_TYPE_CUBE",306:"ENVMAP_TYPE_CUBE_UV"},fZ={302:"ENVMAP_MODE_REFRACTION"},pZ={0:"ENVMAP_BLENDING_MULTIPLY",1:"ENVMAP_BLENDING_MIX",2:"ENVMAP_BLENDING_ADD"};function _Z(n,e,t,i){const r=n.getContext(),o=t.defines;let s=t.vertexShader,a=t.fragmentShader;const c=function lZ(n){return cZ[n.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}(t),l=function dZ(n){return!1===n.envMap?"ENVMAP_TYPE_CUBE":uZ[n.envMapMode]||"ENVMAP_TYPE_CUBE"}(t),u=function hZ(n){return!1===n.envMap?"ENVMAP_MODE_REFLECTION":fZ[n.envMapMode]||"ENVMAP_MODE_REFLECTION"}(t),d=function gZ(n){return!1===n.envMap?"ENVMAP_BLENDING_NONE":pZ[n.combine]||"ENVMAP_BLENDING_NONE"}(t),f=function mZ(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),h=function eZ(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(pf).join("\n")}(t),p=function tZ(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(o),_=r.createProgram();let m,g,v=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(m=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(pf).join("\n"),m.length>0&&(m+="\n"),g=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(pf).join("\n"),g.length>0&&(g+="\n")):(m=[F2(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(pf).join("\n"),g=[F2(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+l:"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",f?"#define CUBEUV_TEXEL_WIDTH "+f.texelWidth:"",f?"#define CUBEUV_TEXEL_HEIGHT "+f.texelHeight:"",f?"#define CUBEUV_MAX_MIP "+f.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==_o?"#define TONE_MAPPING":"",t.toneMapping!==_o?Et.tonemapping_pars_fragment:"",t.toneMapping!==_o?JY("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Et.colorspace_pars_fragment,ZY("linearToOutputTexel",t.outputColorSpace),(Tt.getLuminanceCoefficients(im),["float luminance( const in vec3 rgb ) {",`\tconst vec3 weights = vec3( ${im.x.toFixed(4)}, ${im.y.toFixed(4)}, ${im.z.toFixed(4)} );`,"\treturn dot( weights, rgb );","}"].join("\n")),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(pf).join("\n")),s=tb(s),s=R2(s,t),s=N2(s,t),a=tb(a),a=R2(a,t),a=N2(a,t),s=L2(s),a=L2(a),!0!==t.isRawShaderMaterial&&(v="#version 300 es\n",m=[h,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+m,g=["#define varying in",t.glslVersion===MD?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===MD?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+g);const y=v+g+a,S=O2(r,r.VERTEX_SHADER,v+m+s),P=O2(r,r.FRAGMENT_SHADER,y);function T(F){if(n.debug.checkShaderErrors){const z=r.getProgramInfoLog(_)||"",H=r.getShaderInfoLog(S)||"",W=r.getShaderInfoLog(P)||"",Y=z.trim(),j=H.trim(),X=W.trim();let ce=!0,ye=!0;if(!1===r.getProgramParameter(_,r.LINK_STATUS))if(ce=!1,"function"==typeof n.debug.onShaderError)n.debug.onShaderError(r,_,S,P);else{const _e=I2(r,S,"vertex"),Me=I2(r,P,"fragment");Ze("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(_,r.VALIDATE_STATUS)+"\n\nMaterial Name: "+F.name+"\nMaterial Type: "+F.type+"\n\nProgram Info Log: "+Y+"\n"+_e+"\n"+Me)}else""!==Y?Se("WebGLProgram: Program Info Log:",Y):(""===j||""===X)&&(ye=!1);ye&&(F.diagnostics={runnable:ce,programLog:Y,vertexShader:{log:j,prefix:m},fragmentShader:{log:X,prefix:g}})}r.deleteShader(S),r.deleteShader(P),I=new nm(r,_),C=function nZ(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const o=n.getActiveAttrib(e,r),s=o.name;let a=1;o.type===n.FLOAT_MAT2&&(a=2),o.type===n.FLOAT_MAT3&&(a=3),o.type===n.FLOAT_MAT4&&(a=4),t[s]={type:o.type,location:n.getAttribLocation(e,s),locationSize:a}}return t}(r,_)}let I,C;r.attachShader(_,S),r.attachShader(_,P),void 0!==t.index0AttributeName?r.bindAttribLocation(_,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(_,0,"position"),r.linkProgram(_),this.getUniforms=function(){return void 0===I&&T(this),I},this.getAttributes=function(){return void 0===C&&T(this),C};let E=!1===t.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===E&&(E=r.getProgramParameter(_,$Y)),E},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(_),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=qY++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=S,this.fragmentShader=P,this}let vZ=0;class xZ{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),o=this._getShaderStage(i),s=this._getShaderCacheForMaterial(e);return!1===s.has(r)&&(s.add(r),r.usedTimes++),!1===s.has(o)&&(s.add(o),o.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new yZ(e),t.set(e,i)),i}}class yZ{constructor(e){this.id=vZ++,this.code=e,this.usedTimes=0}}function MZ(n,e,t,i,r,o,s){const a=new Uy,c=new xZ,l=new Set,u=[],d=new Map,f=r.logarithmicDepthBuffer;let h=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _(C){return l.add(C),0===C?"uv":`uv${C}`}return{getParameters:function m(C,E,F,z,H){const W=z.fog,Y=H.geometry,X=(C.isMeshStandardMaterial?t:e).get(C.envMap||(C.isMeshStandardMaterial?z.environment:null)),ce=X&&306===X.mapping?X.image.height:null,ye=p[C.type];null!==C.precision&&(h=r.getMaxPrecision(C.precision),h!==C.precision&&Se("WebGLProgram.getParameters:",C.precision,"not supported, using",h,"instead."));const _e=Y.morphAttributes.position||Y.morphAttributes.normal||Y.morphAttributes.color,Me=void 0!==_e?_e.length:0;let Je,Lt,Ft,ee,_t=0;if(void 0!==Y.morphAttributes.position&&(_t=1),void 0!==Y.morphAttributes.normal&&(_t=2),void 0!==Y.morphAttributes.color&&(_t=3),ye){const Jt=wo[ye];Je=Jt.vertexShader,Lt=Jt.fragmentShader}else Je=C.vertexShader,Lt=C.fragmentShader,c.update(C),Ft=c.getVertexShaderID(C),ee=c.getFragmentShaderID(C);const le=n.getRenderTarget(),Ue=n.state.buffers.depth.getReversed(),Ke=!0===H.isInstancedMesh,Ie=!0===H.isBatchedMesh,At=!!C.map,Ct=!!X,ae=!!C.aoMap,he=!!C.lightMap,ue=!!C.bumpMap,Ae=!!C.normalMap,N=!!C.displacementMap,Qe=!!C.emissiveMap,Le=!!C.metalnessMap,rt=!!C.roughnessMap,ve=C.anisotropy>0,D=C.clearcoat>0,B=C.iridescence>0,Z=C.sheen>0,oe=C.transmission>0,K=ve&&!!C.anisotropyMap,Ge=D&&!!C.clearcoatMap,be=D&&!!C.clearcoatNormalMap,ze=D&&!!C.clearcoatRoughnessMap,st=B&&!!C.iridescenceMap,fe=B&&!!C.iridescenceThicknessMap,Pe=Z&&!!C.sheenColorMap,He=Z&&!!C.sheenRoughnessMap,We=!!C.specularMap,we=!!C.specularColorMap,Ot=!!C.specularIntensityMap,k=oe&&!!C.transmissionMap,Re=oe&&!!C.thicknessMap,Fe=!!C.alphaMap,Ce=!!C.extensions;let yt=_o;C.toneMapped&&(null===le||!0===le.isXRRenderTarget)&&(yt=n.toneMapping);const mn={shaderID:ye,shaderType:C.type,shaderName:C.name,vertexShader:Je,fragmentShader:Lt,defines:C.defines,customVertexShaderID:Ft,customFragmentShaderID:ee,isRawShaderMaterial:!0===C.isRawShaderMaterial,glslVersion:C.glslVersion,precision:h,batching:Ie,batchingColor:Ie&&null!==H._colorsTexture,instancing:Ke,instancingColor:Ke&&null!==H.instanceColor,instancingMorph:Ke&&null!==H.morphTexture,outputColorSpace:null===le?n.outputColorSpace:!0===le.isXRRenderTarget?le.texture.colorSpace:bi,alphaToCoverage:!!C.alphaToCoverage,map:At,matcap:!!C.matcap,envMap:Ct,envMapMode:Ct&&X.mapping,envMapCubeUVHeight:ce,aoMap:ae,lightMap:he,bumpMap:ue,normalMap:Ae,displacementMap:N,emissiveMap:Qe,normalMapObjectSpace:Ae&&1===C.normalMapType,normalMapTangentSpace:Ae&&0===C.normalMapType,metalnessMap:Le,roughnessMap:rt,anisotropy:ve,anisotropyMap:K,clearcoat:D,clearcoatMap:Ge,clearcoatNormalMap:be,clearcoatRoughnessMap:ze,dispersion:C.dispersion>0,iridescence:B,iridescenceMap:st,iridescenceThicknessMap:fe,sheen:Z,sheenColorMap:Pe,sheenRoughnessMap:He,specularMap:We,specularColorMap:we,specularIntensityMap:Ot,transmission:oe,transmissionMap:k,thicknessMap:Re,gradientMap:!!C.gradientMap,opaque:!1===C.transparent&&1===C.blending&&!1===C.alphaToCoverage,alphaMap:Fe,alphaTest:C.alphaTest>0,alphaHash:!!C.alphaHash,combine:C.combine,mapUv:At&&_(C.map.channel),aoMapUv:ae&&_(C.aoMap.channel),lightMapUv:he&&_(C.lightMap.channel),bumpMapUv:ue&&_(C.bumpMap.channel),normalMapUv:Ae&&_(C.normalMap.channel),displacementMapUv:N&&_(C.displacementMap.channel),emissiveMapUv:Qe&&_(C.emissiveMap.channel),metalnessMapUv:Le&&_(C.metalnessMap.channel),roughnessMapUv:rt&&_(C.roughnessMap.channel),anisotropyMapUv:K&&_(C.anisotropyMap.channel),clearcoatMapUv:Ge&&_(C.clearcoatMap.channel),clearcoatNormalMapUv:be&&_(C.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ze&&_(C.clearcoatRoughnessMap.channel),iridescenceMapUv:st&&_(C.iridescenceMap.channel),iridescenceThicknessMapUv:fe&&_(C.iridescenceThicknessMap.channel),sheenColorMapUv:Pe&&_(C.sheenColorMap.channel),sheenRoughnessMapUv:He&&_(C.sheenRoughnessMap.channel),specularMapUv:We&&_(C.specularMap.channel),specularColorMapUv:we&&_(C.specularColorMap.channel),specularIntensityMapUv:Ot&&_(C.specularIntensityMap.channel),transmissionMapUv:k&&_(C.transmissionMap.channel),thicknessMapUv:Re&&_(C.thicknessMap.channel),alphaMapUv:Fe&&_(C.alphaMap.channel),vertexTangents:!!Y.attributes.tangent&&(Ae||ve),vertexColors:C.vertexColors,vertexAlphas:!0===C.vertexColors&&!!Y.attributes.color&&4===Y.attributes.color.itemSize,pointsUvs:!0===H.isPoints&&!!Y.attributes.uv&&(At||Fe),fog:!!W,useFog:!0===C.fog,fogExp2:!!W&&W.isFogExp2,flatShading:!0===C.flatShading&&!1===C.wireframe,sizeAttenuation:!0===C.sizeAttenuation,logarithmicDepthBuffer:f,reversedDepthBuffer:Ue,skinning:!0===H.isSkinnedMesh,morphTargets:void 0!==Y.morphAttributes.position,morphNormals:void 0!==Y.morphAttributes.normal,morphColors:void 0!==Y.morphAttributes.color,morphTargetsCount:Me,morphTextureStride:_t,numDirLights:E.directional.length,numPointLights:E.point.length,numSpotLights:E.spot.length,numSpotLightMaps:E.spotLightMap.length,numRectAreaLights:E.rectArea.length,numHemiLights:E.hemi.length,numDirLightShadows:E.directionalShadowMap.length,numPointLightShadows:E.pointShadowMap.length,numSpotLightShadows:E.spotShadowMap.length,numSpotLightShadowsWithMaps:E.numSpotLightShadowsWithMaps,numLightProbes:E.numLightProbes,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:C.dithering,shadowMapEnabled:n.shadowMap.enabled&&F.length>0,shadowMapType:n.shadowMap.type,toneMapping:yt,decodeVideoTexture:At&&!0===C.map.isVideoTexture&&Tt.getTransfer(C.map.colorSpace)===Kt,decodeVideoTextureEmissive:Qe&&!0===C.emissiveMap.isVideoTexture&&Tt.getTransfer(C.emissiveMap.colorSpace)===Kt,premultipliedAlpha:C.premultipliedAlpha,doubleSided:2===C.side,flipSided:1===C.side,useDepthPacking:C.depthPacking>=0,depthPacking:C.depthPacking||0,index0AttributeName:C.index0AttributeName,extensionClipCullDistance:Ce&&!0===C.extensions.clipCullDistance&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Ce&&!0===C.extensions.multiDraw||Ie)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:C.customProgramCacheKey()};return mn.vertexUv1s=l.has(1),mn.vertexUv2s=l.has(2),mn.vertexUv3s=l.has(3),l.clear(),mn},getProgramCacheKey:function g(C){const E=[];if(C.shaderID?E.push(C.shaderID):(E.push(C.customVertexShaderID),E.push(C.customFragmentShaderID)),void 0!==C.defines)for(const F in C.defines)E.push(F),E.push(C.defines[F]);return!1===C.isRawShaderMaterial&&(function v(C,E){C.push(E.precision),C.push(E.outputColorSpace),C.push(E.envMapMode),C.push(E.envMapCubeUVHeight),C.push(E.mapUv),C.push(E.alphaMapUv),C.push(E.lightMapUv),C.push(E.aoMapUv),C.push(E.bumpMapUv),C.push(E.normalMapUv),C.push(E.displacementMapUv),C.push(E.emissiveMapUv),C.push(E.metalnessMapUv),C.push(E.roughnessMapUv),C.push(E.anisotropyMapUv),C.push(E.clearcoatMapUv),C.push(E.clearcoatNormalMapUv),C.push(E.clearcoatRoughnessMapUv),C.push(E.iridescenceMapUv),C.push(E.iridescenceThicknessMapUv),C.push(E.sheenColorMapUv),C.push(E.sheenRoughnessMapUv),C.push(E.specularMapUv),C.push(E.specularColorMapUv),C.push(E.specularIntensityMapUv),C.push(E.transmissionMapUv),C.push(E.thicknessMapUv),C.push(E.combine),C.push(E.fogExp2),C.push(E.sizeAttenuation),C.push(E.morphTargetsCount),C.push(E.morphAttributeCount),C.push(E.numDirLights),C.push(E.numPointLights),C.push(E.numSpotLights),C.push(E.numSpotLightMaps),C.push(E.numHemiLights),C.push(E.numRectAreaLights),C.push(E.numDirLightShadows),C.push(E.numPointLightShadows),C.push(E.numSpotLightShadows),C.push(E.numSpotLightShadowsWithMaps),C.push(E.numLightProbes),C.push(E.shadowMapType),C.push(E.toneMapping),C.push(E.numClippingPlanes),C.push(E.numClipIntersection),C.push(E.depthPacking)}(E,C),function x(C,E){a.disableAll(),E.instancing&&a.enable(0),E.instancingColor&&a.enable(1),E.instancingMorph&&a.enable(2),E.matcap&&a.enable(3),E.envMap&&a.enable(4),E.normalMapObjectSpace&&a.enable(5),E.normalMapTangentSpace&&a.enable(6),E.clearcoat&&a.enable(7),E.iridescence&&a.enable(8),E.alphaTest&&a.enable(9),E.vertexColors&&a.enable(10),E.vertexAlphas&&a.enable(11),E.vertexUv1s&&a.enable(12),E.vertexUv2s&&a.enable(13),E.vertexUv3s&&a.enable(14),E.vertexTangents&&a.enable(15),E.anisotropy&&a.enable(16),E.alphaHash&&a.enable(17),E.batching&&a.enable(18),E.dispersion&&a.enable(19),E.batchingColor&&a.enable(20),E.gradientMap&&a.enable(21),C.push(a.mask),a.disableAll(),E.fog&&a.enable(0),E.useFog&&a.enable(1),E.flatShading&&a.enable(2),E.logarithmicDepthBuffer&&a.enable(3),E.reversedDepthBuffer&&a.enable(4),E.skinning&&a.enable(5),E.morphTargets&&a.enable(6),E.morphNormals&&a.enable(7),E.morphColors&&a.enable(8),E.premultipliedAlpha&&a.enable(9),E.shadowMapEnabled&&a.enable(10),E.doubleSided&&a.enable(11),E.flipSided&&a.enable(12),E.useDepthPacking&&a.enable(13),E.dithering&&a.enable(14),E.transmission&&a.enable(15),E.sheen&&a.enable(16),E.opaque&&a.enable(17),E.pointsUvs&&a.enable(18),E.decodeVideoTexture&&a.enable(19),E.decodeVideoTextureEmissive&&a.enable(20),E.alphaToCoverage&&a.enable(21),C.push(a.mask)}(E,C),E.push(n.outputColorSpace)),E.push(C.customProgramCacheKey),E.join()},getUniforms:function y(C){const E=p[C.type];let F;return F=E?Nj.clone(wo[E].uniforms):C.uniforms,F},acquireProgram:function S(C,E){let F=d.get(E);return void 0!==F?++F.usedTimes:(F=new _Z(n,E,C,o),u.push(F),d.set(E,F)),F},releaseProgram:function P(C){if(0==--C.usedTimes){const E=u.indexOf(C);u[E]=u[u.length-1],u.pop(),d.delete(C.cacheKey),C.destroy()}},releaseShaderCache:function T(C){c.remove(C)},programs:u,dispose:function I(){c.dispose()}}}function bZ(){let n=new WeakMap;return{has:function e(s){return n.has(s)},get:function t(s){let a=n.get(s);return void 0===a&&(a={},n.set(s,a)),a},remove:function i(s){n.delete(s)},update:function r(s,a,c){n.get(s)[a]=c},dispose:function o(){n=new WeakMap}}}function CZ(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function k2(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function U2(){const n=[];let e=0;const t=[],i=[],r=[];function s(d,f,h,p,_,m){let g=n[e];return void 0===g?(g={id:d.id,object:d,geometry:f,material:h,groupOrder:p,renderOrder:d.renderOrder,z:_,group:m},n[e]=g):(g.id=d.id,g.object=d,g.geometry=f,g.material=h,g.groupOrder=p,g.renderOrder=d.renderOrder,g.z=_,g.group=m),e++,g}return{opaque:t,transmissive:i,transparent:r,init:function o(){e=0,t.length=0,i.length=0,r.length=0},push:function a(d,f,h,p,_,m){const g=s(d,f,h,p,_,m);h.transmission>0?i.push(g):!0===h.transparent?r.push(g):t.push(g)},unshift:function c(d,f,h,p,_,m){const g=s(d,f,h,p,_,m);h.transmission>0?i.unshift(g):!0===h.transparent?r.unshift(g):t.unshift(g)},finish:function u(){for(let d=e,f=n.length;d<f;d++){const h=n[d];if(null===h.id)break;h.id=null,h.object=null,h.geometry=null,h.material=null,h.group=null}},sort:function l(d,f){t.length>1&&t.sort(d||CZ),i.length>1&&i.sort(f||k2),r.length>1&&r.sort(f||k2)}}}function wZ(){let n=new WeakMap;return{get:function e(i,r){const o=n.get(i);let s;return void 0===o?(s=new U2,n.set(i,[s])):r>=o.length?(s=new U2,o.push(s)):s=o[r],s},dispose:function t(){n=new WeakMap}}}function SZ(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new R,color:new xe};break;case"SpotLight":t={position:new R,direction:new R,color:new xe,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new R,color:new xe,distance:0,decay:0};break;case"HemisphereLight":t={direction:new R,skyColor:new xe,groundColor:new xe};break;case"RectAreaLight":t={color:new xe,position:new R,halfWidth:new R,halfHeight:new R}}return n[e.id]=t,t}}}let EZ=0;function TZ(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function AZ(n){const e=new SZ,t=function PZ(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new re};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new re,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let l=0;l<9;l++)i.probe.push(new R);const r=new R,o=new it,s=new it;return{setup:function a(l){let u=0,d=0,f=0;for(let C=0;C<9;C++)i.probe[C].set(0,0,0);let h=0,p=0,_=0,m=0,g=0,v=0,x=0,y=0,S=0,P=0,T=0;l.sort(TZ);for(let C=0,E=l.length;C<E;C++){const F=l[C],z=F.color,H=F.intensity,W=F.distance;let Y=null;if(F.shadow&&F.shadow.map&&(Y=F.shadow.map.texture.format===ul?F.shadow.map.texture:F.shadow.map.depthTexture||F.shadow.map.texture),F.isAmbientLight)u+=z.r*H,d+=z.g*H,f+=z.b*H;else if(F.isLightProbe){for(let j=0;j<9;j++)i.probe[j].addScaledVector(F.sh.coefficients[j],H);T++}else if(F.isDirectionalLight){const j=e.get(F);if(j.color.copy(F.color).multiplyScalar(F.intensity),F.castShadow){const X=F.shadow,ce=t.get(F);ce.shadowIntensity=X.intensity,ce.shadowBias=X.bias,ce.shadowNormalBias=X.normalBias,ce.shadowRadius=X.radius,ce.shadowMapSize=X.mapSize,i.directionalShadow[h]=ce,i.directionalShadowMap[h]=Y,i.directionalShadowMatrix[h]=F.shadow.matrix,v++}i.directional[h]=j,h++}else if(F.isSpotLight){const j=e.get(F);j.position.setFromMatrixPosition(F.matrixWorld),j.color.copy(z).multiplyScalar(H),j.distance=W,j.coneCos=Math.cos(F.angle),j.penumbraCos=Math.cos(F.angle*(1-F.penumbra)),j.decay=F.decay,i.spot[_]=j;const X=F.shadow;if(F.map&&(i.spotLightMap[S]=F.map,S++,X.updateMatrices(F),F.castShadow&&P++),i.spotLightMatrix[_]=X.matrix,F.castShadow){const ce=t.get(F);ce.shadowIntensity=X.intensity,ce.shadowBias=X.bias,ce.shadowNormalBias=X.normalBias,ce.shadowRadius=X.radius,ce.shadowMapSize=X.mapSize,i.spotShadow[_]=ce,i.spotShadowMap[_]=Y,y++}_++}else if(F.isRectAreaLight){const j=e.get(F);j.color.copy(z).multiplyScalar(H),j.halfWidth.set(.5*F.width,0,0),j.halfHeight.set(0,.5*F.height,0),i.rectArea[m]=j,m++}else if(F.isPointLight){const j=e.get(F);if(j.color.copy(F.color).multiplyScalar(F.intensity),j.distance=F.distance,j.decay=F.decay,F.castShadow){const X=F.shadow,ce=t.get(F);ce.shadowIntensity=X.intensity,ce.shadowBias=X.bias,ce.shadowNormalBias=X.normalBias,ce.shadowRadius=X.radius,ce.shadowMapSize=X.mapSize,ce.shadowCameraNear=X.camera.near,ce.shadowCameraFar=X.camera.far,i.pointShadow[p]=ce,i.pointShadowMap[p]=Y,i.pointShadowMatrix[p]=F.shadow.matrix,x++}i.point[p]=j,p++}else if(F.isHemisphereLight){const j=e.get(F);j.skyColor.copy(F.color).multiplyScalar(H),j.groundColor.copy(F.groundColor).multiplyScalar(H),i.hemi[g]=j,g++}}m>0&&(!0===n.has("OES_texture_float_linear")?(i.rectAreaLTC1=Te.LTC_FLOAT_1,i.rectAreaLTC2=Te.LTC_FLOAT_2):(i.rectAreaLTC1=Te.LTC_HALF_1,i.rectAreaLTC2=Te.LTC_HALF_2)),i.ambient[0]=u,i.ambient[1]=d,i.ambient[2]=f;const I=i.hash;(I.directionalLength!==h||I.pointLength!==p||I.spotLength!==_||I.rectAreaLength!==m||I.hemiLength!==g||I.numDirectionalShadows!==v||I.numPointShadows!==x||I.numSpotShadows!==y||I.numSpotMaps!==S||I.numLightProbes!==T)&&(i.directional.length=h,i.spot.length=_,i.rectArea.length=m,i.point.length=p,i.hemi.length=g,i.directionalShadow.length=v,i.directionalShadowMap.length=v,i.pointShadow.length=x,i.pointShadowMap.length=x,i.spotShadow.length=y,i.spotShadowMap.length=y,i.directionalShadowMatrix.length=v,i.pointShadowMatrix.length=x,i.spotLightMatrix.length=y+S-P,i.spotLightMap.length=S,i.numSpotLightShadowsWithMaps=P,i.numLightProbes=T,I.directionalLength=h,I.pointLength=p,I.spotLength=_,I.rectAreaLength=m,I.hemiLength=g,I.numDirectionalShadows=v,I.numPointShadows=x,I.numSpotShadows=y,I.numSpotMaps=S,I.numLightProbes=T,i.version=EZ++)},setupView:function c(l,u){let d=0,f=0,h=0,p=0,_=0;const m=u.matrixWorldInverse;for(let g=0,v=l.length;g<v;g++){const x=l[g];if(x.isDirectionalLight){const y=i.directional[d];y.direction.setFromMatrixPosition(x.matrixWorld),r.setFromMatrixPosition(x.target.matrixWorld),y.direction.sub(r),y.direction.transformDirection(m),d++}else if(x.isSpotLight){const y=i.spot[h];y.position.setFromMatrixPosition(x.matrixWorld),y.position.applyMatrix4(m),y.direction.setFromMatrixPosition(x.matrixWorld),r.setFromMatrixPosition(x.target.matrixWorld),y.direction.sub(r),y.direction.transformDirection(m),h++}else if(x.isRectAreaLight){const y=i.rectArea[p];y.position.setFromMatrixPosition(x.matrixWorld),y.position.applyMatrix4(m),s.identity(),o.copy(x.matrixWorld),o.premultiply(m),s.extractRotation(o),y.halfWidth.set(.5*x.width,0,0),y.halfHeight.set(0,.5*x.height,0),y.halfWidth.applyMatrix4(s),y.halfHeight.applyMatrix4(s),p++}else if(x.isPointLight){const y=i.point[f];y.position.setFromMatrixPosition(x.matrixWorld),y.position.applyMatrix4(m),f++}else if(x.isHemisphereLight){const y=i.hemi[_];y.direction.setFromMatrixPosition(x.matrixWorld),y.direction.transformDirection(m),_++}}},state:i}}function B2(n){const e=new AZ(n),t=[],i=[],l={lightsArray:t,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:function r(u){l.camera=u,t.length=0,i.length=0},state:l,setupLights:function a(){e.setup(t)},setupLightsView:function c(u){e.setupView(t,u)},pushLight:function o(u){t.push(u)},pushShadow:function s(u){i.push(u)}}}function OZ(n){let e=new WeakMap;return{get:function t(r,o=0){const s=e.get(r);let a;return void 0===s?(a=new B2(n),e.set(r,[a])):o>=s.length?(a=new B2(n),s.push(a)):a=s[o],a},dispose:function i(){e=new WeakMap}}}const RZ=[new R(1,0,0),new R(-1,0,0),new R(0,1,0),new R(0,-1,0),new R(0,0,1),new R(0,0,-1)],NZ=[new R(0,-1,0),new R(0,-1,0),new R(0,0,1),new R(0,0,-1),new R(0,-1,0),new R(0,-1,0)],V2=new it,gf=new R,nb=new R;function LZ(n,e,t){let i=new Kd;const r=new re,o=new re,s=new pn,a=new LI,c=new FI,l={},u=t.maxTextureSize,d={0:1,1:0,2:2},f=new qr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new re},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );\n\tgl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );\n}"}),h=f.clone();h.defines.HORIZONTAL_PASS=1;const p=new pt;p.setAttribute("position",new Wt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new Gt(p,f),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1;let g=this.type;function v(P,T){const I=e.update(_);f.defines.VSM_SAMPLES!==P.blurSamples&&(f.defines.VSM_SAMPLES=P.blurSamples,h.defines.VSM_SAMPLES=P.blurSamples,f.needsUpdate=!0,h.needsUpdate=!0),null===P.mapPass&&(P.mapPass=new br(r.x,r.y,{format:ul,type:Zo})),f.uniforms.shadow_pass.value=P.map.depthTexture,f.uniforms.resolution.value=P.mapSize,f.uniforms.radius.value=P.radius,n.setRenderTarget(P.mapPass),n.clear(),n.renderBufferDirect(T,null,I,f,_,null),h.uniforms.shadow_pass.value=P.mapPass.texture,h.uniforms.resolution.value=P.mapSize,h.uniforms.radius.value=P.radius,n.setRenderTarget(P.map),n.clear(),n.renderBufferDirect(T,null,I,h,_,null)}function x(P,T,I,C){let E=null;const F=!0===I.isPointLight?P.customDistanceMaterial:P.customDepthMaterial;if(void 0!==F)E=F;else if(E=!0===I.isPointLight?c:a,n.localClippingEnabled&&!0===T.clipShadows&&Array.isArray(T.clippingPlanes)&&0!==T.clippingPlanes.length||T.displacementMap&&0!==T.displacementScale||T.alphaMap&&T.alphaTest>0||T.map&&T.alphaTest>0||!0===T.alphaToCoverage){const z=E.uuid,H=T.uuid;let W=l[z];void 0===W&&(W={},l[z]=W);let Y=W[H];void 0===Y&&(Y=E.clone(),W[H]=Y,T.addEventListener("dispose",S)),E=Y}return E.visible=T.visible,E.wireframe=T.wireframe,E.side=3===C?null!==T.shadowSide?T.shadowSide:T.side:null!==T.shadowSide?T.shadowSide:d[T.side],E.alphaMap=T.alphaMap,E.alphaTest=!0===T.alphaToCoverage?.5:T.alphaTest,E.map=T.map,E.clipShadows=T.clipShadows,E.clippingPlanes=T.clippingPlanes,E.clipIntersection=T.clipIntersection,E.displacementMap=T.displacementMap,E.displacementScale=T.displacementScale,E.displacementBias=T.displacementBias,E.wireframeLinewidth=T.wireframeLinewidth,E.linewidth=T.linewidth,!0===I.isPointLight&&!0===E.isMeshDistanceMaterial&&(n.properties.get(E).light=I),E}function y(P,T,I,C,E){if(!1===P.visible)return;if(P.layers.test(T.layers)&&(P.isMesh||P.isLine||P.isPoints)&&(P.castShadow||P.receiveShadow&&3===E)&&(!P.frustumCulled||i.intersectsObject(P))){P.modelViewMatrix.multiplyMatrices(I.matrixWorldInverse,P.matrixWorld);const H=e.update(P),W=P.material;if(Array.isArray(W)){const Y=H.groups;for(let j=0,X=Y.length;j<X;j++){const ce=Y[j],ye=W[ce.materialIndex];if(ye&&ye.visible){const _e=x(P,ye,C,E);P.onBeforeShadow(n,P,T,I,H,_e,ce),n.renderBufferDirect(I,null,H,_e,P,ce),P.onAfterShadow(n,P,T,I,H,_e,ce)}}}else if(W.visible){const Y=x(P,W,C,E);P.onBeforeShadow(n,P,T,I,H,Y,null),n.renderBufferDirect(I,null,H,Y,P,null),P.onAfterShadow(n,P,T,I,H,Y,null)}}const z=P.children;for(let H=0,W=z.length;H<W;H++)y(z[H],T,I,C,E)}function S(P){P.target.removeEventListener("dispose",S);for(const I in l){const C=l[I],E=P.target.uuid;E in C&&(C[E].dispose(),delete C[E])}}this.render=function(P,T,I){if(!1===m.enabled||!1===m.autoUpdate&&!1===m.needsUpdate||0===P.length)return;2===P.type&&(Se("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),P.type=1);const C=n.getRenderTarget(),E=n.getActiveCubeFace(),F=n.getActiveMipmapLevel(),z=n.state;z.setBlending(0),!0===z.buffers.depth.getReversed()?z.buffers.color.setClear(0,0,0,0):z.buffers.color.setClear(1,1,1,1),z.buffers.depth.setTest(!0),z.setScissorTest(!1);const H=g!==this.type;H&&T.traverse(function(W){W.material&&(Array.isArray(W.material)?W.material.forEach(Y=>Y.needsUpdate=!0):W.material.needsUpdate=!0)});for(let W=0,Y=P.length;W<Y;W++){const j=P[W],X=j.shadow;if(void 0===X){Se("WebGLShadowMap:",j,"has no shadow.");continue}if(!1===X.autoUpdate&&!1===X.needsUpdate)continue;r.copy(X.mapSize);const ce=X.getFrameExtents();if(r.multiply(ce),o.copy(X.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(o.x=Math.floor(u/ce.x),r.x=o.x*ce.x,X.mapSize.x=o.x),r.y>u&&(o.y=Math.floor(u/ce.y),r.y=o.y*ce.y,X.mapSize.y=o.y)),null===X.map||!0===H){if(null!==X.map&&(null!==X.map.depthTexture&&(X.map.depthTexture.dispose(),X.map.depthTexture=null),X.map.dispose()),3===this.type){if(j.isPointLight){Se("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}X.map=new br(r.x,r.y,{format:ul,type:Zo,minFilter:on,magFilter:on,generateMipmaps:!1}),X.map.texture.name=j.name+".shadowMap",X.map.depthTexture=new tf(r.x,r.y,Vi),X.map.depthTexture.name=j.name+".shadowMapDepth",X.map.depthTexture.format=Ko,X.map.depthTexture.compareFunction=null,X.map.depthTexture.minFilter=En,X.map.depthTexture.magFilter=En}else{j.isPointLight?(X.map=new qD(r.x),X.map.depthTexture=new iW(r.x,Gr)):(X.map=new br(r.x,r.y),X.map.depthTexture=new tf(r.x,r.y,Gr)),X.map.depthTexture.name=j.name+".shadowMap",X.map.depthTexture.format=Ko;const _e=n.state.buffers.depth.getReversed();1===this.type?(X.map.depthTexture.compareFunction=_e?518:515,X.map.depthTexture.minFilter=on,X.map.depthTexture.magFilter=on):(X.map.depthTexture.compareFunction=null,X.map.depthTexture.minFilter=En,X.map.depthTexture.magFilter=En)}X.camera.updateProjectionMatrix()}const ye=X.map.isWebGLCubeRenderTarget?6:1;for(let _e=0;_e<ye;_e++){if(X.map.isWebGLCubeRenderTarget)n.setRenderTarget(X.map,_e),n.clear();else{0===_e&&(n.setRenderTarget(X.map),n.clear());const Me=X.getViewport(_e);s.set(o.x*Me.x,o.y*Me.y,o.x*Me.z,o.y*Me.w),z.viewport(s)}if(j.isPointLight){const Me=X.camera,_t=X.matrix,Je=j.distance||Me.far;Je!==Me.far&&(Me.far=Je,Me.updateProjectionMatrix()),gf.setFromMatrixPosition(j.matrixWorld),Me.position.copy(gf),nb.copy(Me.position),nb.add(RZ[_e]),Me.up.copy(NZ[_e]),Me.lookAt(nb),Me.updateMatrixWorld(),_t.makeTranslation(-gf.x,-gf.y,-gf.z),V2.multiplyMatrices(Me.projectionMatrix,Me.matrixWorldInverse),X._frustum.setFromProjectionMatrix(V2,Me.coordinateSystem,Me.reversedDepth)}else X.updateMatrices(j);i=X.getFrustum(),y(T,I,X.camera,j,this.type)}!0!==X.isPointLightShadow&&3===this.type&&v(X,I),X.needsUpdate=!1}g=this.type,m.needsUpdate=!1,n.setRenderTarget(C,E,F)}}const FZ={0:1,2:6,4:7,3:5,1:0,6:2,7:4,5:3};function kZ(n,e){const o=new function t(){let k=!1;const Re=new pn;let me=null;const Fe=new pn(0,0,0,0);return{setMask:function(pe){me!==pe&&!k&&(n.colorMask(pe,pe,pe,pe),me=pe)},setLocked:function(pe){k=pe},setClear:function(pe,se,Ce,yt,mn){!0===mn&&(pe*=yt,se*=yt,Ce*=yt),Re.set(pe,se,Ce,yt),!1===Fe.equals(Re)&&(n.clearColor(pe,se,Ce,yt),Fe.copy(Re))},reset:function(){k=!1,me=null,Fe.set(-1,0,0,0)}}},s=new function i(){let k=!1,Re=!1,me=null,Fe=null,pe=null;return{setReversed:function(se){if(Re!==se){const Ce=e.get("EXT_clip_control");Ce.clipControlEXT(Ce.LOWER_LEFT_EXT,se?Ce.ZERO_TO_ONE_EXT:Ce.NEGATIVE_ONE_TO_ONE_EXT),Re=se;const yt=pe;pe=null,this.setClear(yt)}},getReversed:function(){return Re},setTest:function(se){se?le(n.DEPTH_TEST):Ue(n.DEPTH_TEST)},setMask:function(se){me!==se&&!k&&(n.depthMask(se),me=se)},setFunc:function(se){if(Re&&(se=FZ[se]),Fe!==se){switch(se){case 0:n.depthFunc(n.NEVER);break;case 1:n.depthFunc(n.ALWAYS);break;case 2:n.depthFunc(n.LESS);break;case 3:default:n.depthFunc(n.LEQUAL);break;case 4:n.depthFunc(n.EQUAL);break;case 5:n.depthFunc(n.GEQUAL);break;case 6:n.depthFunc(n.GREATER);break;case 7:n.depthFunc(n.NOTEQUAL)}Fe=se}},setLocked:function(se){k=se},setClear:function(se){pe!==se&&(Re&&(se=1-se),n.clearDepth(se),pe=se)},reset:function(){k=!1,me=null,Fe=null,pe=null,Re=!1}}},a=new function r(){let k=!1,Re=null,me=null,Fe=null,pe=null,se=null,Ce=null,yt=null,mn=null;return{setTest:function(Jt){k||(Jt?le(n.STENCIL_TEST):Ue(n.STENCIL_TEST))},setMask:function(Jt){Re!==Jt&&!k&&(n.stencilMask(Jt),Re=Jt)},setFunc:function(Jt,To,us){(me!==Jt||Fe!==To||pe!==us)&&(n.stencilFunc(Jt,To,us),me=Jt,Fe=To,pe=us)},setOp:function(Jt,To,us){(se!==Jt||Ce!==To||yt!==us)&&(n.stencilOp(Jt,To,us),se=Jt,Ce=To,yt=us)},setLocked:function(Jt){k=Jt},setClear:function(Jt){mn!==Jt&&(n.clearStencil(Jt),mn=Jt)},reset:function(){k=!1,Re=null,me=null,Fe=null,pe=null,se=null,Ce=null,yt=null,mn=null}}},c=new WeakMap,l=new WeakMap;let u={},d={},f=new WeakMap,h=[],p=null,_=!1,m=null,g=null,v=null,x=null,y=null,S=null,P=null,T=new xe(0,0,0),I=0,C=!1,E=null,F=null,z=null,H=null,W=null;const Y=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let j=!1,X=0;const ce=n.getParameter(n.VERSION);-1!==ce.indexOf("WebGL")?(X=parseFloat(/^WebGL (\d)/.exec(ce)[1]),j=X>=1):-1!==ce.indexOf("OpenGL ES")&&(X=parseFloat(/^OpenGL ES (\d)/.exec(ce)[1]),j=X>=2);let ye=null,_e={};const Me=n.getParameter(n.SCISSOR_BOX),_t=n.getParameter(n.VIEWPORT),Je=(new pn).fromArray(Me),Lt=(new pn).fromArray(_t);function Ft(k,Re,me,Fe){const pe=new Uint8Array(4),se=n.createTexture();n.bindTexture(k,se),n.texParameteri(k,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(k,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Ce=0;Ce<me;Ce++)k===n.TEXTURE_3D||k===n.TEXTURE_2D_ARRAY?n.texImage3D(Re,0,n.RGBA,1,1,Fe,0,n.RGBA,n.UNSIGNED_BYTE,pe):n.texImage2D(Re+Ce,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,pe);return se}const ee={};function le(k){!0!==u[k]&&(n.enable(k),u[k]=!0)}function Ue(k){!1!==u[k]&&(n.disable(k),u[k]=!1)}ee[n.TEXTURE_2D]=Ft(n.TEXTURE_2D,n.TEXTURE_2D,1),ee[n.TEXTURE_CUBE_MAP]=Ft(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),ee[n.TEXTURE_2D_ARRAY]=Ft(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),ee[n.TEXTURE_3D]=Ft(n.TEXTURE_3D,n.TEXTURE_3D,1,1),o.setClear(0,0,0,1),s.setClear(1),a.setClear(0),le(n.DEPTH_TEST),s.setFunc(3),ue(!1),Ae(1),le(n.CULL_FACE),ae(0);const $t={100:n.FUNC_ADD,101:n.FUNC_SUBTRACT,102:n.FUNC_REVERSE_SUBTRACT};$t[103]=n.MIN,$t[104]=n.MAX;const Ct={200:n.ZERO,201:n.ONE,202:n.SRC_COLOR,204:n.SRC_ALPHA,210:n.SRC_ALPHA_SATURATE,208:n.DST_COLOR,206:n.DST_ALPHA,203:n.ONE_MINUS_SRC_COLOR,205:n.ONE_MINUS_SRC_ALPHA,209:n.ONE_MINUS_DST_COLOR,207:n.ONE_MINUS_DST_ALPHA,211:n.CONSTANT_COLOR,212:n.ONE_MINUS_CONSTANT_COLOR,213:n.CONSTANT_ALPHA,214:n.ONE_MINUS_CONSTANT_ALPHA};function ae(k,Re,me,Fe,pe,se,Ce,yt,mn,Jt){if(0!==k){if(!1===_&&(le(n.BLEND),_=!0),5===k)pe=pe||Re,se=se||me,Ce=Ce||Fe,(Re!==g||pe!==y)&&(n.blendEquationSeparate($t[Re],$t[pe]),g=Re,y=pe),(me!==v||Fe!==x||se!==S||Ce!==P)&&(n.blendFuncSeparate(Ct[me],Ct[Fe],Ct[se],Ct[Ce]),v=me,x=Fe,S=se,P=Ce),(!1===yt.equals(T)||mn!==I)&&(n.blendColor(yt.r,yt.g,yt.b,mn),T.copy(yt),I=mn),m=k,C=!1;else if(k!==m||Jt!==C){if((100!==g||100!==y)&&(n.blendEquation(n.FUNC_ADD),g=100,y=100),Jt)switch(k){case 1:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.ONE,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFuncSeparate(n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA,n.ZERO,n.ONE);break;default:Ze("WebGLState: Invalid blending: ",k)}else switch(k){case 1:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE,n.ONE,n.ONE);break;case 3:Ze("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case 4:Ze("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:Ze("WebGLState: Invalid blending: ",k)}v=null,x=null,S=null,P=null,T.set(0,0,0),I=0,m=k,C=Jt}}else!0===_&&(Ue(n.BLEND),_=!1)}function ue(k){E!==k&&(n.frontFace(k?n.CW:n.CCW),E=k)}function Ae(k){0!==k?(le(n.CULL_FACE),k!==F&&n.cullFace(1===k?n.BACK:2===k?n.FRONT:n.FRONT_AND_BACK)):Ue(n.CULL_FACE),F=k}function Qe(k,Re,me){k?(le(n.POLYGON_OFFSET_FILL),(H!==Re||W!==me)&&(n.polygonOffset(Re,me),H=Re,W=me)):Ue(n.POLYGON_OFFSET_FILL)}return{buffers:{color:o,depth:s,stencil:a},enable:le,disable:Ue,bindFramebuffer:function Ke(k,Re){return d[k]!==Re&&(n.bindFramebuffer(k,Re),d[k]=Re,k===n.DRAW_FRAMEBUFFER&&(d[n.FRAMEBUFFER]=Re),k===n.FRAMEBUFFER&&(d[n.DRAW_FRAMEBUFFER]=Re),!0)},drawBuffers:function Ie(k,Re){let me=h,Fe=!1;if(k){me=f.get(Re),void 0===me&&(me=[],f.set(Re,me));const pe=k.textures;if(me.length!==pe.length||me[0]!==n.COLOR_ATTACHMENT0){for(let se=0,Ce=pe.length;se<Ce;se++)me[se]=n.COLOR_ATTACHMENT0+se;me.length=pe.length,Fe=!0}}else me[0]!==n.BACK&&(me[0]=n.BACK,Fe=!0);Fe&&n.drawBuffers(me)},useProgram:function At(k){return p!==k&&(n.useProgram(k),p=k,!0)},setBlending:ae,setMaterial:function he(k,Re){2===k.side?Ue(n.CULL_FACE):le(n.CULL_FACE);let me=1===k.side;Re&&(me=!me),ue(me),1===k.blending&&!1===k.transparent?ae(0):ae(k.blending,k.blendEquation,k.blendSrc,k.blendDst,k.blendEquationAlpha,k.blendSrcAlpha,k.blendDstAlpha,k.blendColor,k.blendAlpha,k.premultipliedAlpha),s.setFunc(k.depthFunc),s.setTest(k.depthTest),s.setMask(k.depthWrite),o.setMask(k.colorWrite);const Fe=k.stencilWrite;a.setTest(Fe),Fe&&(a.setMask(k.stencilWriteMask),a.setFunc(k.stencilFunc,k.stencilRef,k.stencilFuncMask),a.setOp(k.stencilFail,k.stencilZFail,k.stencilZPass)),Qe(k.polygonOffset,k.polygonOffsetFactor,k.polygonOffsetUnits),!0===k.alphaToCoverage?le(n.SAMPLE_ALPHA_TO_COVERAGE):Ue(n.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:ue,setCullFace:Ae,setLineWidth:function N(k){k!==z&&(j&&n.lineWidth(k),z=k)},setPolygonOffset:Qe,setScissorTest:function Le(k){k?le(n.SCISSOR_TEST):Ue(n.SCISSOR_TEST)},activeTexture:function rt(k){void 0===k&&(k=n.TEXTURE0+Y-1),ye!==k&&(n.activeTexture(k),ye=k)},bindTexture:function ve(k,Re,me){void 0===me&&(me=null===ye?n.TEXTURE0+Y-1:ye);let Fe=_e[me];void 0===Fe&&(Fe={type:void 0,texture:void 0},_e[me]=Fe),(Fe.type!==k||Fe.texture!==Re)&&(ye!==me&&(n.activeTexture(me),ye=me),n.bindTexture(k,Re||ee[k]),Fe.type=k,Fe.texture=Re)},unbindTexture:function D(){const k=_e[ye];void 0!==k&&void 0!==k.type&&(n.bindTexture(k.type,null),k.type=void 0,k.texture=void 0)},compressedTexImage2D:function w(){try{n.compressedTexImage2D(...arguments)}catch(k){Ze("WebGLState:",k)}},compressedTexImage3D:function B(){try{n.compressedTexImage3D(...arguments)}catch(k){Ze("WebGLState:",k)}},texImage2D:function st(){try{n.texImage2D(...arguments)}catch(k){Ze("WebGLState:",k)}},texImage3D:function fe(){try{n.texImage3D(...arguments)}catch(k){Ze("WebGLState:",k)}},updateUBOMapping:function We(k,Re){let me=l.get(Re);void 0===me&&(me=new WeakMap,l.set(Re,me));let Fe=me.get(k);void 0===Fe&&(Fe=n.getUniformBlockIndex(Re,k.name),me.set(k,Fe))},uniformBlockBinding:function we(k,Re){const Fe=l.get(Re).get(k);c.get(Re)!==Fe&&(n.uniformBlockBinding(Re,Fe,k.__bindingPointIndex),c.set(Re,Fe))},texStorage2D:function be(){try{n.texStorage2D(...arguments)}catch(k){Ze("WebGLState:",k)}},texStorage3D:function ze(){try{n.texStorage3D(...arguments)}catch(k){Ze("WebGLState:",k)}},texSubImage2D:function Z(){try{n.texSubImage2D(...arguments)}catch(k){Ze("WebGLState:",k)}},texSubImage3D:function oe(){try{n.texSubImage3D(...arguments)}catch(k){Ze("WebGLState:",k)}},compressedTexSubImage2D:function K(){try{n.compressedTexSubImage2D(...arguments)}catch(k){Ze("WebGLState:",k)}},compressedTexSubImage3D:function Ge(){try{n.compressedTexSubImage3D(...arguments)}catch(k){Ze("WebGLState:",k)}},scissor:function Pe(k){!1===Je.equals(k)&&(n.scissor(k.x,k.y,k.z,k.w),Je.copy(k))},viewport:function He(k){!1===Lt.equals(k)&&(n.viewport(k.x,k.y,k.z,k.w),Lt.copy(k))},reset:function Ot(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),s.setReversed(!1),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),u={},ye=null,_e={},d={},f=new WeakMap,h=[],p=null,_=!1,m=null,g=null,v=null,x=null,y=null,S=null,P=null,T=new xe(0,0,0),I=0,C=!1,E=null,F=null,z=null,H=null,W=null,Je.set(0,0,n.canvas.width,n.canvas.height),Lt.set(0,0,n.canvas.width,n.canvas.height),o.reset(),s.reset(),a.reset()}}}function UZ(n,e,t,i,r,o,s){const a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),l=new re,u=new WeakMap;let d;const f=new WeakMap;let h=!1;try{h=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function p(D,w){return h?new OffscreenCanvas(D,w):kd("canvas")}function _(D,w,B){let Z=1;const oe=ve(D);if((oe.width>B||oe.height>B)&&(Z=B/Math.max(oe.width,oe.height)),Z<1){if(typeof HTMLImageElement<"u"&&D instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&D instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&D instanceof ImageBitmap||typeof VideoFrame<"u"&&D instanceof VideoFrame){const K=Math.floor(Z*oe.width),Ge=Math.floor(Z*oe.height);void 0===d&&(d=p(K,Ge));const be=w?p(K,Ge):d;return be.width=K,be.height=Ge,be.getContext("2d").drawImage(D,0,0,K,Ge),Se("WebGLRenderer: Texture has been resized from ("+oe.width+"x"+oe.height+") to ("+K+"x"+Ge+")."),be}return"data"in D&&Se("WebGLRenderer: Image in DataTexture is too big ("+oe.width+"x"+oe.height+")."),D}return D}function m(D){return D.generateMipmaps}function g(D){n.generateMipmap(D)}function v(D){return D.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:D.isWebGL3DRenderTarget?n.TEXTURE_3D:D.isWebGLArrayRenderTarget||D.isCompressedArrayTexture?n.TEXTURE_2D_ARRAY:n.TEXTURE_2D}function x(D,w,B,Z,oe=!1){if(null!==D){if(void 0!==n[D])return n[D];Se("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+D+"'")}let K=w;if(w===n.RED&&(B===n.FLOAT&&(K=n.R32F),B===n.HALF_FLOAT&&(K=n.R16F),B===n.UNSIGNED_BYTE&&(K=n.R8)),w===n.RED_INTEGER&&(B===n.UNSIGNED_BYTE&&(K=n.R8UI),B===n.UNSIGNED_SHORT&&(K=n.R16UI),B===n.UNSIGNED_INT&&(K=n.R32UI),B===n.BYTE&&(K=n.R8I),B===n.SHORT&&(K=n.R16I),B===n.INT&&(K=n.R32I)),w===n.RG&&(B===n.FLOAT&&(K=n.RG32F),B===n.HALF_FLOAT&&(K=n.RG16F),B===n.UNSIGNED_BYTE&&(K=n.RG8)),w===n.RG_INTEGER&&(B===n.UNSIGNED_BYTE&&(K=n.RG8UI),B===n.UNSIGNED_SHORT&&(K=n.RG16UI),B===n.UNSIGNED_INT&&(K=n.RG32UI),B===n.BYTE&&(K=n.RG8I),B===n.SHORT&&(K=n.RG16I),B===n.INT&&(K=n.RG32I)),w===n.RGB_INTEGER&&(B===n.UNSIGNED_BYTE&&(K=n.RGB8UI),B===n.UNSIGNED_SHORT&&(K=n.RGB16UI),B===n.UNSIGNED_INT&&(K=n.RGB32UI),B===n.BYTE&&(K=n.RGB8I),B===n.SHORT&&(K=n.RGB16I),B===n.INT&&(K=n.RGB32I)),w===n.RGBA_INTEGER&&(B===n.UNSIGNED_BYTE&&(K=n.RGBA8UI),B===n.UNSIGNED_SHORT&&(K=n.RGBA16UI),B===n.UNSIGNED_INT&&(K=n.RGBA32UI),B===n.BYTE&&(K=n.RGBA8I),B===n.SHORT&&(K=n.RGBA16I),B===n.INT&&(K=n.RGBA32I)),w===n.RGB&&(B===n.UNSIGNED_INT_5_9_9_9_REV&&(K=n.RGB9_E5),B===n.UNSIGNED_INT_10F_11F_11F_REV&&(K=n.R11F_G11F_B10F)),w===n.RGBA){const Ge=oe?Kp:Tt.getTransfer(Z);B===n.FLOAT&&(K=n.RGBA32F),B===n.HALF_FLOAT&&(K=n.RGBA16F),B===n.UNSIGNED_BYTE&&(K=Ge===Kt?n.SRGB8_ALPHA8:n.RGBA8),B===n.UNSIGNED_SHORT_4_4_4_4&&(K=n.RGBA4),B===n.UNSIGNED_SHORT_5_5_5_1&&(K=n.RGB5_A1)}return(K===n.R16F||K===n.R32F||K===n.RG16F||K===n.RG32F||K===n.RGBA16F||K===n.RGBA32F)&&e.get("EXT_color_buffer_float"),K}function y(D,w){let B;return D?null===w||w===Gr||w===Rd?B=n.DEPTH24_STENCIL8:w===Vi?B=n.DEPTH32F_STENCIL8:w===Id&&(B=n.DEPTH24_STENCIL8,Se("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===w||w===Gr||w===Rd?B=n.DEPTH_COMPONENT24:w===Vi?B=n.DEPTH_COMPONENT32F:w===Id&&(B=n.DEPTH_COMPONENT16),B}function S(D,w){return!0===m(D)||D.isFramebufferTexture&&D.minFilter!==En&&D.minFilter!==on?Math.log2(Math.max(w.width,w.height))+1:void 0!==D.mipmaps&&D.mipmaps.length>0?D.mipmaps.length:D.isCompressedTexture&&Array.isArray(D.image)?w.mipmaps.length:1}function P(D){const w=D.target;w.removeEventListener("dispose",P),function I(D){const w=i.get(D);if(void 0===w.__webglInit)return;const B=D.source,Z=f.get(B);if(Z){const oe=Z[w.__cacheKey];oe.usedTimes--,0===oe.usedTimes&&C(D),0===Object.keys(Z).length&&f.delete(B)}i.remove(D)}(w),w.isVideoTexture&&u.delete(w)}function T(D){const w=D.target;w.removeEventListener("dispose",T),function E(D){const w=i.get(D);if(D.depthTexture&&(D.depthTexture.dispose(),i.remove(D.depthTexture)),D.isWebGLCubeRenderTarget)for(let Z=0;Z<6;Z++){if(Array.isArray(w.__webglFramebuffer[Z]))for(let oe=0;oe<w.__webglFramebuffer[Z].length;oe++)n.deleteFramebuffer(w.__webglFramebuffer[Z][oe]);else n.deleteFramebuffer(w.__webglFramebuffer[Z]);w.__webglDepthbuffer&&n.deleteRenderbuffer(w.__webglDepthbuffer[Z])}else{if(Array.isArray(w.__webglFramebuffer))for(let Z=0;Z<w.__webglFramebuffer.length;Z++)n.deleteFramebuffer(w.__webglFramebuffer[Z]);else n.deleteFramebuffer(w.__webglFramebuffer);if(w.__webglDepthbuffer&&n.deleteRenderbuffer(w.__webglDepthbuffer),w.__webglMultisampledFramebuffer&&n.deleteFramebuffer(w.__webglMultisampledFramebuffer),w.__webglColorRenderbuffer)for(let Z=0;Z<w.__webglColorRenderbuffer.length;Z++)w.__webglColorRenderbuffer[Z]&&n.deleteRenderbuffer(w.__webglColorRenderbuffer[Z]);w.__webglDepthRenderbuffer&&n.deleteRenderbuffer(w.__webglDepthRenderbuffer)}const B=D.textures;for(let Z=0,oe=B.length;Z<oe;Z++){const K=i.get(B[Z]);K.__webglTexture&&(n.deleteTexture(K.__webglTexture),s.memory.textures--),i.remove(B[Z])}i.remove(D)}(w)}function C(D){const w=i.get(D);n.deleteTexture(w.__webglTexture),delete f.get(D.source)[w.__cacheKey],s.memory.textures--}let F=0;function Y(D,w){const B=i.get(D);if(D.isVideoTexture&&function Le(D){const w=s.render.frame;u.get(D)!==w&&(u.set(D,w),D.update())}(D),!1===D.isRenderTargetTexture&&!0!==D.isExternalTexture&&D.version>0&&B.__version!==D.version){const Z=D.image;if(null===Z)Se("WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==Z.complete)return void ee(B,D,w);Se("WebGLRenderer: Texture marked for update but image is incomplete")}}else D.isExternalTexture&&(B.__webglTexture=D.sourceTexture?D.sourceTexture:null);t.bindTexture(n.TEXTURE_2D,B.__webglTexture,n.TEXTURE0+w)}const ye={[Ds]:n.REPEAT,[Bi]:n.CLAMP_TO_EDGE,1002:n.MIRRORED_REPEAT},_e={[En]:n.NEAREST,1004:n.NEAREST_MIPMAP_NEAREST,[ll]:n.NEAREST_MIPMAP_LINEAR,[on]:n.LINEAR,1007:n.LINEAR_MIPMAP_NEAREST,[Hr]:n.LINEAR_MIPMAP_LINEAR},Me={512:n.NEVER,519:n.ALWAYS,513:n.LESS,515:n.LEQUAL,514:n.EQUAL,518:n.GEQUAL,516:n.GREATER,517:n.NOTEQUAL};function _t(D,w){if(w.type===Vi&&!1===e.has("OES_texture_float_linear")&&(w.magFilter===on||1007===w.magFilter||w.magFilter===ll||w.magFilter===Hr||w.minFilter===on||1007===w.minFilter||w.minFilter===ll||w.minFilter===Hr)&&Se("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(D,n.TEXTURE_WRAP_S,ye[w.wrapS]),n.texParameteri(D,n.TEXTURE_WRAP_T,ye[w.wrapT]),(D===n.TEXTURE_3D||D===n.TEXTURE_2D_ARRAY)&&n.texParameteri(D,n.TEXTURE_WRAP_R,ye[w.wrapR]),n.texParameteri(D,n.TEXTURE_MAG_FILTER,_e[w.magFilter]),n.texParameteri(D,n.TEXTURE_MIN_FILTER,_e[w.minFilter]),w.compareFunction&&(n.texParameteri(D,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(D,n.TEXTURE_COMPARE_FUNC,Me[w.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){if(w.magFilter===En||w.minFilter!==ll&&w.minFilter!==Hr||w.type===Vi&&!1===e.has("OES_texture_float_linear"))return;if(w.anisotropy>1||i.get(w).__currentAnisotropy){const B=e.get("EXT_texture_filter_anisotropic");n.texParameterf(D,B.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(w.anisotropy,r.getMaxAnisotropy())),i.get(w).__currentAnisotropy=w.anisotropy}}}function Je(D,w){let B=!1;void 0===D.__webglInit&&(D.__webglInit=!0,w.addEventListener("dispose",P));const Z=w.source;let oe=f.get(Z);void 0===oe&&(oe={},f.set(Z,oe));const K=function W(D){const w=[];return w.push(D.wrapS),w.push(D.wrapT),w.push(D.wrapR||0),w.push(D.magFilter),w.push(D.minFilter),w.push(D.anisotropy),w.push(D.internalFormat),w.push(D.format),w.push(D.type),w.push(D.generateMipmaps),w.push(D.premultiplyAlpha),w.push(D.flipY),w.push(D.unpackAlignment),w.push(D.colorSpace),w.join()}(w);if(K!==D.__cacheKey){void 0===oe[K]&&(oe[K]={texture:n.createTexture(),usedTimes:0},s.memory.textures++,B=!0),oe[K].usedTimes++;const Ge=oe[D.__cacheKey];void 0!==Ge&&(oe[D.__cacheKey].usedTimes--,0===Ge.usedTimes&&C(w)),D.__cacheKey=K,D.__webglTexture=oe[K].texture}return B}function Lt(D,w,B){return Math.floor(Math.floor(D/B)/w)}function ee(D,w,B){let Z=n.TEXTURE_2D;(w.isDataArrayTexture||w.isCompressedArrayTexture)&&(Z=n.TEXTURE_2D_ARRAY),w.isData3DTexture&&(Z=n.TEXTURE_3D);const oe=Je(D,w),K=w.source;t.bindTexture(Z,D.__webglTexture,n.TEXTURE0+B);const Ge=i.get(K);if(K.version!==Ge.__version||!0===oe){t.activeTexture(n.TEXTURE0+B);const be=Tt.getPrimaries(Tt.workingColorSpace),ze=""===w.colorSpace?null:Tt.getPrimaries(w.colorSpace),st=""===w.colorSpace||be===ze?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,w.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,w.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,w.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,st);let fe=_(w.image,!1,r.maxTextureSize);fe=rt(w,fe);const Pe=o.convert(w.format,w.colorSpace),He=o.convert(w.type);let we,We=x(w.internalFormat,Pe,He,w.colorSpace,w.isVideoTexture);_t(Z,w);const Ot=w.mipmaps,k=!0!==w.isVideoTexture,Re=void 0===Ge.__version||!0===oe,me=K.dataReady,Fe=S(w,fe);if(w.isDepthTexture)We=y(w.format===xa,w.type),Re&&(k?t.texStorage2D(n.TEXTURE_2D,1,We,fe.width,fe.height):t.texImage2D(n.TEXTURE_2D,0,We,fe.width,fe.height,0,Pe,He,null));else if(w.isDataTexture)if(Ot.length>0){k&&Re&&t.texStorage2D(n.TEXTURE_2D,Fe,We,Ot[0].width,Ot[0].height);for(let pe=0,se=Ot.length;pe<se;pe++)we=Ot[pe],k?me&&t.texSubImage2D(n.TEXTURE_2D,pe,0,0,we.width,we.height,Pe,He,we.data):t.texImage2D(n.TEXTURE_2D,pe,We,we.width,we.height,0,Pe,He,we.data);w.generateMipmaps=!1}else k?(Re&&t.texStorage2D(n.TEXTURE_2D,Fe,We,fe.width,fe.height),me&&function Ft(D,w,B,Z){const K=D.updateRanges;if(0===K.length)t.texSubImage2D(n.TEXTURE_2D,0,0,0,w.width,w.height,B,Z,w.data);else{K.sort((fe,Pe)=>fe.start-Pe.start);let Ge=0;for(let fe=1;fe<K.length;fe++){const Pe=K[Ge],He=K[fe],We=Pe.start+Pe.count,we=Lt(He.start,w.width,4),Ot=Lt(Pe.start,w.width,4);He.start<=We+1&&we===Ot&&Lt(He.start+He.count-1,w.width,4)===we?Pe.count=Math.max(Pe.count,He.start+He.count-Pe.start):(++Ge,K[Ge]=He)}K.length=Ge+1;const be=n.getParameter(n.UNPACK_ROW_LENGTH),ze=n.getParameter(n.UNPACK_SKIP_PIXELS),st=n.getParameter(n.UNPACK_SKIP_ROWS);n.pixelStorei(n.UNPACK_ROW_LENGTH,w.width);for(let fe=0,Pe=K.length;fe<Pe;fe++){const He=K[fe],We=Math.floor(He.start/4),we=Math.ceil(He.count/4),Ot=We%w.width,k=Math.floor(We/w.width),Re=we,me=1;n.pixelStorei(n.UNPACK_SKIP_PIXELS,Ot),n.pixelStorei(n.UNPACK_SKIP_ROWS,k),t.texSubImage2D(n.TEXTURE_2D,0,Ot,k,Re,me,B,Z,w.data)}D.clearUpdateRanges(),n.pixelStorei(n.UNPACK_ROW_LENGTH,be),n.pixelStorei(n.UNPACK_SKIP_PIXELS,ze),n.pixelStorei(n.UNPACK_SKIP_ROWS,st)}}(w,fe,Pe,He)):t.texImage2D(n.TEXTURE_2D,0,We,fe.width,fe.height,0,Pe,He,fe.data);else if(w.isCompressedTexture)if(w.isCompressedArrayTexture){k&&Re&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Fe,We,Ot[0].width,Ot[0].height,fe.depth);for(let pe=0,se=Ot.length;pe<se;pe++)if(we=Ot[pe],w.format!==zi)if(null!==Pe)if(k){if(me)if(w.layerUpdates.size>0){const Ce=XM(we.width,we.height,w.format,w.type);for(const yt of w.layerUpdates){const mn=we.data.subarray(yt*Ce/we.data.BYTES_PER_ELEMENT,(yt+1)*Ce/we.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,pe,0,0,yt,we.width,we.height,1,Pe,mn)}w.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,pe,0,0,0,we.width,we.height,fe.depth,Pe,we.data)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,pe,We,we.width,we.height,fe.depth,0,we.data,0,0);else Se("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else k?me&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,pe,0,0,0,we.width,we.height,fe.depth,Pe,He,we.data):t.texImage3D(n.TEXTURE_2D_ARRAY,pe,We,we.width,we.height,fe.depth,0,Pe,He,we.data)}else{k&&Re&&t.texStorage2D(n.TEXTURE_2D,Fe,We,Ot[0].width,Ot[0].height);for(let pe=0,se=Ot.length;pe<se;pe++)we=Ot[pe],w.format!==zi?null!==Pe?k?me&&t.compressedTexSubImage2D(n.TEXTURE_2D,pe,0,0,we.width,we.height,Pe,we.data):t.compressedTexImage2D(n.TEXTURE_2D,pe,We,we.width,we.height,0,we.data):Se("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):k?me&&t.texSubImage2D(n.TEXTURE_2D,pe,0,0,we.width,we.height,Pe,He,we.data):t.texImage2D(n.TEXTURE_2D,pe,We,we.width,we.height,0,Pe,He,we.data)}else if(w.isDataArrayTexture)if(k){if(Re&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Fe,We,fe.width,fe.height,fe.depth),me)if(w.layerUpdates.size>0){const pe=XM(fe.width,fe.height,w.format,w.type);for(const se of w.layerUpdates){const Ce=fe.data.subarray(se*pe/fe.data.BYTES_PER_ELEMENT,(se+1)*pe/fe.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,se,fe.width,fe.height,1,Pe,He,Ce)}w.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,fe.width,fe.height,fe.depth,Pe,He,fe.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,We,fe.width,fe.height,fe.depth,0,Pe,He,fe.data);else if(w.isData3DTexture)k?(Re&&t.texStorage3D(n.TEXTURE_3D,Fe,We,fe.width,fe.height,fe.depth),me&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,fe.width,fe.height,fe.depth,Pe,He,fe.data)):t.texImage3D(n.TEXTURE_3D,0,We,fe.width,fe.height,fe.depth,0,Pe,He,fe.data);else if(w.isFramebufferTexture){if(Re)if(k)t.texStorage2D(n.TEXTURE_2D,Fe,We,fe.width,fe.height);else{let pe=fe.width,se=fe.height;for(let Ce=0;Ce<Fe;Ce++)t.texImage2D(n.TEXTURE_2D,Ce,We,pe,se,0,Pe,He,null),pe>>=1,se>>=1}}else if(Ot.length>0){if(k&&Re){const pe=ve(Ot[0]);t.texStorage2D(n.TEXTURE_2D,Fe,We,pe.width,pe.height)}for(let pe=0,se=Ot.length;pe<se;pe++)we=Ot[pe],k?me&&t.texSubImage2D(n.TEXTURE_2D,pe,0,0,Pe,He,we):t.texImage2D(n.TEXTURE_2D,pe,We,Pe,He,we);w.generateMipmaps=!1}else if(k){if(Re){const pe=ve(fe);t.texStorage2D(n.TEXTURE_2D,Fe,We,pe.width,pe.height)}me&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,Pe,He,fe)}else t.texImage2D(n.TEXTURE_2D,0,We,Pe,He,fe);m(w)&&g(Z),Ge.__version=K.version,w.onUpdate&&w.onUpdate(w)}D.__version=w.version}function Ue(D,w,B,Z,oe,K){const Ge=o.convert(B.format,B.colorSpace),be=o.convert(B.type),ze=x(B.internalFormat,Ge,be,B.colorSpace),st=i.get(w),fe=i.get(B);if(fe.__renderTarget=w,!st.__hasExternalTextures){const Pe=Math.max(1,w.width>>K),He=Math.max(1,w.height>>K);oe===n.TEXTURE_3D||oe===n.TEXTURE_2D_ARRAY?t.texImage3D(oe,K,ze,Pe,He,w.depth,0,Ge,be,null):t.texImage2D(oe,K,ze,Pe,He,0,Ge,be,null)}t.bindFramebuffer(n.FRAMEBUFFER,D),Qe(w)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,Z,oe,fe.__webglTexture,0,N(w)):(oe===n.TEXTURE_2D||oe>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&oe<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,Z,oe,fe.__webglTexture,K),t.bindFramebuffer(n.FRAMEBUFFER,null)}function Ke(D,w,B){if(n.bindRenderbuffer(n.RENDERBUFFER,D),w.depthBuffer){const Z=w.depthTexture,K=y(w.stencilBuffer,Z&&Z.isDepthTexture?Z.type:null),Ge=w.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;Qe(w)?a.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,N(w),K,w.width,w.height):B?n.renderbufferStorageMultisample(n.RENDERBUFFER,N(w),K,w.width,w.height):n.renderbufferStorage(n.RENDERBUFFER,K,w.width,w.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,Ge,n.RENDERBUFFER,D)}else{const Z=w.textures;for(let oe=0;oe<Z.length;oe++){const K=Z[oe],Ge=o.convert(K.format,K.colorSpace),be=o.convert(K.type),ze=x(K.internalFormat,Ge,be,K.colorSpace);Qe(w)?a.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,N(w),ze,w.width,w.height):B?n.renderbufferStorageMultisample(n.RENDERBUFFER,N(w),ze,w.width,w.height):n.renderbufferStorage(n.RENDERBUFFER,ze,w.width,w.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function Ie(D,w,B){const Z=!0===w.isWebGLCubeRenderTarget;if(t.bindFramebuffer(n.FRAMEBUFFER,D),!w.depthTexture||!w.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const oe=i.get(w.depthTexture);if(oe.__renderTarget=w,(!oe.__webglTexture||w.depthTexture.image.width!==w.width||w.depthTexture.image.height!==w.height)&&(w.depthTexture.image.width=w.width,w.depthTexture.image.height=w.height,w.depthTexture.needsUpdate=!0),Z){if(void 0===oe.__webglInit&&(oe.__webglInit=!0,w.depthTexture.addEventListener("dispose",P)),void 0===oe.__webglTexture){oe.__webglTexture=n.createTexture(),t.bindTexture(n.TEXTURE_CUBE_MAP,oe.__webglTexture),_t(n.TEXTURE_CUBE_MAP,w.depthTexture);const st=o.convert(w.depthTexture.format),fe=o.convert(w.depthTexture.type);let Pe;w.depthTexture.format===Ko?Pe=n.DEPTH_COMPONENT24:w.depthTexture.format===xa&&(Pe=n.DEPTH24_STENCIL8);for(let He=0;He<6;He++)n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+He,0,Pe,w.width,w.height,0,st,fe,null)}}else Y(w.depthTexture,0);const K=oe.__webglTexture,Ge=N(w),be=Z?n.TEXTURE_CUBE_MAP_POSITIVE_X+B:n.TEXTURE_2D,ze=w.depthTexture.format===xa?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;if(w.depthTexture.format===Ko)Qe(w)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,ze,be,K,0,Ge):n.framebufferTexture2D(n.FRAMEBUFFER,ze,be,K,0);else{if(w.depthTexture.format!==xa)throw new Error("Unknown depthTexture format");Qe(w)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,ze,be,K,0,Ge):n.framebufferTexture2D(n.FRAMEBUFFER,ze,be,K,0)}}function At(D){const w=i.get(D),B=!0===D.isWebGLCubeRenderTarget;if(w.__boundDepthTexture!==D.depthTexture){const Z=D.depthTexture;if(w.__depthDisposeCallback&&w.__depthDisposeCallback(),Z){const oe=()=>{delete w.__boundDepthTexture,delete w.__depthDisposeCallback,Z.removeEventListener("dispose",oe)};Z.addEventListener("dispose",oe),w.__depthDisposeCallback=oe}w.__boundDepthTexture=Z}if(D.depthTexture&&!w.__autoAllocateDepthBuffer)if(B)for(let Z=0;Z<6;Z++)Ie(w.__webglFramebuffer[Z],D,Z);else{const Z=D.texture.mipmaps;Ie(Z&&Z.length>0?w.__webglFramebuffer[0]:w.__webglFramebuffer,D,0)}else if(B){w.__webglDepthbuffer=[];for(let Z=0;Z<6;Z++)if(t.bindFramebuffer(n.FRAMEBUFFER,w.__webglFramebuffer[Z]),void 0===w.__webglDepthbuffer[Z])w.__webglDepthbuffer[Z]=n.createRenderbuffer(),Ke(w.__webglDepthbuffer[Z],D,!1);else{const oe=D.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,K=w.__webglDepthbuffer[Z];n.bindRenderbuffer(n.RENDERBUFFER,K),n.framebufferRenderbuffer(n.FRAMEBUFFER,oe,n.RENDERBUFFER,K)}}else{const Z=D.texture.mipmaps;if(t.bindFramebuffer(n.FRAMEBUFFER,Z&&Z.length>0?w.__webglFramebuffer[0]:w.__webglFramebuffer),void 0===w.__webglDepthbuffer)w.__webglDepthbuffer=n.createRenderbuffer(),Ke(w.__webglDepthbuffer,D,!1);else{const oe=D.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,K=w.__webglDepthbuffer;n.bindRenderbuffer(n.RENDERBUFFER,K),n.framebufferRenderbuffer(n.FRAMEBUFFER,oe,n.RENDERBUFFER,K)}}t.bindFramebuffer(n.FRAMEBUFFER,null)}const he=[],ue=[];function N(D){return Math.min(r.maxSamples,D.samples)}function Qe(D){const w=i.get(D);return D.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==w.__useRenderToTexture}function rt(D,w){const B=D.colorSpace,Z=D.format,oe=D.type;return!0===D.isCompressedTexture||!0===D.isVideoTexture||B!==bi&&""!==B&&(Tt.getTransfer(B)===Kt?(Z!==zi||oe!==rr)&&Se("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):Ze("WebGLTextures: Unsupported texture color space:",B)),w}function ve(D){return typeof HTMLImageElement<"u"&&D instanceof HTMLImageElement?(l.width=D.naturalWidth||D.width,l.height=D.naturalHeight||D.height):typeof VideoFrame<"u"&&D instanceof VideoFrame?(l.width=D.displayWidth,l.height=D.displayHeight):(l.width=D.width,l.height=D.height),l}this.allocateTextureUnit=function H(){const D=F;return D>=r.maxTextures&&Se("WebGLTextures: Trying to use "+D+" texture units while this GPU supports only "+r.maxTextures),F+=1,D},this.resetTextureUnits=function z(){F=0},this.setTexture2D=Y,this.setTexture2DArray=function j(D,w){const B=i.get(D);!1===D.isRenderTargetTexture&&D.version>0&&B.__version!==D.version?ee(B,D,w):(D.isExternalTexture&&(B.__webglTexture=D.sourceTexture?D.sourceTexture:null),t.bindTexture(n.TEXTURE_2D_ARRAY,B.__webglTexture,n.TEXTURE0+w))},this.setTexture3D=function X(D,w){const B=i.get(D);!1===D.isRenderTargetTexture&&D.version>0&&B.__version!==D.version?ee(B,D,w):t.bindTexture(n.TEXTURE_3D,B.__webglTexture,n.TEXTURE0+w)},this.setTextureCube=function ce(D,w){const B=i.get(D);!0!==D.isCubeDepthTexture&&D.version>0&&B.__version!==D.version?function le(D,w,B){if(6!==w.image.length)return;const Z=Je(D,w),oe=w.source;t.bindTexture(n.TEXTURE_CUBE_MAP,D.__webglTexture,n.TEXTURE0+B);const K=i.get(oe);if(oe.version!==K.__version||!0===Z){t.activeTexture(n.TEXTURE0+B);const Ge=Tt.getPrimaries(Tt.workingColorSpace),be=""===w.colorSpace?null:Tt.getPrimaries(w.colorSpace),ze=""===w.colorSpace||Ge===be?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,w.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,w.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,w.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,ze);const st=w.isCompressedTexture||w.image[0].isCompressedTexture,fe=w.image[0]&&w.image[0].isDataTexture,Pe=[];for(let se=0;se<6;se++)Pe[se]=st||fe?fe?w.image[se].image:w.image[se]:_(w.image[se],!0,r.maxCubemapSize),Pe[se]=rt(w,Pe[se]);const He=Pe[0],We=o.convert(w.format,w.colorSpace),we=o.convert(w.type),Ot=x(w.internalFormat,We,we,w.colorSpace),k=!0!==w.isVideoTexture,Re=void 0===K.__version||!0===Z,me=oe.dataReady;let pe,Fe=S(w,He);if(_t(n.TEXTURE_CUBE_MAP,w),st){k&&Re&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Fe,Ot,He.width,He.height);for(let se=0;se<6;se++){pe=Pe[se].mipmaps;for(let Ce=0;Ce<pe.length;Ce++){const yt=pe[Ce];w.format!==zi?null!==We?k?me&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,Ce,0,0,yt.width,yt.height,We,yt.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,Ce,Ot,yt.width,yt.height,0,yt.data):Se("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):k?me&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,Ce,0,0,yt.width,yt.height,We,we,yt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,Ce,Ot,yt.width,yt.height,0,We,we,yt.data)}}}else{if(pe=w.mipmaps,k&&Re){pe.length>0&&Fe++;const se=ve(Pe[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,Fe,Ot,se.width,se.height)}for(let se=0;se<6;se++)if(fe){k?me&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,0,0,0,Pe[se].width,Pe[se].height,We,we,Pe[se].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,0,Ot,Pe[se].width,Pe[se].height,0,We,we,Pe[se].data);for(let Ce=0;Ce<pe.length;Ce++){const mn=pe[Ce].image[se].image;k?me&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,Ce+1,0,0,mn.width,mn.height,We,we,mn.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,Ce+1,Ot,mn.width,mn.height,0,We,we,mn.data)}}else{k?me&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,0,0,0,We,we,Pe[se]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,0,Ot,We,we,Pe[se]);for(let Ce=0;Ce<pe.length;Ce++){const yt=pe[Ce];k?me&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,Ce+1,0,0,We,we,yt.image[se]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+se,Ce+1,Ot,We,we,yt.image[se])}}}m(w)&&g(n.TEXTURE_CUBE_MAP),K.__version=oe.version,w.onUpdate&&w.onUpdate(w)}D.__version=w.version}(B,D,w):t.bindTexture(n.TEXTURE_CUBE_MAP,B.__webglTexture,n.TEXTURE0+w)},this.rebindTextures=function $t(D,w,B){const Z=i.get(D);void 0!==w&&Ue(Z.__webglFramebuffer,D,D.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),void 0!==B&&At(D)},this.setupRenderTarget=function Ct(D){const w=D.texture,B=i.get(D),Z=i.get(w);D.addEventListener("dispose",T);const oe=D.textures,K=!0===D.isWebGLCubeRenderTarget,Ge=oe.length>1;if(Ge||(void 0===Z.__webglTexture&&(Z.__webglTexture=n.createTexture()),Z.__version=w.version,s.memory.textures++),K){B.__webglFramebuffer=[];for(let be=0;be<6;be++)if(w.mipmaps&&w.mipmaps.length>0){B.__webglFramebuffer[be]=[];for(let ze=0;ze<w.mipmaps.length;ze++)B.__webglFramebuffer[be][ze]=n.createFramebuffer()}else B.__webglFramebuffer[be]=n.createFramebuffer()}else{if(w.mipmaps&&w.mipmaps.length>0){B.__webglFramebuffer=[];for(let be=0;be<w.mipmaps.length;be++)B.__webglFramebuffer[be]=n.createFramebuffer()}else B.__webglFramebuffer=n.createFramebuffer();if(Ge)for(let be=0,ze=oe.length;be<ze;be++){const st=i.get(oe[be]);void 0===st.__webglTexture&&(st.__webglTexture=n.createTexture(),s.memory.textures++)}if(D.samples>0&&!1===Qe(D)){B.__webglMultisampledFramebuffer=n.createFramebuffer(),B.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,B.__webglMultisampledFramebuffer);for(let be=0;be<oe.length;be++){const ze=oe[be];B.__webglColorRenderbuffer[be]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,B.__webglColorRenderbuffer[be]);const st=o.convert(ze.format,ze.colorSpace),fe=o.convert(ze.type),Pe=x(ze.internalFormat,st,fe,ze.colorSpace,!0===D.isXRRenderTarget),He=N(D);n.renderbufferStorageMultisample(n.RENDERBUFFER,He,Pe,D.width,D.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+be,n.RENDERBUFFER,B.__webglColorRenderbuffer[be])}n.bindRenderbuffer(n.RENDERBUFFER,null),D.depthBuffer&&(B.__webglDepthRenderbuffer=n.createRenderbuffer(),Ke(B.__webglDepthRenderbuffer,D,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(K){t.bindTexture(n.TEXTURE_CUBE_MAP,Z.__webglTexture),_t(n.TEXTURE_CUBE_MAP,w);for(let be=0;be<6;be++)if(w.mipmaps&&w.mipmaps.length>0)for(let ze=0;ze<w.mipmaps.length;ze++)Ue(B.__webglFramebuffer[be][ze],D,w,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+be,ze);else Ue(B.__webglFramebuffer[be],D,w,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+be,0);m(w)&&g(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Ge){for(let be=0,ze=oe.length;be<ze;be++){const st=oe[be],fe=i.get(st);let Pe=n.TEXTURE_2D;(D.isWebGL3DRenderTarget||D.isWebGLArrayRenderTarget)&&(Pe=D.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(Pe,fe.__webglTexture),_t(Pe,st),Ue(B.__webglFramebuffer,D,st,n.COLOR_ATTACHMENT0+be,Pe,0),m(st)&&g(Pe)}t.unbindTexture()}else{let be=n.TEXTURE_2D;if((D.isWebGL3DRenderTarget||D.isWebGLArrayRenderTarget)&&(be=D.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(be,Z.__webglTexture),_t(be,w),w.mipmaps&&w.mipmaps.length>0)for(let ze=0;ze<w.mipmaps.length;ze++)Ue(B.__webglFramebuffer[ze],D,w,n.COLOR_ATTACHMENT0,be,ze);else Ue(B.__webglFramebuffer,D,w,n.COLOR_ATTACHMENT0,be,0);m(w)&&g(be),t.unbindTexture()}D.depthBuffer&&At(D)},this.updateRenderTargetMipmap=function ae(D){const w=D.textures;for(let B=0,Z=w.length;B<Z;B++){const oe=w[B];if(m(oe)){const K=v(D),Ge=i.get(oe).__webglTexture;t.bindTexture(K,Ge),g(K),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Ae(D){if(D.samples>0)if(!1===Qe(D)){const w=D.textures,B=D.width,Z=D.height;let oe=n.COLOR_BUFFER_BIT;const K=D.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ge=i.get(D),be=w.length>1;if(be)for(let st=0;st<w.length;st++)t.bindFramebuffer(n.FRAMEBUFFER,Ge.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+st,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Ge.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+st,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Ge.__webglMultisampledFramebuffer);const ze=D.texture.mipmaps;t.bindFramebuffer(n.DRAW_FRAMEBUFFER,ze&&ze.length>0?Ge.__webglFramebuffer[0]:Ge.__webglFramebuffer);for(let st=0;st<w.length;st++){if(D.resolveDepthBuffer&&(D.depthBuffer&&(oe|=n.DEPTH_BUFFER_BIT),D.stencilBuffer&&D.resolveStencilBuffer&&(oe|=n.STENCIL_BUFFER_BIT)),be){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Ge.__webglColorRenderbuffer[st]);const fe=i.get(w[st]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,fe,0)}n.blitFramebuffer(0,0,B,Z,0,0,B,Z,oe,n.NEAREST),!0===c&&(he.length=0,ue.length=0,he.push(n.COLOR_ATTACHMENT0+st),D.depthBuffer&&!1===D.resolveDepthBuffer&&(he.push(K),ue.push(K),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,ue)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,he))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),be)for(let st=0;st<w.length;st++){t.bindFramebuffer(n.FRAMEBUFFER,Ge.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+st,n.RENDERBUFFER,Ge.__webglColorRenderbuffer[st]);const fe=i.get(w[st]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Ge.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+st,n.TEXTURE_2D,fe,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ge.__webglMultisampledFramebuffer)}else D.depthBuffer&&!1===D.resolveDepthBuffer&&c&&n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[D.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT])},this.setupDepthRenderbuffer=At,this.setupFrameBufferTexture=Ue,this.useMultisampledRTT=Qe,this.isReversedDepthBuffer=function(){return t.buffers.depth.getReversed()}}function BZ(n,e){return{convert:function t(i,r=""){let o;const s=Tt.getTransfer(r);if(i===rr)return n.UNSIGNED_BYTE;if(i===Ux)return n.UNSIGNED_SHORT_4_4_4_4;if(i===Bx)return n.UNSIGNED_SHORT_5_5_5_1;if(i===pD)return n.UNSIGNED_INT_5_9_9_9_REV;if(i===gD)return n.UNSIGNED_INT_10F_11F_11F_REV;if(i===fD)return n.BYTE;if(i===hD)return n.SHORT;if(i===Id)return n.UNSIGNED_SHORT;if(i===kx)return n.INT;if(i===Gr)return n.UNSIGNED_INT;if(i===Vi)return n.FLOAT;if(i===Zo)return n.HALF_FLOAT;if(i===mD)return n.ALPHA;if(i===_D)return n.RGB;if(i===zi)return n.RGBA;if(i===Ko)return n.DEPTH_COMPONENT;if(i===xa)return n.DEPTH_STENCIL;if(i===Vx)return n.RED;if(i===Wp)return n.RED_INTEGER;if(i===ul)return n.RG;if(i===zx)return n.RG_INTEGER;if(i===Hx)return n.RGBA_INTEGER;if(i===$p||i===qp||i===Xp||i===Yp)if(s===Kt){if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===o)return null;if(i===$p)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===qp)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===Xp)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===Yp)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(o=e.get("WEBGL_compressed_texture_s3tc"),null===o)return null;if(i===$p)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===qp)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===Xp)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===Yp)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(i===Gx||i===jx||i===Wx||i===$x){if(o=e.get("WEBGL_compressed_texture_pvrtc"),null===o)return null;if(i===Gx)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===jx)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===Wx)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===$x)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(i===qx||i===Xx||i===Yx||i===Zx||i===Kx||i===Jx||i===Qx){if(o=e.get("WEBGL_compressed_texture_etc"),null===o)return null;if(i===qx||i===Xx)return s===Kt?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(i===Yx)return s===Kt?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC;if(i===Zx)return o.COMPRESSED_R11_EAC;if(i===Kx)return o.COMPRESSED_SIGNED_R11_EAC;if(i===Jx)return o.COMPRESSED_RG11_EAC;if(i===Qx)return o.COMPRESSED_SIGNED_RG11_EAC}if(i===ey||i===ty||i===ny||i===iy||i===ry||i===oy||i===sy||i===ay||i===cy||i===ly||i===uy||i===dy||i===fy||i===hy){if(o=e.get("WEBGL_compressed_texture_astc"),null===o)return null;if(i===ey)return s===Kt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===ty)return s===Kt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===ny)return s===Kt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===iy)return s===Kt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===ry)return s===Kt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===oy)return s===Kt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===sy)return s===Kt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===ay)return s===Kt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===cy)return s===Kt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===ly)return s===Kt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===uy)return s===Kt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===dy)return s===Kt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===fy)return s===Kt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===hy)return s===Kt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}if(i===py||i===gy||i===my){if(o=e.get("EXT_texture_compression_bptc"),null===o)return null;if(i===py)return s===Kt?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===gy)return o.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===my)return o.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(i===_y||i===vy||i===xy||i===yy){if(o=e.get("EXT_texture_compression_rgtc"),null===o)return null;if(i===_y)return o.COMPRESSED_RED_RGTC1_EXT;if(i===vy)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===xy)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===yy)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return i===Rd?n.UNSIGNED_INT_24_8:void 0!==n[i]?n[i]:null}}}class HZ{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(null===this.texture){const i=new vI(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=i}}getMesh(e){if(null!==this.texture&&null===this.mesh){const t=e.cameras[0].viewport,i=new qr({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Gt(new Hs(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class GZ extends Jo{constructor(e,t){super();const i=this;let r=null,o=1,s=null,a="local-floor",c=1,l=null,u=null,d=null,f=null,h=null,p=null;const _=typeof XRWebGLBinding<"u",m=new HZ,g={},v=t.getContextAttributes();let x=null,y=null;const S=[],P=[],T=new re;let I=null;const C=new jn;C.viewport=new pn;const E=new jn;E.viewport=new pn;const F=[C,E],z=new l$;let H=null,W=null;function Y(ee){const le=P.indexOf(ee.inputSource);if(-1===le)return;const Ue=S[le];void 0!==Ue&&(Ue.update(ee.inputSource,ee.frame,l||s),Ue.dispatchEvent({type:ee.type,data:ee.inputSource}))}function j(){r.removeEventListener("select",Y),r.removeEventListener("selectstart",Y),r.removeEventListener("selectend",Y),r.removeEventListener("squeeze",Y),r.removeEventListener("squeezestart",Y),r.removeEventListener("squeezeend",Y),r.removeEventListener("end",j),r.removeEventListener("inputsourceschange",X);for(let ee=0;ee<S.length;ee++){const le=P[ee];null!==le&&(P[ee]=null,S[ee].disconnect(le))}H=null,W=null,m.reset();for(const ee in g)delete g[ee];e.setRenderTarget(x),h=null,f=null,d=null,r=null,y=null,Ft.stop(),i.isPresenting=!1,e.setPixelRatio(I),e.setSize(T.width,T.height,!1),i.dispatchEvent({type:"sessionend"})}function X(ee){for(let le=0;le<ee.removed.length;le++){const Ue=ee.removed[le],Ke=P.indexOf(Ue);Ke>=0&&(P[Ke]=null,S[Ke].disconnect(Ue))}for(let le=0;le<ee.added.length;le++){const Ue=ee.added[le];let Ke=P.indexOf(Ue);if(-1===Ke){for(let At=0;At<S.length;At++){if(At>=P.length){P.push(Ue),Ke=At;break}if(null===P[At]){P[At]=Ue,Ke=At;break}}if(-1===Ke)break}const Ie=S[Ke];Ie&&Ie.connect(Ue)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ee){let le=S[ee];return void 0===le&&(le=new Ky,S[ee]=le),le.getTargetRaySpace()},this.getControllerGrip=function(ee){let le=S[ee];return void 0===le&&(le=new Ky,S[ee]=le),le.getGripSpace()},this.getHand=function(ee){let le=S[ee];return void 0===le&&(le=new Ky,S[ee]=le),le.getHandSpace()},this.setFramebufferScaleFactor=function(ee){o=ee,!0===i.isPresenting&&Se("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ee){a=ee,!0===i.isPresenting&&Se("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(ee){l=ee},this.getBaseLayer=function(){return null!==f?f:h},this.getBinding=function(){return null===d&&_&&(d=new XRWebGLBinding(r,t)),d},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=function(){var ee=ki(function*(le){if(r=le,null!==r){if(x=e.getRenderTarget(),r.addEventListener("select",Y),r.addEventListener("selectstart",Y),r.addEventListener("selectend",Y),r.addEventListener("squeeze",Y),r.addEventListener("squeezestart",Y),r.addEventListener("squeezeend",Y),r.addEventListener("end",j),r.addEventListener("inputsourceschange",X),!0!==v.xrCompatible&&(yield t.makeXRCompatible()),I=e.getPixelRatio(),e.getSize(T),_&&"createProjectionLayer"in XRWebGLBinding.prototype){let Ke=null,Ie=null,At=null;v.depth&&(At=v.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Ke=v.stencil?xa:Ko,Ie=v.stencil?Rd:Gr);const $t={colorFormat:t.RGBA8,depthFormat:At,scaleFactor:o};d=this.getBinding(),f=d.createProjectionLayer($t),r.updateRenderState({layers:[f]}),e.setPixelRatio(1),e.setSize(f.textureWidth,f.textureHeight,!1),y=new br(f.textureWidth,f.textureHeight,{format:zi,type:rr,depthTexture:new tf(f.textureWidth,f.textureHeight,Ie,void 0,void 0,void 0,void 0,void 0,void 0,Ke),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0,resolveDepthBuffer:!1===f.ignoreDepthValues,resolveStencilBuffer:!1===f.ignoreDepthValues})}else h=new XRWebGLLayer(r,t,{antialias:v.antialias,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:o}),r.updateRenderState({baseLayer:h}),e.setPixelRatio(1),e.setSize(h.framebufferWidth,h.framebufferHeight,!1),y=new br(h.framebufferWidth,h.framebufferHeight,{format:zi,type:rr,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil,resolveDepthBuffer:!1===h.ignoreDepthValues,resolveStencilBuffer:!1===h.ignoreDepthValues});y.isXRRenderTarget=!0,this.setFoveation(c),l=null,s=yield r.requestReferenceSpace(a),Ft.setContext(r),Ft.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(le){return ee.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode},this.getDepthTexture=function(){return m.getDepthTexture()};const ce=new R,ye=new R;function Me(ee,le){null===le?ee.matrixWorld.copy(ee.matrix):ee.matrixWorld.multiplyMatrices(le.matrixWorld,ee.matrix),ee.matrixWorldInverse.copy(ee.matrixWorld).invert()}this.updateCamera=function(ee){if(null===r)return;let le=ee.near,Ue=ee.far;null!==m.texture&&(m.depthNear>0&&(le=m.depthNear),m.depthFar>0&&(Ue=m.depthFar)),z.near=E.near=C.near=le,z.far=E.far=C.far=Ue,(H!==z.near||W!==z.far)&&(r.updateRenderState({depthNear:z.near,depthFar:z.far}),H=z.near,W=z.far),z.layers.mask=6|ee.layers.mask,C.layers.mask=3&z.layers.mask,E.layers.mask=5&z.layers.mask;const Ke=ee.parent,Ie=z.cameras;Me(z,Ke);for(let At=0;At<Ie.length;At++)Me(Ie[At],Ke);2===Ie.length?function _e(ee,le,Ue){ce.setFromMatrixPosition(le.matrixWorld),ye.setFromMatrixPosition(Ue.matrixWorld);const Ke=ce.distanceTo(ye),Ie=le.projectionMatrix.elements,At=Ue.projectionMatrix.elements,$t=Ie[14]/(Ie[10]-1),Ct=Ie[14]/(Ie[10]+1),ae=(Ie[9]+1)/Ie[5],he=(Ie[9]-1)/Ie[5],ue=(Ie[8]-1)/Ie[0],Ae=(At[8]+1)/At[0],N=$t*ue,Qe=$t*Ae,Le=Ke/(-ue+Ae),rt=Le*-ue;if(le.matrixWorld.decompose(ee.position,ee.quaternion,ee.scale),ee.translateX(rt),ee.translateZ(Le),ee.matrixWorld.compose(ee.position,ee.quaternion,ee.scale),ee.matrixWorldInverse.copy(ee.matrixWorld).invert(),-1===Ie[10])ee.projectionMatrix.copy(le.projectionMatrix),ee.projectionMatrixInverse.copy(le.projectionMatrixInverse);else{const ve=$t+Le,D=Ct+Le;ee.projectionMatrix.makePerspective(N-rt,Qe+(Ke-rt),ae*Ct/D*ve,he*Ct/D*ve,ve,D),ee.projectionMatrixInverse.copy(ee.projectionMatrix).invert()}}(z,C,E):z.projectionMatrix.copy(C.projectionMatrix),function _t(ee,le,Ue){null===Ue?ee.matrix.copy(le.matrixWorld):(ee.matrix.copy(Ue.matrixWorld),ee.matrix.invert(),ee.matrix.multiply(le.matrixWorld)),ee.matrix.decompose(ee.position,ee.quaternion,ee.scale),ee.updateMatrixWorld(!0),ee.projectionMatrix.copy(le.projectionMatrix),ee.projectionMatrixInverse.copy(le.projectionMatrixInverse),ee.isPerspectiveCamera&&(ee.fov=2*gl*Math.atan(1/ee.projectionMatrix.elements[5]),ee.zoom=1)}(ee,z,Ke)},this.getCamera=function(){return z},this.getFoveation=function(){if(null!==f||null!==h)return c},this.setFoveation=function(ee){c=ee,null!==f&&(f.fixedFoveation=ee),null!==h&&void 0!==h.fixedFoveation&&(h.fixedFoveation=ee)},this.hasDepthSensing=function(){return null!==m.texture},this.getDepthSensingMesh=function(){return m.getMesh(z)},this.getCameraTexture=function(ee){return g[ee]};let Je=null;const Ft=new h2;Ft.setAnimationLoop(function Lt(ee,le){if(u=le.getViewerPose(l||s),p=le,null!==u){const Ue=u.views;null!==h&&(e.setRenderTargetFramebuffer(y,h.framebuffer),e.setRenderTarget(y));let Ke=!1;Ue.length!==z.cameras.length&&(z.cameras.length=0,Ke=!0);for(let Ct=0;Ct<Ue.length;Ct++){const ae=Ue[Ct];let he=null;if(null!==h)he=h.getViewport(ae);else{const Ae=d.getViewSubImage(f,ae);he=Ae.viewport,0===Ct&&(e.setRenderTargetTextures(y,Ae.colorTexture,Ae.depthStencilTexture),e.setRenderTarget(y))}let ue=F[Ct];void 0===ue&&(ue=new jn,ue.layers.enable(Ct),ue.viewport=new pn,F[Ct]=ue),ue.matrix.fromArray(ae.transform.matrix),ue.matrix.decompose(ue.position,ue.quaternion,ue.scale),ue.projectionMatrix.fromArray(ae.projectionMatrix),ue.projectionMatrixInverse.copy(ue.projectionMatrix).invert(),ue.viewport.set(he.x,he.y,he.width,he.height),0===Ct&&(z.matrix.copy(ue.matrix),z.matrix.decompose(z.position,z.quaternion,z.scale)),!0===Ke&&z.cameras.push(ue)}const Ie=r.enabledFeatures;if(Ie&&Ie.includes("depth-sensing")&&"gpu-optimized"==r.depthUsage&&_){d=i.getBinding();const Ct=d.getDepthInformation(Ue[0]);Ct&&Ct.isValid&&Ct.texture&&m.init(Ct,r.renderState)}if(Ie&&Ie.includes("camera-access")&&_){e.state.unbindTexture(),d=i.getBinding();for(let Ct=0;Ct<Ue.length;Ct++){const ae=Ue[Ct].camera;if(ae){let he=g[ae];he||(he=new vI,g[ae]=he);const ue=d.getCameraImage(ae);he.sourceTexture=ue}}}}for(let Ue=0;Ue<S.length;Ue++){const Ke=P[Ue],Ie=S[Ue];null!==Ke&&void 0!==Ie&&Ie.update(Ke,le,l||s)}Je&&Je(ee,le),le.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:le}),p=null}),this.setAnimationLoop=function(ee){Je=ee},this.dispose=function(){}}}const ja=new ns,jZ=new it;function WZ(n,e){function t(m,g){!0===m.matrixAutoUpdate&&m.updateMatrix(),g.value.copy(m.matrix)}function o(m,g){m.opacity.value=g.opacity,g.color&&m.diffuse.value.copy(g.color),g.emissive&&m.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(m.map.value=g.map,t(g.map,m.mapTransform)),g.alphaMap&&(m.alphaMap.value=g.alphaMap,t(g.alphaMap,m.alphaMapTransform)),g.bumpMap&&(m.bumpMap.value=g.bumpMap,t(g.bumpMap,m.bumpMapTransform),m.bumpScale.value=g.bumpScale,1===g.side&&(m.bumpScale.value*=-1)),g.normalMap&&(m.normalMap.value=g.normalMap,t(g.normalMap,m.normalMapTransform),m.normalScale.value.copy(g.normalScale),1===g.side&&m.normalScale.value.negate()),g.displacementMap&&(m.displacementMap.value=g.displacementMap,t(g.displacementMap,m.displacementMapTransform),m.displacementScale.value=g.displacementScale,m.displacementBias.value=g.displacementBias),g.emissiveMap&&(m.emissiveMap.value=g.emissiveMap,t(g.emissiveMap,m.emissiveMapTransform)),g.specularMap&&(m.specularMap.value=g.specularMap,t(g.specularMap,m.specularMapTransform)),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);const v=e.get(g),x=v.envMap,y=v.envMapRotation;x&&(m.envMap.value=x,ja.copy(y),ja.x*=-1,ja.y*=-1,ja.z*=-1,x.isCubeTexture&&!1===x.isRenderTargetTexture&&(ja.y*=-1,ja.z*=-1),m.envMapRotation.value.setFromMatrix4(jZ.makeRotationFromEuler(ja)),m.flipEnvMap.value=x.isCubeTexture&&!1===x.isRenderTargetTexture?-1:1,m.reflectivity.value=g.reflectivity,m.ior.value=g.ior,m.refractionRatio.value=g.refractionRatio),g.lightMap&&(m.lightMap.value=g.lightMap,m.lightMapIntensity.value=g.lightMapIntensity,t(g.lightMap,m.lightMapTransform)),g.aoMap&&(m.aoMap.value=g.aoMap,m.aoMapIntensity.value=g.aoMapIntensity,t(g.aoMap,m.aoMapTransform))}return{refreshFogUniforms:function i(m,g){g.color.getRGB(m.fogColor.value,jD(n)),g.isFog?(m.fogNear.value=g.near,m.fogFar.value=g.far):g.isFogExp2&&(m.fogDensity.value=g.density)},refreshMaterialUniforms:function r(m,g,v,x,y){g.isMeshBasicMaterial||g.isMeshLambertMaterial?o(m,g):g.isMeshToonMaterial?(o(m,g),function d(m,g){g.gradientMap&&(m.gradientMap.value=g.gradientMap)}(m,g)):g.isMeshPhongMaterial?(o(m,g),function u(m,g){m.specular.value.copy(g.specular),m.shininess.value=Math.max(g.shininess,1e-4)}(m,g)):g.isMeshStandardMaterial?(o(m,g),function f(m,g){m.metalness.value=g.metalness,g.metalnessMap&&(m.metalnessMap.value=g.metalnessMap,t(g.metalnessMap,m.metalnessMapTransform)),m.roughness.value=g.roughness,g.roughnessMap&&(m.roughnessMap.value=g.roughnessMap,t(g.roughnessMap,m.roughnessMapTransform)),g.envMap&&(m.envMapIntensity.value=g.envMapIntensity)}(m,g),g.isMeshPhysicalMaterial&&function h(m,g,v){m.ior.value=g.ior,g.sheen>0&&(m.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),m.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(m.sheenColorMap.value=g.sheenColorMap,t(g.sheenColorMap,m.sheenColorMapTransform)),g.sheenRoughnessMap&&(m.sheenRoughnessMap.value=g.sheenRoughnessMap,t(g.sheenRoughnessMap,m.sheenRoughnessMapTransform))),g.clearcoat>0&&(m.clearcoat.value=g.clearcoat,m.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(m.clearcoatMap.value=g.clearcoatMap,t(g.clearcoatMap,m.clearcoatMapTransform)),g.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap,t(g.clearcoatRoughnessMap,m.clearcoatRoughnessMapTransform)),g.clearcoatNormalMap&&(m.clearcoatNormalMap.value=g.clearcoatNormalMap,t(g.clearcoatNormalMap,m.clearcoatNormalMapTransform),m.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),1===g.side&&m.clearcoatNormalScale.value.negate())),g.dispersion>0&&(m.dispersion.value=g.dispersion),g.iridescence>0&&(m.iridescence.value=g.iridescence,m.iridescenceIOR.value=g.iridescenceIOR,m.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(m.iridescenceMap.value=g.iridescenceMap,t(g.iridescenceMap,m.iridescenceMapTransform)),g.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=g.iridescenceThicknessMap,t(g.iridescenceThicknessMap,m.iridescenceThicknessMapTransform))),g.transmission>0&&(m.transmission.value=g.transmission,m.transmissionSamplerMap.value=v.texture,m.transmissionSamplerSize.value.set(v.width,v.height),g.transmissionMap&&(m.transmissionMap.value=g.transmissionMap,t(g.transmissionMap,m.transmissionMapTransform)),m.thickness.value=g.thickness,g.thicknessMap&&(m.thicknessMap.value=g.thicknessMap,t(g.thicknessMap,m.thicknessMapTransform)),m.attenuationDistance.value=g.attenuationDistance,m.attenuationColor.value.copy(g.attenuationColor)),g.anisotropy>0&&(m.anisotropyVector.value.set(g.anisotropy*Math.cos(g.anisotropyRotation),g.anisotropy*Math.sin(g.anisotropyRotation)),g.anisotropyMap&&(m.anisotropyMap.value=g.anisotropyMap,t(g.anisotropyMap,m.anisotropyMapTransform))),m.specularIntensity.value=g.specularIntensity,m.specularColor.value.copy(g.specularColor),g.specularColorMap&&(m.specularColorMap.value=g.specularColorMap,t(g.specularColorMap,m.specularColorMapTransform)),g.specularIntensityMap&&(m.specularIntensityMap.value=g.specularIntensityMap,t(g.specularIntensityMap,m.specularIntensityMapTransform))}(m,g,y)):g.isMeshMatcapMaterial?(o(m,g),function p(m,g){g.matcap&&(m.matcap.value=g.matcap)}(m,g)):g.isMeshDepthMaterial?o(m,g):g.isMeshDistanceMaterial?(o(m,g),function _(m,g){const v=e.get(g).light;m.referencePosition.value.setFromMatrixPosition(v.matrixWorld),m.nearDistance.value=v.shadow.camera.near,m.farDistance.value=v.shadow.camera.far}(m,g)):g.isMeshNormalMaterial?o(m,g):g.isLineBasicMaterial?(function s(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,g.map&&(m.map.value=g.map,t(g.map,m.mapTransform))}(m,g),g.isLineDashedMaterial&&function a(m,g){m.dashSize.value=g.dashSize,m.totalSize.value=g.dashSize+g.gapSize,m.scale.value=g.scale}(m,g)):g.isPointsMaterial?function c(m,g,v,x){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.size.value=g.size*v,m.scale.value=.5*x,g.map&&(m.map.value=g.map,t(g.map,m.uvTransform)),g.alphaMap&&(m.alphaMap.value=g.alphaMap,t(g.alphaMap,m.alphaMapTransform)),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest)}(m,g,v,x):g.isSpriteMaterial?function l(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.rotation.value=g.rotation,g.map&&(m.map.value=g.map,t(g.map,m.mapTransform)),g.alphaMap&&(m.alphaMap.value=g.alphaMap,t(g.alphaMap,m.alphaMapTransform)),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest)}(m,g):g.isShadowMaterial?(m.color.value.copy(g.color),m.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}}}function $Z(n,e,t,i){let r={},o={},s=[];const a=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function h(v,x,y,S){const P=v.value,T=x+"_"+y;if(void 0===S[T])return S[T]="number"==typeof P||"boolean"==typeof P?P:P.clone(),!0;{const I=S[T];if("number"==typeof P||"boolean"==typeof P){if(I!==P)return S[T]=P,!0}else if(!1===I.equals(P))return I.copy(P),!0}return!1}function _(v){const x={boundary:0,storage:0};return"number"==typeof v||"boolean"==typeof v?(x.boundary=4,x.storage=4):v.isVector2?(x.boundary=8,x.storage=8):v.isVector3||v.isColor?(x.boundary=16,x.storage=12):v.isVector4?(x.boundary=16,x.storage=16):v.isMatrix3?(x.boundary=48,x.storage=48):v.isMatrix4?(x.boundary=64,x.storage=64):v.isTexture?Se("WebGLRenderer: Texture samplers can not be part of an uniforms group."):Se("WebGLRenderer: Unsupported uniform value type.",v),x}function m(v){const x=v.target;x.removeEventListener("dispose",m);const y=s.indexOf(x.__bindingPointIndex);s.splice(y,1),n.deleteBuffer(r[x.id]),delete r[x.id],delete o[x.id]}return{bind:function c(v,x){i.uniformBlockBinding(v,x.program)},update:function l(v,x){let y=r[v.id];void 0===y&&(function p(v){const x=v.uniforms;let y=0;for(let T=0,I=x.length;T<I;T++){const C=Array.isArray(x[T])?x[T]:[x[T]];for(let E=0,F=C.length;E<F;E++){const z=C[E],H=Array.isArray(z.value)?z.value:[z.value];for(let W=0,Y=H.length;W<Y;W++){const X=_(H[W]),ce=y%16,ye=ce%X.boundary,_e=ce+ye;y+=ye,0!==_e&&16-_e<X.storage&&(y+=16-_e),z.__data=new Float32Array(X.storage/Float32Array.BYTES_PER_ELEMENT),z.__offset=y,y+=X.storage}}}const P=y%16;P>0&&(y+=16-P),v.__size=y,v.__cache={}}(v),y=function u(v){const x=function d(){for(let v=0;v<a;v++)if(-1===s.indexOf(v))return s.push(v),v;return Ze("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();v.__bindingPointIndex=x;const y=n.createBuffer(),S=v.__size,P=v.usage;return n.bindBuffer(n.UNIFORM_BUFFER,y),n.bufferData(n.UNIFORM_BUFFER,S,P),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,x,y),y}(v),r[v.id]=y,v.addEventListener("dispose",m)),i.updateUBOMapping(v,x.program);const P=e.render.frame;o[v.id]!==P&&(function f(v){const y=v.uniforms,S=v.__cache;n.bindBuffer(n.UNIFORM_BUFFER,r[v.id]);for(let P=0,T=y.length;P<T;P++){const I=Array.isArray(y[P])?y[P]:[y[P]];for(let C=0,E=I.length;C<E;C++){const F=I[C];if(!0===h(F,P,C,S)){const z=F.__offset,H=Array.isArray(F.value)?F.value:[F.value];let W=0;for(let Y=0;Y<H.length;Y++){const j=H[Y],X=_(j);"number"==typeof j||"boolean"==typeof j?(F.__data[0]=j,n.bufferSubData(n.UNIFORM_BUFFER,z+W,F.__data)):j.isMatrix3?(F.__data[0]=j.elements[0],F.__data[1]=j.elements[1],F.__data[2]=j.elements[2],F.__data[3]=0,F.__data[4]=j.elements[3],F.__data[5]=j.elements[4],F.__data[6]=j.elements[5],F.__data[7]=0,F.__data[8]=j.elements[6],F.__data[9]=j.elements[7],F.__data[10]=j.elements[8],F.__data[11]=0):(j.toArray(F.__data,W),W+=X.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,z,F.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}(v),o[v.id]=P)},dispose:function g(){for(const v in r)n.deleteBuffer(r[v]);s=[],r={},o={}}}}const qZ=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let So=null;class z2{constructor(e={}){const{canvas:t=J7(),context:i=null,depth:r=!0,stencil:o=!1,alpha:s=!1,antialias:a=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:l=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:d=!1,reversedDepthBuffer:f=!1,outputBufferType:h=rr}=e;let p;if(this.isWebGLRenderer=!0,null!==i){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");p=i.getContextAttributes().alpha}else p=s;const _=h,m=new Set([Hx,zx,Wp]),g=new Set([rr,Gr,Id,Rd,Ux,Bx]),v=new Uint32Array(4),x=new Int32Array(4);let y=null,S=null;const P=[],T=[];let I=null;this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=_o,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const C=this;let E=!1;this._outputColorSpace=vn;let F=0,z=0,H=null,W=-1,Y=null;const j=new pn,X=new pn;let ce=null;const ye=new xe(0);let _e=0,Me=t.width,_t=t.height,Je=1,Lt=null,Ft=null;const ee=new pn(0,0,Me,_t),le=new pn(0,0,Me,_t);let Ue=!1;const Ke=new Kd;let Ie=!1,At=!1;const $t=new it,Ct=new R,ae=new pn,he={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let ue=!1;function Ae(){return null===H?Je:1}let Le,rt,ve,D,w,B,Z,oe,K,Ge,be,ze,st,fe,Pe,He,We,we,Ot,k,Re,me,Fe,pe,N=i;function Qe(A,V){return t.getContext(A,V)}try{const A={alpha:!0,depth:r,stencil:o,antialias:a,premultipliedAlpha:c,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:d};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r182"),t.addEventListener("webglcontextlost",yt,!1),t.addEventListener("webglcontextrestored",mn,!1),t.addEventListener("webglcontextcreationerror",Jt,!1),null===N){const V="webgl2";if(N=Qe(V,A),null===N)throw Qe(V)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(A){throw Ze("WebGLRenderer: "+A.message),A}function se(){Le=new XX(N),Le.init(),me=new BZ(N,Le),rt=new BX(N,Le,e,me),ve=new kZ(N,Le),rt.reversedDepthBuffer&&f&&ve.buffers.depth.setReversed(!0),D=new KX(N),w=new bZ,B=new UZ(N,Le,ve,w,rt,me,D),Z=new zX(C),oe=new qX(C),K=new L$(N),Fe=new kX(N,K),Ge=new YX(N,K,D,Fe),be=new QX(N,Ge,K,D),Ot=new JX(N,rt,B),He=new VX(w),ze=new MZ(C,Z,oe,Le,rt,Fe,He),st=new WZ(C,w),fe=new wZ,Pe=new OZ(Le),we=new FX(C,Z,oe,ve,be,p,c),We=new LZ(C,be,rt),pe=new $Z(N,D,rt,ve),k=new UX(N,Le,D),Re=new ZX(N,Le,D),D.programs=ze.programs,C.capabilities=rt,C.extensions=Le,C.properties=w,C.renderLists=fe,C.shadowMap=We,C.state=ve,C.info=D}se(),_!==rr&&(I=new tY(_,t.width,t.height,r,o));const Ce=new GZ(C,N);function yt(A){A.preventDefault(),Qp("WebGLRenderer: Context Lost."),E=!0}function mn(){Qp("WebGLRenderer: Context Restored."),E=!1;const A=D.autoReset,V=We.enabled,q=We.autoUpdate,$=We.needsUpdate,G=We.type;se(),D.autoReset=A,We.enabled=V,We.autoUpdate=q,We.needsUpdate=$,We.type=G}function Jt(A){Ze("WebGLRenderer: A WebGL context could not be created. Reason: ",A.statusMessage)}function To(A){const V=A.target;V.removeEventListener("dispose",To),function us(A){(function Xee(A){const V=w.get(A).programs;void 0!==V&&(V.forEach(function(q){ze.releaseProgram(q)}),A.isShaderMaterial&&ze.releaseShaderCache(A))})(A),w.remove(A)}(V)}function c3(A,V,q){!0===A.transparent&&2===A.side&&!1===A.forceSinglePass?(A.side=1,A.needsUpdate=!0,xm(A,V,q),A.side=0,A.needsUpdate=!0,xm(A,V,q),A.side=2):xm(A,V,q)}this.xr=Ce,this.getContext=function(){return N},this.getContextAttributes=function(){return N.getContextAttributes()},this.forceContextLoss=function(){const A=Le.get("WEBGL_lose_context");A&&A.loseContext()},this.forceContextRestore=function(){const A=Le.get("WEBGL_lose_context");A&&A.restoreContext()},this.getPixelRatio=function(){return Je},this.setPixelRatio=function(A){void 0!==A&&(Je=A,this.setSize(Me,_t,!1))},this.getSize=function(A){return A.set(Me,_t)},this.setSize=function(A,V,q=!0){Ce.isPresenting?Se("WebGLRenderer: Can't change size while VR device is presenting."):(Me=A,_t=V,t.width=Math.floor(A*Je),t.height=Math.floor(V*Je),!0===q&&(t.style.width=A+"px",t.style.height=V+"px"),null!==I&&I.setSize(t.width,t.height),this.setViewport(0,0,A,V))},this.getDrawingBufferSize=function(A){return A.set(Me*Je,_t*Je).floor()},this.setDrawingBufferSize=function(A,V,q){Me=A,_t=V,Je=q,t.width=Math.floor(A*q),t.height=Math.floor(V*q),this.setViewport(0,0,A,V)},this.setEffects=function(A){if(_!==rr){if(A)for(let V=0;V<A.length;V++)if(!0===A[V].isOutputPass){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}I.setEffects(A||[])}else console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.")},this.getCurrentViewport=function(A){return A.copy(j)},this.getViewport=function(A){return A.copy(ee)},this.setViewport=function(A,V,q,$){A.isVector4?ee.set(A.x,A.y,A.z,A.w):ee.set(A,V,q,$),ve.viewport(j.copy(ee).multiplyScalar(Je).round())},this.getScissor=function(A){return A.copy(le)},this.setScissor=function(A,V,q,$){A.isVector4?le.set(A.x,A.y,A.z,A.w):le.set(A,V,q,$),ve.scissor(X.copy(le).multiplyScalar(Je).round())},this.getScissorTest=function(){return Ue},this.setScissorTest=function(A){ve.setScissorTest(Ue=A)},this.setOpaqueSort=function(A){Lt=A},this.setTransparentSort=function(A){Ft=A},this.getClearColor=function(A){return A.copy(we.getClearColor())},this.setClearColor=function(){we.setClearColor(...arguments)},this.getClearAlpha=function(){return we.getClearAlpha()},this.setClearAlpha=function(){we.setClearAlpha(...arguments)},this.clear=function(A=!0,V=!0,q=!0){let $=0;if(A){let G=!1;if(null!==H&&(G=m.has(H.texture.format)),G){const ke=g.has(H.texture.type),Oe=we.getClearColor(),je=we.getClearAlpha(),$e=Oe.r,ut=Oe.g,tt=Oe.b;ke?(v[0]=$e,v[1]=ut,v[2]=tt,v[3]=je,N.clearBufferuiv(N.COLOR,0,v)):(x[0]=$e,x[1]=ut,x[2]=tt,x[3]=je,N.clearBufferiv(N.COLOR,0,x))}else $|=N.COLOR_BUFFER_BIT}V&&($|=N.DEPTH_BUFFER_BIT),q&&($|=N.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),N.clear($)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",yt,!1),t.removeEventListener("webglcontextrestored",mn,!1),t.removeEventListener("webglcontextcreationerror",Jt,!1),we.dispose(),fe.dispose(),Pe.dispose(),w.dispose(),Z.dispose(),oe.dispose(),be.dispose(),Fe.dispose(),pe.dispose(),ze.dispose(),Ce.dispose(),Ce.removeEventListener("sessionstart",l3),Ce.removeEventListener("sessionend",u3),Ya.stop()},this.renderBufferDirect=function(A,V,q,$,G,Ee){null===V&&(V=he);const ke=G.isMesh&&G.matrixWorld.determinant()<0,Oe=function Zee(A,V,q,$,G){!0!==V.isScene&&(V=he),B.resetTextureUnits();const Ee=V.fog,Oe=null===H?C.outputColorSpace:!0===H.isXRRenderTarget?H.texture.colorSpace:bi,je=($.isMeshStandardMaterial?oe:Z).get($.envMap||($.isMeshStandardMaterial?V.environment:null)),$e=!0===$.vertexColors&&!!q.attributes.color&&4===q.attributes.color.itemSize,ut=!!q.attributes.tangent&&(!!$.normalMap||$.anisotropy>0),tt=!!q.morphAttributes.position,Nt=!!q.morphAttributes.normal,qt=!!q.morphAttributes.color;let Nn=_o;$.toneMapped&&(null===H||!0===H.isXRRenderTarget)&&(Nn=C.toneMapping);const xn=q.morphAttributes.position||q.morphAttributes.normal||q.morphAttributes.color,an=void 0!==xn?xn.length:0,nt=w.get($),Qt=S.state.lights;!0!==Ie||!0!==At&&A===Y||He.setState($,A,A===Y&&$.id===W);let Vt=!1;$.version===nt.__version?(nt.needsLights&&nt.lightsStateVersion!==Qt.state.version||nt.outputColorSpace!==Oe||G.isBatchedMesh&&!1===nt.batching||!G.isBatchedMesh&&!0===nt.batching||G.isBatchedMesh&&!0===nt.batchingColor&&null===G.colorTexture||G.isBatchedMesh&&!1===nt.batchingColor&&null!==G.colorTexture||G.isInstancedMesh&&!1===nt.instancing||!G.isInstancedMesh&&!0===nt.instancing||G.isSkinnedMesh&&!1===nt.skinning||!G.isSkinnedMesh&&!0===nt.skinning||G.isInstancedMesh&&!0===nt.instancingColor&&null===G.instanceColor||G.isInstancedMesh&&!1===nt.instancingColor&&null!==G.instanceColor||G.isInstancedMesh&&!0===nt.instancingMorph&&null===G.morphTexture||G.isInstancedMesh&&!1===nt.instancingMorph&&null!==G.morphTexture||nt.envMap!==je||!0===$.fog&&nt.fog!==Ee||void 0!==nt.numClippingPlanes&&(nt.numClippingPlanes!==He.numPlanes||nt.numIntersection!==He.numIntersection)||nt.vertexAlphas!==$e||nt.vertexTangents!==ut||nt.morphTargets!==tt||nt.morphNormals!==Nt||nt.morphColors!==qt||nt.toneMapping!==Nn||nt.morphTargetsCount!==an)&&(Vt=!0):(Vt=!0,nt.__version=$.version);let lr=nt.currentProgram;!0===Vt&&(lr=xm($,V,G));let Jl=!1,ur=!1,Ef=!1;const _n=lr.getUniforms(),ji=nt.uniforms;if(ve.useProgram(lr.program)&&(Jl=!0,ur=!0,Ef=!0),$.id!==W&&(W=$.id,ur=!0),Jl||Y!==A){ve.buffers.depth.getReversed()&&!0!==A.reversedDepth&&(A._reversedDepth=!0,A.updateProjectionMatrix()),_n.setValue(N,"projectionMatrix",A.projectionMatrix),_n.setValue(N,"viewMatrix",A.matrixWorldInverse);const Wi=_n.map.cameraPosition;void 0!==Wi&&Wi.setValue(N,Ct.setFromMatrixPosition(A.matrixWorld)),rt.logarithmicDepthBuffer&&_n.setValue(N,"logDepthBufFC",2/(Math.log(A.far+1)/Math.LN2)),($.isMeshPhongMaterial||$.isMeshToonMaterial||$.isMeshLambertMaterial||$.isMeshBasicMaterial||$.isMeshStandardMaterial||$.isShaderMaterial)&&_n.setValue(N,"isOrthographic",!0===A.isOrthographicCamera),Y!==A&&(Y=A,ur=!0,Ef=!0)}if(nt.needsLights&&(Qt.state.directionalShadowMap.length>0&&_n.setValue(N,"directionalShadowMap",Qt.state.directionalShadowMap,B),Qt.state.spotShadowMap.length>0&&_n.setValue(N,"spotShadowMap",Qt.state.spotShadowMap,B),Qt.state.pointShadowMap.length>0&&_n.setValue(N,"pointShadowMap",Qt.state.pointShadowMap,B)),G.isSkinnedMesh){_n.setOptional(N,G,"bindMatrix"),_n.setOptional(N,G,"bindMatrixInverse");const Ai=G.skeleton;Ai&&(null===Ai.boneTexture&&Ai.computeBoneTexture(),_n.setValue(N,"boneTexture",Ai.boneTexture,B))}G.isBatchedMesh&&(_n.setOptional(N,G,"batchingTexture"),_n.setValue(N,"batchingTexture",G._matricesTexture,B),_n.setOptional(N,G,"batchingIdTexture"),_n.setValue(N,"batchingIdTexture",G._indirectTexture,B),_n.setOptional(N,G,"batchingColorTexture"),null!==G._colorsTexture&&_n.setValue(N,"batchingColorTexture",G._colorsTexture,B));const Ar=q.morphAttributes;if((void 0!==Ar.position||void 0!==Ar.normal||void 0!==Ar.color)&&Ot.update(G,q,lr),(ur||nt.receiveShadow!==G.receiveShadow)&&(nt.receiveShadow=G.receiveShadow,_n.setValue(N,"receiveShadow",G.receiveShadow)),$.isMeshGouraudMaterial&&null!==$.envMap&&(ji.envMap.value=je,ji.flipEnvMap.value=je.isCubeTexture&&!1===je.isRenderTargetTexture?-1:1),$.isMeshStandardMaterial&&null===$.envMap&&null!==V.environment&&(ji.envMapIntensity.value=V.environmentIntensity),void 0!==ji.dfgLUT&&(ji.dfgLUT.value=function XZ(){return null===So&&(So=new vo(qZ,16,16,ul,Zo),So.name="DFG_LUT",So.minFilter=on,So.magFilter=on,So.wrapS=Bi,So.wrapT=Bi,So.generateMipmaps=!1,So.needsUpdate=!0),So}()),ur&&(_n.setValue(N,"toneMappingExposure",C.toneMappingExposure),nt.needsLights&&function Kee(A,V){A.ambientLightColor.needsUpdate=V,A.lightProbe.needsUpdate=V,A.directionalLights.needsUpdate=V,A.directionalLightShadows.needsUpdate=V,A.pointLights.needsUpdate=V,A.pointLightShadows.needsUpdate=V,A.spotLights.needsUpdate=V,A.spotLightShadows.needsUpdate=V,A.rectAreaLights.needsUpdate=V,A.hemisphereLights.needsUpdate=V}(ji,Ef),Ee&&!0===$.fog&&st.refreshFogUniforms(ji,Ee),st.refreshMaterialUniforms(ji,$,Je,_t,S.state.transmissionRenderTarget[A.id]),nm.upload(N,p3(nt),ji,B)),$.isShaderMaterial&&!0===$.uniformsNeedUpdate&&(nm.upload(N,p3(nt),ji,B),$.uniformsNeedUpdate=!1),$.isSpriteMaterial&&_n.setValue(N,"center",G.center),_n.setValue(N,"modelViewMatrix",G.modelViewMatrix),_n.setValue(N,"normalMatrix",G.normalMatrix),_n.setValue(N,"modelMatrix",G.matrixWorld),$.isShaderMaterial||$.isRawShaderMaterial){const Ai=$.uniformsGroups;for(let Wi=0,Lb=Ai.length;Wi<Lb;Wi++){const Za=Ai[Wi];pe.update(Za,lr),pe.bind(Za,lr)}}return lr}(A,V,q,$,G);ve.setMaterial($,ke);let je=q.index,$e=1;if(!0===$.wireframe){if(je=Ge.getWireframeAttribute(q),void 0===je)return;$e=2}const ut=q.drawRange,tt=q.attributes.position;let Nt=ut.start*$e,qt=(ut.start+ut.count)*$e;null!==Ee&&(Nt=Math.max(Nt,Ee.start*$e),qt=Math.min(qt,(Ee.start+Ee.count)*$e)),null!==je?(Nt=Math.max(Nt,0),qt=Math.min(qt,je.count)):null!=tt&&(Nt=Math.max(Nt,0),qt=Math.min(qt,tt.count));const Nn=qt-Nt;if(Nn<0||Nn===1/0)return;Fe.setup(G,$,Oe,q,je);let xn,an=k;if(null!==je&&(xn=K.get(je),an=Re,an.setIndex(xn)),G.isMesh)!0===$.wireframe?(ve.setLineWidth($.wireframeLinewidth*Ae()),an.setMode(N.LINES)):an.setMode(N.TRIANGLES);else if(G.isLine){let nt=$.linewidth;void 0===nt&&(nt=1),ve.setLineWidth(nt*Ae()),an.setMode(G.isLineSegments?N.LINES:G.isLineLoop?N.LINE_LOOP:N.LINE_STRIP)}else G.isPoints?an.setMode(N.POINTS):G.isSprite&&an.setMode(N.TRIANGLES);if(G.isBatchedMesh)if(null!==G._multiDrawInstances)Ud("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),an.renderMultiDrawInstances(G._multiDrawStarts,G._multiDrawCounts,G._multiDrawCount,G._multiDrawInstances);else if(Le.get("WEBGL_multi_draw"))an.renderMultiDraw(G._multiDrawStarts,G._multiDrawCounts,G._multiDrawCount);else{const nt=G._multiDrawStarts,Qt=G._multiDrawCounts,Vt=G._multiDrawCount,lr=je?K.get(je).bytesPerElement:1,Jl=w.get($).currentProgram.getUniforms();for(let ur=0;ur<Vt;ur++)Jl.setValue(N,"_gl_DrawID",ur),an.render(nt[ur]/lr,Qt[ur])}else if(G.isInstancedMesh)an.renderInstances(Nt,Nn,G.count);else if(q.isInstancedBufferGeometry){const Qt=Math.min(q.instanceCount,void 0!==q._maxInstanceCount?q._maxInstanceCount:1/0);an.renderInstances(Nt,Nn,Qt)}else an.render(Nt,Nn)},this.compile=function(A,V,q=null){null===q&&(q=A),S=Pe.get(q),S.init(V),T.push(S),q.traverseVisible(function(G){G.isLight&&G.layers.test(V.layers)&&(S.pushLight(G),G.castShadow&&S.pushShadow(G))}),A!==q&&A.traverseVisible(function(G){G.isLight&&G.layers.test(V.layers)&&(S.pushLight(G),G.castShadow&&S.pushShadow(G))}),S.setupLights();const $=new Set;return A.traverse(function(G){if(!(G.isMesh||G.isPoints||G.isLine||G.isSprite))return;const Ee=G.material;if(Ee)if(Array.isArray(Ee))for(let ke=0;ke<Ee.length;ke++){const Oe=Ee[ke];c3(Oe,q,G),$.add(Oe)}else c3(Ee,q,G),$.add(Ee)}),S=T.pop(),$},this.compileAsync=function(A,V,q=null){const $=this.compile(A,V,q);return new Promise(G=>{function Ee(){$.forEach(function(ke){w.get(ke).currentProgram.isReady()&&$.delete(ke)}),0!==$.size?setTimeout(Ee,10):G(A)}null!==Le.get("KHR_parallel_shader_compile")?Ee():setTimeout(Ee,10)})};let Rb=null;function l3(){Ya.stop()}function u3(){Ya.start()}const Ya=new h2;function Nb(A,V,q,$){if(!1===A.visible)return;if(A.layers.test(V.layers))if(A.isGroup)q=A.renderOrder;else if(A.isLOD)!0===A.autoUpdate&&A.update(V);else if(A.isLight)S.pushLight(A),A.castShadow&&S.pushShadow(A);else if(A.isSprite){if(!A.frustumCulled||Ke.intersectsSprite(A)){$&&ae.setFromMatrixPosition(A.matrixWorld).applyMatrix4($t);const ke=be.update(A),Oe=A.material;Oe.visible&&y.push(A,ke,Oe,q,ae.z,null)}}else if((A.isMesh||A.isLine||A.isPoints)&&(!A.frustumCulled||Ke.intersectsObject(A))){const ke=be.update(A),Oe=A.material;if($&&(void 0!==A.boundingSphere?(null===A.boundingSphere&&A.computeBoundingSphere(),ae.copy(A.boundingSphere.center)):(null===ke.boundingSphere&&ke.computeBoundingSphere(),ae.copy(ke.boundingSphere.center)),ae.applyMatrix4(A.matrixWorld).applyMatrix4($t)),Array.isArray(Oe)){const je=ke.groups;for(let $e=0,ut=je.length;$e<ut;$e++){const tt=je[$e],Nt=Oe[tt.materialIndex];Nt&&Nt.visible&&y.push(A,ke,Nt,q,ae.z,tt)}}else Oe.visible&&y.push(A,ke,Oe,q,ae.z,null)}const Ee=A.children;for(let ke=0,Oe=Ee.length;ke<Oe;ke++)Nb(Ee[ke],V,q,$)}function d3(A,V,q,$){const{opaque:G,transmissive:Ee,transparent:ke}=A;S.setupLightsView(q),!0===Ie&&He.setGlobalState(C.clippingPlanes,q),$&&ve.viewport(j.copy($)),G.length>0&&vm(G,V,q),Ee.length>0&&vm(Ee,V,q),ke.length>0&&vm(ke,V,q),ve.buffers.depth.setTest(!0),ve.buffers.depth.setMask(!0),ve.buffers.color.setMask(!0),ve.setPolygonOffset(!1)}function f3(A,V,q,$){if(null!==(!0===q.isScene?q.overrideMaterial:null))return;if(void 0===S.state.transmissionRenderTarget[$.id]){const Nt=Le.has("EXT_color_buffer_half_float")||Le.has("EXT_color_buffer_float");S.state.transmissionRenderTarget[$.id]=new br(1,1,{generateMipmaps:!0,type:Nt?Zo:rr,minFilter:Hr,samples:rt.samples,stencilBuffer:o,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Tt.workingColorSpace})}const Ee=S.state.transmissionRenderTarget[$.id],ke=$.viewport||j;Ee.setSize(ke.z*C.transmissionResolutionScale,ke.w*C.transmissionResolutionScale);const Oe=C.getRenderTarget(),je=C.getActiveCubeFace(),$e=C.getActiveMipmapLevel();C.setRenderTarget(Ee),C.getClearColor(ye),_e=C.getClearAlpha(),_e<1&&C.setClearColor(16777215,.5),C.clear(),ue&&we.render(q);const ut=C.toneMapping;C.toneMapping=_o;const tt=$.viewport;if(void 0!==$.viewport&&($.viewport=void 0),S.setupLightsView($),!0===Ie&&He.setGlobalState(C.clippingPlanes,$),vm(A,q,$),B.updateMultisampleRenderTarget(Ee),B.updateRenderTargetMipmap(Ee),!1===Le.has("WEBGL_multisampled_render_to_texture")){let Nt=!1;for(let qt=0,Nn=V.length;qt<Nn;qt++){const xn=V[qt],{object:an,geometry:nt,material:Qt,group:Vt}=xn;if(2===Qt.side&&an.layers.test($.layers)){const lr=Qt.side;Qt.side=1,Qt.needsUpdate=!0,h3(an,q,$,nt,Qt,Vt),Qt.side=lr,Qt.needsUpdate=!0,Nt=!0}}!0===Nt&&(B.updateMultisampleRenderTarget(Ee),B.updateRenderTargetMipmap(Ee))}C.setRenderTarget(Oe,je,$e),C.setClearColor(ye,_e),void 0!==tt&&($.viewport=tt),C.toneMapping=ut}function vm(A,V,q){const $=!0===V.isScene?V.overrideMaterial:null;for(let G=0,Ee=A.length;G<Ee;G++){const ke=A[G],{object:Oe,geometry:je,group:$e}=ke;let ut=ke.material;!0===ut.allowOverride&&null!==$&&(ut=$),Oe.layers.test(q.layers)&&h3(Oe,V,q,je,ut,$e)}}function h3(A,V,q,$,G,Ee){A.onBeforeRender(C,V,q,$,G,Ee),A.modelViewMatrix.multiplyMatrices(q.matrixWorldInverse,A.matrixWorld),A.normalMatrix.getNormalMatrix(A.modelViewMatrix),G.onBeforeRender(C,V,q,$,A,Ee),!0===G.transparent&&2===G.side&&!1===G.forceSinglePass?(G.side=1,G.needsUpdate=!0,C.renderBufferDirect(q,V,$,G,A,Ee),G.side=0,G.needsUpdate=!0,C.renderBufferDirect(q,V,$,G,A,Ee),G.side=2):C.renderBufferDirect(q,V,$,G,A,Ee),A.onAfterRender(C,V,q,$,G,Ee)}function xm(A,V,q){!0!==V.isScene&&(V=he);const $=w.get(A),G=S.state.lights,ke=G.state.version,Oe=ze.getParameters(A,G.state,S.state.shadowsArray,V,q),je=ze.getProgramCacheKey(Oe);let $e=$.programs;$.environment=A.isMeshStandardMaterial?V.environment:null,$.fog=V.fog,$.envMap=(A.isMeshStandardMaterial?oe:Z).get(A.envMap||$.environment),$.envMapRotation=null!==$.environment&&null===A.envMap?V.environmentRotation:A.envMapRotation,void 0===$e&&(A.addEventListener("dispose",To),$e=new Map,$.programs=$e);let ut=$e.get(je);if(void 0!==ut){if($.currentProgram===ut&&$.lightsStateVersion===ke)return g3(A,Oe),ut}else Oe.uniforms=ze.getUniforms(A),A.onBeforeCompile(Oe,C),ut=ze.acquireProgram(Oe,je),$e.set(je,ut),$.uniforms=Oe.uniforms;const tt=$.uniforms;return(!A.isShaderMaterial&&!A.isRawShaderMaterial||!0===A.clipping)&&(tt.clippingPlanes=He.uniform),g3(A,Oe),$.needsLights=function Jee(A){return A.isMeshLambertMaterial||A.isMeshToonMaterial||A.isMeshPhongMaterial||A.isMeshStandardMaterial||A.isShadowMaterial||A.isShaderMaterial&&!0===A.lights}(A),$.lightsStateVersion=ke,$.needsLights&&(tt.ambientLightColor.value=G.state.ambient,tt.lightProbe.value=G.state.probe,tt.directionalLights.value=G.state.directional,tt.directionalLightShadows.value=G.state.directionalShadow,tt.spotLights.value=G.state.spot,tt.spotLightShadows.value=G.state.spotShadow,tt.rectAreaLights.value=G.state.rectArea,tt.ltc_1.value=G.state.rectAreaLTC1,tt.ltc_2.value=G.state.rectAreaLTC2,tt.pointLights.value=G.state.point,tt.pointLightShadows.value=G.state.pointShadow,tt.hemisphereLights.value=G.state.hemi,tt.directionalShadowMap.value=G.state.directionalShadowMap,tt.directionalShadowMatrix.value=G.state.directionalShadowMatrix,tt.spotShadowMap.value=G.state.spotShadowMap,tt.spotLightMatrix.value=G.state.spotLightMatrix,tt.spotLightMap.value=G.state.spotLightMap,tt.pointShadowMap.value=G.state.pointShadowMap,tt.pointShadowMatrix.value=G.state.pointShadowMatrix),$.currentProgram=ut,$.uniformsList=null,ut}function p3(A){if(null===A.uniformsList){const V=A.currentProgram.getUniforms();A.uniformsList=nm.seqWithValue(V.seq,A.uniforms)}return A.uniformsList}function g3(A,V){const q=w.get(A);q.outputColorSpace=V.outputColorSpace,q.batching=V.batching,q.batchingColor=V.batchingColor,q.instancing=V.instancing,q.instancingColor=V.instancingColor,q.instancingMorph=V.instancingMorph,q.skinning=V.skinning,q.morphTargets=V.morphTargets,q.morphNormals=V.morphNormals,q.morphColors=V.morphColors,q.morphTargetsCount=V.morphTargetsCount,q.numClippingPlanes=V.numClippingPlanes,q.numIntersection=V.numClipIntersection,q.vertexAlphas=V.vertexAlphas,q.vertexTangents=V.vertexTangents,q.toneMapping=V.toneMapping}Ya.setAnimationLoop(function Yee(A){Rb&&Rb(A)}),typeof self<"u"&&Ya.setContext(self),this.setAnimationLoop=function(A){Rb=A,Ce.setAnimationLoop(A),null===A?Ya.stop():Ya.start()},Ce.addEventListener("sessionstart",l3),Ce.addEventListener("sessionend",u3),this.render=function(A,V){if(void 0!==V&&!0!==V.isCamera)return void Ze("WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===E)return;const $=null!==I&&(null===H||!0===Ce.enabled&&!0===Ce.isPresenting)&&I.begin(C,H);if(!0===A.matrixWorldAutoUpdate&&A.updateMatrixWorld(),null===V.parent&&!0===V.matrixWorldAutoUpdate&&V.updateMatrixWorld(),!0===Ce.enabled&&!0===Ce.isPresenting&&(null===I||!1===I.isCompositing())&&(!0===Ce.cameraAutoUpdate&&Ce.updateCamera(V),V=Ce.getCamera()),!0===A.isScene&&A.onBeforeRender(C,A,V,H),S=Pe.get(A,T.length),S.init(V),T.push(S),$t.multiplyMatrices(V.projectionMatrix,V.matrixWorldInverse),Ke.setFromProjectionMatrix($t,Mr,V.reversedDepth),At=this.localClippingEnabled,Ie=He.init(this.clippingPlanes,At),y=fe.get(A,P.length),y.init(),P.push(y),!0===Ce.enabled&&!0===Ce.isPresenting){const ke=C.xr.getDepthSensingMesh();null!==ke&&Nb(ke,V,-1/0,C.sortObjects)}if(Nb(A,V,0,C.sortObjects),y.finish(),!0===C.sortObjects&&y.sort(Lt,Ft),ue=!1===Ce.enabled||!1===Ce.isPresenting||!1===Ce.hasDepthSensing(),ue&&we.addToRenderList(y,A),this.info.render.frame++,!0===Ie&&He.beginShadows(),We.render(S.state.shadowsArray,A,V),!0===Ie&&He.endShadows(),!0===this.info.autoReset&&this.info.reset(),!1===($&&I.hasRenderPass())){const ke=y.opaque,Oe=y.transmissive;if(S.setupLights(),V.isArrayCamera){const je=V.cameras;if(Oe.length>0)for(let $e=0,ut=je.length;$e<ut;$e++)f3(ke,Oe,A,je[$e]);ue&&we.render(A);for(let $e=0,ut=je.length;$e<ut;$e++){const tt=je[$e];d3(y,A,tt,tt.viewport)}}else Oe.length>0&&f3(ke,Oe,A,V),ue&&we.render(A),d3(y,A,V)}null!==H&&0===z&&(B.updateMultisampleRenderTarget(H),B.updateRenderTargetMipmap(H)),$&&I.end(C),!0===A.isScene&&A.onAfterRender(C,A,V),Fe.resetDefaultState(),W=-1,Y=null,T.pop(),T.length>0?(S=T[T.length-1],!0===Ie&&He.setGlobalState(C.clippingPlanes,S.state.camera)):S=null,P.pop(),y=P.length>0?P[P.length-1]:null},this.getActiveCubeFace=function(){return F},this.getActiveMipmapLevel=function(){return z},this.getRenderTarget=function(){return H},this.setRenderTargetTextures=function(A,V,q){const $=w.get(A);$.__autoAllocateDepthBuffer=!1===A.resolveDepthBuffer,!1===$.__autoAllocateDepthBuffer&&($.__useRenderToTexture=!1),w.get(A.texture).__webglTexture=V,w.get(A.depthTexture).__webglTexture=$.__autoAllocateDepthBuffer?void 0:q,$.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(A,V){const q=w.get(A);q.__webglFramebuffer=V,q.__useDefaultFramebuffer=void 0===V};const Qee=N.createFramebuffer();this.setRenderTarget=function(A,V=0,q=0){H=A,F=V,z=q;let $=null,G=!1,Ee=!1;if(A){const Oe=w.get(A);if(void 0!==Oe.__useDefaultFramebuffer)return ve.bindFramebuffer(N.FRAMEBUFFER,Oe.__webglFramebuffer),j.copy(A.viewport),X.copy(A.scissor),ce=A.scissorTest,ve.viewport(j),ve.scissor(X),ve.setScissorTest(ce),void(W=-1);if(void 0===Oe.__webglFramebuffer)B.setupRenderTarget(A);else if(Oe.__hasExternalTextures)B.rebindTextures(A,w.get(A.texture).__webglTexture,w.get(A.depthTexture).__webglTexture);else if(A.depthBuffer){const ut=A.depthTexture;if(Oe.__boundDepthTexture!==ut){if(null!==ut&&w.has(ut)&&(A.width!==ut.image.width||A.height!==ut.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");B.setupDepthRenderbuffer(A)}}const je=A.texture;(je.isData3DTexture||je.isDataArrayTexture||je.isCompressedArrayTexture)&&(Ee=!0);const $e=w.get(A).__webglFramebuffer;A.isWebGLCubeRenderTarget?($=Array.isArray($e[V])?$e[V][q]:$e[V],G=!0):$=A.samples>0&&!1===B.useMultisampledRTT(A)?w.get(A).__webglMultisampledFramebuffer:Array.isArray($e)?$e[q]:$e,j.copy(A.viewport),X.copy(A.scissor),ce=A.scissorTest}else j.copy(ee).multiplyScalar(Je).floor(),X.copy(le).multiplyScalar(Je).floor(),ce=Ue;if(0!==q&&($=Qee),ve.bindFramebuffer(N.FRAMEBUFFER,$)&&ve.drawBuffers(A,$),ve.viewport(j),ve.scissor(X),ve.setScissorTest(ce),G){const Oe=w.get(A.texture);N.framebufferTexture2D(N.FRAMEBUFFER,N.COLOR_ATTACHMENT0,N.TEXTURE_CUBE_MAP_POSITIVE_X+V,Oe.__webglTexture,q)}else if(Ee){const Oe=V;for(let je=0;je<A.textures.length;je++){const $e=w.get(A.textures[je]);N.framebufferTextureLayer(N.FRAMEBUFFER,N.COLOR_ATTACHMENT0+je,$e.__webglTexture,q,Oe)}}else if(null!==A&&0!==q){const Oe=w.get(A.texture);N.framebufferTexture2D(N.FRAMEBUFFER,N.COLOR_ATTACHMENT0,N.TEXTURE_2D,Oe.__webglTexture,q)}W=-1},this.readRenderTargetPixels=function(A,V,q,$,G,Ee,ke,Oe=0){if(!A||!A.isWebGLRenderTarget)return void Ze("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let je=w.get(A).__webglFramebuffer;if(A.isWebGLCubeRenderTarget&&void 0!==ke&&(je=je[ke]),je){ve.bindFramebuffer(N.FRAMEBUFFER,je);try{const $e=A.textures[Oe],ut=$e.format,tt=$e.type;if(!rt.textureFormatReadable(ut))return void Ze("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!rt.textureTypeReadable(tt))return void Ze("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");V>=0&&V<=A.width-$&&q>=0&&q<=A.height-G&&(A.textures.length>1&&N.readBuffer(N.COLOR_ATTACHMENT0+Oe),N.readPixels(V,q,$,G,me.convert(ut),me.convert(tt),Ee))}finally{const $e=null!==H?w.get(H).__webglFramebuffer:null;ve.bindFramebuffer(N.FRAMEBUFFER,$e)}}},this.readRenderTargetPixelsAsync=function(){var A=ki(function*(V,q,$,G,Ee,ke,Oe,je=0){if(!V||!V.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let $e=w.get(V).__webglFramebuffer;if(V.isWebGLCubeRenderTarget&&void 0!==Oe&&($e=$e[Oe]),$e){if(q>=0&&q<=V.width-G&&$>=0&&$<=V.height-Ee){ve.bindFramebuffer(N.FRAMEBUFFER,$e);const ut=V.textures[je],tt=ut.format,Nt=ut.type;if(!rt.textureFormatReadable(tt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!rt.textureTypeReadable(Nt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const qt=N.createBuffer();N.bindBuffer(N.PIXEL_PACK_BUFFER,qt),N.bufferData(N.PIXEL_PACK_BUFFER,ke.byteLength,N.STREAM_READ),V.textures.length>1&&N.readBuffer(N.COLOR_ATTACHMENT0+je),N.readPixels(q,$,G,Ee,me.convert(tt),me.convert(Nt),0);const Nn=null!==H?w.get(H).__webglFramebuffer:null;ve.bindFramebuffer(N.FRAMEBUFFER,Nn);const xn=N.fenceSync(N.SYNC_GPU_COMMANDS_COMPLETE,0);return N.flush(),yield function Q7(n,e,t){return new Promise(function(i,r){setTimeout(function o(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:r();break;case n.TIMEOUT_EXPIRED:setTimeout(o,t);break;default:i()}},t)})}(N,xn,4),N.bindBuffer(N.PIXEL_PACK_BUFFER,qt),N.getBufferSubData(N.PIXEL_PACK_BUFFER,0,ke),N.deleteBuffer(qt),N.deleteSync(xn),ke}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}});return function(V,q,$,G,Ee,ke,Oe){return A.apply(this,arguments)}}(),this.copyFramebufferToTexture=function(A,V=null,q=0){const $=Math.pow(2,-q),G=Math.floor(A.image.width*$),Ee=Math.floor(A.image.height*$),ke=null!==V?V.x:0,Oe=null!==V?V.y:0;B.setTexture2D(A,0),N.copyTexSubImage2D(N.TEXTURE_2D,q,0,0,ke,Oe,G,Ee),ve.unbindTexture()};const ete=N.createFramebuffer(),tte=N.createFramebuffer();this.copyTextureToTexture=function(A,V,q=null,$=null,G=0,Ee=null){let ke,Oe,je,$e,ut,tt,Nt,qt,Nn;null===Ee&&(0!==G?(Ud("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Ee=G,G=0):Ee=0);const xn=A.isCompressedTexture?A.mipmaps[Ee]:A.image;if(null!==q)ke=q.max.x-q.min.x,Oe=q.max.y-q.min.y,je=q.isBox3?q.max.z-q.min.z:1,$e=q.min.x,ut=q.min.y,tt=q.isBox3?q.min.z:0;else{const Ar=Math.pow(2,-G);ke=Math.floor(xn.width*Ar),Oe=Math.floor(xn.height*Ar),je=A.isDataArrayTexture?xn.depth:A.isData3DTexture?Math.floor(xn.depth*Ar):1,$e=0,ut=0,tt=0}null!==$?(Nt=$.x,qt=$.y,Nn=$.z):(Nt=0,qt=0,Nn=0);const an=me.convert(V.format),nt=me.convert(V.type);let Qt;V.isData3DTexture?(B.setTexture3D(V,0),Qt=N.TEXTURE_3D):V.isDataArrayTexture||V.isCompressedArrayTexture?(B.setTexture2DArray(V,0),Qt=N.TEXTURE_2D_ARRAY):(B.setTexture2D(V,0),Qt=N.TEXTURE_2D),N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,V.flipY),N.pixelStorei(N.UNPACK_PREMULTIPLY_ALPHA_WEBGL,V.premultiplyAlpha),N.pixelStorei(N.UNPACK_ALIGNMENT,V.unpackAlignment);const Vt=N.getParameter(N.UNPACK_ROW_LENGTH),lr=N.getParameter(N.UNPACK_IMAGE_HEIGHT),Jl=N.getParameter(N.UNPACK_SKIP_PIXELS),ur=N.getParameter(N.UNPACK_SKIP_ROWS),Ef=N.getParameter(N.UNPACK_SKIP_IMAGES);N.pixelStorei(N.UNPACK_ROW_LENGTH,xn.width),N.pixelStorei(N.UNPACK_IMAGE_HEIGHT,xn.height),N.pixelStorei(N.UNPACK_SKIP_PIXELS,$e),N.pixelStorei(N.UNPACK_SKIP_ROWS,ut),N.pixelStorei(N.UNPACK_SKIP_IMAGES,tt);const _n=A.isDataArrayTexture||A.isData3DTexture,ji=V.isDataArrayTexture||V.isData3DTexture;if(A.isDepthTexture){const Ar=w.get(A),Ai=w.get(V),Wi=w.get(Ar.__renderTarget),Lb=w.get(Ai.__renderTarget);ve.bindFramebuffer(N.READ_FRAMEBUFFER,Wi.__webglFramebuffer),ve.bindFramebuffer(N.DRAW_FRAMEBUFFER,Lb.__webglFramebuffer);for(let Za=0;Za<je;Za++)_n&&(N.framebufferTextureLayer(N.READ_FRAMEBUFFER,N.COLOR_ATTACHMENT0,w.get(A).__webglTexture,G,tt+Za),N.framebufferTextureLayer(N.DRAW_FRAMEBUFFER,N.COLOR_ATTACHMENT0,w.get(V).__webglTexture,Ee,Nn+Za)),N.blitFramebuffer($e,ut,ke,Oe,Nt,qt,ke,Oe,N.DEPTH_BUFFER_BIT,N.NEAREST);ve.bindFramebuffer(N.READ_FRAMEBUFFER,null),ve.bindFramebuffer(N.DRAW_FRAMEBUFFER,null)}else if(0!==G||A.isRenderTargetTexture||w.has(A)){const Ar=w.get(A),Ai=w.get(V);ve.bindFramebuffer(N.READ_FRAMEBUFFER,ete),ve.bindFramebuffer(N.DRAW_FRAMEBUFFER,tte);for(let Wi=0;Wi<je;Wi++)_n?N.framebufferTextureLayer(N.READ_FRAMEBUFFER,N.COLOR_ATTACHMENT0,Ar.__webglTexture,G,tt+Wi):N.framebufferTexture2D(N.READ_FRAMEBUFFER,N.COLOR_ATTACHMENT0,N.TEXTURE_2D,Ar.__webglTexture,G),ji?N.framebufferTextureLayer(N.DRAW_FRAMEBUFFER,N.COLOR_ATTACHMENT0,Ai.__webglTexture,Ee,Nn+Wi):N.framebufferTexture2D(N.DRAW_FRAMEBUFFER,N.COLOR_ATTACHMENT0,N.TEXTURE_2D,Ai.__webglTexture,Ee),0!==G?N.blitFramebuffer($e,ut,ke,Oe,Nt,qt,ke,Oe,N.COLOR_BUFFER_BIT,N.NEAREST):ji?N.copyTexSubImage3D(Qt,Ee,Nt,qt,Nn+Wi,$e,ut,ke,Oe):N.copyTexSubImage2D(Qt,Ee,Nt,qt,$e,ut,ke,Oe);ve.bindFramebuffer(N.READ_FRAMEBUFFER,null),ve.bindFramebuffer(N.DRAW_FRAMEBUFFER,null)}else ji?A.isDataTexture||A.isData3DTexture?N.texSubImage3D(Qt,Ee,Nt,qt,Nn,ke,Oe,je,an,nt,xn.data):V.isCompressedArrayTexture?N.compressedTexSubImage3D(Qt,Ee,Nt,qt,Nn,ke,Oe,je,an,xn.data):N.texSubImage3D(Qt,Ee,Nt,qt,Nn,ke,Oe,je,an,nt,xn):A.isDataTexture?N.texSubImage2D(N.TEXTURE_2D,Ee,Nt,qt,ke,Oe,an,nt,xn.data):A.isCompressedTexture?N.compressedTexSubImage2D(N.TEXTURE_2D,Ee,Nt,qt,xn.width,xn.height,an,xn.data):N.texSubImage2D(N.TEXTURE_2D,Ee,Nt,qt,ke,Oe,an,nt,xn);N.pixelStorei(N.UNPACK_ROW_LENGTH,Vt),N.pixelStorei(N.UNPACK_IMAGE_HEIGHT,lr),N.pixelStorei(N.UNPACK_SKIP_PIXELS,Jl),N.pixelStorei(N.UNPACK_SKIP_ROWS,ur),N.pixelStorei(N.UNPACK_SKIP_IMAGES,Ef),0===Ee&&V.generateMipmaps&&N.generateMipmap(Qt),ve.unbindTexture()},this.initRenderTarget=function(A){void 0===w.get(A).__webglFramebuffer&&B.setupRenderTarget(A)},this.initTexture=function(A){A.isCubeTexture?B.setTextureCube(A,0):A.isData3DTexture?B.setTexture3D(A,0):A.isDataArrayTexture||A.isCompressedArrayTexture?B.setTexture2DArray(A,0):B.setTexture2D(A,0),ve.unbindTexture()},this.resetState=function(){F=0,z=0,H=null,ve.reset(),Fe.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Mr}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=Tt._getDrawingBufferColorSpace(e),t.unpackColorSpace=Tt._getUnpackColorSpace()}}const YZ=/^[og]\s*(.+)?/,ZZ=/^mtllib /,KZ=/^usemtl /,JZ=/^usemap /,H2=/\s+/,G2=new R,ib=new R,j2=new R,W2=new R,Er=new R,rm=new xe;function QZ(){const n={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);const i=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(r,o){const s=this._finalize(!1);s&&(s.inherited||s.groupCount<=0)&&this.materials.splice(s.index,1);const a={index:this.materials.length,name:r||"",mtllib:Array.isArray(o)&&o.length>0?o[o.length-1]:"",smooth:void 0!==s?s.smooth:this.smooth,groupStart:void 0!==s?s.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(c){const l={index:"number"==typeof c?c:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return l.clone=this.clone.bind(l),l}};return this.materials.push(a),a},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(r){const o=this.currentMaterial();if(o&&-1===o.groupEnd&&(o.groupEnd=this.geometry.vertices.length/3,o.groupCount=o.groupEnd-o.groupStart,o.inherited=!1),r&&this.materials.length>1)for(let s=this.materials.length-1;s>=0;s--)this.materials[s].groupCount<=0&&this.materials.splice(s,1);return r&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),o}},i&&i.name&&"function"==typeof i.clone){const r=i.clone(0);r.inherited=!0,this.object.materials.push(r)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){const i=parseInt(e,10);return 3*(i>=0?i-1:i+t/3)},parseNormalIndex:function(e,t){const i=parseInt(e,10);return 3*(i>=0?i-1:i+t/3)},parseUVIndex:function(e,t){const i=parseInt(e,10);return 2*(i>=0?i-1:i+t/2)},addVertex:function(e,t,i){const r=this.vertices,o=this.object.geometry.vertices;o.push(r[e+0],r[e+1],r[e+2]),o.push(r[t+0],r[t+1],r[t+2]),o.push(r[i+0],r[i+1],r[i+2])},addVertexPoint:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,i){const r=this.normals,o=this.object.geometry.normals;o.push(r[e+0],r[e+1],r[e+2]),o.push(r[t+0],r[t+1],r[t+2]),o.push(r[i+0],r[i+1],r[i+2])},addFaceNormal:function(e,t,i){const r=this.vertices,o=this.object.geometry.normals;G2.fromArray(r,e),ib.fromArray(r,t),j2.fromArray(r,i),Er.subVectors(j2,ib),W2.subVectors(G2,ib),Er.cross(W2),Er.normalize(),o.push(Er.x,Er.y,Er.z),o.push(Er.x,Er.y,Er.z),o.push(Er.x,Er.y,Er.z)},addColor:function(e,t,i){const r=this.colors,o=this.object.geometry.colors;void 0!==r[e]&&o.push(r[e+0],r[e+1],r[e+2]),void 0!==r[t]&&o.push(r[t+0],r[t+1],r[t+2]),void 0!==r[i]&&o.push(r[i+0],r[i+1],r[i+2])},addUV:function(e,t,i){const r=this.uvs,o=this.object.geometry.uvs;o.push(r[e+0],r[e+1]),o.push(r[t+0],r[t+1]),o.push(r[i+0],r[i+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,i,r,o,s,a,c,l){const u=this.vertices.length;let d=this.parseVertexIndex(e,u),f=this.parseVertexIndex(t,u),h=this.parseVertexIndex(i,u);if(this.addVertex(d,f,h),this.addColor(d,f,h),void 0!==a&&""!==a){const p=this.normals.length;d=this.parseNormalIndex(a,p),f=this.parseNormalIndex(c,p),h=this.parseNormalIndex(l,p),this.addNormal(d,f,h)}else this.addFaceNormal(d,f,h);if(void 0!==r&&""!==r){const p=this.uvs.length;d=this.parseUVIndex(r,p),f=this.parseUVIndex(o,p),h=this.parseUVIndex(s,p),this.addUV(d,f,h),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const t=this.vertices.length;for(let i=0,r=e.length;i<r;i++){const o=this.parseVertexIndex(e[i],t);this.addVertexPoint(o),this.addColor(o)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";const i=this.vertices.length,r=this.uvs.length;for(let o=0,s=e.length;o<s;o++)this.addVertexLine(this.parseVertexIndex(e[o],i));for(let o=0,s=t.length;o<s;o++)this.addUVLine(this.parseUVIndex(t[o],r))}};return n.startObject("",!1),n}class eK extends Ei{constructor(e){super(e),this.materials=null}load(e,t,i,r){const o=this,s=new Pr(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(a){try{t(o.parse(a))}catch(c){r?r(c):console.error(c),o.manager.itemError(e)}},i,r)}setMaterials(e){return this.materials=e,this}parse(e){const t=new QZ;-1!==e.indexOf("\r\n")&&(e=e.replace(/\r\n/g,"\n")),-1!==e.indexOf("\\\n")&&(e=e.replace(/\\\n/g,""));const i=e.split("\n");let r=[];for(let a=0,c=i.length;a<c;a++){const l=i[a].trimStart();if(0===l.length)continue;const u=l.charAt(0);if("#"!==u)if("v"===u){const d=l.split(H2);switch(d[0]){case"v":t.vertices.push(parseFloat(d[1]),parseFloat(d[2]),parseFloat(d[3])),d.length>=7?(rm.setRGB(parseFloat(d[4]),parseFloat(d[5]),parseFloat(d[6]),vn),t.colors.push(rm.r,rm.g,rm.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(d[1]),parseFloat(d[2]),parseFloat(d[3]));break;case"vt":t.uvs.push(parseFloat(d[1]),parseFloat(d[2]))}}else if("f"===u){const f=l.slice(1).trim().split(H2),h=[];for(let _=0,m=f.length;_<m;_++){const g=f[_];if(g.length>0){const v=g.split("/");h.push(v)}}const p=h[0];for(let _=1,m=h.length-1;_<m;_++){const g=h[_],v=h[_+1];t.addFace(p[0],g[0],v[0],p[1],g[1],v[1],p[2],g[2],v[2])}}else if("l"===u){const d=l.substring(1).trim().split(" ");let f=[];const h=[];if(-1===l.indexOf("/"))f=d;else for(let p=0,_=d.length;p<_;p++){const m=d[p].split("/");""!==m[0]&&f.push(m[0]),""!==m[1]&&h.push(m[1])}t.addLineGeometry(f,h)}else if("p"===u){const f=l.slice(1).trim().split(" ");t.addPointGeometry(f)}else if(null!==(r=YZ.exec(l))){const d=(" "+r[0].slice(1).trim()).slice(1);t.startObject(d)}else if(KZ.test(l))t.object.startMaterial(l.substring(7).trim(),t.materialLibraries);else if(ZZ.test(l))t.materialLibraries.push(l.substring(7).trim());else if(JZ.test(l))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===u){if(r=l.split(" "),r.length>1){const f=r[1].trim().toLowerCase();t.object.smooth="0"!==f&&"off"!==f}else t.object.smooth=!0;const d=t.object.currentMaterial();d&&(d.smooth=t.object.smooth)}else{if("\0"===l)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+l+'"')}}t.finalize();const o=new as;if(o.materialLibraries=[].concat(t.materialLibraries),1==!(1===t.objects.length&&0===t.objects[0].geometry.vertices.length))for(let a=0,c=t.objects.length;a<c;a++){const l=t.objects[a],u=l.geometry,d=l.materials,f="Line"===u.type,h="Points"===u.type;let p=!1;if(0===u.vertices.length)continue;const _=new pt;_.setAttribute("position",new Ne(u.vertices,3)),u.normals.length>0&&_.setAttribute("normal",new Ne(u.normals,3)),u.colors.length>0&&(p=!0,_.setAttribute("color",new Ne(u.colors,3))),!0===u.hasUVIndices&&_.setAttribute("uv",new Ne(u.uvs,2));const m=[];for(let v=0,x=d.length;v<x;v++){const y=d[v],S=y.name+"_"+y.smooth+"_"+p;let P=t.materials[S];if(null!==this.materials)if(P=this.materials.create(y.name),!f||!P||P instanceof Kn){if(h&&P&&!(P instanceof Da)){const T=new Da({size:10,sizeAttenuation:!1});Un.prototype.copy.call(T,P),T.color.copy(P.color),T.map=P.map,P=T}}else{const T=new Kn;Un.prototype.copy.call(T,P),T.color.copy(P.color),P=T}void 0===P&&(P=f?new Kn:h?new Da({size:1,sizeAttenuation:!1}):new RM,P.name=y.name,P.flatShading=!y.smooth,P.vertexColors=p,t.materials[S]=P),m.push(P)}let g;if(m.length>1){for(let v=0,x=d.length;v<x;v++){const y=d[v];_.addGroup(y.groupStart,y.groupCount,v)}g=f?new Sr(_,m):h?new ef(_,m):new Gt(_,m)}else g=f?new Sr(_,m[0]):h?new ef(_,m[0]):new Gt(_,m[0]);g.name=l.name,o.add(g)}else if(t.vertices.length>0){const a=new Da({size:1,sizeAttenuation:!1}),c=new pt;c.setAttribute("position",new Ne(t.vertices,3)),t.colors.length>0&&void 0!==t.colors[0]&&(c.setAttribute("color",new Ne(t.colors,3)),a.vertexColors=!0);const l=new ef(c,a);o.add(l)}return o}}class tK extends Ei{constructor(e){super(e)}load(e,t,i,r){const o=this,s=""===this.path?Gs.extractUrlBase(e):this.path,a=new Pr(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(c){try{t(o.parse(c,s))}catch(l){r?r(l):console.error(l),o.manager.itemError(e)}},i,r)}setMaterialOptions(e){return this.materialOptions=e,this}parse(e,t){const i=e.split("\n");let r={};const o=/\s+/,s={};for(let c=0;c<i.length;c++){let l=i[c];if(l=l.trim(),0===l.length||"#"===l.charAt(0))continue;const u=l.indexOf(" ");let d=u>=0?l.substring(0,u):l;d=d.toLowerCase();let f=u>=0?l.substring(u+1):"";if(f=f.trim(),"newmtl"===d)r={name:f},s[f]=r;else if("ka"===d||"kd"===d||"ks"===d||"ke"===d){const h=f.split(o,3);r[d]=[parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2])]}else r[d]=f}const a=new nK(this.resourcePath||t,this.materialOptions);return a.setCrossOrigin(this.crossOrigin),a.setManager(this.manager),a.setMaterials(s),a}}class nK{constructor(e="",t={}){this.baseUrl=e,this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=void 0!==this.options.side?this.options.side:0,this.wrap=void 0!==this.options.wrap?this.options.wrap:Ds}setCrossOrigin(e){return this.crossOrigin=e,this}setManager(e){this.manager=e}setMaterials(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(e){if(!this.options)return e;const t={};for(const i in e){const r=e[i],o={};t[i]=o;for(const s in r){let a=!0,c=r[s];const l=s.toLowerCase();switch(l){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(c=[c[0]/255,c[1]/255,c[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===c[0]&&0===c[1]&&0===c[2]&&(a=!1)}a&&(o[l]=c)}}return t}preload(){for(const e in this.materialsInfo)this.create(e)}getIndex(e){return this.nameLookup[e]}getAsArray(){let e=0;for(const t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray}create(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]}createMaterial_(e){const t=this,i=this.materialsInfo[e],r={name:e,side:this.side};function s(a,c){if(r[a])return;const l=t.getTextureParams(c,r),u=t.loadTexture(function o(a,c){return"string"!=typeof c||""===c?"":/^https?:\/\//i.test(c)?c:a+c}(t.baseUrl,l.url));u.repeat.copy(l.scale),u.offset.copy(l.offset),u.wrapS=t.wrap,u.wrapT=t.wrap,("map"===a||"emissiveMap"===a)&&(u.colorSpace=vn),r[a]=u}for(const a in i){const c=i[a];let l;if(""!==c)switch(a.toLowerCase()){case"kd":r.color=Tt.colorSpaceToWorking((new xe).fromArray(c),vn);break;case"ks":r.specular=Tt.colorSpaceToWorking((new xe).fromArray(c),vn);break;case"ke":r.emissive=Tt.colorSpaceToWorking((new xe).fromArray(c),vn);break;case"map_kd":s("map",c);break;case"map_ks":s("specularMap",c);break;case"map_ke":s("emissiveMap",c);break;case"norm":s("normalMap",c);break;case"map_bump":case"bump":s("bumpMap",c);break;case"disp":s("displacementMap",c);break;case"map_d":s("alphaMap",c),r.transparent=!0;break;case"ns":r.shininess=parseFloat(c);break;case"d":l=parseFloat(c),l<1&&(r.opacity=l,r.transparent=!0);break;case"tr":l=parseFloat(c),this.options&&this.options.invertTrProperty&&(l=1-l),l>0&&(r.opacity=1-l,r.transparent=!0)}}return this.materials[e]=new RM(r),this.materials[e]}getTextureParams(e,t){const i={scale:new re(1,1),offset:new re(0,0)},r=e.split(/\s+/);let o;return o=r.indexOf("-bm"),o>=0&&(t.bumpScale=parseFloat(r[o+1]),r.splice(o,2)),o=r.indexOf("-mm"),o>=0&&(t.displacementBias=parseFloat(r[o+1]),t.displacementScale=parseFloat(r[o+2]),r.splice(o,3)),o=r.indexOf("-s"),o>=0&&(i.scale.set(parseFloat(r[o+1]),parseFloat(r[o+2])),r.splice(o,4)),o=r.indexOf("-o"),o>=0&&(i.offset.set(parseFloat(r[o+1]),parseFloat(r[o+2])),r.splice(o,4)),i.url=r.join(" ").trim(),i}loadTexture(e,t,i,r,o){const s=void 0!==this.manager?this.manager:zI;let a=s.getHandler(e);null===a&&(a=new HI(s)),a.setCrossOrigin&&a.setCrossOrigin(this.crossOrigin);const c=a.load(e,i,r,o);return void 0!==t&&(c.mapping=t),c}}function q2(n,e){if(0===e)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(2===e||1===e){let t=n.getIndex();if(null===t){const s=[],a=n.getAttribute("position");if(void 0===a)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n;for(let c=0;c<a.count;c++)s.push(c);n.setIndex(s),t=n.getIndex()}const i=t.count-2,r=[];if(2===e)for(let s=1;s<=i;s++)r.push(t.getX(0)),r.push(t.getX(s)),r.push(t.getX(s+1));else for(let s=0;s<i;s++)s%2==0?(r.push(t.getX(s)),r.push(t.getX(s+1)),r.push(t.getX(s+2))):(r.push(t.getX(s+2)),r.push(t.getX(s+1)),r.push(t.getX(s)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const o=n.clone();return o.setIndex(r),o.clearGroups(),o}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}class X2 extends Ei{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new aK(t)}),this.register(function(t){return new cK(t)}),this.register(function(t){return new _K(t)}),this.register(function(t){return new vK(t)}),this.register(function(t){return new xK(t)}),this.register(function(t){return new uK(t)}),this.register(function(t){return new dK(t)}),this.register(function(t){return new fK(t)}),this.register(function(t){return new hK(t)}),this.register(function(t){return new sK(t)}),this.register(function(t){return new pK(t)}),this.register(function(t){return new lK(t)}),this.register(function(t){return new mK(t)}),this.register(function(t){return new gK(t)}),this.register(function(t){return new rK(t)}),this.register(function(t){return new yK(t)}),this.register(function(t){return new MK(t)})}load(e,t,i,r){const o=this;let s;if(""!==this.resourcePath)s=this.resourcePath;else if(""!==this.path){const l=Gs.extractUrlBase(e);s=Gs.resolveURL(l,this.path)}else s=Gs.extractUrlBase(e);this.manager.itemStart(e);const a=function(l){r?r(l):console.error(l),o.manager.itemError(e),o.manager.itemEnd(e)},c=new Pr(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(l){try{o.parse(l,s,function(u){t(u),o.manager.itemEnd(e)},a)}catch(u){a(u)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let o;const s={},a={},c=new TextDecoder;if("string"==typeof e)o=JSON.parse(e);else if(e instanceof ArrayBuffer)if(c.decode(new Uint8Array(e,0,4))===Y2){try{s[Rt.KHR_BINARY_GLTF]=new bK(e)}catch(d){return void(r&&r(d))}o=JSON.parse(s[Rt.KHR_BINARY_GLTF].content)}else o=JSON.parse(c.decode(e));else o=e;if(void 0===o.asset||o.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const l=new LK(o,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const d=this.pluginCallbacks[u](l);d.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[d.name]=d,s[d.name]=!0}if(o.extensionsUsed)for(let u=0;u<o.extensionsUsed.length;++u){const d=o.extensionsUsed[u],f=o.extensionsRequired||[];switch(d){case Rt.KHR_MATERIALS_UNLIT:s[d]=new oK;break;case Rt.KHR_DRACO_MESH_COMPRESSION:s[d]=new CK(o,this.dracoLoader);break;case Rt.KHR_TEXTURE_TRANSFORM:s[d]=new wK;break;case Rt.KHR_MESH_QUANTIZATION:s[d]=new SK;break;default:f.indexOf(d)>=0&&void 0===a[d]&&console.warn('THREE.GLTFLoader: Unknown extension "'+d+'".')}}l.setExtensions(s),l.setPlugins(a),l.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,o){i.parse(e,t,r,o)})}}function iK(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const Rt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class rK{constructor(e){this.parser=e,this.name=Rt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const o=t[i];o.extensions&&o.extensions[this.name]&&void 0!==o.extensions[this.name].light&&e._addNodeRef(this.cache,o.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const o=t.json,c=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e];let l;const u=new xe(16777215);void 0!==c.color&&u.setRGB(c.color[0],c.color[1],c.color[2],bi);const d=void 0!==c.range?c.range:0;switch(c.type){case"directional":l=new jl(u),l.target.position.set(0,0,-1),l.add(l.target);break;case"point":l=new $I(u),l.distance=d;break;case"spot":l=new WI(u),l.distance=d,c.spot=c.spot||{},c.spot.innerConeAngle=void 0!==c.spot.innerConeAngle?c.spot.innerConeAngle:0,c.spot.outerConeAngle=void 0!==c.spot.outerConeAngle?c.spot.outerConeAngle:Math.PI/4,l.angle=c.spot.outerConeAngle,l.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle,l.target.position.set(0,0,-1),l.add(l.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}return l.position.set(0,0,0),Po(l,c),void 0!==c.intensity&&(l.intensity=c.intensity),l.name=t.createUniqueName(c.name||"light_"+e),r=Promise.resolve(l),t.cache.add(i,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,o=i.json.nodes[e],a=(o.extensions&&o.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then(function(c){return i._getNodeRef(t.cache,a,c)})}}class oK{constructor(){this.name=Rt.KHR_MATERIALS_UNLIT}getMaterialType(){return Cr}extendParams(e,t,i){const r=[];e.color=new xe(1,1,1),e.opacity=1;const o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){const s=o.baseColorFactor;e.color.setRGB(s[0],s[1],s[2],bi),e.opacity=s[3]}void 0!==o.baseColorTexture&&r.push(i.assignTexture(e,"map",o.baseColorTexture,vn))}return Promise.all(r)}}class sK{constructor(e){this.parser=e,this.name=Rt.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=r.extensions[this.name].emissiveStrength;return void 0!==o&&(t.emissiveIntensity=o),Promise.resolve()}}class aK{constructor(e){this.parser=e,this.name=Rt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Xr:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],s=r.extensions[this.name];if(void 0!==s.clearcoatFactor&&(t.clearcoat=s.clearcoatFactor),void 0!==s.clearcoatTexture&&o.push(i.assignTexture(t,"clearcoatMap",s.clearcoatTexture)),void 0!==s.clearcoatRoughnessFactor&&(t.clearcoatRoughness=s.clearcoatRoughnessFactor),void 0!==s.clearcoatRoughnessTexture&&o.push(i.assignTexture(t,"clearcoatRoughnessMap",s.clearcoatRoughnessTexture)),void 0!==s.clearcoatNormalTexture&&(o.push(i.assignTexture(t,"clearcoatNormalMap",s.clearcoatNormalTexture)),void 0!==s.clearcoatNormalTexture.scale)){const a=s.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new re(a,a)}return Promise.all(o)}}class cK{constructor(e){this.parser=e,this.name=Rt.KHR_MATERIALS_DISPERSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Xr:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=r.extensions[this.name];return t.dispersion=void 0!==o.dispersion?o.dispersion:0,Promise.resolve()}}class lK{constructor(e){this.parser=e,this.name=Rt.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Xr:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],s=r.extensions[this.name];return void 0!==s.iridescenceFactor&&(t.iridescence=s.iridescenceFactor),void 0!==s.iridescenceTexture&&o.push(i.assignTexture(t,"iridescenceMap",s.iridescenceTexture)),void 0!==s.iridescenceIor&&(t.iridescenceIOR=s.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==s.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=s.iridescenceThicknessMinimum),void 0!==s.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=s.iridescenceThicknessMaximum),void 0!==s.iridescenceThicknessTexture&&o.push(i.assignTexture(t,"iridescenceThicknessMap",s.iridescenceThicknessTexture)),Promise.all(o)}}class uK{constructor(e){this.parser=e,this.name=Rt.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Xr:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[];t.sheenColor=new xe(0,0,0),t.sheenRoughness=0,t.sheen=1;const s=r.extensions[this.name];if(void 0!==s.sheenColorFactor){const a=s.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],bi)}return void 0!==s.sheenRoughnessFactor&&(t.sheenRoughness=s.sheenRoughnessFactor),void 0!==s.sheenColorTexture&&o.push(i.assignTexture(t,"sheenColorMap",s.sheenColorTexture,vn)),void 0!==s.sheenRoughnessTexture&&o.push(i.assignTexture(t,"sheenRoughnessMap",s.sheenRoughnessTexture)),Promise.all(o)}}class dK{constructor(e){this.parser=e,this.name=Rt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Xr:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],s=r.extensions[this.name];return void 0!==s.transmissionFactor&&(t.transmission=s.transmissionFactor),void 0!==s.transmissionTexture&&o.push(i.assignTexture(t,"transmissionMap",s.transmissionTexture)),Promise.all(o)}}class fK{constructor(e){this.parser=e,this.name=Rt.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Xr:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],s=r.extensions[this.name];t.thickness=void 0!==s.thicknessFactor?s.thicknessFactor:0,void 0!==s.thicknessTexture&&o.push(i.assignTexture(t,"thicknessMap",s.thicknessTexture)),t.attenuationDistance=s.attenuationDistance||1/0;const a=s.attenuationColor||[1,1,1];return t.attenuationColor=(new xe).setRGB(a[0],a[1],a[2],bi),Promise.all(o)}}class hK{constructor(e){this.parser=e,this.name=Rt.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Xr:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=r.extensions[this.name];return t.ior=void 0!==o.ior?o.ior:1.5,Promise.resolve()}}class pK{constructor(e){this.parser=e,this.name=Rt.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Xr:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],s=r.extensions[this.name];t.specularIntensity=void 0!==s.specularFactor?s.specularFactor:1,void 0!==s.specularTexture&&o.push(i.assignTexture(t,"specularIntensityMap",s.specularTexture));const a=s.specularColorFactor||[1,1,1];return t.specularColor=(new xe).setRGB(a[0],a[1],a[2],bi),void 0!==s.specularColorTexture&&o.push(i.assignTexture(t,"specularColorMap",s.specularColorTexture,vn)),Promise.all(o)}}class gK{constructor(e){this.parser=e,this.name=Rt.EXT_MATERIALS_BUMP}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Xr:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],s=r.extensions[this.name];return t.bumpScale=void 0!==s.bumpFactor?s.bumpFactor:1,void 0!==s.bumpTexture&&o.push(i.assignTexture(t,"bumpMap",s.bumpTexture)),Promise.all(o)}}class mK{constructor(e){this.parser=e,this.name=Rt.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Xr:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],s=r.extensions[this.name];return void 0!==s.anisotropyStrength&&(t.anisotropy=s.anisotropyStrength),void 0!==s.anisotropyRotation&&(t.anisotropyRotation=s.anisotropyRotation),void 0!==s.anisotropyTexture&&o.push(i.assignTexture(t,"anisotropyMap",s.anisotropyTexture)),Promise.all(o)}}class _K{constructor(e){this.parser=e,this.name=Rt.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const o=r.extensions[this.name],s=t.options.ktx2Loader;if(!s){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,o.source,s)}}class vK{constructor(e){this.parser=e,this.name=Rt.EXT_TEXTURE_WEBP}loadTexture(e){const t=this.name,i=this.parser,r=i.json,o=r.textures[e];if(!o.extensions||!o.extensions[t])return null;const s=o.extensions[t],a=r.images[s.source];let c=i.textureLoader;if(a.uri){const l=i.options.manager.getHandler(a.uri);null!==l&&(c=l)}return i.loadTextureImage(e,s.source,c)}}class xK{constructor(e){this.parser=e,this.name=Rt.EXT_TEXTURE_AVIF}loadTexture(e){const t=this.name,i=this.parser,r=i.json,o=r.textures[e];if(!o.extensions||!o.extensions[t])return null;const s=o.extensions[t],a=r.images[s.source];let c=i.textureLoader;if(a.uri){const l=i.options.manager.getHandler(a.uri);null!==l&&(c=l)}return i.loadTextureImage(e,s.source,c)}}class yK{constructor(e){this.name=Rt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],o=this.parser.getDependency("buffer",r.buffer),s=this.parser.options.meshoptDecoder;if(!s||!s.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return o.then(function(a){const u=r.count,d=r.byteStride,f=new Uint8Array(a,r.byteOffset||0,r.byteLength||0);return s.decodeGltfBufferAsync?s.decodeGltfBufferAsync(u,d,f,r.mode,r.filter).then(function(h){return h.buffer}):s.ready.then(function(){const h=new ArrayBuffer(u*d);return s.decodeGltfBuffer(new Uint8Array(h),u,d,f,r.mode,r.filter),h})})}return null}}class MK{constructor(e){this.name=Rt.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||void 0===i.mesh)return null;const r=t.meshes[i.mesh];for(const l of r.primitives)if(l.mode!==Tr.TRIANGLES&&l.mode!==Tr.TRIANGLE_STRIP&&l.mode!==Tr.TRIANGLE_FAN&&void 0!==l.mode)return null;const s=i.extensions[this.name].attributes,a=[],c={};for(const l in s)a.push(this.parser.getDependency("accessor",s[l]).then(u=>(c[l]=u,c[l])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(l=>{const u=l.pop(),d=u.isGroup?u.children:[u],f=l[0].count,h=[];for(const p of d){const _=new it,m=new R,g=new wi,v=new R(1,1,1),x=new cI(p.geometry,p.material,f);for(let y=0;y<f;y++)c.TRANSLATION&&m.fromBufferAttribute(c.TRANSLATION,y),c.ROTATION&&g.fromBufferAttribute(c.ROTATION,y),c.SCALE&&v.fromBufferAttribute(c.SCALE,y),x.setMatrixAt(y,_.compose(m,g,v));for(const y in c)if("_COLOR_0"===y){const S=c[y];x.instanceColor=new Nl(S.array,S.itemSize,S.normalized)}else"TRANSLATION"!==y&&"ROTATION"!==y&&"SCALE"!==y&&p.geometry.setAttribute(y,c[y]);sn.prototype.copy.call(x,p),this.parser.assignFinalMaterial(x),h.push(x)}return u.isGroup?(u.clear(),u.add(...h),u):h[0]}))}}const Y2="glTF";class bK{constructor(e){this.name=Rt.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==Y2)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,o=new DataView(e,12);let s=0;for(;s<r;){const a=o.getUint32(s,!0);s+=4;const c=o.getUint32(s,!0);if(s+=4,1313821514===c){const l=new Uint8Array(e,12+s,a);this.content=i.decode(l)}else if(5130562===c){const l=12+s;this.body=e.slice(l,l+a)}s+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class CK{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Rt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,o=e.extensions[this.name].bufferView,s=e.extensions[this.name].attributes,a={},c={},l={};for(const u in s){const d=sb[u]||u.toLowerCase();a[d]=s[u]}for(const u in e.attributes){const d=sb[u]||u.toLowerCase();if(void 0!==s[u]){const f=i.accessors[e.attributes[u]];l[d]=Yl[f.componentType].name,c[d]=!0===f.normalized}}return t.getDependency("bufferView",o).then(function(u){return new Promise(function(d,f){r.decodeDracoFile(u,function(h){for(const p in h.attributes){const m=c[p];void 0!==m&&(h.attributes[p].normalized=m)}d(h)},a,l,bi,f)})})}}class wK{constructor(){this.name=Rt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class SK{constructor(){this.name=Rt.KHR_MESH_QUANTIZATION}}class K2 extends uf{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,o=e*r*3+r;for(let s=0;s!==r;s++)t[s]=i[o+s];return t}interpolate_(e,t,i,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,c=2*a,l=3*a,u=r-t,d=(i-t)/u,f=d*d,h=f*d,p=e*l,_=p-l,m=-2*h+3*f,g=h-f,v=1-m,x=g-f+d;for(let y=0;y!==a;y++)o[y]=v*s[_+y+a]+x*(s[_+y+c]*u)+m*s[p+y+a]+g*(s[p+y]*u);return o}}const PK=new wi;class EK extends K2{interpolate_(e,t,i,r){const o=super.interpolate_(e,t,i,r);return PK.fromArray(o).normalize().toArray(o),o}}const Tr={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Yl={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},J2={9728:En,9729:on,9984:1004,9985:1007,9986:ll,9987:Hr},Q2={33071:Bi,33648:1002,10497:Ds},ob={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},sb={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},$s={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},TK={CUBICSPLINE:void 0,LINEAR:Ld,STEP:Nd};function Wa(n,e,t){for(const i in t.extensions)void 0===n[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function Po(n,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function DK(n,e){if(n.updateMorphTargets(),void 0!==e.weights)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function IK(n){let e;const t=n.extensions&&n.extensions[Rt.KHR_DRACO_MESH_COMPRESSION];if(e=t?"draco:"+t.bufferView+":"+t.indices+":"+cb(t.attributes):n.indices+":"+cb(n.attributes)+":"+n.mode,void 0!==n.targets)for(let i=0,r=n.targets.length;i<r;i++)e+=":"+cb(n.targets[i]);return e}function cb(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function lb(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const NK=new it;class LK{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new iK,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=-1,o=!1,s=-1;if(typeof navigator<"u"){const a=navigator.userAgent;i=!0===/^((?!chrome|android).)*safari/i.test(a);const c=a.match(/Version\/(\d+)/);r=i&&c?parseInt(c[1],10):-1,o=a.indexOf("Firefox")>-1,s=o?a.match(/Firefox\/([0-9]+)\./)[1]:-1}this.textureLoader=typeof createImageBitmap>"u"||i&&r<17||o&&s<98?new HI(this.options.manager):new c$(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Pr(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,o=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(s){return s._markDefs&&s._markDefs()}),Promise.all(this._invokeAll(function(s){return s.beforeRoot&&s.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(s){const a={scene:s[0][r.scene||0],scenes:s[0],animations:s[1],cameras:s[2],asset:r.asset,parser:i,userData:{}};return Wa(o,a,r),Po(a,r),Promise.all(i._invokeAll(function(c){return c.afterRoot&&c.afterRoot(a)})).then(function(){for(const c of a.scenes)c.updateMatrixWorld();e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,o=t.length;r<o;r++){const s=t[r].joints;for(let a=0,c=s.length;a<c;a++)e[s[a]].isBone=!0}for(let r=0,o=e.length;r<o;r++){const s=e[r];void 0!==s.mesh&&(this._addNodeRef(this.meshCache,s.mesh),void 0!==s.skin&&(i[s.mesh].isSkinnedMesh=!0)),void 0!==s.camera&&this._addNodeRef(this.cameraCache,s.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),o=(s,a)=>{const c=this.associations.get(s);null!=c&&this.associations.set(a,c);for(const[l,u]of s.children.entries())o(u,a.children[l])};return o(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const o=e(t[r]);o&&i.push(o)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(o){return o.loadNode&&o.loadNode(t)});break;case"mesh":r=this._invokeOne(function(o){return o.loadMesh&&o.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(o){return o.loadBufferView&&o.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(o){return o.loadMaterial&&o.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(o){return o.loadTexture&&o.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(o){return o.loadAnimation&&o.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(o){return o!=this&&o.getDependency&&o.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e)}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(o,s){return i.getDependency(e,s)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[Rt.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(o,s){i.load(Gs.resolveURL(t.uri,r.path),o,void 0,function(){s(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const o=t.byteOffset||0;return i.slice(o,o+(t.byteLength||0))})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const s=ob[r.type],c=!0===r.normalized,l=new(0,Yl[r.componentType])(r.count*s);return Promise.resolve(new Wt(l,s,c))}const o=[];return o.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(o.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(o).then(function(s){const a=s[0],c=ob[r.type],l=Yl[r.componentType],u=l.BYTES_PER_ELEMENT,f=r.byteOffset||0,h=void 0!==r.bufferView?i.bufferViews[r.bufferView].byteStride:void 0,p=!0===r.normalized;let _,m;if(h&&h!==u*c){const g=Math.floor(f/h),v="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+g+":"+r.count;let x=t.cache.get(v);x||(_=new l(a,g*h,r.count*h/u),x=new _g(_,h/u),t.cache.add(v,x)),m=new Pa(x,c,f%h/u,p)}else _=null===a?new l(r.count*c):new l(a,f,r.count*c),m=new Wt(_,c,p);if(void 0!==r.sparse){const y=r.sparse.values.byteOffset||0,S=new(0,Yl[r.sparse.indices.componentType])(s[1],r.sparse.indices.byteOffset||0,r.sparse.count*ob.SCALAR),P=new l(s[2],y,r.sparse.count*c);null!==a&&(m=new Wt(m.array.slice(),m.itemSize,m.normalized)),m.normalized=!1;for(let T=0,I=S.length;T<I;T++){const C=S[T];if(m.setX(C,P[T*c]),c>=2&&m.setY(C,P[T*c+1]),c>=3&&m.setZ(C,P[T*c+2]),c>=4&&m.setW(C,P[T*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}m.normalized=p}return m})}loadTexture(e){const t=this.json,o=t.textures[e].source,s=t.images[o];let a=this.textureLoader;if(s.uri){const c=this.options.manager.getHandler(s.uri);null!==c&&(a=c)}return this.loadTextureImage(e,o,a)}loadTextureImage(e,t,i){const r=this,o=this.json,s=o.textures[e],a=o.images[t],c=(a.uri||a.bufferView)+":"+s.sampler;if(this.textureCache[c])return this.textureCache[c];const l=this.loadImageSource(t,i).then(function(u){u.flipY=!1,u.name=s.name||a.name||"",""===u.name&&"string"==typeof a.uri&&!1===a.uri.startsWith("data:image/")&&(u.name=a.uri);const f=(o.samplers||{})[s.sampler]||{};return u.magFilter=J2[f.magFilter]||on,u.minFilter=J2[f.minFilter]||Hr,u.wrapS=Q2[f.wrapS]||Ds,u.wrapT=Q2[f.wrapT]||Ds,u.generateMipmaps=!u.isCompressedTexture&&u.minFilter!==En&&u.minFilter!==on,r.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[c]=l,l}loadImageSource(e,t){const r=this.json,o=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(d=>d.clone());const s=r.images[e],a=self.URL||self.webkitURL;let c=s.uri||"",l=!1;if(void 0!==s.bufferView)c=this.getDependency("bufferView",s.bufferView).then(function(d){l=!0;const f=new Blob([d],{type:s.mimeType});return c=a.createObjectURL(f),c});else if(void 0===s.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(c).then(function(d){return new Promise(function(f,h){let p=f;!0===t.isImageBitmapLoader&&(p=function(_){const m=new ui(_);m.needsUpdate=!0,f(m)}),t.load(Gs.resolveURL(d,o.path),p,void 0,h)})}).then(function(d){return!0===l&&a.revokeObjectURL(c),Po(d,s),d.userData.mimeType=s.mimeType||function RK(n){return n.search(/\.jpe?g($|\?)/i)>0||0===n.search(/^data\:image\/jpeg/)?"image/jpeg":n.search(/\.webp($|\?)/i)>0||0===n.search(/^data\:image\/webp/)?"image/webp":n.search(/\.ktx2($|\?)/i)>0||0===n.search(/^data\:image\/ktx2/)?"image/ktx2":"image/png"}(s.uri),d}).catch(function(d){throw console.error("THREE.GLTFLoader: Couldn't load texture",c),d});return this.sourceCache[e]=u,u}assignTexture(e,t,i,r){const o=this;return this.getDependency("texture",i.index).then(function(s){if(!s)return null;if(void 0!==i.texCoord&&i.texCoord>0&&((s=s.clone()).channel=i.texCoord),o.extensions[Rt.KHR_TEXTURE_TRANSFORM]){const a=void 0!==i.extensions?i.extensions[Rt.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const c=o.associations.get(s);s=o.extensions[Rt.KHR_TEXTURE_TRANSFORM].extendTexture(s,a),o.associations.set(s,c)}}return void 0!==r&&(s.colorSpace=r),e[t]=s,s})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=void 0===t.attributes.tangent,o=void 0!==t.attributes.color,s=void 0===t.attributes.normal;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let c=this.cache.get(a);c||(c=new Da,Un.prototype.copy.call(c,i),c.color.copy(i.color),c.map=i.map,c.sizeAttenuation=!1,this.cache.add(a,c)),i=c}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let c=this.cache.get(a);c||(c=new Kn,Un.prototype.copy.call(c,i),c.color.copy(i.color),c.map=i.map,this.cache.add(a,c)),i=c}if(r||o||s){let a="ClonedMaterial:"+i.uuid+":";r&&(a+="derivative-tangents:"),o&&(a+="vertex-colors:"),s&&(a+="flat-shading:");let c=this.cache.get(a);c||(c=i.clone(),o&&(c.vertexColors=!0),s&&(c.flatShading=!0),r&&(c.normalScale&&(c.normalScale.y*=-1),c.clearcoatNormalScale&&(c.clearcoatNormalScale.y*=-1)),this.cache.add(a,c),this.associations.set(c,this.associations.get(i))),i=c}e.material=i}getMaterialType(){return Co}loadMaterial(e){const t=this,r=this.extensions,o=this.json.materials[e];let s;const a={},l=[];if((o.extensions||{})[Rt.KHR_MATERIALS_UNLIT]){const d=r[Rt.KHR_MATERIALS_UNLIT];s=d.getMaterialType(),l.push(d.extendParams(a,o,t))}else{const d=o.pbrMetallicRoughness||{};if(a.color=new xe(1,1,1),a.opacity=1,Array.isArray(d.baseColorFactor)){const f=d.baseColorFactor;a.color.setRGB(f[0],f[1],f[2],bi),a.opacity=f[3]}void 0!==d.baseColorTexture&&l.push(t.assignTexture(a,"map",d.baseColorTexture,vn)),a.metalness=void 0!==d.metallicFactor?d.metallicFactor:1,a.roughness=void 0!==d.roughnessFactor?d.roughnessFactor:1,void 0!==d.metallicRoughnessTexture&&(l.push(t.assignTexture(a,"metalnessMap",d.metallicRoughnessTexture)),l.push(t.assignTexture(a,"roughnessMap",d.metallicRoughnessTexture))),s=this._invokeOne(function(f){return f.getMaterialType&&f.getMaterialType(e)}),l.push(Promise.all(this._invokeAll(function(f){return f.extendMaterialParams&&f.extendMaterialParams(e,a)})))}!0===o.doubleSided&&(a.side=2);const u=o.alphaMode||"OPAQUE";if("BLEND"===u?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===u&&(a.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&s!==Cr&&(l.push(t.assignTexture(a,"normalMap",o.normalTexture)),a.normalScale=new re(1,1),void 0!==o.normalTexture.scale)){const d=o.normalTexture.scale;a.normalScale.set(d,d)}if(void 0!==o.occlusionTexture&&s!==Cr&&(l.push(t.assignTexture(a,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength&&(a.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&s!==Cr){const d=o.emissiveFactor;a.emissive=(new xe).setRGB(d[0],d[1],d[2],bi)}return void 0!==o.emissiveTexture&&s!==Cr&&l.push(t.assignTexture(a,"emissiveMap",o.emissiveTexture,vn)),Promise.all(l).then(function(){const d=new s(a);return o.name&&(d.name=o.name),Po(d,o),t.associations.set(d,{materials:e}),o.extensions&&Wa(r,d,o),d})}createUniqueName(e){const t=gn.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function o(a){return i[Rt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(c){return eR(c,a,t)})}const s=[];for(let a=0,c=e.length;a<c;a++){const l=e[a],u=IK(l),d=r[u];if(d)s.push(d.promise);else{let f;f=l.extensions&&l.extensions[Rt.KHR_DRACO_MESH_COMPRESSION]?o(l):eR(new pt,l,t),r[u]={primitive:l,promise:f},s.push(f)}}return Promise.all(s)}loadMesh(e){const t=this,r=this.extensions,o=this.json.meshes[e],s=o.primitives,a=[];for(let c=0,l=s.length;c<l;c++){const u=void 0===s[c].material?(void 0===(n=this.cache).DefaultMaterial&&(n.DefaultMaterial=new Co({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),n.DefaultMaterial):this.getDependency("material",s[c].material);a.push(u)}var n;return a.push(t.loadGeometries(s)),Promise.all(a).then(function(c){const l=c.slice(0,c.length-1),u=c[c.length-1],d=[];for(let h=0,p=u.length;h<p;h++){const _=u[h],m=s[h];let g;const v=l[h];if(m.mode===Tr.TRIANGLES||m.mode===Tr.TRIANGLE_STRIP||m.mode===Tr.TRIANGLE_FAN||void 0===m.mode)g=!0===o.isSkinnedMesh?new rI(_,v):new Gt(_,v),!0===g.isSkinnedMesh&&g.normalizeSkinWeights(),m.mode===Tr.TRIANGLE_STRIP?g.geometry=q2(g.geometry,1):m.mode===Tr.TRIANGLE_FAN&&(g.geometry=q2(g.geometry,2));else if(m.mode===Tr.LINES)g=new Sr(_,v);else if(m.mode===Tr.LINE_STRIP)g=new zs(_,v);else if(m.mode===Tr.LINE_LOOP)g=new gI(_,v);else{if(m.mode!==Tr.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+m.mode);g=new ef(_,v)}Object.keys(g.geometry.morphAttributes).length>0&&DK(g,o),g.name=t.createUniqueName(o.name||"mesh_"+e),Po(g,o),m.extensions&&Wa(r,g,m),t.assignFinalMaterial(g),d.push(g)}for(let h=0,p=d.length;h<p;h++)t.associations.set(d[h],{meshes:e,primitives:h});if(1===d.length)return o.extensions&&Wa(r,d[0],o),d[0];const f=new as;o.extensions&&Wa(r,f,o),t.associations.set(f,{meshes:e});for(let h=0,p=d.length;h<p;h++)f.add(d[h]);return f})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(r)return"perspective"===i.type?t=new jn(mj_radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===i.type&&(t=new ff(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),Po(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,o=t.joints.length;r<o;r++)i.push(this._loadNodeShallow(t.joints[r]));return i.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(i).then(function(r){const o=r.pop(),s=r,a=[],c=[];for(let l=0,u=s.length;l<u;l++){const d=s[l];if(d){a.push(d);const f=new it;null!==o&&f.fromArray(o.array,16*l),c.push(f)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[l])}return new Cg(a,c)})}loadAnimation(e){const i=this,r=this.json.animations[e],o=r.name?r.name:"animation_"+e,s=[],a=[],c=[],l=[],u=[];for(let d=0,f=r.channels.length;d<f;d++){const h=r.channels[d],p=r.samplers[h.sampler],_=h.target,g=void 0!==r.parameters?r.parameters[p.input]:p.input,v=void 0!==r.parameters?r.parameters[p.output]:p.output;void 0!==_.node&&(s.push(this.getDependency("node",_.node)),a.push(this.getDependency("accessor",g)),c.push(this.getDependency("accessor",v)),l.push(p),u.push(_))}return Promise.all([Promise.all(s),Promise.all(a),Promise.all(c),Promise.all(l),Promise.all(u)]).then(function(d){const f=d[0],h=d[1],p=d[2],_=d[3],m=d[4],g=[];for(let x=0,y=f.length;x<y;x++){const S=f[x],P=h[x],T=p[x],I=_[x],C=m[x];if(void 0===S)continue;S.updateMatrix&&S.updateMatrix();const E=i._createAnimationTracks(S,P,T,I,C);if(E)for(let F=0;F<E.length;F++)g.push(E[F])}const v=new df(o,void 0,g);return Po(v,r),v})}createNodeMesh(e){const i=this,r=this.json.nodes[e];return void 0===r.mesh?null:i.getDependency("mesh",r.mesh).then(function(o){const s=i._getNodeRef(i.meshCache,r.mesh,o);return void 0!==r.weights&&s.traverse(function(a){if(a.isMesh)for(let c=0,l=r.weights.length;c<l;c++)a.morphTargetInfluences[c]=r.weights[c]}),s})}loadNode(e){const i=this,r=this.json.nodes[e],o=i._loadNodeShallow(e),s=[],a=r.children||[];for(let l=0,u=a.length;l<u;l++)s.push(i.getDependency("node",a[l]));const c=void 0===r.skin?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([o,Promise.all(s),c]).then(function(l){const u=l[0],d=l[1],f=l[2];null!==f&&u.traverse(function(h){h.isSkinnedMesh&&h.bind(f,NK)});for(let h=0,p=d.length;h<p;h++)u.add(d[h]);return u})}_loadNodeShallow(e){const i=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const o=this.json.nodes[e],s=o.name?r.createUniqueName(o.name):"",a=[],c=r._invokeOne(function(l){return l.createNodeMesh&&l.createNodeMesh(e)});return c&&a.push(c),void 0!==o.camera&&a.push(r.getDependency("camera",o.camera).then(function(l){return r._getNodeRef(r.cameraCache,o.camera,l)})),r._invokeAll(function(l){return l.createNodeAttachment&&l.createNodeAttachment(e)}).forEach(function(l){a.push(l)}),this.nodeCache[e]=Promise.all(a).then(function(l){let u;if(u=!0===o.isBone?new rM:l.length>1?new as:1===l.length?l[0]:new sn,u!==l[0])for(let d=0,f=l.length;d<f;d++)u.add(l[d]);if(o.name&&(u.userData.name=o.name,u.name=s),Po(u,o),o.extensions&&Wa(i,u,o),void 0!==o.matrix){const d=new it;d.fromArray(o.matrix),u.applyMatrix4(d)}else void 0!==o.translation&&u.position.fromArray(o.translation),void 0!==o.rotation&&u.quaternion.fromArray(o.rotation),void 0!==o.scale&&u.scale.fromArray(o.scale);if(r.associations.has(u)){if(void 0!==o.mesh&&r.meshCache.refs[o.mesh]>1){const d=r.associations.get(u);r.associations.set(u,{...d})}}else r.associations.set(u,{});return r.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,o=new as;i.name&&(o.name=r.createUniqueName(i.name)),Po(o,i),i.extensions&&Wa(t,o,i);const s=i.nodes||[],a=[];for(let c=0,l=s.length;c<l;c++)a.push(r.getDependency("node",s[c]));return Promise.all(a).then(function(c){for(let u=0,d=c.length;u<d;u++)o.add(c[u]);return r.associations=(u=>{const d=new Map;for(const[f,h]of r.associations)(f instanceof Un||f instanceof ui)&&d.set(f,h);return u.traverse(f=>{const h=r.associations.get(f);null!=h&&d.set(f,h)}),d})(o),o})}_createAnimationTracks(e,t,i,r,o){const s=[],a=e.name?e.name:e.uuid,c=[];let l;switch($s[o.path]===$s.weights?e.traverse(function(f){f.morphTargetInfluences&&c.push(f.name?f.name:f.uuid)}):c.push(a),$s[o.path]){case $s.weights:l=Bl;break;case $s.rotation:l=Vl;break;case $s.translation:case $s.scale:l=Hl;break;default:l=1===i.itemSize?Bl:Hl}const u=void 0!==r.interpolation?TK[r.interpolation]:Ld,d=this._getArrayFromAccessor(i);for(let f=0,h=c.length;f<h;f++){const p=new l(c[f]+"."+$s[o.path],t.array,d,u);"CUBICSPLINE"===r.interpolation&&this._createCubicSplineTrackInterpolant(p),s.push(p)}return s}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=lb(t.constructor),r=new Float32Array(t.length);for(let o=0,s=t.length;o<s;o++)r[o]=t[o]*i;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){return new(this instanceof Vl?EK:K2)(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function eR(n,e,t){const i=e.attributes,r=[];function o(s,a){return t.getDependency("accessor",s).then(function(c){n.setAttribute(a,c)})}for(const s in i){const a=sb[s]||s.toLowerCase();a in n.attributes||r.push(o(i[s],a))}if(void 0!==e.indices&&!n.index){const s=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});r.push(s)}return Tt.workingColorSpace!==bi&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${Tt.workingColorSpace}" not supported.`),Po(n,e),function FK(n,e,t){const i=e.attributes,r=new Yn;if(void 0===i.POSITION)return;{const a=t.json.accessors[i.POSITION],c=a.min,l=a.max;if(void 0===c||void 0===l)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new R(c[0],c[1],c[2]),new R(l[0],l[1],l[2])),a.normalized){const u=lb(Yl[a.componentType]);r.min.multiplyScalar(u),r.max.multiplyScalar(u)}}const o=e.targets;if(void 0!==o){const a=new R,c=new R;for(let l=0,u=o.length;l<u;l++){const d=o[l];if(void 0!==d.POSITION){const f=t.json.accessors[d.POSITION],h=f.min,p=f.max;if(void 0!==h&&void 0!==p){if(c.setX(Math.max(Math.abs(h[0]),Math.abs(p[0]))),c.setY(Math.max(Math.abs(h[1]),Math.abs(p[1]))),c.setZ(Math.max(Math.abs(h[2]),Math.abs(p[2]))),f.normalized){const _=lb(Yl[f.componentType]);c.multiplyScalar(_)}a.max(c)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}n.boundingBox=r;const s=new ri;r.getCenter(s.center),s.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=s}(n,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function OK(n,e,t){let i=!1,r=!1,o=!1;for(let l=0,u=e.length;l<u;l++){const d=e[l];if(void 0!==d.POSITION&&(i=!0),void 0!==d.NORMAL&&(r=!0),void 0!==d.COLOR_0&&(o=!0),i&&r&&o)break}if(!i&&!r&&!o)return Promise.resolve(n);const s=[],a=[],c=[];for(let l=0,u=e.length;l<u;l++){const d=e[l];if(i){const f=void 0!==d.POSITION?t.getDependency("accessor",d.POSITION):n.attributes.position;s.push(f)}if(r){const f=void 0!==d.NORMAL?t.getDependency("accessor",d.NORMAL):n.attributes.normal;a.push(f)}if(o){const f=void 0!==d.COLOR_0?t.getDependency("accessor",d.COLOR_0):n.attributes.color;c.push(f)}}return Promise.all([Promise.all(s),Promise.all(a),Promise.all(c)]).then(function(l){const d=l[1],f=l[2];return i&&(n.morphAttributes.position=l[0]),r&&(n.morphAttributes.normal=d),o&&(n.morphAttributes.color=f),n.morphTargetsRelative=!0,n})}(n,e.targets,t):n})}const kK=["canvas"];function UK(n,e){1&n&&(M(0,"div",4),U(1,"div",5),M(2,"span",6),O(3,"LOADING 3D MODEL..."),b()())}let _f=(()=>{class n{constructor(){this.modelPath="",this.autoRotate=!0,this.autoScale=!0,this.targetSize=5,this.addStreetBackground=!0,this.model=null,this.streetBackground=null,this.animationId=0,this.isLoaded=!1,this.currentRotationEnabled=!0}ngOnInit(){this.currentRotationEnabled=this.autoRotate,console.log("\u{1f3ae} ModelViewerComponent - ngOnInit"),console.log("\u{1f4ca} Input values:",{modelPath:this.modelPath,addStreetBackground:this.addStreetBackground,autoRotate:this.autoRotate})}ngAfterViewInit(){console.log("\u{1f680} ModelViewerComponent - ngAfterViewInit"),setTimeout(()=>{this.initThreeJS(),this.loadModel(),this.animate()},100)}ngOnDestroy(){this.animationId&&cancelAnimationFrame(this.animationId),this.renderer&&this.renderer.dispose()}initThreeJS(){console.log("\u{1f527} Initialisation ThreeJS...");const t=this.canvasRef.nativeElement,i=t.clientWidth||400,r=t.clientHeight||400;console.log("\u{1f4cf} Canvas dimensions:",{width:i,height:r}),this.scene=new eM,this.scene.background=new xe(0),console.log("\u{1f3a8} Fond noir d\xe9fini"),this.camera=new jn(45,i/r,.1,1e3),this.camera.position.set(0,3,12),this.renderer=new z2({canvas:t,antialias:!0,alpha:!1}),this.renderer.setSize(i,r),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.renderer.outputColorSpace=vn,this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=2,this.setupLighting(),console.log("\u2705 ThreeJS initialis\xe9")}setupLighting(){console.log("\u{1f4a1} Configuration des lumi\xe8res...");const t=new UM(16777215,.7);this.scene.add(t);const i=new jl(16777215,1);i.position.set(10,15,10),i.castShadow=!0,this.scene.add(i);const r=new jl(16777215,.4);r.position.set(-10,5,-5),this.scene.add(r),console.log("\u2705 Lumi\xe8res ajout\xe9es")}loadModel(){console.log("\u{1f4e6} D\xe9but du chargement..."),console.log("\u{1f4cd} Chemin du mod\xe8le:",this.modelPath),console.log("\u{1f3d9}\ufe0f Ajout fond de rue:",this.addStreetBackground),this.addStreetBackground?(console.log("\u{1f3e2} Tentative de chargement du fond de rue..."),this.loadStreetBackground().then(()=>{console.log("\u2705 Fond de rue charg\xe9"),this.loadMainModel()}).catch(t=>{console.error("\u274c Erreur chargement fond:",t),this.createSimpleBackground(),this.loadMainModel()})):(console.log("\u26ab Pas de fond demand\xe9"),this.loadMainModel())}loadStreetBackground(){var t=this;return ki(function*(){return console.log("\u{1f50d} Recherche du fichier GLB..."),new Promise((i,r)=>{const o=new X2,s=["assets/shoot_background__graffiti_street.glb","./assets/shoot_background__graffiti_street.glb","/assets/shoot_background__graffiti_street.glb"];let a=0;const c=()=>{if(a>=s.length)return console.error("\u274c Tous les chemins ont \xe9chou\xe9"),void r(new Error("Fichier non trouv\xe9"));const l=s[a];console.log(`\u{1f504} Test du chemin: ${l}`),o.load(l,u=>{console.log(`\u2705 Fichier trouv\xe9 \xe0: ${l}`),console.log("\u{1f4e6} Contenu GLTF:",u),t.streetBackground=u.scene,t.streetBackground.position.set(0,-3,-20),t.streetBackground.scale.set(4,4,4),t.streetBackground.traverse(d=>{d instanceof Gt&&(d.castShadow=!0,d.receiveShadow=!0)}),t.scene.add(t.streetBackground),console.log("\u2705 Fond ajout\xe9 \xe0 la sc\xe8ne"),i()},u=>{console.log(`\u{1f4e5} Progression: ${u.loaded}/${u.total}`)},u=>{console.error(`\u274c Erreur avec ${l}:`,u),a++,setTimeout(c,100)})};c()})})()}createSimpleBackground(){console.log("\u{1f3a8} Cr\xe9ation d'un fond simple...");const t=new Hs(100,100),i=new Co({color:3355443,roughness:.9}),r=new Gt(t,i);r.rotation.x=-Math.PI/2,r.position.y=-5,r.receiveShadow=!0,this.scene.add(r);const o=document.createElement("canvas");o.width=256,o.height=256;const s=o.getContext("2d"),a=s.createLinearGradient(0,0,0,256);a.addColorStop(0,"#1a1a2e"),a.addColorStop(1,"#0f3460"),s.fillStyle=a,s.fillRect(0,0,256,256);const c=new nW(o);this.scene.background=c,console.log("\u2705 Fond simple cr\xe9\xe9")}loadMainModel(){if(console.log("\u{1f3af} Chargement du mod\xe8le principal..."),!this.modelPath)return console.log("\u26a0\ufe0f Pas de chemin de mod\xe8le, cr\xe9ation placeholder"),this.createPlaceholder(),void(this.isLoaded=!0);console.log("\u{1f4c2} Chemin du mod\xe8le:",this.modelPath),this.modelPath.toLowerCase().endsWith(".obj")?(console.log("\u{1f3af} Format: OBJ"),this.loadOBJModel()):(console.log("\u26a0\ufe0f Format non support\xe9, cr\xe9ation placeholder"),this.createPlaceholder(),this.isLoaded=!0)}loadOBJModel(){console.log("\u{1f4e6} Chargement OBJ...");const t=this.modelPath.substring(0,this.modelPath.lastIndexOf("/")+1),i=this.modelPath.split("/").pop(),r=i.replace(".obj",".mtl");console.log("\u{1f4c1} Dossier:",t),console.log("\u{1f4c4} Fichier OBJ:",i),console.log("\u{1f3a8} Fichier MTL:",r);const o=new tK;o.setPath(t),o.load(r,s=>{console.log("\u2705 MTL charg\xe9"),s.preload();const a=new eK;a.setMaterials(s),a.setPath(t),a.load(i,c=>{console.log("\u2705 OBJ charg\xe9:",c),this.model=c,c.traverse(l=>{l instanceof Gt&&(l.castShadow=!0,l.receiveShadow=!0)}),this.centerAndScale(c),this.scene.add(c),this.adjustCamera(),this.isLoaded=!0,console.log("\u{1f389} Mod\xe8le charg\xe9 avec succ\xe8s!")},c=>{console.log(`\u{1f4e5} Progression OBJ: ${c.loaded}`)},c=>{console.error("\u274c Erreur chargement OBJ:",c),this.createPlaceholder(),this.isLoaded=!0})},s=>{console.log(`\u{1f4e5} Progression MTL: ${s.loaded}`)},s=>{console.error("\u274c Erreur chargement MTL:",s),this.createPlaceholder(),this.isLoaded=!0})}centerAndScale(t){console.log("\u{1f4d0} Centrage et mise \xe0 l'\xe9chelle...");const i=(new Yn).setFromObject(t),r=i.getCenter(new R),o=i.getSize(new R);if(console.log("\u{1f4cf} Taille:",o),console.log("\u{1f3af} Centre:",r),t.position.set(-r.x,-r.y,-r.z),this.autoScale){const s=this.targetSize/Math.max(o.x,o.y,o.z);console.log("\u2696\ufe0f \xc9chelle:",s),t.scale.setScalar(s)}}adjustCamera(){if(!this.model)return;console.log("\u{1f4f7} Ajustement cam\xe9ra...");const t=(new Yn).setFromObject(this.model),i=t.getSize(new R),r=t.getCenter(new R),o=Math.max(i.x,i.y,i.z)*(this.addStreetBackground?3:2.5);console.log("\u{1f4d0} Distance cam\xe9ra:",o),this.camera.position.set(r.x,r.y+.4*i.y,r.z+o);const s=new R(r.x,r.y+.2*i.y,r.z);this.camera.lookAt(s),console.log("\u{1f4cd} Position cam\xe9ra:",this.camera.position),console.log("\u{1f440} Regarde vers:",s)}changeColor(t){console.log(`\u{1f3a8} Changement couleur: #${t.toString(16)}`),this.model&&this.model.traverse(i=>{i instanceof Gt&&i.material instanceof Co&&i.material.color.setHex(t)})}createPlaceholder(){console.log("\u{1f3a8} Cr\xe9ation placeholder...");const t=new Bs(3,4,.2),i=new Co({color:16724838,roughness:.4,metalness:.6}),r=new Gt(t,i);r.castShadow=!0,r.receiveShadow=!0,this.scene.add(r),this.model=r,console.log("\u2705 Placeholder cr\xe9\xe9")}animate(){this.animationId=requestAnimationFrame(()=>this.animate()),this.model&&this.currentRotationEnabled&&(this.model.rotation.y+=.005),this.renderer.render(this.scene,this.camera)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Zi({type:n,selectors:[["app-model-viewer"]],viewQuery:function(i,r){if(1&i&&ep(kK,5),2&i){let o;td(o=nd())&&(r.canvasRef=o.first)}},inputs:{modelPath:"modelPath",autoRotate:"autoRotate",autoScale:"autoScale",targetSize:"targetSize",addStreetBackground:"addStreetBackground"},decls:4,vars:1,consts:[[1,"model-viewer-container"],[1,"model-canvas"],["canvas",""],["class","loading-overlay",4,"ngIf"],[1,"loading-overlay"],[1,"loading-spinner"],[1,"loading-text"]],template:function(i,r){1&i&&(M(0,"div",0),U(1,"canvas",1,2),ie(3,UK,4,0,"div",3),b()),2&i&&(L(3),J("ngIf",!r.isLoaded))},dependencies:[jo],styles:['@charset "UTF-8";.model-viewer-container[_ngcontent-%COMP%]{width:100%;height:100%;position:relative;background:#000000;overflow:hidden;min-height:500px;border-radius:12px;box-shadow:0 0 30px #39ff1433}.model-canvas[_ngcontent-%COMP%]{width:100%!important;height:100%!important;display:block;background:transparent!important;position:absolute;top:0;left:0;border-radius:10px}.loading-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.95);z-index:10;flex-direction:column;gap:20px;border-radius:10px;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.loading-spinner[_ngcontent-%COMP%]{width:70px;height:70px;border:5px solid rgba(57,255,20,.1);border-top:5px solid #39ff14;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;box-shadow:0 0 20px #39ff1480}.loading-text[_ngcontent-%COMP%]{color:#39ff14;font-size:20px;font-weight:700;text-transform:uppercase;letter-spacing:3px;font-family:Courier New,monospace;text-shadow:0 0 15px rgba(57,255,20,.7);animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1;text-shadow:0 0 10px rgba(57,255,20,.7)}50%{opacity:.8;text-shadow:0 0 20px rgba(57,255,20,.4)}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.model-viewer-container[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(45deg,transparent 48%,rgba(57,255,20,.05) 50%,transparent 52%);background-size:10px 10px;animation:_ngcontent-%COMP%_backgroundMove 20s linear infinite;pointer-events:none;z-index:1;opacity:.3;border-radius:10px}@keyframes _ngcontent-%COMP%_backgroundMove{0%{background-position:0 0}to{background-position:100px 100px}}.model-viewer-container.loaded[_ngcontent-%COMP%]   .model-canvas[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .5s ease-out}@media (max-width: 768px){.model-viewer-container[_ngcontent-%COMP%]{min-height:400px}.loading-text[_ngcontent-%COMP%]{font-size:16px;letter-spacing:2px}.loading-spinner[_ngcontent-%COMP%]{width:50px;height:50px;border-width:4px}}@media (max-width: 480px){.model-viewer-container[_ngcontent-%COMP%]{min-height:300px;border-radius:8px}.loading-text[_ngcontent-%COMP%]{font-size:14px;letter-spacing:1px}.loading-spinner[_ngcontent-%COMP%]{width:40px;height:40px;border-width:3px}}@media (prefers-color-scheme: light){.model-viewer-container[_ngcontent-%COMP%]{background:#f0f0f0;box-shadow:0 0 30px #0064001a}.loading-overlay[_ngcontent-%COMP%]{background:rgba(255,255,255,.95)}.loading-text[_ngcontent-%COMP%]{color:#006400;text-shadow:0 0 5px rgba(0,100,0,.3)}.loading-spinner[_ngcontent-%COMP%]{border-top-color:#006400;border-color:#0064001a}.model-viewer-container[_ngcontent-%COMP%]:before{background:linear-gradient(45deg,transparent 48%,rgba(0,100,0,.05) 50%,transparent 52%)}}']})}}return n})();function BK(n,e){if(1&n&&(sa(0),M(1,"div",111),U(2,"app-model-viewer",112),M(3,"div",113),U(4,"i",114),M(5,"span"),O(6,"INTERACTIVE 3D MODEL"),b()()(),aa()),2&n){const t=Q();L(2),J("modelPath",t.featuredProduct.images[0])("autoRotate",!0)}}function VK(n,e){if(1&n&&U(0,"img",117),2&n){const t=Q(2);J("src",t.featuredProduct.images[0],ro)("alt",t.featuredProduct.name)}}function zK(n,e){1&n&&(M(0,"div",118),U(1,"i",119),M(2,"span"),O(3,"FEATURED PRODUCT"),b()())}function HK(n,e){if(1&n&&(ie(0,VK,1,2,"img",115),ie(1,zK,4,0,"div",116)),2&n){const t=Q();J("ngIf",t.featuredProduct),L(1),J("ngIf",!t.featuredProduct)}}function GK(n,e){1&n&&(M(0,"span",120),O(1,"NEW ARRIVAL"),b())}function jK(n,e){1&n&&(M(0,"span",120),O(1,"LIMITED SALE"),b())}function WK(n,e){1&n&&(M(0,"span",120),O(1,"3D MODEL"),b())}function $K(n,e){if(1&n&&(M(0,"span",140),O(1),b()),2&n){const t=Q(2);L(1),Ye(" $",t.featuredProduct.originalPrice.toFixed(2)," ")}}function qK(n,e){if(1&n&&(M(0,"span",141),O(1),b()),2&n){const t=Q(2);L(1),Ye(" -",t.getDiscountPercent(t.featuredProduct),"% ")}}function XK(n,e){if(1&n){const t=tn();M(0,"div",121)(1,"div",122)(2,"h3",123),O(3),b(),M(4,"div",124),U(5,"i",125),M(6,"span"),O(7),b(),M(8,"span",126),O(9),b()()(),M(10,"h2",127),O(11),b(),M(12,"p",128),O(13),Qu(14,"slice"),b(),M(15,"div",129)(16,"div",130),U(17,"i",131),M(18,"span"),O(19),b()(),M(20,"div",130),U(21,"i",132),M(22,"span"),O(23),b()()(),M(24,"div",133)(25,"div",134)(26,"span",135),O(27),b(),ie(28,$K,2,1,"span",136),ie(29,qK,2,1,"span",137),b(),M(30,"button",138),ge("click",function(){qe(t);const r=Q();return Xe(r.goToProduct(r.featuredProduct.id))}),U(31,"i",139),O(32," VIEW DETAILS "),b()()()}if(2&n){const t=Q();L(3),xt(t.featuredProduct.brand),L(4),xt(t.featuredProduct.rating.toFixed(1)),L(2),Ye("(",t.featuredProduct.reviewCount,")"),L(2),xt(t.featuredProduct.name),L(2),Ye("",Kh(14,10,t.featuredProduct.description,0,120),"..."),L(6),xt(t.featuredProduct.material||"Premium Material"),L(4),xt(t.featuredProduct.category),L(4),Ye("$",t.featuredProduct.price.toFixed(2),""),L(1),J("ngIf",t.featuredProduct.originalPrice),L(1),J("ngIf",t.featuredProduct.originalPrice)}}function YK(n,e){if(1&n){const t=tn();M(0,"div",142),ge("click",function(){const o=qe(t).$implicit;return Xe(Q().goToCategory(o.id))}),M(1,"div",143),U(2,"i"),b(),M(3,"h3",144),O(4),b(),M(5,"p",145),O(6),b(),M(7,"div",146)(8,"span"),O(9,"EXPLORE \u2192"),b()()()}if(2&n){const t=e.$implicit;L(2),Hc(t.icon),L(2),xt(t.name),L(2),Ye("",t.count," items")}}function ZK(n,e){if(1&n&&(M(0,"div",179)(1,"span",180),O(2),b(),U(3,"div",181),b()),2&n){const t=Q().index;L(2),Ye("#",t+1,"")}}function KK(n,e){1&n&&(M(0,"span",182),O(1,"TRENDING"),b())}function JK(n,e){if(1&n&&(M(0,"span",183),O(1),b()),2&n){const t=Q().$implicit,i=Q();L(1),Ye("-",i.getDiscountPercent(t),"%")}}function QK(n,e){1&n&&(M(0,"span",184),O(1,"NEW"),b())}function eJ(n,e){1&n&&(M(0,"span",185),O(1,"3D"),b())}function tJ(n,e){if(1&n&&(sa(0),M(1,"div",186),U(2,"app-model-viewer",112),M(3,"div",187),U(4,"i",74),M(5,"span"),O(6,"3D VIEW"),b()()(),aa()),2&n){const t=Q().$implicit;L(2),J("modelPath",t.images[0])("autoRotate",!0)}}function nJ(n,e){if(1&n&&U(0,"img",188),2&n){const t=Q().$implicit;J("src",t.images[0],ro)("alt",t.name)}}function iJ(n,e){if(1&n&&(M(0,"span",140),O(1),b()),2&n){const t=Q().$implicit;L(1),Ye(" $",t.originalPrice.toFixed(2)," ")}}function rJ(n,e){if(1&n){const t=tn();M(0,"div",147),ge("click",function(){const o=qe(t).$implicit;return Xe(Q().goToProduct(o.id))}),ie(1,ZK,4,1,"div",148),M(2,"div",149)(3,"div",150),ie(4,KK,2,0,"span",151),ie(5,JK,2,1,"span",152),ie(6,QK,2,0,"span",153),ie(7,eJ,2,0,"span",154),b(),M(8,"div",155),ie(9,tJ,7,2,"ng-container",34),ie(10,nJ,1,2,"ng-template",null,156,Cs),b(),M(12,"div",157)(13,"button",158),ge("click",function(r){const s=qe(t).$implicit,a=Q();return r.stopPropagation(),Xe(a.addToCart(s))}),U(14,"i",159),b(),M(15,"button",158),ge("click",function(r){const s=qe(t).$implicit,a=Q();return r.stopPropagation(),Xe(a.tryOnProduct(s))}),U(16,"i",160),b(),M(17,"button",161),ge("click",function(r){const s=qe(t).$implicit,a=Q();return r.stopPropagation(),Xe(a.toggleFavorite(s.id))}),U(18,"i",162),b()(),M(19,"div",163),U(20,"i",164),M(21,"span"),O(22),b()()(),M(23,"div",165)(24,"div",166)(25,"span",167),O(26),b(),M(27,"span",168),O(28),b()(),M(29,"h3",169),O(30),b(),M(31,"p",170),O(32),Qu(33,"slice"),b(),M(34,"div",171)(35,"div",172),U(36,"i",131),M(37,"span"),O(38),b()(),M(39,"div",172),U(40,"i",125),M(41,"span"),O(42),b()()(),M(43,"div",173)(44,"div",174)(45,"span",135),O(46),b(),ie(47,iJ,2,1,"span",136),b(),M(48,"div",175)(49,"button",176),ge("click",function(r){const s=qe(t).$implicit,a=Q();return r.stopPropagation(),Xe(a.goToProduct(s.id))}),U(50,"i",139),b(),M(51,"button",177),ge("click",function(r){const s=qe(t).$implicit,a=Q();return r.stopPropagation(),Xe(a.addToCart(s))}),U(52,"i",178),b()()()()()}if(2&n){const t=e.$implicit,i=e.index,r=Ms(11),o=Q();bt("featured",0===i),L(1),J("ngIf",i<3),L(3),J("ngIf",i<3),L(1),J("ngIf",t.originalPrice),L(1),J("ngIf",t.isNew),L(1),J("ngIf",o.has3DModel(t)),L(2),J("ngIf",o.has3DModel(t))("ngIfElse",r),L(4),J("disabled",!t.inStock),L(2),J("disabled",!t.inStock),L(3),bt("active",o.isFavorite(t.id)),L(1),bt("in-stock",t.inStock),L(1),bt("fa-check-circle",t.inStock)("fa-times-circle",!t.inStock),L(2),xt(t.inStock?"IN STOCK":"OUT OF STOCK"),L(4),xt(t.brand),L(2),xt(t.category),L(2),xt(t.name),L(2),Ye("",Kh(33,30,t.description,0,80),"..."),L(6),xt(t.material||"Premium"),L(4),$h("",t.rating.toFixed(1)," (",t.reviewCount,")"),L(4),Ye("$",t.price.toFixed(2),""),L(1),J("ngIf",t.originalPrice),L(4),J("disabled",!t.inStock)}}function oJ(n,e){if(1&n){const t=tn();M(0,"div",189)(1,"div",190)(2,"div",191)(3,"div",192),O(4,"NEW DROP"),b(),U(5,"img",193),M(6,"div",194)(7,"button",195),ge("click",function(){const o=qe(t).$implicit;return Xe(Q().goToProduct(o.id))}),U(8,"i",139),O(9," QUICK VIEW "),b()()(),M(10,"div",196)(11,"h3",197),O(12),b(),M(13,"p",198),O(14),b(),M(15,"div",199)(16,"span",200),O(17),b(),M(18,"span",201),O(19),b()(),M(20,"div",202)(21,"span",134),O(22),b(),M(23,"span",203),ge("click",function(){const o=qe(t).$implicit;return Xe(Q().addToCart(o))}),O(24," ADD TO CART "),U(25,"i",178),b()()()()()}if(2&n){const t=e.$implicit;L(5),J("src",t.images,ro)("alt",t.name),L(7),xt(t.name),L(2),xt(t.description),L(3),xt(t.category),L(2),xt(t.material),L(3),Ye("$",t.price.toFixed(2),"")}}function sJ(n,e){if(1&n){const t=tn();M(0,"span",204),ge("click",function(){const o=qe(t).index;return Xe(Q().goToSlide(o))}),b()}2&n&&bt("active",e.index===Q().currentSlide)}function aJ(n,e){if(1&n){const t=tn();M(0,"div",205),ge("click",function(){const o=qe(t).$implicit;return Xe(Q().goToCollection(o.id))}),M(1,"div",206)(2,"div",207)(3,"div",208)(4,"h3",209),O(5),b(),M(6,"p",210),O(7),b(),M(8,"div",211)(9,"span",212),O(10),b(),M(11,"span",213),O(12),b()(),M(13,"button",214),O(14," EXPLORE COLLECTION "),U(15,"i",23),b()()(),U(16,"div",215),b()()}if(2&n){const t=e.$implicit;L(1),lo("background-image","url("+t.image+")"),L(4),xt(t.name),L(2),xt(t.description),L(3),Ye("",t.itemCount," items"),L(2),Ye("From $",t.startingPrice,"")}}function cJ(n,e){1&n&&U(0,"i",125),2&n&&bt("active",e.$implicit<=Q().$implicit.rating)}const lJ=function(){return[1,2,3,4,5]};function uJ(n,e){if(1&n&&(M(0,"div",216)(1,"div",217)(2,"div",218),U(3,"img",193),b(),M(4,"div",219)(5,"h4",220),O(6),b(),M(7,"span",221),O(8),b()(),M(9,"div",222),ie(10,cJ,1,2,"i",223),b()(),M(11,"p",224),O(12),b(),M(13,"div",225)(14,"span",226),O(15,"Bought:"),b(),M(16,"span",227),O(17),b()()()),2&n){const t=e.$implicit;L(3),J("src",t.avatar,ro)("alt",t.name),L(3),xt(t.name),L(2),xt(t.location),L(2),J("ngForOf",Ku(7,lJ)),L(2),Ye('"',t.text,'"'),L(5),xt(t.product)}}const dJ=function(){return[0,1,2]};let fJ=(()=>{class n{constructor(t,i){this.router=t,this.cartService=i,this.allProducts=Vp,this.featuredProducts=[],this.featuredProduct=null,this.newArrivals=[],this.categories=[{id:"tops",name:"TOPS",icon:"fas fa-tshirt",count:156},{id:"bottoms",name:"BOTTOMS",icon:"fas fa-vest",count:89},{id:"shoes",name:"SHOES",icon:"fas fa-shoe-prints",count:72},{id:"accessories",name:"ACCESSORIES",icon:"fas fa-gem",count:134},{id:"outerwear",name:"OUTERWEAR",icon:"fas fa-jacket",count:67},{id:"limited",name:"LIMITED",icon:"fas fa-crown",count:42}],this.collections=[{id:"street-essentials",name:"Street Essentials",image:"assets/collections/essentials.jpg",description:"Core pieces for everyday wear",itemCount:45,startingPrice:39.99},{id:"premium-collection",name:"Premium Collection",image:"assets/collections/premium.jpg",description:"High-end materials and craftsmanship",itemCount:28,startingPrice:129.99},{id:"limited-edition",name:"Limited Edition",image:"assets/collections/limited.jpg",description:"Exclusive drops available for limited time",itemCount:15,startingPrice:89.99}],this.testimonials=[{name:"FRANKLIN",location:"Los Santos",avatar:"assets/avatars/franklin.jpg",rating:5,text:"The 3D fitting room changed how I shop. No more returns!",product:"Vinewood Jacket"},{name:"TREVOR",location:"Sandy Shores",avatar:"assets/avatars/trevor.jpg",rating:4,text:"Best streetwear in the city. Quality is unmatched.",product:"Desert Cargos"},{name:"MICHAEL",location:"Rockford Hills",avatar:"assets/avatars/michael.jpg",rating:5,text:"Premium quality meets street style. My go-to shop.",product:"Executive Hoodie"}],this.currentSlide=0,this.favorites={}}ngOnInit(){this.loadData(),this.startSlider(),this.loadFavorites()}ngOnDestroy(){this.sliderInterval&&clearInterval(this.sliderInterval)}loadData(){if(this.featuredProducts=this.allProducts.filter(t=>t.isFeatured).slice(0,6),this.featuredProducts.length>0&&(this.featuredProduct=this.featuredProducts[0]),this.newArrivals=this.allProducts.filter(t=>t.isNew).slice(0,4),this.newArrivals.length<4){const t=this.allProducts.filter(i=>!i.isNew).slice(0,4-this.newArrivals.length);this.newArrivals=[...this.newArrivals,...t]}}goToTryOn(){this.router.navigate(["/try-on"])}goToShop(){this.router.navigate(["/shop"])}goToProduct(t){this.router.navigate(["/product",t])}goToCategory(t){this.router.navigate(["/shop"],{queryParams:{category:t.toUpperCase()}})}goToCollection(t){this.router.navigate(["/shop"],{queryParams:{collection:t}})}goToTutorial(){this.router.navigate(["/tutorial"])}addToCart(t){t.inStock&&(this.cartService.addToCart(t),console.log("Added to cart:",t.name))}tryOnProduct(t){t.inStock&&this.router.navigate(["/try-on"],{queryParams:{productId:t.id}})}toggleFavorite(t){this.favorites[t]=!this.favorites[t],this.saveFavorites()}isFavorite(t){return!!this.favorites[t]}loadFavorites(){const t=localStorage.getItem("home_favorites");t&&(this.favorites=JSON.parse(t))}saveFavorites(){localStorage.setItem("home_favorites",JSON.stringify(this.favorites))}getDiscountPercent(t){return t.originalPrice?Math.round((t.originalPrice-t.price)/t.originalPrice*100):0}has3DModel(t){if(!t||!t.images||!t.images[0])return!1;const i=t.images[0].toLowerCase();return i.endsWith(".obj")||i.endsWith(".glb")||i.endsWith(".fbx")||!!t.has3DModel}startSlider(){this.sliderInterval=setInterval(()=>{this.nextSlide()},5e3)}nextSlide(){this.currentSlide=(this.currentSlide+1)%3}prevSlide(){this.currentSlide=0===this.currentSlide?2:this.currentSlide-1}goToSlide(t){this.currentSlide=t,this.sliderInterval&&(clearInterval(this.sliderInterval),this.startSlider())}onResize(){}getNewArrivalData(){return this.newArrivals.map(t=>({...t,category:t.category,material:t.material||"Premium Material"}))}static{this.\u0275fac=function(i){return new(i||n)(te(Xn),te(Ed))}}static{this.\u0275cmp=Zi({type:n,selectors:[["app-home"]],hostBindings:function(i,r){1&i&&ge("resize",function(){return r.onResize()},0,Nu)},decls:237,vars:15,consts:[[1,"home","page-container"],[1,"home-hero"],[1,"hero-background"],[1,"hero-grid-overlay"],[1,"hero-glow"],[1,"hero-content"],[1,"hero-left"],[1,"hero-badge"],[1,"badge-text"],[1,"fas","fa-bolt"],[1,"hero-title"],[1,"title-line-1"],[1,"title-line-2"],[1,"title-line-3"],[1,"hero-subtitle"],[1,"highlight"],[1,"hero-stats"],[1,"stat-item"],[1,"stat-number"],[1,"stat-label"],[1,"hero-actions"],[1,"btn-hero-primary",3,"click"],[1,"fas","fa-vr-cardboard"],[1,"fas","fa-arrow-right"],[1,"btn-hero-secondary",3,"click"],[1,"fas","fa-store"],[1,"hero-scroll-indicator"],[1,"fas","fa-chevron-down"],[1,"hero-right"],[1,"hero-featured-product"],[1,"featured-badge"],[1,"featured-product-card"],[1,"featured-product-image"],[1,"image-container"],[4,"ngIf","ngIfElse"],["featuredImage",""],[1,"product-tags"],["class","tag",4,"ngIf"],["class","featured-product-info",4,"ngIf"],[1,"quick-categories"],[1,"section-header"],[1,"section-title"],[1,"title-accent"],[1,"section-subtitle"],[1,"categories-grid"],["class","category-card",3,"click",4,"ngFor","ngForOf"],[1,"featured-products"],[1,"header-left"],[1,"header-right"],[1,"btn-view-all",3,"click"],[1,"products-grid-home"],["class","product-card-home",3,"featured","click",4,"ngFor","ngForOf"],[1,"try-on-banner"],[1,"banner-content"],[1,"banner-left"],[1,"banner-badge"],[1,"banner-title"],[1,"banner-description"],[1,"banner-features"],[1,"feature"],[1,"fas","fa-rotate"],[1,"fas","fa-expand-alt"],[1,"fas","fa-palette"],[1,"fas","fa-user"],[1,"banner-actions"],[1,"btn-banner-primary",3,"click"],[1,"fas","fa-play-circle"],[1,"btn-banner-secondary",3,"click"],[1,"fas","fa-question-circle"],[1,"banner-right"],[1,"banner-preview"],[1,"preview-container"],[1,"preview-model"],[1,"model-placeholder"],[1,"fas","fa-cube"],[1,"preview-controls"],[1,"control-btn"],[1,"new-arrivals"],[1,"arrivals-slider"],[1,"slider-nav","prev",3,"click"],[1,"fas","fa-chevron-left"],[1,"slider-container"],[1,"slider-track"],["class","arrival-slide",4,"ngFor","ngForOf"],[1,"slider-nav","next",3,"click"],[1,"fas","fa-chevron-right"],[1,"slider-dots"],["class","dot",3,"active","click",4,"ngFor","ngForOf"],[1,"collections-home"],[1,"collections-grid-home"],["class","collection-card-home",3,"click",4,"ngFor","ngForOf"],[1,"testimonials"],[1,"testimonials-grid"],["class","testimonial-card",4,"ngFor","ngForOf"],[1,"cta-home"],[1,"cta-background"],[1,"cta-overlay"],[1,"cta-content-home"],[1,"cta-title-home"],[1,"cta-description-home"],[1,"cta-stats-home"],[1,"cta-stat"],[1,"cta-actions-home"],[1,"btn-cta-primary-home",3,"click"],[1,"btn-cta-secondary-home",3,"click"],[1,"trust-badges-home"],[1,"trust-badge"],[1,"fas","fa-shield-alt"],[1,"fas","fa-truck"],[1,"fas","fa-undo-alt"],[1,"fas","fa-headset"],[1,"model-preview-large"],[3,"modelPath","autoRotate"],[1,"model-hint-large"],[1,"fas","fa-arrows-alt"],["class","featured-img",3,"src","alt",4,"ngIf"],["class","image-placeholder-large",4,"ngIf"],[1,"featured-img",3,"src","alt"],[1,"image-placeholder-large"],[1,"fas","fa-tshirt"],[1,"tag"],[1,"featured-product-info"],[1,"featured-product-header"],[1,"featured-brand"],[1,"featured-rating"],[1,"fas","fa-star"],[1,"review-count"],[1,"featured-name"],[1,"featured-description"],[1,"featured-specs"],[1,"spec"],[1,"fas","fa-tag"],[1,"fas","fa-layer-group"],[1,"featured-price-section"],[1,"price"],[1,"current"],["class","original",4,"ngIf"],["class","discount",4,"ngIf"],[1,"btn-featured-view",3,"click"],[1,"fas","fa-eye"],[1,"original"],[1,"discount"],[1,"category-card",3,"click"],[1,"category-icon"],[1,"category-name"],[1,"category-count"],[1,"category-hover"],[1,"product-card-home",3,"click"],["class","product-rank",4,"ngIf"],[1,"product-image-home"],[1,"product-badges-home"],["class","badge hot",4,"ngIf"],["class","badge sale",4,"ngIf"],["class","badge new",4,"ngIf"],["class","badge model-3d",4,"ngIf"],[1,"image-container-home"],["regularImage",""],[1,"quick-actions-home"],[1,"quick-action-btn",3,"disabled","click"],[1,"fas","fa-shopping-bag"],[1,"fas","fa-user-check"],[1,"quick-action-btn",3,"click"],[1,"fas","fa-heart"],[1,"stock-status-home"],[1,"fas"],[1,"product-info-home"],[1,"product-meta-home"],[1,"brand"],[1,"category"],[1,"product-name-home"],[1,"product-description-home"],[1,"product-specs-home"],[1,"spec-home"],[1,"product-footer-home"],[1,"price-home"],[1,"actions-home"],[1,"btn-quick-view",3,"click"],[1,"btn-quick-add",3,"disabled","click"],[1,"fas","fa-plus"],[1,"product-rank"],[1,"rank-number"],[1,"rank-glow"],[1,"badge","hot"],[1,"badge","sale"],[1,"badge","new"],[1,"badge","model-3d"],[1,"model-preview-home"],[1,"model-overlay"],[1,"product-img-home",3,"src","alt"],[1,"arrival-slide"],[1,"arrival-card-home"],[1,"arrival-image-home"],[1,"arrival-badge-home"],[3,"src","alt"],[1,"arrival-overlay"],[1,"btn-quick-view-arrival",3,"click"],[1,"arrival-info-home"],[1,"arrival-name"],[1,"arrival-description"],[1,"arrival-meta"],[1,"arrival-category"],[1,"arrival-material"],[1,"arrival-price-home"],[1,"arrival-action",3,"click"],[1,"dot",3,"click"],[1,"collection-card-home",3,"click"],[1,"collection-image-home"],[1,"collection-overlay-home"],[1,"collection-content-home"],[1,"collection-name-home"],[1,"collection-description-home"],[1,"collection-stats-home"],[1,"collection-count"],[1,"collection-price"],[1,"btn-collection-home"],[1,"collection-gradient"],[1,"testimonial-card"],[1,"testimonial-header"],[1,"testimonial-avatar"],[1,"testimonial-info"],[1,"testimonial-name"],[1,"testimonial-location"],[1,"testimonial-rating"],["class","fas fa-star",3,"active",4,"ngFor","ngForOf"],[1,"testimonial-text"],[1,"testimonial-product"],[1,"product-bought"],[1,"product-name"]],template:function(i,r){if(1&i&&(M(0,"div",0)(1,"section",1)(2,"div",2),U(3,"div",3)(4,"div",4),b(),M(5,"div",5)(6,"div",6)(7,"div",7)(8,"span",8),O(9,"LIMITED TIME"),b(),U(10,"i",9),b(),M(11,"h1",10)(12,"span",11),O(13,"FREEPPING"),b(),M(14,"span",12),O(15,"LOS SANTOS"),b(),M(16,"span",13),O(17,"STREETWEAR"),b()(),M(18,"p",14),O(19," Experience urban fashion through cutting-edge 3D visualization. "),M(20,"span",15),O(21,"Try before you buy"),b(),O(22," in our virtual fitting room. "),b(),M(23,"div",16)(24,"div",17)(25,"div",18),O(26,"500+"),b(),M(27,"div",19),O(28,"PREMIUM ITEMS"),b()(),M(29,"div",17)(30,"div",18),O(31,"3D"),b(),M(32,"div",19),O(33,"VIRTUAL TRY-ON"),b()(),M(34,"div",17)(35,"div",18),O(36,"24H"),b(),M(37,"div",19),O(38,"EXPRESS DELIVERY"),b()(),M(39,"div",17)(40,"div",18),O(41,"4.8"),b(),M(42,"div",19),O(43,"RATING"),b()()(),M(44,"div",20)(45,"button",21),ge("click",function(){return r.goToTryOn()}),U(46,"i",22),M(47,"span"),O(48,"LAUNCH 3D FITTING ROOM"),b(),U(49,"i",23),b(),M(50,"button",24),ge("click",function(){return r.goToShop()}),U(51,"i",25),M(52,"span"),O(53,"EXPLORE COLLECTION"),b()()(),M(54,"div",26)(55,"span"),O(56,"SCROLL TO EXPLORE"),b(),U(57,"i",27),b()(),M(58,"div",28)(59,"div",29)(60,"div",30),O(61,"FEATURED DROP"),b(),M(62,"div",31)(63,"div",32)(64,"div",33),ie(65,BK,7,2,"ng-container",34),ie(66,HK,2,2,"ng-template",null,35,Cs),b(),M(68,"div",36),ie(69,GK,2,0,"span",37),ie(70,jK,2,0,"span",37),ie(71,WK,2,0,"span",37),b()(),ie(72,XK,33,14,"div",38),b()()()()(),M(73,"section",39)(74,"div",40)(75,"h2",41),U(76,"span",42),O(77," SHOP BY CATEGORY "),U(78,"span",42),b(),M(79,"p",43),O(80,"Browse our curated collections"),b()(),M(81,"div",44),ie(82,YK,10,4,"div",45),b()(),M(83,"section",46)(84,"div",40)(85,"div",47)(86,"h2",41),U(87,"span",42),O(88," TRENDING NOW "),U(89,"span",42),b(),M(90,"p",43),O(91,"Most popular this week"),b()(),M(92,"div",48)(93,"button",49),ge("click",function(){return r.goToShop()}),O(94," VIEW ALL PRODUCTS "),U(95,"i",23),b()()(),M(96,"div",50),ie(97,rJ,53,34,"div",51),b()(),M(98,"section",52)(99,"div",53)(100,"div",54)(101,"div",55),U(102,"i",22),M(103,"span"),O(104,"EXCLUSIVE FEATURE"),b()(),M(105,"h2",56),O(106," VIRTUAL "),M(107,"span",15),O(108,"3D FITTING ROOM"),b()(),M(109,"p",57),O(110," Try on any item in our collection with our advanced 3D visualization technology. See how clothes fit, rotate 360\xb0, and find your perfect style. "),b(),M(111,"div",58)(112,"div",59),U(113,"i",60),M(114,"span"),O(115,"360\xb0 Rotation"),b()(),M(116,"div",59),U(117,"i",61),M(118,"span"),O(119,"Zoom & Detail View"),b()(),M(120,"div",59),U(121,"i",62),M(122,"span"),O(123,"Color Customization"),b()(),M(124,"div",59),U(125,"i",63),M(126,"span"),O(127,"Avatar Support"),b()()(),M(128,"div",64)(129,"button",65),ge("click",function(){return r.goToTryOn()}),U(130,"i",66),O(131," LAUNCH 3D FITTING ROOM "),b(),M(132,"button",67),ge("click",function(){return r.goToTutorial()}),U(133,"i",68),O(134," HOW IT WORKS "),b()()(),M(135,"div",69)(136,"div",70)(137,"div",71)(138,"div",72)(139,"div",73),U(140,"i",74),M(141,"span"),O(142,"3D MODEL PREVIEW"),b()(),M(143,"div",75)(144,"button",76),U(145,"i",60),b(),M(146,"button",76),U(147,"i",61),b(),M(148,"button",76),U(149,"i",62),b()()()()()()()(),M(150,"section",77)(151,"div",40)(152,"h2",41),U(153,"span",42),O(154," NEW ARRIVALS "),U(155,"span",42),b(),M(156,"p",43),O(157,"Fresh from Los Santos"),b()(),M(158,"div",78)(159,"button",79),ge("click",function(){return r.prevSlide()}),U(160,"i",80),b(),M(161,"div",81)(162,"div",82),ie(163,oJ,26,7,"div",83),b()(),M(164,"button",84),ge("click",function(){return r.nextSlide()}),U(165,"i",85),b(),M(166,"div",86),ie(167,sJ,1,2,"span",87),b()()(),M(168,"section",88)(169,"div",40)(170,"h2",41),U(171,"span",42),O(172," CURATED COLLECTIONS "),U(173,"span",42),b(),M(174,"p",43),O(175,"Handpicked styles for every vibe"),b()(),M(176,"div",89),ie(177,aJ,17,6,"div",90),b()(),M(178,"section",91)(179,"div",40)(180,"h2",41),U(181,"span",42),O(182," FROM THE STREETS "),U(183,"span",42),b(),M(184,"p",43),O(185,"What Los Santos is saying"),b()(),M(186,"div",92),ie(187,uJ,18,8,"div",93),b()(),M(188,"section",94)(189,"div",95),U(190,"div",96),b(),M(191,"div",97)(192,"h2",98),O(193,"READY TO ELEVATE YOUR STREETWEAR?"),b(),M(194,"p",99),O(195," Join thousands of trendsetters in Los Santos who trust Freepping for premium streetwear. "),b(),M(196,"div",100)(197,"div",101)(198,"div",18),O(199,"10K+"),b(),M(200,"div",19),O(201,"SATISFIED CUSTOMERS"),b()(),M(202,"div",101)(203,"div",18),O(204,"4.8"),b(),M(205,"div",19),O(206,"AVERAGE RATING"),b()(),M(207,"div",101)(208,"div",18),O(209,"24H"),b(),M(210,"div",19),O(211,"DELIVERY TIME"),b()()(),M(212,"div",102)(213,"button",103),ge("click",function(){return r.goToShop()}),U(214,"i",25),O(215," START SHOPPING "),b(),M(216,"button",104),ge("click",function(){return r.goToTryOn()}),U(217,"i",22),O(218," TRY 3D FITTING "),b()(),M(219,"div",105)(220,"div",106),U(221,"i",107),M(222,"span"),O(223,"Secure Payment"),b()(),M(224,"div",106),U(225,"i",108),M(226,"span"),O(227,"Free Shipping $100+"),b()(),M(228,"div",106),U(229,"i",109),M(230,"span"),O(231,"30-Day Returns"),b()(),M(232,"div",106),U(233,"i",110),M(234,"span"),O(235,"24/7 Support"),b()()()()()(),U(236,"app-bottom-nav")),2&i){const o=Ms(67);L(65),J("ngIf",r.featuredProduct&&r.has3DModel(r.featuredProduct))("ngIfElse",o),L(4),J("ngIf",null==r.featuredProduct?null:r.featuredProduct.isNew),L(1),J("ngIf",null==r.featuredProduct?null:r.featuredProduct.originalPrice),L(1),J("ngIf",null==r.featuredProduct?null:r.featuredProduct.has3DModel),L(1),J("ngIf",r.featuredProduct),L(10),J("ngForOf",r.categories),L(15),J("ngForOf",r.featuredProducts),L(65),lo("transform","translateX("+100*-r.currentSlide+"%)"),L(1),J("ngForOf",r.newArrivals),L(4),J("ngForOf",Ku(14,dJ)),L(10),J("ngForOf",r.collections),L(10),J("ngForOf",r.testimonials)}},dependencies:[Ps,jo,sl,_f,Vv],styles:['.home.page-container[_ngcontent-%COMP%]{background:#0a0a0a;min-height:100vh;color:#fff;overflow-x:hidden}.home.page-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.home.page-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#1a1a1a}.home.page-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#39ff14;border-radius:4px}.home.page-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#00ffaa}.home-hero[_ngcontent-%COMP%]{position:relative;min-height:90vh;padding:60px 20px;overflow:hidden}.home-hero[_ngcontent-%COMP%]   .hero-background[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:0}.home-hero[_ngcontent-%COMP%]   .hero-background[_ngcontent-%COMP%]   .hero-grid-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background-image:linear-gradient(rgba(57,255,20,.05) 1px,transparent 1px),linear-gradient(90deg,rgba(57,255,20,.05) 1px,transparent 1px);background-size:50px 50px;opacity:.3}.home-hero[_ngcontent-%COMP%]   .hero-background[_ngcontent-%COMP%]   .hero-glow[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:800px;height:800px;background:radial-gradient(circle,rgba(57,255,20,.1) 0%,transparent 70%);filter:blur(100px);z-index:-1}.home-hero[_ngcontent-%COMP%]   .hero-content[_ngcontent-%COMP%]{position:relative;z-index:1;max-width:1400px;margin:0 auto;display:grid;grid-template-columns:1fr 1fr;gap:60px;align-items:center}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:10px;background:rgba(57,255,20,.1);border:1px solid #39ff14;padding:8px 16px;border-radius:30px;margin-bottom:30px}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-badge[_ngcontent-%COMP%]   .badge-text[_ngcontent-%COMP%]{font-size:12px;font-weight:600;letter-spacing:2px;color:#39ff14}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-badge[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#39ff14;font-size:14px;animation:_ngcontent-%COMP%_pulse 2s infinite}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-title[_ngcontent-%COMP%]{font-family:Pricedown,sans-serif;font-size:80px;line-height:1;margin-bottom:20px}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-title[_ngcontent-%COMP%]   .title-line-1[_ngcontent-%COMP%]{color:#39ff14;display:block;text-shadow:0 0 30px rgba(57,255,20,.5)}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-title[_ngcontent-%COMP%]   .title-line-2[_ngcontent-%COMP%]{color:#fff;display:block;font-size:60px}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-title[_ngcontent-%COMP%]   .title-line-3[_ngcontent-%COMP%]{color:#ccc;display:block;font-size:40px;letter-spacing:5px}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-subtitle[_ngcontent-%COMP%]{font-size:18px;color:#b0b0b0;line-height:1.6;margin-bottom:40px;max-width:500px}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-subtitle[_ngcontent-%COMP%]   .highlight[_ngcontent-%COMP%]{color:#39ff14;font-weight:600}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:20px;margin-bottom:40px}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{text-align:center;padding:20px;background:rgba(255,255,255,.05);border-radius:10px;border:1px solid rgba(255,255,255,.1);transition:all .3s ease}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]:hover{border-color:#39ff14;transform:translateY(-5px);background:rgba(57,255,20,.05)}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-number[_ngcontent-%COMP%]{font-size:32px;font-weight:700;color:#39ff14;margin-bottom:5px}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:12px;color:#888;letter-spacing:1px;text-transform:uppercase}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-actions[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:50px}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-actions[_ngcontent-%COMP%]   .btn-hero-primary[_ngcontent-%COMP%]{flex:1;background:linear-gradient(45deg,#39ff14,#00ffaa);color:#000;border:none;padding:18px 30px;border-radius:10px;font-size:16px;font-weight:600;display:flex;align-items:center;justify-content:center;gap:15px;cursor:pointer;transition:all .3s ease;text-transform:uppercase;letter-spacing:1px}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-actions[_ngcontent-%COMP%]   .btn-hero-primary[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 10px 30px #39ff1466}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-actions[_ngcontent-%COMP%]   .btn-hero-primary[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]:last-child{transform:translate(5px)}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-actions[_ngcontent-%COMP%]   .btn-hero-primary[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:last-child{transition:transform .3s ease}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-actions[_ngcontent-%COMP%]   .btn-hero-secondary[_ngcontent-%COMP%]{flex:1;background:transparent;color:#fff;border:2px solid #39ff14;padding:18px 30px;border-radius:10px;font-size:16px;font-weight:600;display:flex;align-items:center;justify-content:center;gap:15px;cursor:pointer;transition:all .3s ease;text-transform:uppercase;letter-spacing:1px}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-actions[_ngcontent-%COMP%]   .btn-hero-secondary[_ngcontent-%COMP%]:hover{background:rgba(57,255,20,.1);transform:translateY(-3px)}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-scroll-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;color:#888;font-size:14px;letter-spacing:2px}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-scroll-indicator[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_bounce 2s infinite}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]{position:relative}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-badge[_ngcontent-%COMP%]{position:absolute;top:-10px;left:50%;transform:translate(-50%);background:#ff3366;color:#fff;padding:8px 20px;border-radius:20px;font-size:12px;font-weight:600;letter-spacing:2px;z-index:2;box-shadow:0 5px 20px #ff33664d}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]{background:rgba(26,26,26,.8);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:20px;border:2px solid rgba(57,255,20,.3);overflow:hidden;box-shadow:0 20px 60px #00000080}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-image[_ngcontent-%COMP%]{position:relative;height:400px}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-image[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{height:100%;width:100%;position:relative}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-image[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .model-preview-large[_ngcontent-%COMP%], .home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-image[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .featured-img[_ngcontent-%COMP%], .home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-image[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .image-placeholder-large[_ngcontent-%COMP%]{height:100%;width:100%;object-fit:cover}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-image[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .model-preview-large[_ngcontent-%COMP%]{position:relative}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-image[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .model-preview-large[_ngcontent-%COMP%]   .model-hint-large[_ngcontent-%COMP%]{position:absolute;bottom:20px;left:50%;transform:translate(-50%);background:rgba(0,0,0,.8);color:#39ff14;padding:8px 16px;border-radius:20px;font-size:12px;display:flex;align-items:center;gap:8px;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-image[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .image-placeholder-large[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;background:#1a1a1a;color:#666}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-image[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .image-placeholder-large[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:60px;margin-bottom:20px;color:#39ff14}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-image[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .image-placeholder-large[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;letter-spacing:2px}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-image[_ngcontent-%COMP%]   .product-tags[_ngcontent-%COMP%]{position:absolute;bottom:20px;left:20px;display:flex;gap:10px}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-image[_ngcontent-%COMP%]   .product-tags[_ngcontent-%COMP%]   .tag[_ngcontent-%COMP%]{background:rgba(0,0,0,.8);color:#fff;padding:6px 12px;border-radius:15px;font-size:11px;letter-spacing:1px;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-image[_ngcontent-%COMP%]   .product-tags[_ngcontent-%COMP%]   .tag[_ngcontent-%COMP%]:first-child{background:rgba(57,255,20,.8);color:#000}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-info[_ngcontent-%COMP%]{padding:30px}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-info[_ngcontent-%COMP%]   .featured-product-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-info[_ngcontent-%COMP%]   .featured-product-header[_ngcontent-%COMP%]   .featured-brand[_ngcontent-%COMP%]{color:#39ff14;font-size:14px;font-weight:600;letter-spacing:2px;text-transform:uppercase}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-info[_ngcontent-%COMP%]   .featured-product-header[_ngcontent-%COMP%]   .featured-rating[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#f90}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-info[_ngcontent-%COMP%]   .featured-product-header[_ngcontent-%COMP%]   .featured-rating[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:14px}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-info[_ngcontent-%COMP%]   .featured-product-header[_ngcontent-%COMP%]   .featured-rating[_ngcontent-%COMP%]   .review-count[_ngcontent-%COMP%]{color:#666;font-size:12px}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-info[_ngcontent-%COMP%]   .featured-name[_ngcontent-%COMP%]{font-size:24px;font-weight:700;margin-bottom:15px;line-height:1.3}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-info[_ngcontent-%COMP%]   .featured-description[_ngcontent-%COMP%]{color:#b0b0b0;font-size:14px;line-height:1.6;margin-bottom:20px}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-info[_ngcontent-%COMP%]   .featured-specs[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:25px}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-info[_ngcontent-%COMP%]   .featured-specs[_ngcontent-%COMP%]   .spec[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#888;font-size:13px}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-info[_ngcontent-%COMP%]   .featured-specs[_ngcontent-%COMP%]   .spec[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#39ff14}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-info[_ngcontent-%COMP%]   .featured-price-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-info[_ngcontent-%COMP%]   .featured-price-section[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-info[_ngcontent-%COMP%]   .featured-price-section[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{font-size:32px;font-weight:700;color:#39ff14}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-info[_ngcontent-%COMP%]   .featured-price-section[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]   .original[_ngcontent-%COMP%]{font-size:20px;color:#666;text-decoration:line-through}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-info[_ngcontent-%COMP%]   .featured-price-section[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]   .discount[_ngcontent-%COMP%]{background:#ff3366;color:#fff;padding:4px 10px;border-radius:15px;font-size:12px;font-weight:600}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-info[_ngcontent-%COMP%]   .featured-price-section[_ngcontent-%COMP%]   .btn-featured-view[_ngcontent-%COMP%]{background:transparent;color:#fff;border:2px solid #39ff14;padding:12px 24px;border-radius:8px;font-size:14px;font-weight:600;display:flex;align-items:center;gap:10px;cursor:pointer;transition:all .3s ease}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-info[_ngcontent-%COMP%]   .featured-price-section[_ngcontent-%COMP%]   .btn-featured-view[_ngcontent-%COMP%]:hover{background:rgba(57,255,20,.1);transform:translate(5px)}.quick-categories[_ngcontent-%COMP%]{padding:80px 20px;background:#111}.quick-categories[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:60px}.quick-categories[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:36px;display:flex;align-items:center;justify-content:center;gap:20px;margin-bottom:15px;font-family:Oswald,sans-serif;letter-spacing:3px}.quick-categories[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]   .title-accent[_ngcontent-%COMP%]{width:60px;height:2px;background:#39ff14}.quick-categories[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-subtitle[_ngcontent-%COMP%]{color:#888;font-size:16px;max-width:600px;margin:0 auto}.quick-categories[_ngcontent-%COMP%]   .categories-grid[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:20px}.quick-categories[_ngcontent-%COMP%]   .categories-grid[_ngcontent-%COMP%]   .category-card[_ngcontent-%COMP%]{background:#1a1a1a;border-radius:15px;padding:30px 20px;text-align:center;cursor:pointer;transition:all .3s ease;border:1px solid rgba(255,255,255,.1);position:relative;overflow:hidden}.quick-categories[_ngcontent-%COMP%]   .categories-grid[_ngcontent-%COMP%]   .category-card[_ngcontent-%COMP%]:hover{border-color:#39ff14;transform:translateY(-10px);box-shadow:0 20px 40px #39ff141a}.quick-categories[_ngcontent-%COMP%]   .categories-grid[_ngcontent-%COMP%]   .category-card[_ngcontent-%COMP%]:hover   .category-hover[_ngcontent-%COMP%]{opacity:1;transform:translateY(0)}.quick-categories[_ngcontent-%COMP%]   .categories-grid[_ngcontent-%COMP%]   .category-card[_ngcontent-%COMP%]:hover   .category-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transform:scale(1.2)}.quick-categories[_ngcontent-%COMP%]   .categories-grid[_ngcontent-%COMP%]   .category-card[_ngcontent-%COMP%]   .category-icon[_ngcontent-%COMP%]{margin-bottom:20px}.quick-categories[_ngcontent-%COMP%]   .categories-grid[_ngcontent-%COMP%]   .category-card[_ngcontent-%COMP%]   .category-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:40px;color:#39ff14;transition:transform .3s ease}.quick-categories[_ngcontent-%COMP%]   .categories-grid[_ngcontent-%COMP%]   .category-card[_ngcontent-%COMP%]   .category-name[_ngcontent-%COMP%]{font-size:18px;font-weight:600;margin-bottom:10px;color:#fff}.quick-categories[_ngcontent-%COMP%]   .categories-grid[_ngcontent-%COMP%]   .category-card[_ngcontent-%COMP%]   .category-count[_ngcontent-%COMP%]{color:#888;font-size:14px}.quick-categories[_ngcontent-%COMP%]   .categories-grid[_ngcontent-%COMP%]   .category-card[_ngcontent-%COMP%]   .category-hover[_ngcontent-%COMP%]{position:absolute;bottom:20px;left:0;right:0;text-align:center;opacity:0;transform:translateY(10px);transition:all .3s ease}.quick-categories[_ngcontent-%COMP%]   .categories-grid[_ngcontent-%COMP%]   .category-card[_ngcontent-%COMP%]   .category-hover[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#39ff14;font-size:12px;letter-spacing:2px}.featured-products[_ngcontent-%COMP%]{padding:80px 20px;background:#0a0a0a}.featured-products[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto 60px;display:flex;justify-content:space-between;align-items:flex-end}.featured-products[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:36px;display:flex;align-items:center;gap:20px;margin-bottom:15px;font-family:Oswald,sans-serif;letter-spacing:3px}.featured-products[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]   .title-accent[_ngcontent-%COMP%]{width:60px;height:2px;background:#39ff14}.featured-products[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .section-subtitle[_ngcontent-%COMP%]{color:#888;font-size:16px}.featured-products[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .btn-view-all[_ngcontent-%COMP%]{background:transparent;color:#fff;border:2px solid #39ff14;padding:12px 24px;border-radius:8px;font-size:14px;font-weight:600;display:flex;align-items:center;gap:10px;cursor:pointer;transition:all .3s ease}.featured-products[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .btn-view-all[_ngcontent-%COMP%]:hover{background:rgba(57,255,20,.1);transform:translate(5px)}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:30px}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]{background:#1a1a1a;border-radius:15px;overflow:hidden;cursor:pointer;transition:all .3s ease;border:1px solid rgba(255,255,255,.1);position:relative}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home.featured[_ngcontent-%COMP%]{grid-column:span 2}@media (max-width: 1024px){.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home.featured[_ngcontent-%COMP%]{grid-column:span 1}}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]:hover{border-color:#39ff14;transform:translateY(-10px);box-shadow:0 20px 40px #39ff141a}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]:hover   .quick-actions-home[_ngcontent-%COMP%]{opacity:1;transform:translateY(0)}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-rank[_ngcontent-%COMP%]{position:absolute;top:15px;left:15px;z-index:2}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-rank[_ngcontent-%COMP%]   .rank-number[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#f90;position:relative;z-index:1}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-rank[_ngcontent-%COMP%]   .rank-glow[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:50px;height:50px;background:radial-gradient(circle,rgba(255,153,0,.3) 0%,transparent 70%);filter:blur(10px)}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-image-home[_ngcontent-%COMP%]{height:250px;position:relative;overflow:hidden}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-image-home[_ngcontent-%COMP%]   .product-badges-home[_ngcontent-%COMP%]{position:absolute;top:15px;right:15px;display:flex;flex-direction:column;gap:8px;z-index:2}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-image-home[_ngcontent-%COMP%]   .product-badges-home[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{padding:6px 12px;border-radius:4px;font-size:11px;font-weight:600;letter-spacing:1px;text-transform:uppercase}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-image-home[_ngcontent-%COMP%]   .product-badges-home[_ngcontent-%COMP%]   .badge.hot[_ngcontent-%COMP%]{background:#ff3366;color:#fff}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-image-home[_ngcontent-%COMP%]   .product-badges-home[_ngcontent-%COMP%]   .badge.sale[_ngcontent-%COMP%]{background:#ff9900;color:#000}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-image-home[_ngcontent-%COMP%]   .product-badges-home[_ngcontent-%COMP%]   .badge.new[_ngcontent-%COMP%]{background:#39ff14;color:#000}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-image-home[_ngcontent-%COMP%]   .product-badges-home[_ngcontent-%COMP%]   .badge.model-3d[_ngcontent-%COMP%]{background:#3366ff;color:#fff}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-image-home[_ngcontent-%COMP%]   .image-container-home[_ngcontent-%COMP%], .featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-image-home[_ngcontent-%COMP%]   .image-container-home[_ngcontent-%COMP%]   .model-preview-home[_ngcontent-%COMP%]{height:100%;width:100%;position:relative}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-image-home[_ngcontent-%COMP%]   .image-container-home[_ngcontent-%COMP%]   .model-preview-home[_ngcontent-%COMP%]   .model-overlay[_ngcontent-%COMP%]{position:absolute;bottom:15px;right:15px;background:rgba(0,0,0,.8);color:#39ff14;padding:6px 12px;border-radius:15px;font-size:11px;display:flex;align-items:center;gap:6px;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-image-home[_ngcontent-%COMP%]   .image-container-home[_ngcontent-%COMP%]   .product-img-home[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-image-home[_ngcontent-%COMP%]   .quick-actions-home[_ngcontent-%COMP%]{position:absolute;top:15px;left:15px;display:flex;flex-direction:column;gap:10px;opacity:0;transform:translateY(-10px);transition:all .3s ease}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-image-home[_ngcontent-%COMP%]   .quick-actions-home[_ngcontent-%COMP%]   .quick-action-btn[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:rgba(0,0,0,.8);border:1px solid #39ff14;color:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s ease;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-image-home[_ngcontent-%COMP%]   .quick-actions-home[_ngcontent-%COMP%]   .quick-action-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#39ff14;color:#000}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-image-home[_ngcontent-%COMP%]   .quick-actions-home[_ngcontent-%COMP%]   .quick-action-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-image-home[_ngcontent-%COMP%]   .quick-actions-home[_ngcontent-%COMP%]   .quick-action-btn[_ngcontent-%COMP%]   .fa-heart.active[_ngcontent-%COMP%]{color:#f36}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-image-home[_ngcontent-%COMP%]   .stock-status-home[_ngcontent-%COMP%]{position:absolute;bottom:15px;left:15px;display:flex;align-items:center;gap:8px;padding:6px 12px;border-radius:15px;font-size:12px;font-weight:600;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-image-home[_ngcontent-%COMP%]   .stock-status-home.in-stock[_ngcontent-%COMP%]{background:rgba(57,255,20,.2);color:#39ff14;border:1px solid rgba(57,255,20,.5)}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-image-home[_ngcontent-%COMP%]   .stock-status-home.out-of-stock[_ngcontent-%COMP%]{background:rgba(255,51,102,.2);color:#f36;border:1px solid rgba(255,51,102,.5)}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-info-home[_ngcontent-%COMP%]{padding:25px}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-info-home[_ngcontent-%COMP%]   .product-meta-home[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-info-home[_ngcontent-%COMP%]   .product-meta-home[_ngcontent-%COMP%]   .brand[_ngcontent-%COMP%]{color:#39ff14;font-size:12px;font-weight:600;letter-spacing:2px;text-transform:uppercase}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-info-home[_ngcontent-%COMP%]   .product-meta-home[_ngcontent-%COMP%]   .category[_ngcontent-%COMP%]{color:#666;font-size:12px}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-info-home[_ngcontent-%COMP%]   .product-name-home[_ngcontent-%COMP%]{font-size:18px;font-weight:600;margin-bottom:12px;line-height:1.4}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-info-home[_ngcontent-%COMP%]   .product-description-home[_ngcontent-%COMP%]{color:#888;font-size:14px;line-height:1.6;margin-bottom:20px}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-info-home[_ngcontent-%COMP%]   .product-specs-home[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:25px}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-info-home[_ngcontent-%COMP%]   .product-specs-home[_ngcontent-%COMP%]   .spec-home[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#666;font-size:12px}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-info-home[_ngcontent-%COMP%]   .product-specs-home[_ngcontent-%COMP%]   .spec-home[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#39ff14}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-info-home[_ngcontent-%COMP%]   .product-footer-home[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;border-top:1px solid rgba(255,255,255,.1);padding-top:20px}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-info-home[_ngcontent-%COMP%]   .product-footer-home[_ngcontent-%COMP%]   .price-home[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{font-size:22px;font-weight:700;color:#39ff14;margin-right:10px}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-info-home[_ngcontent-%COMP%]   .product-footer-home[_ngcontent-%COMP%]   .price-home[_ngcontent-%COMP%]   .original[_ngcontent-%COMP%]{font-size:16px;color:#666;text-decoration:line-through}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-info-home[_ngcontent-%COMP%]   .product-footer-home[_ngcontent-%COMP%]   .actions-home[_ngcontent-%COMP%]{display:flex;gap:10px}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-info-home[_ngcontent-%COMP%]   .product-footer-home[_ngcontent-%COMP%]   .actions-home[_ngcontent-%COMP%]   .btn-quick-view[_ngcontent-%COMP%], .featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-info-home[_ngcontent-%COMP%]   .product-footer-home[_ngcontent-%COMP%]   .actions-home[_ngcontent-%COMP%]   .btn-quick-add[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;border:none;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s ease}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-info-home[_ngcontent-%COMP%]   .product-footer-home[_ngcontent-%COMP%]   .actions-home[_ngcontent-%COMP%]   .btn-quick-view[_ngcontent-%COMP%]{background:rgba(57,255,20,.1);color:#39ff14;border:1px solid #39ff14}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-info-home[_ngcontent-%COMP%]   .product-footer-home[_ngcontent-%COMP%]   .actions-home[_ngcontent-%COMP%]   .btn-quick-view[_ngcontent-%COMP%]:hover, .featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-info-home[_ngcontent-%COMP%]   .product-footer-home[_ngcontent-%COMP%]   .actions-home[_ngcontent-%COMP%]   .btn-quick-add[_ngcontent-%COMP%]{background:#39ff14;color:#000}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-info-home[_ngcontent-%COMP%]   .product-footer-home[_ngcontent-%COMP%]   .actions-home[_ngcontent-%COMP%]   .btn-quick-add[_ngcontent-%COMP%]:hover:not(:disabled){background:#00ffaa;transform:scale(1.1)}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home[_ngcontent-%COMP%]   .product-info-home[_ngcontent-%COMP%]   .product-footer-home[_ngcontent-%COMP%]   .actions-home[_ngcontent-%COMP%]   .btn-quick-add[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.try-on-banner[_ngcontent-%COMP%]{padding:100px 20px;background:linear-gradient(135deg,#0a0a0a 0%,#1a1f1b 100%);position:relative;overflow:hidden}.try-on-banner[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,#39ff14,transparent)}.try-on-banner[_ngcontent-%COMP%]   .banner-content[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;display:grid;grid-template-columns:1fr 1fr;gap:60px;align-items:center;position:relative;z-index:1}.try-on-banner[_ngcontent-%COMP%]   .banner-left[_ngcontent-%COMP%]   .banner-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:10px;background:rgba(57,255,20,.1);border:1px solid #39ff14;padding:8px 16px;border-radius:30px;margin-bottom:30px}.try-on-banner[_ngcontent-%COMP%]   .banner-left[_ngcontent-%COMP%]   .banner-badge[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#39ff14;animation:_ngcontent-%COMP%_pulse 2s infinite}.try-on-banner[_ngcontent-%COMP%]   .banner-left[_ngcontent-%COMP%]   .banner-badge[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;font-weight:600;letter-spacing:2px;color:#39ff14}.try-on-banner[_ngcontent-%COMP%]   .banner-left[_ngcontent-%COMP%]   .banner-title[_ngcontent-%COMP%]{font-size:48px;font-weight:700;margin-bottom:20px;line-height:1.2}.try-on-banner[_ngcontent-%COMP%]   .banner-left[_ngcontent-%COMP%]   .banner-title[_ngcontent-%COMP%]   .highlight[_ngcontent-%COMP%]{color:#39ff14}.try-on-banner[_ngcontent-%COMP%]   .banner-left[_ngcontent-%COMP%]   .banner-description[_ngcontent-%COMP%]{font-size:18px;color:#b0b0b0;line-height:1.6;margin-bottom:40px;max-width:500px}.try-on-banner[_ngcontent-%COMP%]   .banner-left[_ngcontent-%COMP%]   .banner-features[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:20px;margin-bottom:40px}.try-on-banner[_ngcontent-%COMP%]   .banner-left[_ngcontent-%COMP%]   .banner-features[_ngcontent-%COMP%]   .feature[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:15px;background:rgba(255,255,255,.05);border-radius:10px;border:1px solid rgba(255,255,255,.1);transition:all .3s ease}.try-on-banner[_ngcontent-%COMP%]   .banner-left[_ngcontent-%COMP%]   .banner-features[_ngcontent-%COMP%]   .feature[_ngcontent-%COMP%]:hover{border-color:#39ff14;transform:translateY(-3px)}.try-on-banner[_ngcontent-%COMP%]   .banner-left[_ngcontent-%COMP%]   .banner-features[_ngcontent-%COMP%]   .feature[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#39ff14;font-size:20px}.try-on-banner[_ngcontent-%COMP%]   .banner-left[_ngcontent-%COMP%]   .banner-features[_ngcontent-%COMP%]   .feature[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#fff}.try-on-banner[_ngcontent-%COMP%]   .banner-left[_ngcontent-%COMP%]   .banner-actions[_ngcontent-%COMP%]{display:flex;gap:20px}.try-on-banner[_ngcontent-%COMP%]   .banner-left[_ngcontent-%COMP%]   .banner-actions[_ngcontent-%COMP%]   .btn-banner-primary[_ngcontent-%COMP%]{background:linear-gradient(45deg,#39ff14,#00ffaa);color:#000;border:none;padding:18px 30px;border-radius:10px;font-size:16px;font-weight:600;display:flex;align-items:center;justify-content:center;gap:15px;cursor:pointer;transition:all .3s ease}.try-on-banner[_ngcontent-%COMP%]   .banner-left[_ngcontent-%COMP%]   .banner-actions[_ngcontent-%COMP%]   .btn-banner-primary[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 10px 30px #39ff1466}.try-on-banner[_ngcontent-%COMP%]   .banner-left[_ngcontent-%COMP%]   .banner-actions[_ngcontent-%COMP%]   .btn-banner-secondary[_ngcontent-%COMP%]{background:transparent;color:#fff;border:2px solid #39ff14;padding:18px 30px;border-radius:10px;font-size:16px;font-weight:600;display:flex;align-items:center;justify-content:center;gap:15px;cursor:pointer;transition:all .3s ease}.try-on-banner[_ngcontent-%COMP%]   .banner-left[_ngcontent-%COMP%]   .banner-actions[_ngcontent-%COMP%]   .btn-banner-secondary[_ngcontent-%COMP%]:hover{background:rgba(57,255,20,.1);transform:translateY(-3px)}.try-on-banner[_ngcontent-%COMP%]   .banner-right[_ngcontent-%COMP%]   .banner-preview[_ngcontent-%COMP%]   .preview-container[_ngcontent-%COMP%]{background:rgba(26,26,26,.8);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:20px;border:2px solid rgba(57,255,20,.3);overflow:hidden;box-shadow:0 20px 60px #00000080;padding:30px}.try-on-banner[_ngcontent-%COMP%]   .banner-right[_ngcontent-%COMP%]   .banner-preview[_ngcontent-%COMP%]   .preview-container[_ngcontent-%COMP%]   .preview-model[_ngcontent-%COMP%]{height:300px;position:relative}.try-on-banner[_ngcontent-%COMP%]   .banner-right[_ngcontent-%COMP%]   .banner-preview[_ngcontent-%COMP%]   .preview-container[_ngcontent-%COMP%]   .preview-model[_ngcontent-%COMP%]   .model-placeholder[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#1a1a1a;border-radius:10px;border:2px dashed rgba(57,255,20,.3)}.try-on-banner[_ngcontent-%COMP%]   .banner-right[_ngcontent-%COMP%]   .banner-preview[_ngcontent-%COMP%]   .preview-container[_ngcontent-%COMP%]   .preview-model[_ngcontent-%COMP%]   .model-placeholder[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:60px;color:#39ff14;margin-bottom:20px;animation:_ngcontent-%COMP%_rotate 10s linear infinite}.try-on-banner[_ngcontent-%COMP%]   .banner-right[_ngcontent-%COMP%]   .banner-preview[_ngcontent-%COMP%]   .preview-container[_ngcontent-%COMP%]   .preview-model[_ngcontent-%COMP%]   .model-placeholder[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#666;font-size:14px;letter-spacing:2px}.try-on-banner[_ngcontent-%COMP%]   .banner-right[_ngcontent-%COMP%]   .banner-preview[_ngcontent-%COMP%]   .preview-container[_ngcontent-%COMP%]   .preview-model[_ngcontent-%COMP%]   .preview-controls[_ngcontent-%COMP%]{position:absolute;bottom:20px;left:50%;transform:translate(-50%);display:flex;gap:10px}.try-on-banner[_ngcontent-%COMP%]   .banner-right[_ngcontent-%COMP%]   .banner-preview[_ngcontent-%COMP%]   .preview-container[_ngcontent-%COMP%]   .preview-model[_ngcontent-%COMP%]   .preview-controls[_ngcontent-%COMP%]   .control-btn[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:rgba(0,0,0,.8);border:1px solid #39ff14;color:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s ease;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.try-on-banner[_ngcontent-%COMP%]   .banner-right[_ngcontent-%COMP%]   .banner-preview[_ngcontent-%COMP%]   .preview-container[_ngcontent-%COMP%]   .preview-model[_ngcontent-%COMP%]   .preview-controls[_ngcontent-%COMP%]   .control-btn[_ngcontent-%COMP%]:hover{background:#39ff14;color:#000}.new-arrivals[_ngcontent-%COMP%]{padding:80px 20px;background:#111}.new-arrivals[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:60px}.new-arrivals[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:36px;display:flex;align-items:center;justify-content:center;gap:20px;margin-bottom:15px;font-family:Oswald,sans-serif;letter-spacing:3px}.new-arrivals[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]   .title-accent[_ngcontent-%COMP%]{width:60px;height:2px;background:#39ff14}.new-arrivals[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-subtitle[_ngcontent-%COMP%]{color:#888;font-size:16px;max-width:600px;margin:0 auto}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;position:relative}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-nav[_ngcontent-%COMP%]{position:absolute;top:50%;transform:translateY(-50%);width:50px;height:50px;border-radius:50%;background:rgba(0,0,0,.8);border:1px solid #39ff14;color:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s ease;z-index:2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-nav[_ngcontent-%COMP%]:hover{background:#39ff14;color:#000}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-nav.prev[_ngcontent-%COMP%]{left:-25px}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-nav.next[_ngcontent-%COMP%]{right:-25px}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]{overflow:hidden;border-radius:20px}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   .slider-track[_ngcontent-%COMP%]{display:flex;transition:transform .5s ease}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   .slider-track[_ngcontent-%COMP%]   .arrival-slide[_ngcontent-%COMP%]{flex:0 0 100%}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   .slider-track[_ngcontent-%COMP%]   .arrival-slide[_ngcontent-%COMP%]   .arrival-card-home[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:40px;background:#1a1a1a;border-radius:20px;overflow:hidden;border:1px solid rgba(255,255,255,.1)}@media (max-width: 768px){.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   .slider-track[_ngcontent-%COMP%]   .arrival-slide[_ngcontent-%COMP%]   .arrival-card-home[_ngcontent-%COMP%]{grid-template-columns:1fr}}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   .slider-track[_ngcontent-%COMP%]   .arrival-slide[_ngcontent-%COMP%]   .arrival-card-home[_ngcontent-%COMP%]   .arrival-image-home[_ngcontent-%COMP%]{position:relative;min-height:400px}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   .slider-track[_ngcontent-%COMP%]   .arrival-slide[_ngcontent-%COMP%]   .arrival-card-home[_ngcontent-%COMP%]   .arrival-image-home[_ngcontent-%COMP%]   .arrival-badge-home[_ngcontent-%COMP%]{position:absolute;top:20px;left:20px;background:#39ff14;color:#000;padding:8px 16px;border-radius:4px;font-size:12px;font-weight:600;letter-spacing:2px;z-index:2}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   .slider-track[_ngcontent-%COMP%]   .arrival-slide[_ngcontent-%COMP%]   .arrival-card-home[_ngcontent-%COMP%]   .arrival-image-home[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   .slider-track[_ngcontent-%COMP%]   .arrival-slide[_ngcontent-%COMP%]   .arrival-card-home[_ngcontent-%COMP%]   .arrival-image-home[_ngcontent-%COMP%]   .arrival-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .3s ease}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   .slider-track[_ngcontent-%COMP%]   .arrival-slide[_ngcontent-%COMP%]   .arrival-card-home[_ngcontent-%COMP%]   .arrival-image-home[_ngcontent-%COMP%]   .arrival-overlay[_ngcontent-%COMP%]:hover{opacity:1}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   .slider-track[_ngcontent-%COMP%]   .arrival-slide[_ngcontent-%COMP%]   .arrival-card-home[_ngcontent-%COMP%]   .arrival-image-home[_ngcontent-%COMP%]   .arrival-overlay[_ngcontent-%COMP%]   .btn-quick-view-arrival[_ngcontent-%COMP%]{background:rgba(57,255,20,.9);color:#000;border:none;padding:12px 24px;border-radius:8px;font-size:14px;font-weight:600;display:flex;align-items:center;gap:10px;cursor:pointer;transition:all .3s ease}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   .slider-track[_ngcontent-%COMP%]   .arrival-slide[_ngcontent-%COMP%]   .arrival-card-home[_ngcontent-%COMP%]   .arrival-image-home[_ngcontent-%COMP%]   .arrival-overlay[_ngcontent-%COMP%]   .btn-quick-view-arrival[_ngcontent-%COMP%]:hover{background:#00ffaa;transform:scale(1.05)}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   .slider-track[_ngcontent-%COMP%]   .arrival-slide[_ngcontent-%COMP%]   .arrival-card-home[_ngcontent-%COMP%]   .arrival-info-home[_ngcontent-%COMP%]{padding:40px;display:flex;flex-direction:column;justify-content:center}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   .slider-track[_ngcontent-%COMP%]   .arrival-slide[_ngcontent-%COMP%]   .arrival-card-home[_ngcontent-%COMP%]   .arrival-info-home[_ngcontent-%COMP%]   .arrival-name[_ngcontent-%COMP%]{font-size:32px;font-weight:700;margin-bottom:20px;line-height:1.2}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   .slider-track[_ngcontent-%COMP%]   .arrival-slide[_ngcontent-%COMP%]   .arrival-card-home[_ngcontent-%COMP%]   .arrival-info-home[_ngcontent-%COMP%]   .arrival-description[_ngcontent-%COMP%]{color:#b0b0b0;font-size:16px;line-height:1.6;margin-bottom:25px}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   .slider-track[_ngcontent-%COMP%]   .arrival-slide[_ngcontent-%COMP%]   .arrival-card-home[_ngcontent-%COMP%]   .arrival-info-home[_ngcontent-%COMP%]   .arrival-meta[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:30px}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   .slider-track[_ngcontent-%COMP%]   .arrival-slide[_ngcontent-%COMP%]   .arrival-card-home[_ngcontent-%COMP%]   .arrival-info-home[_ngcontent-%COMP%]   .arrival-meta[_ngcontent-%COMP%]   .arrival-category[_ngcontent-%COMP%], .new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   .slider-track[_ngcontent-%COMP%]   .arrival-slide[_ngcontent-%COMP%]   .arrival-card-home[_ngcontent-%COMP%]   .arrival-info-home[_ngcontent-%COMP%]   .arrival-meta[_ngcontent-%COMP%]   .arrival-material[_ngcontent-%COMP%]{background:rgba(57,255,20,.1);color:#39ff14;padding:6px 12px;border-radius:15px;font-size:12px;font-weight:600}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   .slider-track[_ngcontent-%COMP%]   .arrival-slide[_ngcontent-%COMP%]   .arrival-card-home[_ngcontent-%COMP%]   .arrival-info-home[_ngcontent-%COMP%]   .arrival-price-home[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   .slider-track[_ngcontent-%COMP%]   .arrival-slide[_ngcontent-%COMP%]   .arrival-card-home[_ngcontent-%COMP%]   .arrival-info-home[_ngcontent-%COMP%]   .arrival-price-home[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#39ff14}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   .slider-track[_ngcontent-%COMP%]   .arrival-slide[_ngcontent-%COMP%]   .arrival-card-home[_ngcontent-%COMP%]   .arrival-info-home[_ngcontent-%COMP%]   .arrival-price-home[_ngcontent-%COMP%]   .arrival-action[_ngcontent-%COMP%]{background:transparent;color:#fff;border:2px solid #39ff14;padding:12px 24px;border-radius:8px;font-size:14px;font-weight:600;display:flex;align-items:center;gap:10px;cursor:pointer;transition:all .3s ease}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   .slider-track[_ngcontent-%COMP%]   .arrival-slide[_ngcontent-%COMP%]   .arrival-card-home[_ngcontent-%COMP%]   .arrival-info-home[_ngcontent-%COMP%]   .arrival-price-home[_ngcontent-%COMP%]   .arrival-action[_ngcontent-%COMP%]:hover{background:rgba(57,255,20,.1)}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-dots[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:10px;margin-top:30px}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-dots[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%;background:rgba(255,255,255,.2);cursor:pointer;transition:all .3s ease}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-dots[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]:hover{background:rgba(57,255,20,.5)}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-dots[_ngcontent-%COMP%]   .dot.active[_ngcontent-%COMP%]{background:#39ff14;transform:scale(1.2)}.collections-home[_ngcontent-%COMP%]{padding:80px 20px;background:#0a0a0a}.collections-home[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:60px}.collections-home[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:36px;display:flex;align-items:center;justify-content:center;gap:20px;margin-bottom:15px;font-family:Oswald,sans-serif;letter-spacing:3px}.collections-home[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]   .title-accent[_ngcontent-%COMP%]{width:60px;height:2px;background:#39ff14}.collections-home[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-subtitle[_ngcontent-%COMP%]{color:#888;font-size:16px;max-width:600px;margin:0 auto}.collections-home[_ngcontent-%COMP%]   .collections-grid-home[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:30px}.collections-home[_ngcontent-%COMP%]   .collections-grid-home[_ngcontent-%COMP%]   .collection-card-home[_ngcontent-%COMP%]{height:400px;border-radius:20px;overflow:hidden;cursor:pointer;position:relative}.collections-home[_ngcontent-%COMP%]   .collections-grid-home[_ngcontent-%COMP%]   .collection-card-home[_ngcontent-%COMP%]:hover   .collection-overlay-home[_ngcontent-%COMP%]{opacity:1}.collections-home[_ngcontent-%COMP%]   .collections-grid-home[_ngcontent-%COMP%]   .collection-card-home[_ngcontent-%COMP%]:hover   .collection-overlay-home[_ngcontent-%COMP%]   .collection-content-home[_ngcontent-%COMP%]{transform:translateY(0)}.collections-home[_ngcontent-%COMP%]   .collections-grid-home[_ngcontent-%COMP%]   .collection-card-home[_ngcontent-%COMP%]:hover   .collection-gradient[_ngcontent-%COMP%]{opacity:.8}.collections-home[_ngcontent-%COMP%]   .collections-grid-home[_ngcontent-%COMP%]   .collection-card-home[_ngcontent-%COMP%]   .collection-image-home[_ngcontent-%COMP%]{height:100%;width:100%;background-size:cover;background-position:center;position:relative}.collections-home[_ngcontent-%COMP%]   .collections-grid-home[_ngcontent-%COMP%]   .collection-card-home[_ngcontent-%COMP%]   .collection-image-home[_ngcontent-%COMP%]   .collection-overlay-home[_ngcontent-%COMP%]{position:absolute;inset:0;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;padding:40px;opacity:0;transition:opacity .3s ease}.collections-home[_ngcontent-%COMP%]   .collections-grid-home[_ngcontent-%COMP%]   .collection-card-home[_ngcontent-%COMP%]   .collection-image-home[_ngcontent-%COMP%]   .collection-overlay-home[_ngcontent-%COMP%]   .collection-content-home[_ngcontent-%COMP%]{text-align:center;transform:translateY(20px);transition:transform .3s ease}.collections-home[_ngcontent-%COMP%]   .collections-grid-home[_ngcontent-%COMP%]   .collection-card-home[_ngcontent-%COMP%]   .collection-image-home[_ngcontent-%COMP%]   .collection-overlay-home[_ngcontent-%COMP%]   .collection-content-home[_ngcontent-%COMP%]   .collection-name-home[_ngcontent-%COMP%]{font-size:28px;font-weight:700;margin-bottom:15px;color:#fff}.collections-home[_ngcontent-%COMP%]   .collections-grid-home[_ngcontent-%COMP%]   .collection-card-home[_ngcontent-%COMP%]   .collection-image-home[_ngcontent-%COMP%]   .collection-overlay-home[_ngcontent-%COMP%]   .collection-content-home[_ngcontent-%COMP%]   .collection-description-home[_ngcontent-%COMP%]{color:#b0b0b0;font-size:16px;line-height:1.6;margin-bottom:25px}.collections-home[_ngcontent-%COMP%]   .collections-grid-home[_ngcontent-%COMP%]   .collection-card-home[_ngcontent-%COMP%]   .collection-image-home[_ngcontent-%COMP%]   .collection-overlay-home[_ngcontent-%COMP%]   .collection-content-home[_ngcontent-%COMP%]   .collection-stats-home[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:30px;margin-bottom:30px}.collections-home[_ngcontent-%COMP%]   .collections-grid-home[_ngcontent-%COMP%]   .collection-card-home[_ngcontent-%COMP%]   .collection-image-home[_ngcontent-%COMP%]   .collection-overlay-home[_ngcontent-%COMP%]   .collection-content-home[_ngcontent-%COMP%]   .collection-stats-home[_ngcontent-%COMP%]   .collection-count[_ngcontent-%COMP%], .collections-home[_ngcontent-%COMP%]   .collections-grid-home[_ngcontent-%COMP%]   .collection-card-home[_ngcontent-%COMP%]   .collection-image-home[_ngcontent-%COMP%]   .collection-overlay-home[_ngcontent-%COMP%]   .collection-content-home[_ngcontent-%COMP%]   .collection-stats-home[_ngcontent-%COMP%]   .collection-price[_ngcontent-%COMP%]{color:#39ff14;font-size:14px;font-weight:600}.collections-home[_ngcontent-%COMP%]   .collections-grid-home[_ngcontent-%COMP%]   .collection-card-home[_ngcontent-%COMP%]   .collection-image-home[_ngcontent-%COMP%]   .collection-overlay-home[_ngcontent-%COMP%]   .collection-content-home[_ngcontent-%COMP%]   .btn-collection-home[_ngcontent-%COMP%]{background:rgba(57,255,20,.2);color:#fff;border:2px solid #39ff14;padding:12px 24px;border-radius:8px;font-size:14px;font-weight:600;display:flex;align-items:center;gap:10px;cursor:pointer;transition:all .3s ease;margin:0 auto}.collections-home[_ngcontent-%COMP%]   .collections-grid-home[_ngcontent-%COMP%]   .collection-card-home[_ngcontent-%COMP%]   .collection-image-home[_ngcontent-%COMP%]   .collection-overlay-home[_ngcontent-%COMP%]   .collection-content-home[_ngcontent-%COMP%]   .btn-collection-home[_ngcontent-%COMP%]:hover{background:rgba(57,255,20,.4);transform:translate(5px)}.collections-home[_ngcontent-%COMP%]   .collections-grid-home[_ngcontent-%COMP%]   .collection-card-home[_ngcontent-%COMP%]   .collection-image-home[_ngcontent-%COMP%]   .collection-gradient[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;height:50%;background:linear-gradient(transparent,rgba(0,0,0,.8));opacity:0;transition:opacity .3s ease}.testimonials[_ngcontent-%COMP%]{padding:80px 20px;background:#111}.testimonials[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:60px}.testimonials[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:36px;display:flex;align-items:center;justify-content:center;gap:20px;margin-bottom:15px;font-family:Oswald,sans-serif;letter-spacing:3px}.testimonials[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]   .title-accent[_ngcontent-%COMP%]{width:60px;height:2px;background:#39ff14}.testimonials[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .section-subtitle[_ngcontent-%COMP%]{color:#888;font-size:16px;max-width:600px;margin:0 auto}.testimonials[_ngcontent-%COMP%]   .testimonials-grid[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:30px}.testimonials[_ngcontent-%COMP%]   .testimonials-grid[_ngcontent-%COMP%]   .testimonial-card[_ngcontent-%COMP%]{background:#1a1a1a;border-radius:20px;padding:30px;border:1px solid rgba(255,255,255,.1);transition:all .3s ease}.testimonials[_ngcontent-%COMP%]   .testimonials-grid[_ngcontent-%COMP%]   .testimonial-card[_ngcontent-%COMP%]:hover{border-color:#39ff14;transform:translateY(-5px);box-shadow:0 10px 30px #39ff141a}.testimonials[_ngcontent-%COMP%]   .testimonials-grid[_ngcontent-%COMP%]   .testimonial-card[_ngcontent-%COMP%]   .testimonial-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px;margin-bottom:20px}.testimonials[_ngcontent-%COMP%]   .testimonials-grid[_ngcontent-%COMP%]   .testimonial-card[_ngcontent-%COMP%]   .testimonial-header[_ngcontent-%COMP%]   .testimonial-avatar[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;overflow:hidden;border:2px solid #39ff14}.testimonials[_ngcontent-%COMP%]   .testimonials-grid[_ngcontent-%COMP%]   .testimonial-card[_ngcontent-%COMP%]   .testimonial-header[_ngcontent-%COMP%]   .testimonial-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.testimonials[_ngcontent-%COMP%]   .testimonials-grid[_ngcontent-%COMP%]   .testimonial-card[_ngcontent-%COMP%]   .testimonial-header[_ngcontent-%COMP%]   .testimonial-info[_ngcontent-%COMP%]{flex:1}.testimonials[_ngcontent-%COMP%]   .testimonials-grid[_ngcontent-%COMP%]   .testimonial-card[_ngcontent-%COMP%]   .testimonial-header[_ngcontent-%COMP%]   .testimonial-info[_ngcontent-%COMP%]   .testimonial-name[_ngcontent-%COMP%]{font-size:18px;font-weight:600;margin-bottom:5px;color:#fff}.testimonials[_ngcontent-%COMP%]   .testimonials-grid[_ngcontent-%COMP%]   .testimonial-card[_ngcontent-%COMP%]   .testimonial-header[_ngcontent-%COMP%]   .testimonial-info[_ngcontent-%COMP%]   .testimonial-location[_ngcontent-%COMP%]{color:#39ff14;font-size:12px;letter-spacing:1px}.testimonials[_ngcontent-%COMP%]   .testimonials-grid[_ngcontent-%COMP%]   .testimonial-card[_ngcontent-%COMP%]   .testimonial-header[_ngcontent-%COMP%]   .testimonial-rating[_ngcontent-%COMP%]{display:flex;gap:2px}.testimonials[_ngcontent-%COMP%]   .testimonials-grid[_ngcontent-%COMP%]   .testimonial-card[_ngcontent-%COMP%]   .testimonial-header[_ngcontent-%COMP%]   .testimonial-rating[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#f90;font-size:14px}.testimonials[_ngcontent-%COMP%]   .testimonials-grid[_ngcontent-%COMP%]   .testimonial-card[_ngcontent-%COMP%]   .testimonial-header[_ngcontent-%COMP%]   .testimonial-rating[_ngcontent-%COMP%]   i.active[_ngcontent-%COMP%]{color:#f90}.testimonials[_ngcontent-%COMP%]   .testimonials-grid[_ngcontent-%COMP%]   .testimonial-card[_ngcontent-%COMP%]   .testimonial-header[_ngcontent-%COMP%]   .testimonial-rating[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:not(.active){color:#666}.testimonials[_ngcontent-%COMP%]   .testimonials-grid[_ngcontent-%COMP%]   .testimonial-card[_ngcontent-%COMP%]   .testimonial-text[_ngcontent-%COMP%]{color:#b0b0b0;font-size:16px;line-height:1.6;margin-bottom:20px;font-style:italic}.testimonials[_ngcontent-%COMP%]   .testimonials-grid[_ngcontent-%COMP%]   .testimonial-card[_ngcontent-%COMP%]   .testimonial-product[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding-top:20px;border-top:1px solid rgba(255,255,255,.1)}.testimonials[_ngcontent-%COMP%]   .testimonials-grid[_ngcontent-%COMP%]   .testimonial-card[_ngcontent-%COMP%]   .testimonial-product[_ngcontent-%COMP%]   .product-bought[_ngcontent-%COMP%]{color:#888;font-size:12px}.testimonials[_ngcontent-%COMP%]   .testimonials-grid[_ngcontent-%COMP%]   .testimonial-card[_ngcontent-%COMP%]   .testimonial-product[_ngcontent-%COMP%]   .product-name[_ngcontent-%COMP%]{color:#39ff14;font-size:14px;font-weight:600}.cta-home[_ngcontent-%COMP%]{padding:100px 20px;position:relative;overflow:hidden}.cta-home[_ngcontent-%COMP%]   .cta-background[_ngcontent-%COMP%]{position:absolute;inset:0}.cta-home[_ngcontent-%COMP%]   .cta-background[_ngcontent-%COMP%]   .cta-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:linear-gradient(135deg,#0a0a0a 0%,#1a1f1b 100%)}.cta-home[_ngcontent-%COMP%]   .cta-content-home[_ngcontent-%COMP%]{position:relative;z-index:1;max-width:800px;margin:0 auto;text-align:center}.cta-home[_ngcontent-%COMP%]   .cta-content-home[_ngcontent-%COMP%]   .cta-title-home[_ngcontent-%COMP%]{font-size:48px;font-weight:700;margin-bottom:20px;font-family:Oswald,sans-serif;letter-spacing:3px;color:#fff}.cta-home[_ngcontent-%COMP%]   .cta-content-home[_ngcontent-%COMP%]   .cta-description-home[_ngcontent-%COMP%]{color:#b0b0b0;font-size:18px;line-height:1.6;margin-bottom:40px;max-width:600px;margin-left:auto;margin-right:auto}.cta-home[_ngcontent-%COMP%]   .cta-content-home[_ngcontent-%COMP%]   .cta-stats-home[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:40px;margin-bottom:50px;flex-wrap:wrap}.cta-home[_ngcontent-%COMP%]   .cta-content-home[_ngcontent-%COMP%]   .cta-stats-home[_ngcontent-%COMP%]   .cta-stat[_ngcontent-%COMP%]{text-align:center}.cta-home[_ngcontent-%COMP%]   .cta-content-home[_ngcontent-%COMP%]   .cta-stats-home[_ngcontent-%COMP%]   .cta-stat[_ngcontent-%COMP%]   .stat-number[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#39ff14;margin-bottom:5px}.cta-home[_ngcontent-%COMP%]   .cta-content-home[_ngcontent-%COMP%]   .cta-stats-home[_ngcontent-%COMP%]   .cta-stat[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{color:#888;font-size:12px;letter-spacing:2px;text-transform:uppercase}.cta-home[_ngcontent-%COMP%]   .cta-content-home[_ngcontent-%COMP%]   .cta-actions-home[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:20px;margin-bottom:50px;flex-wrap:wrap}.cta-home[_ngcontent-%COMP%]   .cta-content-home[_ngcontent-%COMP%]   .cta-actions-home[_ngcontent-%COMP%]   .btn-cta-primary-home[_ngcontent-%COMP%]{background:linear-gradient(45deg,#39ff14,#00ffaa);color:#000;border:none;padding:20px 40px;border-radius:10px;font-size:16px;font-weight:600;display:flex;align-items:center;justify-content:center;gap:15px;cursor:pointer;transition:all .3s ease}.cta-home[_ngcontent-%COMP%]   .cta-content-home[_ngcontent-%COMP%]   .cta-actions-home[_ngcontent-%COMP%]   .btn-cta-primary-home[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 10px 30px #39ff1466}.cta-home[_ngcontent-%COMP%]   .cta-content-home[_ngcontent-%COMP%]   .cta-actions-home[_ngcontent-%COMP%]   .btn-cta-secondary-home[_ngcontent-%COMP%]{background:transparent;color:#fff;border:2px solid #39ff14;padding:20px 40px;border-radius:10px;font-size:16px;font-weight:600;display:flex;align-items:center;justify-content:center;gap:15px;cursor:pointer;transition:all .3s ease}.cta-home[_ngcontent-%COMP%]   .cta-content-home[_ngcontent-%COMP%]   .cta-actions-home[_ngcontent-%COMP%]   .btn-cta-secondary-home[_ngcontent-%COMP%]:hover{background:rgba(57,255,20,.1);transform:translateY(-5px)}.cta-home[_ngcontent-%COMP%]   .cta-content-home[_ngcontent-%COMP%]   .trust-badges-home[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:40px;flex-wrap:wrap}.cta-home[_ngcontent-%COMP%]   .cta-content-home[_ngcontent-%COMP%]   .trust-badges-home[_ngcontent-%COMP%]   .trust-badge[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;color:#888;font-size:14px}.cta-home[_ngcontent-%COMP%]   .cta-content-home[_ngcontent-%COMP%]   .trust-badges-home[_ngcontent-%COMP%]   .trust-badge[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#39ff14;font-size:20px}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}@keyframes _ngcontent-%COMP%_bounce{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-10px)}60%{transform:translateY(-5px)}}@keyframes _ngcontent-%COMP%_rotate{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 1200px){.home-hero[_ngcontent-%COMP%]   .hero-content[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:40px}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]{text-align:center}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-stats[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-actions[_ngcontent-%COMP%]{flex-direction:column}.try-on-banner[_ngcontent-%COMP%]   .banner-content[_ngcontent-%COMP%]{grid-template-columns:1fr;text-align:center}.try-on-banner[_ngcontent-%COMP%]   .banner-content[_ngcontent-%COMP%]   .banner-left[_ngcontent-%COMP%]   .banner-features[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);max-width:500px;margin:0 auto 40px}.try-on-banner[_ngcontent-%COMP%]   .banner-content[_ngcontent-%COMP%]   .banner-left[_ngcontent-%COMP%]   .banner-actions[_ngcontent-%COMP%]{justify-content:center}}@media (max-width: 768px){.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-title[_ngcontent-%COMP%]{font-size:60px}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-title[_ngcontent-%COMP%]   .title-line-2[_ngcontent-%COMP%]{font-size:45px}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-title[_ngcontent-%COMP%]   .title-line-3[_ngcontent-%COMP%]{font-size:30px}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-stats[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-image[_ngcontent-%COMP%]{height:300px}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-info[_ngcontent-%COMP%]{padding:20px}.home-hero[_ngcontent-%COMP%]   .hero-right[_ngcontent-%COMP%]   .hero-featured-product[_ngcontent-%COMP%]   .featured-product-card[_ngcontent-%COMP%]   .featured-product-info[_ngcontent-%COMP%]   .featured-price-section[_ngcontent-%COMP%]{flex-direction:column;gap:20px;align-items:flex-start}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]{grid-template-columns:1fr}.featured-products[_ngcontent-%COMP%]   .products-grid-home[_ngcontent-%COMP%]   .product-card-home.featured[_ngcontent-%COMP%]{grid-column:span 1}.new-arrivals[_ngcontent-%COMP%]   .arrivals-slider[_ngcontent-%COMP%]   .slider-nav[_ngcontent-%COMP%]{display:none}.cta-home[_ngcontent-%COMP%]   .cta-content-home[_ngcontent-%COMP%]   .cta-actions-home[_ngcontent-%COMP%]{flex-direction:column;align-items:center}.cta-home[_ngcontent-%COMP%]   .cta-content-home[_ngcontent-%COMP%]   .cta-actions-home[_ngcontent-%COMP%]   .btn-cta-primary-home[_ngcontent-%COMP%], .cta-home[_ngcontent-%COMP%]   .cta-content-home[_ngcontent-%COMP%]   .cta-actions-home[_ngcontent-%COMP%]   .btn-cta-secondary-home[_ngcontent-%COMP%]{width:100%;max-width:300px}.cta-home[_ngcontent-%COMP%]   .cta-content-home[_ngcontent-%COMP%]   .trust-badges-home[_ngcontent-%COMP%]{flex-direction:column;align-items:center;gap:20px}}@media (max-width: 480px){.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-title[_ngcontent-%COMP%]{font-size:48px}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-title[_ngcontent-%COMP%]   .title-line-2[_ngcontent-%COMP%]{font-size:36px}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-title[_ngcontent-%COMP%]   .title-line-3[_ngcontent-%COMP%]{font-size:24px}.home-hero[_ngcontent-%COMP%]   .hero-left[_ngcontent-%COMP%]   .hero-stats[_ngcontent-%COMP%]{grid-template-columns:1fr}.quick-categories[_ngcontent-%COMP%]   .categories-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.collections-home[_ngcontent-%COMP%]   .collections-grid-home[_ngcontent-%COMP%], .testimonials[_ngcontent-%COMP%]   .testimonials-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}']})}}return n})(),tR=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static{this.\u0275fac=function(i){return new(i||n)(te(oo),te(er))}}static{this.\u0275dir=ft({type:n})}}return n})(),$a=(()=>{class n extends tR{static{this.\u0275fac=function(){let t;return function(r){return(t||(t=ii(n)))(r||n)}}()}static{this.\u0275dir=ft({type:n,features:[Yt]})}}return n})();const Eo=new Ve("NgValueAccessor"),pJ={provide:Eo,useExisting:cn(()=>ub),multi:!0};let ub=(()=>{class n extends $a{writeValue(t){this.setProperty("checked",t)}static{this.\u0275fac=function(){let t;return function(r){return(t||(t=ii(n)))(r||n)}}()}static{this.\u0275dir=ft({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(i,r){1&i&&ge("change",function(s){return r.onChange(s.target.checked)})("blur",function(){return r.onTouched()})},features:[Mn([pJ]),Yt]})}}return n})();const gJ={provide:Eo,useExisting:cn(()=>Zl),multi:!0},_J=new Ve("CompositionEventMode");let Zl=(()=>{class n extends tR{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function mJ(){const n=Ss()?Ss().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static{this.\u0275fac=function(i){return new(i||n)(te(oo),te(er),te(_J,8))}}static{this.\u0275dir=ft({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){1&i&&ge("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},features:[Mn([gJ]),Yt]})}}return n})();function qs(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}function nR(n){return null!=n&&"number"==typeof n.length}const hi=new Ve("NgValidators"),Xs=new Ve("NgAsyncValidators"),vJ=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Rn{static min(e){return function iR(n){return e=>{if(qs(e.value)||qs(n))return null;const t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}(e)}static max(e){return function rR(n){return e=>{if(qs(e.value)||qs(n))return null;const t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}(e)}static required(e){return function oR(n){return qs(n.value)?{required:!0}:null}(e)}static requiredTrue(e){return function sR(n){return!0===n.value?null:{required:!0}}(e)}static email(e){return function aR(n){return qs(n.value)||vJ.test(n.value)?null:{email:!0}}(e)}static minLength(e){return function cR(n){return e=>qs(e.value)||!nR(e.value)?null:e.value.length<n?{minlength:{requiredLength:n,actualLength:e.value.length}}:null}(e)}static maxLength(e){return lR(e)}static pattern(e){return function uR(n){if(!n)return om;let e,t;return"string"==typeof n?(t="","^"!==n.charAt(0)&&(t+="^"),t+=n,"$"!==n.charAt(n.length-1)&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),i=>{if(qs(i.value))return null;const r=i.value;return e.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}(e)}static nullValidator(e){return null}static compose(e){return mR(e)}static composeAsync(e){return _R(e)}}function lR(n){return e=>nR(e.value)&&e.value.length>n?{maxlength:{requiredLength:n,actualLength:e.value.length}}:null}function om(n){return null}function dR(n){return null!=n}function fR(n){return ju(n)?qn(n):n}function hR(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function pR(n,e){return e.map(t=>t(n))}function gR(n){return n.map(e=>function xJ(n){return!n.validate}(e)?e:t=>e.validate(t))}function mR(n){if(!n)return null;const e=n.filter(dR);return 0==e.length?null:function(t){return hR(pR(t,e))}}function db(n){return null!=n?mR(gR(n)):null}function _R(n){if(!n)return null;const e=n.filter(dR);return 0==e.length?null:function(t){return function hJ(...n){const e=rC(n),{args:t,keys:i}=jA(n),r=new Ln(o=>{const{length:s}=t;if(!s)return void o.complete();const a=new Array(s);let c=s,l=s;for(let u=0;u<s;u++){let d=!1;qi(t[u]).subscribe(Fn(o,f=>{d||(d=!0,l--),a[u]=f},()=>c--,void 0,()=>{(!c||!d)&&(l||o.next(i?$A(i,a):a),o.complete())}))}});return e?r.pipe(WA(e)):r}(pR(t,e).map(fR)).pipe(nn(hR))}}function fb(n){return null!=n?_R(gR(n)):null}function vR(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function xR(n){return n._rawValidators}function yR(n){return n._rawAsyncValidators}function hb(n){return n?Array.isArray(n)?n:[n]:[]}function sm(n,e){return Array.isArray(n)?n.includes(e):n===e}function MR(n,e){const t=hb(e);return hb(n).forEach(r=>{sm(t,r)||t.push(r)}),t}function bR(n,e){return hb(e).filter(t=>!sm(n,t))}class CR{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=db(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=fb(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class Ti extends CR{get formDirective(){return null}get path(){return null}}class Ys extends CR{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class wR{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let am=(()=>{class n extends wR{constructor(t){super(t)}static{this.\u0275fac=function(i){return new(i||n)(te(Ys,2))}}static{this.\u0275dir=ft({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){2&i&&bt("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[Yt]})}}return n})(),SR=(()=>{class n extends wR{constructor(t){super(t)}static{this.\u0275fac=function(i){return new(i||n)(te(Ti,10))}}static{this.\u0275dir=ft({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){2&i&&bt("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[Yt]})}}return n})();const vf="VALID",lm="INVALID",Kl="PENDING",xf="DISABLED";function mb(n){return(um(n)?n.validators:n)||null}function _b(n,e){return(um(e)?e.asyncValidators:n)||null}function um(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}function ER(n,e,t){const i=n.controls;if(!(e?Object.keys(i):i).length)throw new de(1e3,"");if(!i[t])throw new de(1001,"")}function TR(n,e,t){n._forEachChild((i,r)=>{if(void 0===t[r])throw new de(1002,"")})}class dm{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===vf}get invalid(){return this.status===lm}get pending(){return this.status==Kl}get disabled(){return this.status===xf}get enabled(){return this.status!==xf}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(MR(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(MR(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(bR(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(bR(e,this._rawAsyncValidators))}hasValidator(e){return sm(this._rawValidators,e)}hasAsyncValidator(e){return sm(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Kl,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=xf,this.errors=null,this._forEachChild(i=>{i.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=vf,this._forEachChild(i=>{i.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===vf||this.status===Kl)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?xf:vf}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Kl,this._hasOwnPendingAsyncValidator=!0;const t=fR(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Cn,this.statusChanges=new Cn}_calculateStatus(){return this._allControlsDisabled()?xf:this.errors?lm:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Kl)?Kl:this._anyControlsHaveStatus(lm)?lm:vf}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){um(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function CJ(n){return Array.isArray(n)?db(n):n||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function wJ(n){return Array.isArray(n)?fb(n):n||null}(this._rawAsyncValidators)}}class yf extends dm{constructor(e,t,i){super(mb(t),_b(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){TR(this,0,e),Object.keys(e).forEach(i=>{ER(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(i=>{const r=this.controls[i];r&&r.patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e?e[r]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>!!i._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const[t,i]of Object.entries(this.controls))if(this.contains(t)&&e(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,o)=>{i=t(i,r,o)}),i}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}}class AR extends yf{}const qa=new Ve("CallSetDisabledState",{providedIn:"root",factory:()=>Mf}),Mf="always";function fm(n,e){return[...e.path,n]}function bf(n,e,t=Mf){vb(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(n.disabled),function PJ(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&OR(n,e)})}(n,e),function TJ(n,e){const t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function EJ(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&OR(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function SJ(n,e){if(e.valueAccessor.setDisabledState){const t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function hm(n,e,t=!0){const i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),gm(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function pm(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function vb(n,e){const t=xR(n);null!==e.validator?n.setValidators(vR(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const i=yR(n);null!==e.asyncValidator?n.setAsyncValidators(vR(i,e.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();pm(e._rawValidators,r),pm(e._rawAsyncValidators,r)}function gm(n,e){let t=!1;if(null!==n){if(null!==e.validator){const r=xR(n);if(Array.isArray(r)&&r.length>0){const o=r.filter(s=>s!==e.validator);o.length!==r.length&&(t=!0,n.setValidators(o))}}if(null!==e.asyncValidator){const r=yR(n);if(Array.isArray(r)&&r.length>0){const o=r.filter(s=>s!==e.asyncValidator);o.length!==r.length&&(t=!0,n.setAsyncValidators(o))}}}const i=()=>{};return pm(e._rawValidators,i),pm(e._rawAsyncValidators,i),t}function OR(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function yb(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}function Mb(n,e){if(!e)return null;let t,i,r;return Array.isArray(e),e.forEach(o=>{o.constructor===Zl?t=o:function DJ(n){return Object.getPrototypeOf(n.constructor)===$a}(o)?i=o:r=o}),r||i||t||null}function RR(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function NR(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const wf=class extends dm{constructor(e=null,t,i){super(mb(t),_b(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),um(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=NR(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){RR(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){RR(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){NR(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},FJ={provide:Ys,useExisting:cn(()=>mm)},kR=(()=>Promise.resolve())();let mm=(()=>{class n extends Ys{constructor(t,i,r,o,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this.control=new wf,this._registered=!1,this.name="",this.update=new Cn,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=Mb(0,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),yb(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){bf(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){kR.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const i=t.isDisabled.currentValue,r=0!==i&&function Yc(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}(i);kR.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?fm(t,this._parent):[t]}static{this.\u0275fac=function(i){return new(i||n)(te(Ti,9),te(hi,10),te(Xs,10),te(Eo,10),te(Xc,8),te(qa,8))}}static{this.\u0275dir=ft({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Mn([FJ]),Yt,pr]})}}return n})(),UR=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=ft({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return n})();const UJ={provide:Eo,useExisting:cn(()=>Cb),multi:!0};let VR=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Rr({type:n})}static{this.\u0275inj=fr({})}}return n})(),BJ=(()=>{class n{constructor(){this._accessors=[]}add(t,i){this._accessors.push([t,i])}remove(t){for(let i=this._accessors.length-1;i>=0;--i)if(this._accessors[i][1]===t)return void this._accessors.splice(i,1)}select(t){this._accessors.forEach(i=>{this._isSameGroup(i,t)&&i[1]!==t&&i[1].fireUncheck(t.value)})}_isSameGroup(t,i){return!!t[0].control&&t[0]._parent===i._control._parent&&t[1].name===i.name}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:VR})}}return n})(),Cb=(()=>{class n extends $a{constructor(t,i,r,o){super(t,i),this._registry=r,this._injector=o,this.setDisabledStateFired=!1,this.onChange=()=>{},this.callSetDisabledState=Be(qa,{optional:!0})??Mf}ngOnInit(){this._control=this._injector.get(Ys),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(t){this._state=t===this.value,this.setProperty("checked",this._state)}registerOnChange(t){this._fn=t,this.onChange=()=>{t(this.value),this._registry.select(this)}}setDisabledState(t){(this.setDisabledStateFired||t||"whenDisabledForLegacyCode"===this.callSetDisabledState)&&this.setProperty("disabled",t),this.setDisabledStateFired=!0}fireUncheck(t){this.writeValue(t)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}static{this.\u0275fac=function(i){return new(i||n)(te(oo),te(er),te(BJ),te(tr))}}static{this.\u0275dir=ft({type:n,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(i,r){1&i&&ge("change",function(){return r.onChange()})("blur",function(){return r.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[Mn([UJ]),Yt]})}}return n})();const wb=new Ve("NgModelWithFormControlWarning"),HJ={provide:Ti,useExisting:cn(()=>_m)};let _m=(()=>{class n extends Ti{constructor(t,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Cn,this._setValidators(t),this._setAsyncValidators(i)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(gm(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const i=this.form.get(t.path);return bf(i,t,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),i}getControl(t){return this.form.get(t.path)}removeControl(t){hm(t.control||null,t,!1),function IJ(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,i){this.form.get(t.path).setValue(i)}onSubmit(t){return this.submitted=!0,function IR(n,e){n._syncPendingControls(),e.forEach(t=>{const i=t.control;"submit"===i.updateOn&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}(this.form,this.directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const i=t.control,r=this.form.get(t.path);i!==r&&(hm(i||null,t),(n=>n instanceof wf)(r)&&(bf(r,t,this.callSetDisabledState),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){const i=this.form.get(t.path);(function DR(n,e){vb(n,e)})(i,t),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){const i=this.form.get(t.path);i&&function AJ(n,e){return gm(n,e)}(i,t)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){vb(this.form,this),this._oldForm&&gm(this._oldForm,this)}_checkFormPresent(){}static{this.\u0275fac=function(i){return new(i||n)(te(hi,10),te(Xs,10),te(qa,8))}}static{this.\u0275dir=ft({type:n,selectors:[["","formGroup",""]],hostBindings:function(i,r){1&i&&ge("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Mn([HJ]),Yt,pr]})}}return n})();const WJ={provide:Ys,useExisting:cn(()=>Eb)};let Eb=(()=>{class n extends Ys{set isDisabled(t){}static{this._ngModelWarningSentOnce=!1}constructor(t,i,r,o,s){super(),this._ngModelWarningConfig=s,this._added=!1,this.name=null,this.update=new Cn,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=Mb(0,o)}ngOnChanges(t){this._added||this._setUpControl(),yb(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return fm(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static{this.\u0275fac=function(i){return new(i||n)(te(Ti,13),te(hi,10),te(Xs,10),te(Eo,10),te(wb,8))}}static{this.\u0275dir=ft({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[Mn([WJ]),Yt,pr]})}}return n})();const $J={provide:Eo,useExisting:cn(()=>Sf),multi:!0};function jR(n,e){return null==n?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${n}: ${e}`.slice(0,50))}let Sf=(()=>{class n extends $a{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;const r=jR(this._getOptionId(t),t);this.setProperty("value",r)}registerOnChange(t){this.onChange=i=>{this.value=this._getOptionValue(i),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),t))return i;return null}_getOptionValue(t){const i=function qJ(n){return n.split(":")[0]}(t);return this._optionMap.has(i)?this._optionMap.get(i):t}static{this.\u0275fac=function(){let t;return function(r){return(t||(t=ii(n)))(r||n)}}()}static{this.\u0275dir=ft({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,r){1&i&&ge("change",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[Mn([$J]),Yt]})}}return n})(),Tb=(()=>{class n{constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue(jR(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static{this.\u0275fac=function(i){return new(i||n)(te(er),te(oo),te(Sf,9))}}static{this.\u0275dir=ft({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}}return n})();const XJ={provide:Eo,useExisting:cn(()=>Ab),multi:!0};function WR(n,e){return null==n?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${n}: ${e}`.slice(0,50))}let Ab=(()=>{class n extends $a{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){let i;if(this.value=t,Array.isArray(t)){const r=t.map(o=>this._getOptionId(o));i=(o,s)=>{o._setSelected(r.indexOf(s.toString())>-1)}}else i=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(t){this.onChange=i=>{const r=[],o=i.selectedOptions;if(void 0!==o){const s=o;for(let a=0;a<s.length;a++){const l=this._getOptionValue(s[a].value);r.push(l)}}else{const s=i.options;for(let a=0;a<s.length;a++){const c=s[a];if(c.selected){const l=this._getOptionValue(c.value);r.push(l)}}}this.value=r,t(r)}}_registerOption(t){const i=(this._idCounter++).toString();return this._optionMap.set(i,t),i}_getOptionId(t){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,t))return i;return null}_getOptionValue(t){const i=function YJ(n){return n.split(":")[0]}(t);return this._optionMap.has(i)?this._optionMap.get(i)._value:t}static{this.\u0275fac=function(){let t;return function(r){return(t||(t=ii(n)))(r||n)}}()}static{this.\u0275dir=ft({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,r){1&i&&ge("change",function(s){return r.onChange(s.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[Mn([XJ]),Yt]})}}return n})(),Ob=(()=>{class n{constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(WR(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(WR(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static{this.\u0275fac=function(i){return new(i||n)(te(er),te(oo),te(Ab,9))}}static{this.\u0275dir=ft({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}}return n})();let Xa=(()=>{class n{constructor(){this._validator=om}ngOnChanges(t){if(this.inputName in t){const i=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):om,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return null!=t}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=ft({type:n,features:[pr]})}}return n})();const nQ={provide:hi,useExisting:cn(()=>Ib),multi:!0};let Ib=(()=>{class n extends Xa{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=t=>function $R(n){return"number"==typeof n?n:parseInt(n,10)}(t),this.createValidator=t=>lR(t)}static{this.\u0275fac=function(){let t;return function(r){return(t||(t=ii(n)))(r||n)}}()}static{this.\u0275dir=ft({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(i,r){2&i&&co("maxlength",r._enabled?r.maxlength:null)},inputs:{maxlength:"maxlength"},features:[Mn([nQ]),Yt]})}}return n})(),e3=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Rr({type:n})}static{this.\u0275inj=fr({imports:[VR]})}}return n})();class t3 extends dm{constructor(e,t,i){super(mb(t),_b(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,i={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(e,t={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,i={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),t&&(this.controls.splice(r,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){TR(this,0,e),e.forEach((i,r)=>{ER(this,!1,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((i,r)=>{i.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,i)=>!!i._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,i)=>{e(t,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}}function n3(n){return!!n&&(void 0!==n.asyncValidators||void 0!==n.validators||void 0!==n.updateOn)}let rQ=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){const t=new n;return t.useNonNullable=!0,t}group(t,i=null){const r=this._reduceControls(t);let o={};return n3(i)?o=i:null!==i&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new yf(r,o)}record(t,i=null){const r=this._reduceControls(t);return new AR(r,i)}control(t,i,r){let o={};return this.useNonNullable?(n3(i)?o=i:(o.validators=i,o.asyncValidators=r),new wf(t,{...o,nonNullable:!0})):new wf(t,i,r)}array(t,i,r){const o=t.map(s=>this._createControl(s));return new t3(o,i,r)}_reduceControls(t){const i={};return Object.keys(t).forEach(r=>{i[r]=this._createControl(t[r])}),i}_createControl(t){return t instanceof wf||t instanceof dm?t:Array.isArray(t)?this.control(t[0],t.length>1?t[1]:null,t.length>2?t[2]:null):this.control(t)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),i3=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:qa,useValue:t.callSetDisabledState??Mf}]}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Rr({type:n})}static{this.\u0275inj=fr({imports:[e3]})}}return n})(),oQ=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:wb,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:qa,useValue:t.callSetDisabledState??Mf}]}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Rr({type:n})}static{this.\u0275inj=fr({imports:[e3]})}}return n})();function sQ(n,e){if(1&n){const t=tn();M(0,"button",34),ge("click",function(){const o=qe(t).$implicit;return Xe(Q().onCategorySelect(o.name))}),U(1,"i"),O(2),b()}if(2&n){const t=e.$implicit;bt("active",Q().selectedCategory===t.name),L(1),Hc(t.icon),L(1),Ye(" ",t.name," ")}}function aQ(n,e){if(1&n&&(M(0,"option",35),O(1),b()),2&n){const t=e.$implicit;J("value",t),L(1),xt(t)}}function cQ(n,e){1&n&&(M(0,"div",36),U(1,"div",37),M(2,"span",38),O(3,"LOADING DROPS..."),b()())}function lQ(n,e){if(1&n){const t=tn();M(0,"div",39)(1,"div",40),U(2,"i",5),M(3,"h3"),O(4,"NO MATCHES FOUND"),b(),M(5,"p"),O(6,"Your search didn't return any results"),b(),M(7,"button",41),ge("click",function(){return qe(t),Xe(Q().clearFilters())}),O(8," RESET FILTERS "),b()()()}}function uQ(n,e){if(1&n){const t=tn();sa(0),M(1,"div",81)(2,"div",82),U(3,"app-model-viewer",83),b(),M(4,"div",84)(5,"button",85),ge("click",function(r){qe(t);const o=Q().$implicit,s=Q(2);return r.stopPropagation(),Xe(s.toggleProductRotation(o.id))}),U(6,"i",86),O(7),b(),M(8,"button",85),ge("click",function(r){qe(t);const o=Q().$implicit,s=Q(2);return r.stopPropagation(),Xe(s.changeProductColor(o.id))}),U(9,"i",87),O(10," COLOR "),b(),M(11,"button",85),ge("click",function(r){qe(t);const o=Q().$implicit,s=Q(2);return r.stopPropagation(),Xe(s.resetProductView(o.id))}),U(12,"i",88),O(13," RESET "),b()()(),aa()}if(2&n){const t=Q().$implicit,i=Q(2);L(3),J("modelPath",t.images[0])("autoRotate",!0)("autoScale",!0)("targetSize",16),L(3),bt("fa-pause",!i.productIsRotating[t.id])("fa-sync-alt",i.productIsRotating[t.id]),L(1),Ye(" ",i.productIsRotating[t.id]?"PAUSE":"ROTATE"," ")}}function dQ(n,e){if(1&n&&U(0,"img",91),2&n){const t=Q(2).$implicit;J("src",t.images[0],ro)("alt",t.name)}}function fQ(n,e){1&n&&(M(0,"div",92),U(1,"i",93),M(2,"span"),O(3,"NO IMAGE"),b()())}function hQ(n,e){if(1&n&&(ie(0,dQ,1,2,"img",89),ie(1,fQ,4,0,"ng-template",null,90,Cs)),2&n){const t=Ms(2),i=Q().$implicit;J("ngIf",i.images&&i.images.length>0)("ngIfElse",t)}}function pQ(n,e){1&n&&(M(0,"span",94),O(1," SALE "),b())}function gQ(n,e){1&n&&(M(0,"span",95),O(1," FEATURED "),b())}function mQ(n,e){1&n&&(M(0,"span",96),O(1," OUT "),b())}function _Q(n,e){1&n&&(M(0,"span",97),O(1," 3D "),b())}function vQ(n,e){1&n&&U(0,"i"),2&n&&Hc(e.$implicit<=Q().$implicit.rating?"fas fa-star":"far fa-star")}function xQ(n,e){if(1&n&&(M(0,"div",98)(1,"div",99)(2,"span",100),O(3,"MATERIAL:"),b(),M(4,"span",101),O(5),b()()()),2&n){const t=Q().$implicit;L(5),xt(t.material)}}function yQ(n,e){if(1&n&&(M(0,"span",102),O(1),b()),2&n){const t=Q().$implicit;L(1),Ye(" $",t.originalPrice," ")}}const MQ=function(){return[1,2,3,4,5]};function bQ(n,e){if(1&n){const t=tn();M(0,"div",44),ge("click",function(){const o=qe(t).$implicit;return Xe(Q(2).onProductClick(o))}),M(1,"div",45)(2,"div",46),U(3,"div",47)(4,"div",48)(5,"div",49),b(),M(6,"div",50),ge("click",function(){const o=qe(t).$implicit;return Xe(Q(2).goToProduct(o.id))}),ie(7,uQ,14,9,"ng-container",51),ie(8,hQ,3,2,"ng-template",null,52,Cs),b(),M(10,"div",53),ie(11,pQ,2,0,"span",54),ie(12,gQ,2,0,"span",55),ie(13,mQ,2,0,"span",56),ie(14,_Q,2,0,"span",57),b(),M(15,"div",58)(16,"button",59),ge("click",function(r){const s=qe(t).$implicit,a=Q(2);return r.stopPropagation(),Xe(a.tryOnProduct(s))}),U(17,"i",60),b(),M(18,"button",59),ge("click",function(r){const s=qe(t).$implicit,a=Q(2);return r.stopPropagation(),Xe(a.toggleFavorite(s.id))}),U(19,"i",61),b()()(),M(20,"div",62)(21,"div",63)(22,"div",64),O(23),b(),M(24,"h3",65),O(25),b(),M(26,"div",66),O(27),b(),M(28,"div",67)(29,"div",68),ie(30,vQ,1,2,"i",69),b(),M(31,"span",70),O(32),b()(),M(33,"p",71),O(34),Qu(35,"slice"),b(),ie(36,xQ,6,1,"div",72),b(),M(37,"div",73)(38,"div",74)(39,"div",75)(40,"span",76),O(41),b(),ie(42,yQ,2,1,"span",77),b(),M(43,"div",78),O(44),b()(),M(45,"button",79),ge("click",function(r){const s=qe(t).$implicit,a=Q(2);return r.stopPropagation(),Xe(a.addToCart(s))}),U(46,"i",80),b()()()()}if(2&n){const t=e.$implicit,i=Ms(9),r=Q(2);bt("has-3d",r.has3DModel(t)),L(7),J("ngIf",r.has3DModel(t))("ngIfElse",i),L(4),J("ngIf",t.originalPrice),L(1),J("ngIf",t.isFeatured),L(1),J("ngIf",!t.inStock),L(1),J("ngIf",r.has3DModel(t)),L(9),xt(t.brand),L(2),xt(t.name),L(2),xt(t.category),L(3),J("ngForOf",Ku(23,MQ)),L(2),Ye("(",t.reviewCount,")"),L(2),Ye("",Kh(35,19,t.description,0,80),"..."),L(2),J("ngIf",t.material),L(5),Ye("$",t.price,""),L(1),J("ngIf",t.originalPrice),L(2),Ye(" ",t.material," "),L(1),J("disabled",!t.inStock)}}function CQ(n,e){if(1&n&&(M(0,"div",42),ie(1,bQ,47,24,"div",43),b()),2&n){const t=Q();J("ngClass","grid-"+t.gridSize),L(1),J("ngForOf",t.filteredProducts)}}let wQ=(()=>{class n{onProductClick(t){t&&this.goToProduct(t.id)}constructor(t,i,r){this.router=t,this.route=i,this.cartService=r,this.allProducts=Vp,this.filteredProducts=[],this.categories=h7,this.selectedCategory="ALL",this.sortOptions=["NEWEST","PRICE LOW-HIGH","PRICE HIGH-LOW","POPULAR"],this.selectedSort="NEWEST",this.searchQuery="",this.isLoading=!1,this.viewMode="grid",this.gridSize="medium",this.product3DView={},this.productIsRotating={},this.favorites={},this.selectedProduct=null,this.selectedSize="",this.selectedColor="",this.isRotating=!0,this.show3DView=!0,this.selectedImageIndex=0}ngOnInit(){this.route.queryParams.subscribe(t=>{if(t.category&&(this.selectedCategory=t.category),t.productId){const i=t.productId;this.selectedProduct=this.allProducts.find(r=>r.id===i)||null}this.filterProducts()})}selectProduct(t){this.selectedProduct=t,this.selectedSize="",this.selectedColor="",this.isRotating=!0,this.show3DView=this.has3DModel(t),this.selectedImageIndex=0,this.router.navigate([],{relativeTo:this.route,queryParams:{productId:t.id},queryParamsHandling:"merge"})}closeProductDetails(){this.selectedProduct=null,this.router.navigate([],{relativeTo:this.route,queryParams:{productId:null},queryParamsHandling:"merge"})}get selectedProductHas3DModel(){return!!this.selectedProduct&&this.has3DModel(this.selectedProduct)}getCurrentImage(){return this.selectedProduct&&this.selectedProduct.images?this.selectedProduct.images[this.selectedImageIndex]:""}selectImage(t){this.selectedImageIndex=t}toggleRotation(){this.isRotating=!this.isRotating}changeColor(){console.log("Change color for selected product")}resetView(){this.isRotating=!0,this.selectedImageIndex=0}onResize(){window.innerWidth<768&&this.selectedProduct&&this.closeProductDetails()}filterProducts(){this.isLoading=!0,setTimeout(()=>{let t=[...this.allProducts];if("ALL"!==this.selectedCategory&&(t=t.filter(i=>i.category===this.selectedCategory)),this.searchQuery.trim()){const i=this.searchQuery.toLowerCase();t=t.filter(r=>r.name.toLowerCase().includes(i)||r.description.toLowerCase().includes(i)||r.tags&&r.tags.some(o=>o.toLowerCase().includes(i)))}this.filteredProducts=this.sortProducts(t),this.isLoading=!1},300)}sortProducts(t){switch(this.selectedSort){case"PRICE LOW-HIGH":return[...t].sort((i,r)=>i.price-r.price);case"PRICE HIGH-LOW":return[...t].sort((i,r)=>r.price-i.price);case"POPULAR":return[...t].sort((i,r)=>r.rating-i.rating);default:return t}}onCategorySelect(t){this.selectedCategory=t,this.filterProducts()}onSortChange(){this.filterProducts()}onSearch(){this.filterProducts()}clearFilters(){this.selectedCategory="ALL",this.searchQuery="",this.selectedSort="NEWEST",this.filterProducts()}goToProduct(t){this.router.navigate(["/product",t])}getCategoryIcon(t){return{TOPS:"fas fa-tshirt",BOTTOMS:"fas fa-vest",SHOES:"fas fa-shoe-prints",ACCESSORIES:"fas fa-gem",OUTERWEAR:"fas fa-jacket"}[t]||"fas fa-store"}getDiscountPercent(t){return t.originalPrice?Math.round((t.originalPrice-t.price)/t.originalPrice*100):0}has3DModel(t){if(!t||!t.images||!t.images[0])return!1;const i=t.images[0].toLowerCase();return i.endsWith(".obj")||i.endsWith(".glb")||i.endsWith(".fbx")||!!t.has3DModel}toggleProduct3DView(t){this.product3DView[t]=!this.product3DView[t],this.product3DView[t]&&(this.productIsRotating[t]=!0)}toggleProductRotation(t){this.productIsRotating[t]=!this.productIsRotating[t]}changeProductColor(t){console.log("Change color for product:",t)}resetProductView(t){this.product3DView[t]=!1,this.productIsRotating[t]=!1}addToCart(t){this.cartService.addToCart(t),console.log("Added to cart:",t.name)}tryOnProduct(t){console.log("Try on:",t.name),this.router.navigate(["/try-on"],{queryParams:{productId:t.id}})}toggleFavorite(t){this.favorites[t]=!this.favorites[t],console.log("Toggled favorite for:",t,"Status:",this.favorites[t])}isFavorite(t){return!!this.favorites[t]}static{this.\u0275fac=function(i){return new(i||n)(te(Xn),te(Os),te(Ed))}}static{this.\u0275cmp=Zi({type:n,selectors:[["app-shop"]],hostBindings:function(i,r){1&i&&ge("resize",function(){return r.onResize()},0,Nu)},decls:49,vars:15,consts:[[1,"shop","page-container"],[1,"shop-header"],[1,"shop-title"],[1,"search-container"],[1,"search-bar"],[1,"fas","fa-search"],["type","text","placeholder","SEARCH STREETWEAR...",1,"search-input",3,"ngModel","ngModelChange","keyup.enter"],[1,"search-btn",3,"click"],[1,"filters"],[1,"filter-row"],[1,"filter-section"],[1,"filter-title"],[1,"category-filters"],["class","category-filter-btn",3,"active","click",4,"ngFor","ngForOf"],[1,"sort-options"],[1,"sort-select",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-dark",3,"click"],[1,"fas","fa-redo","mr-2"],[1,"products-section"],[1,"products-header-modern"],[1,"modern-header-left"],[1,"modern-title"],[1,"modern-subtitle"],[1,"modern-header-right"],[1,"modern-count"],[1,"modern-view-controls"],[1,"modern-view-btn",3,"click"],[1,"fas","fa-th"],[1,"fas","fa-th-large"],[1,"fas","fa-square"],["class","loading-modern",4,"ngIf"],["class","no-products-modern",4,"ngIf"],["class","products-modern-grid",3,"ngClass",4,"ngIf"],[1,"category-filter-btn",3,"click"],[3,"value"],[1,"loading-modern"],[1,"modern-spinner"],[1,"modern-loading-text"],[1,"no-products-modern"],[1,"modern-empty-state"],[1,"btn-modern",3,"click"],[1,"products-modern-grid",3,"ngClass"],["class","modern-product",3,"has-3d","click",4,"ngFor","ngForOf"],[1,"modern-product",3,"click"],[1,"modern-product-image"],[1,"gta-panels"],[1,"gta-panel","panel-1"],[1,"gta-panel","panel-2"],[1,"gta-panel","panel-3"],[1,"product-img-container",3,"click"],[4,"ngIf","ngIfElse"],["imageView",""],[1,"modern-indicators"],["class","modern-badge sale",4,"ngIf"],["class","modern-badge new",4,"ngIf"],["class","modern-badge out",4,"ngIf"],["class","modern-badge model-3d",4,"ngIf"],[1,"modern-quick-actions"],[1,"modern-quick-btn",3,"click"],[1,"fas","fa-user"],[1,"fas","fa-heart"],[1,"modern-product-content"],[1,"modern-product-info"],[1,"modern-brand"],[1,"modern-product-name"],[1,"modern-category"],[1,"modern-rating"],[1,"stars"],[3,"class",4,"ngFor","ngForOf"],[1,"rating-count"],[1,"product-description"],["class","product-specs",4,"ngIf"],[1,"modern-product-footer"],[1,"modern-price-section"],[1,"modern-price"],[1,"modern-current"],["class","modern-original",4,"ngIf"],[1,"modern-material"],[1,"modern-add-btn",3,"disabled","click"],[1,"fas","fa-plus"],[1,"model-container"],[1,"model-viewer-wrapper"],[3,"modelPath","autoRotate","autoScale","targetSize"],[1,"model-controls"],[1,"model-btn",3,"click"],[1,"fas"],[1,"fas","fa-palette"],[1,"fas","fa-undo"],["class","product-img",3,"src","alt",4,"ngIf","ngIfElse"],["placeholder",""],[1,"product-img",3,"src","alt"],[1,"product-img-placeholder"],[1,"fas","fa-tshirt"],[1,"modern-badge","sale"],[1,"modern-badge","new"],[1,"modern-badge","out"],[1,"modern-badge","model-3d"],[1,"product-specs"],[1,"spec-item"],[1,"spec-label"],[1,"spec-value"],[1,"modern-original"]],template:function(i,r){1&i&&(M(0,"div",0)(1,"header",1)(2,"h1",2),O(3,"SHOP"),b(),M(4,"div",3)(5,"div",4),U(6,"i",5),M(7,"input",6),ge("ngModelChange",function(s){return r.searchQuery=s})("keyup.enter",function(){return r.onSearch()}),b(),M(8,"button",7),ge("click",function(){return r.onSearch()}),O(9,"GO"),b()()()(),M(10,"section",8)(11,"div",9)(12,"div",10)(13,"h3",11),O(14,"CATEGORIES"),b(),M(15,"div",12),ie(16,sQ,3,5,"button",13),b()()(),M(17,"div",9)(18,"div",10)(19,"h3",11),O(20,"SORT BY"),b(),M(21,"div",14)(22,"select",15),ge("ngModelChange",function(s){return r.selectedSort=s})("change",function(){return r.onSortChange()}),ie(23,aQ,2,2,"option",16),b()()(),M(24,"div",10)(25,"button",17),ge("click",function(){return r.clearFilters()}),U(26,"i",18),O(27,"CLEAR FILTERS "),b()()()(),M(28,"section",19)(29,"div",20)(30,"div",21)(31,"h2",22),O(32),b(),M(33,"span",23),O(34,"LOS SANTOS STREETWEAR"),b()(),M(35,"div",24)(36,"span",25),O(37),b(),M(38,"div",26)(39,"button",27),ge("click",function(){return r.gridSize="small"}),U(40,"i",28),b(),M(41,"button",27),ge("click",function(){return r.gridSize="medium"}),U(42,"i",29),b(),M(43,"button",27),ge("click",function(){return r.gridSize="large"}),U(44,"i",30),b()()()(),ie(45,cQ,4,0,"div",31),ie(46,lQ,9,0,"div",32),ie(47,CQ,2,2,"div",33),b()(),U(48,"app-bottom-nav")),2&i&&(L(7),J("ngModel",r.searchQuery),L(9),J("ngForOf",r.categories),L(6),J("ngModel",r.selectedSort),L(1),J("ngForOf",r.sortOptions),L(9),xt(r.selectedCategory),L(5),Ye("",r.filteredProducts.length," ITEMS"),L(2),bt("active","small"===r.gridSize),L(2),bt("active","medium"===r.gridSize),L(2),bt("active","large"===r.gridSize),L(2),J("ngIf",r.isLoading),L(1),J("ngIf",!r.isLoading&&0===r.filteredProducts.length),L(1),J("ngIf",!r.isLoading&&r.filteredProducts.length>0))},dependencies:[hA,Ps,jo,Tb,Ob,Zl,Sf,am,mm,sl,_f,Vv],styles:['@charset "UTF-8";.product-details-style[_ngcontent-%COMP%]{background:#fff;border:4px solid #000;border-radius:0;box-shadow:8px 8px #000;padding:0;margin:0;display:flex;flex-direction:column;min-height:520px;max-width:100%;overflow:hidden;position:relative}.product-details-style[_ngcontent-%COMP%]   .product-content[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:0;padding:0;min-height:400px}.product-details-style[_ngcontent-%COMP%]   .product-gallery[_ngcontent-%COMP%]{flex:1 1 50%;background:#000;display:flex;align-items:center;justify-content:center;min-width:0;min-height:320px;padding:0;position:relative}.product-details-style[_ngcontent-%COMP%]   .model-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:transparent}.product-details-style[_ngcontent-%COMP%]   .model-viewer-wrapper[_ngcontent-%COMP%]{width:100%;height:320px;display:flex;align-items:center;justify-content:center;background:transparent}.product-details-style[_ngcontent-%COMP%]   app-model-viewer[_ngcontent-%COMP%]{width:100%!important;height:320px!important;display:block;background:transparent}.product-details-style[_ngcontent-%COMP%]   .model-controls[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:8px;position:absolute;bottom:10px;left:10px;z-index:2}.product-details-style[_ngcontent-%COMP%]{background:#fff;border:4px solid #000;border-radius:0;box-shadow:8px 8px #000;padding:0;margin:0;display:flex;flex-direction:column;min-height:520px;max-width:100%;overflow:hidden;position:relative;box-shadow:2px 2px #000}.product-details-style[_ngcontent-%COMP%]   .product-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:0;padding:0;min-height:400px;flex:1 1 50%}.product-details-style[_ngcontent-%COMP%]   .product-gallery[_ngcontent-%COMP%]{width:100%;background:#000;display:flex;align-items:center;justify-content:center;min-width:0;min-height:260px;padding:0;font-family:Oswald,sans-serif;position:relative}.product-details-style[_ngcontent-%COMP%]   .product-info-panel[_ngcontent-%COMP%]{width:100%;padding:18px;display:flex;flex-direction:column;justify-content:flex-start;background:#fff;min-width:0;min-height:180px;border-top:2px solid #eee;letter-spacing:1.5px}.product-details-style[_ngcontent-%COMP%]   .product-gallery[_ngcontent-%COMP%] + .product-info-panel[_ngcontent-%COMP%]{margin-top:0}@media (max-width: 900px){.product-details-style[_ngcontent-%COMP%]   .product-content[_ngcontent-%COMP%]{flex-direction:column}.product-details-style[_ngcontent-%COMP%]   .product-gallery[_ngcontent-%COMP%], .product-details-style[_ngcontent-%COMP%]   .product-info-panel[_ngcontent-%COMP%]{min-width:0;width:100%;min-height:160px;padding:10px 8px}.product-details-style[_ngcontent-%COMP%]   .model-viewer-wrapper[_ngcontent-%COMP%], .product-details-style[_ngcontent-%COMP%]   app-model-viewer[_ngcontent-%COMP%]{height:180px!important}}.product-details-style[_ngcontent-%COMP%]   .product-meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:18px;margin-bottom:10px}.product-details-style[_ngcontent-%COMP%]   .price-tag[_ngcontent-%COMP%]{color:#000;font-size:20px;font-family:Street,Pricedown,sans-serif;font-weight:900}.product-details-style[_ngcontent-%COMP%]   .original-price[_ngcontent-%COMP%]{color:#777;font-size:15px;text-decoration:line-through;margin-left:8px}.product-details-style[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%]{color:#f90;font-size:15px;display:flex;align-items:center;gap:3px}.product-details-style[_ngcontent-%COMP%]   .product-description[_ngcontent-%COMP%]{color:#222;font-size:15px;margin:10px 0 12px;font-family:Oswald,sans-serif}.product-details-style[_ngcontent-%COMP%]   .product-specs[_ngcontent-%COMP%]{margin-bottom:10px}.product-details-style[_ngcontent-%COMP%]   .spec-item[_ngcontent-%COMP%]{font-size:13px;color:#555;margin-bottom:2px}.product-details-style[_ngcontent-%COMP%]   .spec-label[_ngcontent-%COMP%]{color:#39ff14;font-weight:700;margin-right:4px}.product-details-style[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;gap:10px;margin-top:10px}.product-details-style[_ngcontent-%COMP%]   .gta-btn[_ngcontent-%COMP%]{background:#39ff14;color:#000;border:2px solid #000;font-family:Street,Pricedown,sans-serif;font-size:14px;padding:8px 18px;border-radius:0;cursor:pointer;transition:background .2s,color .2s;font-weight:900;box-shadow:2px 2px #000}.product-details-style[_ngcontent-%COMP%]   .gta-btn.secondary-btn[_ngcontent-%COMP%]{background:#fff;color:#39ff14;border:2px solid #39ff14}.product-details-style[_ngcontent-%COMP%]   .gta-btn[_ngcontent-%COMP%]:disabled{background:#ccc;color:#777;border-color:#aaa;cursor:not-allowed}.product-details-style[_ngcontent-%COMP%]   .model-info[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:10px;margin-top:12px;background:#f7f7f7;border-left:3px solid #39ff14;padding:8px 12px;border-radius:0 6px 6px 0}.product-details-style[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]{color:#39ff14;font-size:22px;margin-top:2px}.product-details-style[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 2px;font-size:15px;color:#222;font-family:Street,Pricedown,sans-serif}.product-details-style[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:13px;color:#555;font-family:Oswald,sans-serif}@media (max-width: 900px){.product-details-style[_ngcontent-%COMP%]   .product-content[_ngcontent-%COMP%]{flex-direction:column}.product-details-style[_ngcontent-%COMP%]   .product-gallery[_ngcontent-%COMP%], .product-details-style[_ngcontent-%COMP%]   .product-info-panel[_ngcontent-%COMP%]{min-width:0;width:100%;min-height:220px;padding:10px 8px}.product-details-style[_ngcontent-%COMP%]   .model-viewer-wrapper[_ngcontent-%COMP%], .product-details-style[_ngcontent-%COMP%]   app-model-viewer[_ngcontent-%COMP%]{height:220px!important}}.shop[_ngcontent-%COMP%]{background:#0b0f0c;min-height:100vh;position:relative;overflow-x:hidden;scroll-behavior:smooth}.shop[_ngcontent-%COMP%]:before{content:"";position:fixed;inset:0;background-image:radial-gradient(circle at 20% 30%,rgba(57,255,20,.05) 0%,transparent 50%),radial-gradient(circle at 80% 70%,rgba(255,153,0,.05) 0%,transparent 50%),linear-gradient(45deg,#0b0f0c 25%,#0f1f14 25%,#0f1f14 50%,#0b0f0c 50%,#0b0f0c 75%,#0f1f14 75%,#0f1f14);background-size:5px 5px,5px 5px,10px 10px;z-index:-1;opacity:.3}.shop-header[_ngcontent-%COMP%]{background:#000;padding:40px 20px 30px;border-bottom:4px solid #39ff14;position:relative;overflow:hidden}.shop-header[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(45deg,transparent 48%,rgba(57,255,20,.1) 50%,transparent 52%),linear-gradient(-45deg,transparent 48%,rgba(57,255,20,.1) 50%,transparent 52%);background-size:20px 20px}.shop-title[_ngcontent-%COMP%]{font-family:Street,Pricedown,sans-serif;font-size:52px;color:#39ff14;text-align:center;letter-spacing:4px;margin-bottom:25px;text-shadow:3px 3px 0 #000,-1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000,1px 1px 0 #000;position:relative;z-index:1}.shop-title[_ngcontent-%COMP%]:after{content:"LOS SANTOS";position:absolute;bottom:-10px;left:50%;transform:translate(-50%);font-size:16px;color:#fff;letter-spacing:8px;opacity:.7;font-family:Oswald,sans-serif}.search-container[_ngcontent-%COMP%]{max-width:600px;margin:0 auto;position:relative;z-index:1}.search-bar[_ngcontent-%COMP%]{display:flex;background:#111;border:3px solid #39ff14;border-radius:0;overflow:hidden;transform:skew(-5deg);box-shadow:5px 5px #000}.search-bar[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#39ff14;padding:15px;font-size:18px;transform:skew(5deg);background:#000}.search-input[_ngcontent-%COMP%]{flex:1;background:#000;border:none;color:#39ff14;font-size:16px;padding:0 15px;outline:none;font-family:Oswald,sans-serif;letter-spacing:1px;transform:skew(5deg)}.search-input[_ngcontent-%COMP%]::placeholder{color:#777;letter-spacing:2px;text-transform:uppercase}.search-btn[_ngcontent-%COMP%]{background:#39ff14;color:#000;border:none;padding:0 30px;font-weight:900;cursor:pointer;text-transform:uppercase;letter-spacing:2px;font-family:Street,Pricedown,sans-serif;transition:all .3s ease;transform:skew(5deg);position:relative;overflow:hidden}.search-btn[_ngcontent-%COMP%]:hover{background:#ff9900;color:#000;box-shadow:0 0 15px #f90}.search-btn[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.3),transparent);transition:.5s}.search-btn[_ngcontent-%COMP%]:hover:before{left:100%}.filters[_ngcontent-%COMP%]{background:#000;border:3px solid #39ff14;border-radius:0;margin:40px 20px 30px;padding:25px;box-shadow:10px 10px #000;position:relative;transform:skew(-2deg);overflow:hidden}.filters[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:4px;background:repeating-linear-gradient(90deg,#39ff14,#39ff14 10px,#000 10px,#000 20px)}.filter-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:20px;margin-bottom:20px;transform:skew(2deg)}.filter-row[_ngcontent-%COMP%]:last-child{margin-bottom:0}.filter-section[_ngcontent-%COMP%]{flex:1;min-width:250px}.filter-title[_ngcontent-%COMP%]{color:#39ff14;font-size:18px;margin-bottom:15px;letter-spacing:2px;text-transform:uppercase;font-family:Street,Pricedown,sans-serif;text-shadow:2px 2px 0 #000;position:relative;display:inline-block}.filter-title[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-5px;left:0;width:60%;height:2px;background:#ff9900}.category-filters[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:12px}.category-filter-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;background:#000;border:2px solid #333;color:#ccc;padding:12px 20px;border-radius:0;cursor:pointer;transition:all .3s ease;font-weight:600;letter-spacing:1px;font-family:Oswald,sans-serif;text-transform:uppercase;transform:skew(-5deg);position:relative;overflow:hidden}.category-filter-btn[_ngcontent-%COMP%]:hover{border-color:#39ff14;color:#39ff14;transform:skew(-5deg) translateY(-3px);box-shadow:4px 4px #000}.category-filter-btn.active[_ngcontent-%COMP%]{background:#39ff14;color:#000;border-color:#000;box-shadow:6px 6px #000;transform:skew(-5deg)}.category-filter-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px;transform:skew(5deg)}.category-filter-btn[_ngcontent-%COMP%]:before{content:"";position:absolute;top:50%;left:50%;width:0;height:0;background:rgba(57,255,20,.2);border-radius:50%;transform:translate(-50%,-50%);transition:width .6s,height .6s}.category-filter-btn[_ngcontent-%COMP%]:hover:before{width:100%;height:100%}.sort-options[_ngcontent-%COMP%]{display:flex;gap:10px}.sort-select[_ngcontent-%COMP%]{flex:1;background:#000;border:2px solid #39ff14;color:#39ff14;padding:12px 15px;border-radius:0;font-size:16px;cursor:pointer;outline:none;font-family:Oswald,sans-serif;min-width:200px;text-transform:uppercase;letter-spacing:1px;transform:skew(-5deg)}.sort-select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{background:#000;color:#39ff14;font-family:Oswald,sans-serif}.products-section[_ngcontent-%COMP%]{padding:0 20px 60px}.products-header-modern[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end;margin-bottom:40px;padding-bottom:15px;border-bottom:4px solid #39ff14;position:relative}.products-header-modern[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-4px;left:0;width:100%;height:4px;background:repeating-linear-gradient(90deg,#ff9900,#ff9900 10px,transparent 10px,transparent 20px)}.modern-header-left[_ngcontent-%COMP%]{flex:1}.modern-title[_ngcontent-%COMP%]{font-family:Street,Pricedown,sans-serif;font-size:42px;color:#39ff14;letter-spacing:3px;margin:0 0 5px;text-transform:uppercase;text-shadow:2px 2px 0 #000,-1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000}.modern-subtitle[_ngcontent-%COMP%]{color:#fff;font-size:16px;letter-spacing:3px;text-transform:uppercase;font-family:Oswald,sans-serif;background:#000;padding:5px 15px;display:inline-block;border:2px solid #ff9900;transform:skew(-5deg)}.modern-header-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:25px}.modern-count[_ngcontent-%COMP%]{color:#39ff14;font-weight:900;font-size:18px;letter-spacing:2px;background:#000;padding:8px 15px;border:2px solid #39ff14;transform:skew(-5deg);font-family:Street,Pricedown,sans-serif;text-shadow:1px 1px 0 #000}.modern-view-controls[_ngcontent-%COMP%]{display:flex;gap:8px;background:#000;border:2px solid #39ff14;padding:8px;transform:skew(-5deg)}.modern-view-btn[_ngcontent-%COMP%]{background:#111;border:2px solid #000;color:#777;width:40px;height:40px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s ease;transform:skew(5deg)}.modern-view-btn[_ngcontent-%COMP%]:hover{color:#39ff14;background:#000;border-color:#39ff14}.modern-view-btn.active[_ngcontent-%COMP%]{background:#39ff14;color:#000;border-color:#000;box-shadow:3px 3px #000}.modern-product[_ngcontent-%COMP%]{background:linear-gradient(160deg,#e3efcd 0%,#cbdca8 100%);border:4px solid #000;border-radius:0;transform:skew(-3deg);box-shadow:10px 10px #000;transition:all .2s cubic-bezier(.4,0,.2,1);cursor:pointer;position:relative;overflow:hidden;z-index:1}.modern-product[_ngcontent-%COMP%]:hover{transform:skew(-3deg) translate(-4px,-4px);box-shadow:16px 16px #000;z-index:10;background:linear-gradient(160deg,#eaf4da 0%,#d4e2b6 100%)}.modern-product[_ngcontent-%COMP%]:before, .modern-product[_ngcontent-%COMP%]:after{display:none}.products-modern-grid[_ngcontent-%COMP%]{display:grid;gap:35px;position:relative;z-index:2}.grid-small[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(220px,1fr))}.grid-medium[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(300px,1fr))}.grid-large[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(380px,1fr))}@media (max-width: 768px){.grid-small[_ngcontent-%COMP%], .grid-medium[_ngcontent-%COMP%], .grid-large[_ngcontent-%COMP%]{grid-template-columns:1fr!important}.modern-product-image[_ngcontent-%COMP%]{height:1000px}}.modern-product-image[_ngcontent-%COMP%]{background:#000;height:500px;border-bottom:4px solid #000;position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center}.gta-panels[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;inset:0;display:flex;justify-content:center;align-items:center;gap:10px;overflow:hidden;z-index:0}.gta-panel[_ngcontent-%COMP%]{background:linear-gradient(to bottom,rgba(0,0,0,.2),rgba(0,0,0,.8)),url(bg1.54feb52e8cf9f583.jpg);background-size:cover;background-position:center;border:2px solid #000;box-shadow:8px 8px #000;position:relative}.gta-panel[_ngcontent-%COMP%]:after{content:"";position:absolute;inset:0;background:linear-gradient(120deg,rgba(255,255,255,.1),rgba(0,0,0,.1))}.panel-1[_ngcontent-%COMP%]{flex:.8;height:55%;transform:rotate(-5deg) translateY(10px);will-change:transform;animation:_ngcontent-%COMP%_float-1 3s ease-in-out infinite alternate;margin-top:0}.panel-2[_ngcontent-%COMP%]{flex:1;height:80%;transform:rotate(0) scale(1.1);z-index:2;will-change:transform;animation:_ngcontent-%COMP%_float-2 4s ease-in-out infinite alternate}.panel-3[_ngcontent-%COMP%]{flex:.6;height:55%;transform:rotate(5deg) translateY(10px);will-change:transform;animation:_ngcontent-%COMP%_float-3 3.5s ease-in-out infinite alternate;margin-top:0}@keyframes _ngcontent-%COMP%_float-1{0%{transform:rotate(-5deg) translateY(10px) translate(0)}to{transform:rotate(-5deg) translateY(10px) translate(5px,-5px)}}@keyframes _ngcontent-%COMP%_float-2{0%{transform:rotate(0) scale(1.1) translate(0)}to{transform:rotate(0) scale(1.1) translate(-5px,5px)}}@keyframes _ngcontent-%COMP%_float-3{0%{transform:rotate(5deg) translateY(10px) translate(0)}to{transform:rotate(5deg) translateY(10px) translate(8px,8px)}}.modern-product-image[_ngcontent-%COMP%]:before{display:none}.product-img-container[_ngcontent-%COMP%]{z-index:2;position:relative;width:100%;height:100%;display:flex;align-items:center;justify-content:center;padding:20px}.product-3d-viewer[_ngcontent-%COMP%]{width:100%;height:100%;display:block}.product-img[_ngcontent-%COMP%]{max-width:100%;max-height:100%;object-fit:contain;filter:drop-shadow(5px 5px 0 rgba(0,0,0,.3)) contrast(1.1);mix-blend-mode:multiply}.product-img-placeholder[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:15px;color:#39ff14;font-size:24px}.product-img-placeholder[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:64px;opacity:.5}.product-img-placeholder[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-family:Street,Pricedown,sans-serif;font-size:32px;letter-spacing:3px;text-shadow:2px 2px 0 #000}.modern-product-image[_ngcontent-%COMP%]:after{content:"";position:absolute;inset:0;background:linear-gradient(to bottom,transparent 70%,rgba(0,0,0,.2));z-index:2}.modern-indicators[_ngcontent-%COMP%]{position:absolute;top:15px;left:15px;display:flex;flex-direction:column;gap:10px;z-index:3}.modern-badge[_ngcontent-%COMP%]{padding:8px 15px;border-radius:0;border:2px solid #000;transform:skew(-10deg);font-size:12px;font-weight:900;letter-spacing:1px;text-transform:uppercase;font-family:Street,Pricedown,sans-serif;box-shadow:3px 3px #0000004d;z-index:4}.modern-badge.sale[_ngcontent-%COMP%]{background:#ffcc00;color:#000}.modern-badge.new[_ngcontent-%COMP%]{background:#39ff14;color:#000}.modern-badge.out[_ngcontent-%COMP%]{background:#ff3333;color:#fff}.modern-quick-actions[_ngcontent-%COMP%]{position:absolute;top:15px;right:15px;display:flex;flex-direction:column;gap:10px;opacity:0;transform:translate(20px) skew(2deg);transition:all .3s ease;z-index:3}.modern-product[_ngcontent-%COMP%]:hover   .modern-quick-actions[_ngcontent-%COMP%]{opacity:1;transform:translate(0) skew(2deg)}.modern-quick-btn[_ngcontent-%COMP%]{width:42px;height:42px;border-radius:0;border:2px solid #000;background:#fff;color:#000;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s ease;font-size:18px;transform:skew(2deg);box-shadow:3px 3px #000}.modern-quick-btn[_ngcontent-%COMP%]:hover{background:#39ff14;color:#000;transform:skew(2deg) translate(-2px,-2px);box-shadow:5px 5px #000}.modern-product-content[_ngcontent-%COMP%]{position:relative;z-index:2;background:#fff;color:#000;border-top:4px solid #000;padding:25px;display:flex;flex-direction:column;flex:1}.modern-product-info[_ngcontent-%COMP%]{flex:1;margin-bottom:20px}.modern-brand[_ngcontent-%COMP%]{color:#777;font-size:12px;letter-spacing:2px;text-transform:uppercase;margin-bottom:8px;font-family:Oswald,sans-serif;font-weight:600}.modern-product-name[_ngcontent-%COMP%]{font-family:Street,Pricedown,sans-serif;text-transform:uppercase;letter-spacing:1.5px;color:#000;font-size:22px;margin:0 0 10px;font-weight:900;line-height:1.2;text-shadow:1px 1px 0 rgba(0,0,0,.1);position:relative}.modern-product-name[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-5px;left:0;width:60px;height:3px;background:#ff9900}.modern-category[_ngcontent-%COMP%]{color:#39ff14;font-size:14px;text-transform:uppercase;letter-spacing:1px;margin-bottom:15px;font-family:Oswald,sans-serif;font-weight:600;background:#000;padding:4px 10px;display:inline-block;transform:skew(-5deg)}.modern-rating[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;margin-top:15px}.stars[_ngcontent-%COMP%]{color:#f90;font-size:14px}.stars[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{text-shadow:1px 1px 0 #000}.rating-count[_ngcontent-%COMP%]{color:#777;font-size:13px;font-weight:600;font-family:Oswald,sans-serif}.modern-product-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end}.modern-price-section[_ngcontent-%COMP%]{flex:1}.modern-price[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px;margin-bottom:8px}.modern-current[_ngcontent-%COMP%]{color:#000;font-size:28px;font-weight:900;font-family:Street,Pricedown,sans-serif;text-shadow:2px 2px 0 rgba(0,0,0,.1);position:relative}.modern-current[_ngcontent-%COMP%]:before{content:"$";font-size:18px;vertical-align:super;margin-right:2px}.modern-original[_ngcontent-%COMP%]{color:#777;font-size:18px;text-decoration:line-through;font-weight:600;font-family:Oswald,sans-serif}.modern-material[_ngcontent-%COMP%]{color:#555;font-size:12px;letter-spacing:.5px;font-style:italic;font-family:Oswald,sans-serif;border-top:1px dashed #ccc;padding-top:5px;margin-top:5px}.modern-add-btn[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:0;border:3px solid #000;background:#39ff14;color:#000;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s ease;font-size:24px;font-weight:900;box-shadow:4px 4px #000;transform:skew(-5deg)}.modern-add-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#ff9900;transform:skew(-5deg) translate(-4px,-4px);box-shadow:8px 8px #000}.modern-add-btn[_ngcontent-%COMP%]:disabled{background:#ccc;color:#777;cursor:not-allowed;box-shadow:2px 2px #777}.loading-modern[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:100px 20px;background:#000;border:3px solid #39ff14;margin:40px;transform:skew(-5deg)}.modern-spinner[_ngcontent-%COMP%]{width:60px;height:60px;border:4px solid #333;border-top:4px solid #39ff14;border-radius:0;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:20px;transform:skew(5deg)}@keyframes _ngcontent-%COMP%_spin{0%{transform:skew(5deg) rotate(0)}to{transform:skew(5deg) rotate(360deg)}}.modern-loading-text[_ngcontent-%COMP%]{color:#39ff14;letter-spacing:3px;text-transform:uppercase;font-size:16px;font-family:Street,Pricedown,sans-serif;text-shadow:2px 2px 0 #000}.no-products-modern[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:500px;padding:40px}.modern-empty-state[_ngcontent-%COMP%]{text-align:center;padding:50px;background:#000;border:4px solid #39ff14;transform:skew(-5deg);box-shadow:15px 15px #00000080;max-width:500px}.modern-empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:80px;color:#333;margin-bottom:30px;transform:skew(5deg)}.modern-empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#39ff14;font-size:32px;margin-bottom:15px;font-family:Street,Pricedown,sans-serif;text-transform:uppercase;letter-spacing:3px;transform:skew(5deg)}.modern-empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#ccc;margin-bottom:30px;font-size:18px;font-family:Oswald,sans-serif;transform:skew(5deg)}.btn-modern[_ngcontent-%COMP%]{background:#39ff14;color:#000;border:3px solid #000;padding:15px 40px;border-radius:0;font-weight:900;letter-spacing:2px;cursor:pointer;text-transform:uppercase;transition:all .3s ease;font-family:Street,Pricedown,sans-serif;transform:skew(-5deg);box-shadow:6px 6px #000}.btn-modern[_ngcontent-%COMP%]:hover{background:#ff9900;transform:skew(-5deg) translate(-4px,-4px);box-shadow:10px 10px #000}@media (max-width: 1024px){.grid-large[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(320px,1fr))}.shop-title[_ngcontent-%COMP%]{font-size:42px}.modern-title[_ngcontent-%COMP%]{font-size:36px}}@media (max-width: 768px){.products-header-modern[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:20px}.modern-header-right[_ngcontent-%COMP%]{width:100%;justify-content:space-between}.grid-small[_ngcontent-%COMP%], .grid-medium[_ngcontent-%COMP%], .grid-large[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.modern-product-image[_ngcontent-%COMP%]{height:220px}.shop-title[_ngcontent-%COMP%]{font-size:36px}.modern-title[_ngcontent-%COMP%]{font-size:28px}.modern-subtitle[_ngcontent-%COMP%]{font-size:14px}}@media (max-width: 480px){.grid-small[_ngcontent-%COMP%], .grid-medium[_ngcontent-%COMP%], .grid-large[_ngcontent-%COMP%]{grid-template-columns:1fr}.modern-view-controls[_ngcontent-%COMP%]{display:none}.shop-title[_ngcontent-%COMP%]{font-size:28px;letter-spacing:2px}.modern-title[_ngcontent-%COMP%]{font-size:24px}.filters[_ngcontent-%COMP%]{margin:20px 10px;padding:15px}.category-filters[_ngcontent-%COMP%]{justify-content:center}.category-filter-btn[_ngcontent-%COMP%]{flex:1;min-width:120px;justify-content:center;padding:10px;font-size:12px}.search-bar[_ngcontent-%COMP%]{flex-direction:column;border-radius:0;transform:none}.search-bar[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{display:none}.search-input[_ngcontent-%COMP%]{padding:15px;text-align:center;transform:none}.search-btn[_ngcontent-%COMP%]{padding:15px;transform:none;width:100%}.modern-product[_ngcontent-%COMP%]{transform:skew(-1deg)}.modern-product[_ngcontent-%COMP%]:hover{transform:skew(-1deg) scale(1.02)}}@keyframes _ngcontent-%COMP%_street-pulse{0%,to{box-shadow:12px 12px #000}50%{box-shadow:12px 12px #000,0 0 20px #39ff1480}}.modern-product.featured[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_street-pulse 2s infinite;border-color:#f90}.modern-product[_ngcontent-%COMP%]:nth-child(3n):before{content:"FRESH";position:absolute;bottom:10px;right:10px;font-family:Street,Pricedown,sans-serif;color:#ff99004d;font-size:24px;transform:rotate(-15deg) skew(-10deg);z-index:1}.modern-product[_ngcontent-%COMP%]:nth-child(3n+1):before{content:"HOT";position:absolute;bottom:10px;right:10px;font-family:Street,Pricedown,sans-serif;color:#ff33334d;font-size:24px;transform:rotate(10deg) skew(-10deg);z-index:1}']})}}return n})();function SQ(n,e){1&n&&(M(0,"div",34),U(1,"i",35),M(2,"span"),O(3,"3D VIEW"),b()())}function PQ(n,e){if(1&n){const t=tn();M(0,"div",36)(1,"div",37),U(2,"app-model-viewer",38),M(3,"div",39)(4,"button",40),ge("click",function(){return qe(t),Xe(Q(2).toggleBackground())}),U(5,"i",41),M(6,"span"),O(7),b()()(),M(8,"div",42)(9,"button",43),U(10,"i",41),O(11),b(),M(12,"button",43),U(13,"i",44),O(14," COLOR "),b(),M(15,"button",43),U(16,"i",45),O(17," RESET "),b()()()()}if(2&n){const t=Q(2);L(2),J("modelPath",t.product.images[0])("autoRotate",t.isRotating)("autoScale",!0)("targetSize",12)("addStreetBackground",!0),L(2),bt("active",t.addStreetBackground),L(1),bt("fa-city",t.addStreetBackground)("fa-mountain",!t.addStreetBackground),L(2),xt(t.addStreetBackground?"STREET VIEW":"STUDIO VIEW"),L(3),bt("fa-pause",!t.isRotating)("fa-sync-alt",t.isRotating),L(1),Ye(" ",t.isRotating?"PAUSE":"ROTATE"," ")}}function EQ(n,e){if(1&n&&(M(0,"div",46)(1,"div",47),U(2,"div",48)(3,"div",49)(4,"div",50),b(),U(5,"img",51),b()),2&n){const t=Q(2);L(5),J("src",t.getCurrentImage(),ro)("alt",t.product.name)}}function TQ(n,e){if(1&n){const t=tn();M(0,"div",52)(1,"button",53),ge("click",function(){return qe(t),Xe(Q(2).show3DView=!0)}),U(2,"i",35),M(3,"span"),O(4,"3D VIEW"),b()(),M(5,"button",53),ge("click",function(){return qe(t),Xe(Q(2).show3DView=!1)}),U(6,"i",54),M(7,"span"),O(8,"IMAGE"),b()()()}if(2&n){const t=Q(2);L(1),bt("active",t.show3DView),L(4),bt("active",!t.show3DView)}}function AQ(n,e){if(1&n){const t=tn();M(0,"div",57),ge("click",function(){const o=qe(t).index;return Xe(Q(3).selectImage(o))}),U(1,"img",58),b()}if(2&n){const t=e.$implicit,i=e.index,r=Q(3);bt("active",r.selectedImageIndex===i),L(1),J("src",t,ro)("alt",r.product.name+" thumbnail "+(i+1))}}function OQ(n,e){if(1&n&&(M(0,"div",55),ie(1,AQ,2,4,"div",56),b()),2&n){const t=Q(2);L(1),J("ngForOf",t.getImageThumbnails())}}function DQ(n,e){if(1&n&&(M(0,"span",59),O(1),b()),2&n){const t=Q(2);L(1),Ye("$",t.product.originalPrice,"")}}function IQ(n,e){1&n&&U(0,"i",60),2&n&&lo("opacity",e.$implicit<=Q(2).product.rating?1:.3)}function RQ(n,e){1&n&&(M(0,"div",62)(1,"span",63),O(2,"VIEW:"),b(),M(3,"span",64),O(4,"3D Model Available"),b()())}function NQ(n,e){if(1&n&&(M(0,"div",62)(1,"span",63),O(2,"BACKGROUND:"),b(),M(3,"span",64),O(4),b()()),2&n){const t=Q(3);L(4),xt(t.addStreetBackground?"Street View":"Studio View")}}function LQ(n,e){if(1&n&&(M(0,"div",61)(1,"div",62)(2,"span",63),O(3,"MATERIAL:"),b(),M(4,"span",64),O(5),b()(),ie(6,RQ,5,0,"div",65),ie(7,NQ,5,1,"div",65),b()),2&n){const t=Q(2);L(5),xt(t.product.material),L(1),J("ngIf",t.has3DModel),L(1),J("ngIf",t.has3DModel)}}function FQ(n,e){if(1&n){const t=tn();M(0,"div",69),ge("click",function(){const o=qe(t).$implicit;return Xe(Q(3).selectSize(o))}),O(1),b()}if(2&n){const t=e.$implicit;bt("selected",Q(3).selectedSize===t),L(1),Ye(" ",t," ")}}function kQ(n,e){if(1&n&&(M(0,"div",66)(1,"h3"),O(2,"SELECT SIZE"),b(),M(3,"div",67),ie(4,FQ,2,3,"div",68),b()()),2&n){const t=Q(2);L(4),J("ngForOf",t.product.sizes)}}function UQ(n,e){if(1&n){const t=tn();M(0,"div",69),ge("click",function(){const o=qe(t).$implicit;return Xe(Q(3).selectColor(o))}),O(1),b()}if(2&n){const t=e.$implicit;bt("selected",Q(3).selectedColor===t),L(1),Ye(" ",t," ")}}function BQ(n,e){if(1&n&&(M(0,"div",66)(1,"h3"),O(2,"SELECT COLOR"),b(),M(3,"div",67),ie(4,UQ,2,3,"div",68),b()()),2&n){const t=Q(2);L(4),J("ngForOf",t.product.colors)}}function VQ(n,e){if(1&n){const t=tn();M(0,"div",66)(1,"h3"),O(2,"3D BACKGROUND"),b(),M(3,"div",67)(4,"div",69),ge("click",function(){return qe(t),Xe(Q(2).addStreetBackground=!0)}),O(5," STREET "),b(),M(6,"div",69),ge("click",function(){return qe(t),Xe(Q(2).addStreetBackground=!1)}),O(7," STUDIO "),b()()()}if(2&n){const t=Q(2);L(4),bt("selected",t.addStreetBackground),L(2),bt("selected",!t.addStreetBackground)}}function zQ(n,e){1&n&&(M(0,"p",75),U(1,"i",76),O(2," Viewing in Street Mode with graffiti background "),b())}function HQ(n,e){if(1&n&&(M(0,"div",70)(1,"div",71),U(2,"i",72),b(),M(3,"div",73)(4,"h4"),O(5,"3D INTERACTIVE VIEW"),b(),M(6,"p"),O(7,"Rotate, zoom, and change colors of this product in 3D. Click and drag to explore."),b(),ie(8,zQ,3,0,"p",74),b()()),2&n){const t=Q(2);L(8),J("ngIf",t.addStreetBackground)}}const GQ=function(){return[1,2,3,4,5]};function jQ(n,e){if(1&n){const t=tn();M(0,"div",3)(1,"div",4)(2,"div",5),ge("click",function(){return qe(t),Xe(Q().goBack())}),U(3,"i",6),O(4," BACK "),b(),ie(5,SQ,4,0,"div",7),b(),M(6,"div",8)(7,"div",9),ie(8,PQ,18,17,"div",10),ie(9,EQ,6,2,"div",11),M(10,"div",12),ie(11,TQ,9,4,"div",13),ie(12,OQ,2,1,"div",14),b()(),M(13,"div",15)(14,"span",16),O(15),b(),M(16,"h1",17),O(17),b(),M(18,"div",18)(19,"div",19)(20,"span",20),O(21,"$"),b(),O(22),ie(23,DQ,2,1,"span",21),b(),M(24,"div",22),ie(25,IQ,1,2,"i",23),M(26,"span"),O(27),b()()(),M(28,"p",24),O(29),b(),ie(30,LQ,8,3,"div",25),M(31,"div",26),ie(32,kQ,5,1,"div",27),ie(33,BQ,5,1,"div",27),ie(34,VQ,8,4,"div",27),b(),M(35,"div",28)(36,"button",29),ge("click",function(r){qe(t);const o=Q();return r.stopPropagation(),Xe(o.addToCart(o.product))}),U(37,"i",30),O(38),b(),M(39,"button",31),ge("click",function(){return qe(t),Xe(Q().tryOn())}),U(40,"i",32),O(41," TRY ON "),b()(),ie(42,HQ,9,1,"div",33),b()()()}if(2&n){const t=Q();L(5),J("ngIf",t.has3DModel),L(3),J("ngIf",t.has3DModel&&t.show3DView),L(1),J("ngIf",!t.has3DModel||!t.show3DView),L(2),J("ngIf",t.has3DModel),L(1),J("ngIf",!t.show3DView&&t.product.images.length>1),L(3),$h("",t.product.brand," // ",t.product.category,""),L(2),xt(t.product.name),L(5),Ye("",t.product.price," "),L(1),J("ngIf",t.product.originalPrice),L(2),J("ngForOf",Ku(20,GQ)),L(2),Ye("(",t.product.reviewCount," REVIEWS)"),L(2),xt(t.product.description),L(1),J("ngIf",t.product.material),L(2),J("ngIf",null==t.product.sizes?null:t.product.sizes.length),L(1),J("ngIf",null==t.product.colors?null:t.product.colors.length),L(1),J("ngIf",t.has3DModel),L(2),J("disabled",!t.product.inStock),L(2),Ye(" ",t.product.inStock?"ADD TO CART":"OUT OF STOCK"," "),L(4),J("ngIf",t.has3DModel)}}function WQ(n,e){1&n&&(M(0,"div",77),U(1,"div",78),M(2,"p"),O(3,"LOADING PRODUCT DATA..."),b()())}let $Q=(()=>{class n{constructor(t,i,r){this.route=t,this.router=i,this.cartService=r,this.selectedSize="",this.selectedColor="",this.selectedImageIndex=0,this.isRotating=!0,this.has3DModel=!1,this.show3DView=!0,this.addStreetBackground=!0}ngOnInit(){const t=this.route.snapshot.paramMap.get("id");t&&(this.product=Vp.find(i=>i.id===t),this.checkFor3DModel()),this.product&&(this.product.sizes?.length>0&&(this.selectedSize=this.product.sizes[0]),this.product.colors?.length>0&&(this.selectedColor=this.product.colors[0]))}checkFor3DModel(){if(!this.product||!this.product.images||0===this.product.images.length)return this.has3DModel=!1,void(this.show3DView=!1);const t=this.product.images[0];this.has3DModel=t?.endsWith(".obj")||t?.endsWith(".glb")||t?.endsWith(".gltf")||this.product.has3DModel||!1,this.show3DView=this.has3DModel}toggleRotation(){this.isRotating=!this.isRotating}toggleBackground(){this.addStreetBackground=!this.addStreetBackground}changeModelColor(){if(this.modelViewer){const t=[16711680,65280,255,16776960,16711935,65535],i=t[Math.floor(Math.random()*t.length)];this.modelViewer.changeColor(i)}}resetModel(){this.isRotating=!0}getCurrentImage(){if(!this.product?.images||0===this.product.images.length)return"assets/images/placeholder.jpg";if(this.show3DView&&this.has3DModel)return this.product.images[0];const t=this.getImageThumbnails();return t[this.selectedImageIndex]||t[0]||"assets/images/placeholder.jpg"}getImageThumbnails(){return this.product?.images?this.product.images.filter(t=>!(t.endsWith(".obj")||t.endsWith(".fbx")||t.endsWith(".glb")||t.endsWith(".gltf"))):[]}selectImage(t){this.selectedImageIndex=t}selectSize(t){this.selectedSize=t}selectColor(t){this.selectedColor=t}tryOn(){this.product&&this.router.navigate(["/try-on"],{queryParams:{productId:this.product.id,modelUrl:this.has3DModel?this.product.images[0]:null,backgroundMode:this.addStreetBackground?"street":"studio"}})}goBack(){this.router.navigate(["/shop"])}addToCart(t){this.cartService.addToCart(t),console.log("Added to cart:",t.name)}static{this.\u0275fac=function(i){return new(i||n)(te(Os),te(Xn),te(Ed))}}static{this.\u0275cmp=Zi({type:n,selectors:[["app-product-details"]],viewQuery:function(i,r){if(1&i&&ep(_f,5),2&i){let o;td(o=nd())&&(r.modelViewer=o.first)}},decls:5,vars:2,consts:[[1,"product-details-page"],["class","product-page-container",4,"ngIf","ngIfElse"],["loading",""],[1,"product-page-container"],[1,"details-header"],[1,"back-button",3,"click"],[1,"fas","fa-arrow-left"],["class","model-indicator",4,"ngIf"],[1,"product-content"],[1,"product-gallery"],["class","model-container",4,"ngIf"],["class","main-image-container",4,"ngIf"],[1,"gallery-controls"],["class","view-toggle",4,"ngIf"],["class","thumbnail-gallery",4,"ngIf"],[1,"product-info-panel"],[1,"product-brand"],[1,"product-title"],[1,"product-meta"],[1,"price-tag"],[1,"currency"],["class","original-price",4,"ngIf"],[1,"rating"],["class","fas fa-star",3,"opacity",4,"ngFor","ngForOf"],[1,"product-description"],["class","product-specs",4,"ngIf"],[1,"options-container"],["class","option-group",4,"ngIf"],[1,"action-buttons"],[1,"gta-btn","primary-btn",3,"disabled","click"],[1,"fas","fa-shopping-cart"],[1,"gta-btn","secondary-btn",3,"click"],[1,"fas","fa-camera"],["class","model-info",4,"ngIf"],[1,"model-indicator"],[1,"fas","fa-cube"],[1,"model-container"],[1,"model-viewer-wrapper"],[3,"modelPath","autoRotate","autoScale","targetSize","addStreetBackground"],[1,"background-toggle"],[1,"bg-toggle-btn",3,"click"],[1,"fas"],[1,"model-controls"],[1,"model-btn"],[1,"fas","fa-palette"],[1,"fas","fa-undo"],[1,"main-image-container"],[1,"gta-bg-elements"],[1,"bg-panel","panel-1"],[1,"bg-panel","panel-2"],[1,"bg-panel","panel-3"],[1,"main-image",3,"src","alt"],[1,"view-toggle"],[1,"view-btn",3,"click"],[1,"fas","fa-image"],[1,"thumbnail-gallery"],["class","thumbnail",3,"active","click",4,"ngFor","ngForOf"],[1,"thumbnail",3,"click"],[3,"src","alt"],[1,"original-price"],[1,"fas","fa-star"],[1,"product-specs"],[1,"spec-item"],[1,"spec-label"],[1,"spec-value"],["class","spec-item",4,"ngIf"],[1,"option-group"],[1,"option-chips"],["class","chip",3,"selected","click",4,"ngFor","ngForOf"],[1,"chip",3,"click"],[1,"model-info"],[1,"info-icon"],[1,"fas","fa-info-circle"],[1,"info-text"],["class","bg-info",4,"ngIf"],[1,"bg-info"],[1,"fas","fa-map-marker-alt"],[1,"loading-state"],[1,"spinner"]],template:function(i,r){if(1&i&&(M(0,"div",0),ie(1,jQ,43,21,"div",1),ie(2,WQ,4,0,"ng-template",null,2,Cs),b(),U(4,"app-bottom-nav")),2&i){const o=Ms(3);L(1),J("ngIf",r.product)("ngIfElse",o)}},dependencies:[Ps,jo,sl,_f],styles:['@import"https://fonts.googleapis.com/css2?family=Oswald:wght@300;400;500;700&display=swap";[_nghost-%COMP%]{display:block;min-height:100vh;font-family:Oswald,sans-serif}.product-details-page[_ngcontent-%COMP%]{background:#0b0f0c;min-height:100vh;position:relative;overflow-x:hidden;padding-top:80px}.product-details-page[_ngcontent-%COMP%]:before{content:"";position:fixed;inset:0;background-image:radial-gradient(circle at 20% 30%,rgba(57,255,20,.05) 0%,transparent 50%),radial-gradient(circle at 80% 70%,rgba(255,153,0,.05) 0%,transparent 50%),linear-gradient(45deg,#0b0f0c 25%,#0f1f14 25%,#0f1f14 50%,#0b0f0c 50%,#0b0f0c 75%,#0f1f14 75%,#0f1f14);background-size:5px 5px,5px 5px,10px 10px;z-index:0;opacity:.3}.product-page-container[_ngcontent-%COMP%]{max-width:950px;margin:0 auto;padding:30px 20px;position:relative;z-index:1}.details-header[_ngcontent-%COMP%]{border-bottom:4px solid #39ff14;padding-bottom:20px;margin-bottom:40px;display:flex;justify-content:space-between;align-items:center}.model-indicator[_ngcontent-%COMP%]{background:rgba(57,255,20,.1);border:2px solid #39ff14;padding:8px 16px;color:#39ff14;font-family:Oswald,sans-serif;font-weight:700;text-transform:uppercase;letter-spacing:1px;display:flex;align-items:center;gap:8px;font-size:14px}.model-indicator[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px;animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}.back-button[_ngcontent-%COMP%]{cursor:pointer;background:#000;border:2px solid #39ff14;padding:10px 20px;color:#39ff14;font-family:Street,Pricedown,sans-serif;letter-spacing:2px;text-transform:uppercase;transform:skew(-5deg);display:inline-flex;align-items:center;gap:10px;font-size:18px;transition:all .3s ease}.back-button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transform:skew(5deg)}.back-button[_ngcontent-%COMP%]:hover{background:#39ff14;color:#000;box-shadow:0 0 15px #39ff1466}.product-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:40px;align-items:start}.product-gallery[_ngcontent-%COMP%]{position:relative}.main-image-container[_ngcontent-%COMP%]{width:100%;aspect-ratio:1;background:transparent;position:relative;display:flex;align-items:center;justify-content:center;transform:skew(-2deg);transition:transform .3s ease;margin-bottom:20px}.main-image-container[_ngcontent-%COMP%]:hover{transform:skew(-2deg) scale(1.02)}.gta-bg-elements[_ngcontent-%COMP%]{position:absolute;inset:0;width:100%;height:100%;z-index:1;display:flex;justify-content:center;align-items:center;gap:10px}.bg-panel[_ngcontent-%COMP%]{background:linear-gradient(to bottom,rgba(0,0,0,.2),rgba(0,0,0,.8)),url(bg1.54feb52e8cf9f583.jpg);background-size:cover;background-position:center;border:2px solid #000}.panel-1[_ngcontent-%COMP%]{flex:.8;height:85%;transform:rotate(-5deg) translateY(20px);transition:transform .3s ease;will-change:transform;animation:_ngcontent-%COMP%_float-1 3s ease-in-out infinite alternate}.panel-2[_ngcontent-%COMP%]{flex:1;height:100%;transform:rotate(0) scale(1.1);transition:transform .3s ease;will-change:transform;animation:_ngcontent-%COMP%_float-2 4s ease-in-out infinite alternate}.panel-3[_ngcontent-%COMP%]{flex:.6;height:75%;transform:rotate(5deg) translateY(20px);transition:transform .3s ease;will-change:transform;animation:_ngcontent-%COMP%_float-3 3.5s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_float-1{0%{transform:rotate(-5deg) translateY(20px) translate(0)}to{transform:rotate(-5deg) translateY(20px) translate(5px,-10px)}}@keyframes _ngcontent-%COMP%_float-2{0%{transform:rotate(0) scale(1.1) translate(0)}to{transform:rotate(0) scale(1.1) translate(-5px,5px)}}@keyframes _ngcontent-%COMP%_float-3{0%{transform:rotate(5deg) translateY(20px) translate(0)}to{transform:rotate(5deg) translateY(20px) translate(8px,8px)}}.model-viewer-wrapper[_ngcontent-%COMP%]{width:100%;height:100%;position:relative;z-index:10;transform:skew(2deg)}.model-viewer-wrapper[_ngcontent-%COMP%]   app-model-viewer[_ngcontent-%COMP%]{width:100%;height:100%;display:block;background:transparent!important}.model-viewer-wrapper[_ngcontent-%COMP%]   .model-controls[_ngcontent-%COMP%]{position:absolute;bottom:20px;left:50%;transform:translate(-50%);display:flex;gap:10px;z-index:20}.model-viewer-wrapper[_ngcontent-%COMP%]   .model-controls[_ngcontent-%COMP%]   .model-btn[_ngcontent-%COMP%]{background:rgba(0,0,0,.8);color:#39ff14;border:2px solid #39ff14;padding:10px 20px;cursor:pointer;font-family:Oswald,sans-serif;font-weight:700;font-size:14px;text-transform:uppercase;letter-spacing:1px;transition:all .3s ease;display:flex;align-items:center;gap:8px;box-shadow:3px 3px #000}.model-viewer-wrapper[_ngcontent-%COMP%]   .model-controls[_ngcontent-%COMP%]   .model-btn[_ngcontent-%COMP%]:hover{background:#39ff14;color:#000;transform:translate(-2px,-2px);box-shadow:5px 5px #000}.model-viewer-wrapper[_ngcontent-%COMP%]   .model-controls[_ngcontent-%COMP%]   .model-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:12px}.main-image[_ngcontent-%COMP%]{max-width:90%;max-height:90%;object-fit:contain;z-index:10;filter:drop-shadow(10px 10px 5px rgba(0,0,0,.5));transform:skew(2deg)}.gallery-controls[_ngcontent-%COMP%]{margin-top:20px}.view-toggle[_ngcontent-%COMP%]{display:flex;gap:10px;margin-bottom:20px}.view-toggle[_ngcontent-%COMP%]   .view-btn[_ngcontent-%COMP%]{flex:1;background:rgba(255,255,255,.1);border:2px solid #333;color:#888;padding:12px;cursor:pointer;font-family:Oswald,sans-serif;font-weight:700;text-transform:uppercase;letter-spacing:1px;display:flex;align-items:center;justify-content:center;gap:8px;transition:all .3s ease}.view-toggle[_ngcontent-%COMP%]   .view-btn.active[_ngcontent-%COMP%]{background:rgba(57,255,20,.2);border-color:#39ff14;color:#39ff14}.view-toggle[_ngcontent-%COMP%]   .view-btn[_ngcontent-%COMP%]:hover{border-color:#fff;color:#fff}.view-toggle[_ngcontent-%COMP%]   .view-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}.view-toggle[_ngcontent-%COMP%]   .view-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px}.thumbnail-gallery[_ngcontent-%COMP%]{display:flex;gap:15px;overflow-x:auto;padding:10px;background:rgba(0,0,0,.5);border-radius:8px;border:1px solid #333}.thumbnail-gallery[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{flex:0 0 auto;width:80px;height:80px;border:2px solid #333;border-radius:6px;overflow:hidden;cursor:pointer;transition:all .3s ease}.thumbnail-gallery[_ngcontent-%COMP%]   .thumbnail.active[_ngcontent-%COMP%]{border-color:#39ff14;transform:scale(1.1)}.thumbnail-gallery[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]:hover{border-color:#fff}.thumbnail-gallery[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.product-info-panel[_ngcontent-%COMP%]{background:#000;border:3px solid #39ff14;padding:40px;box-shadow:10px 10px #000c;position:relative;transform:skew(-2deg)}.product-info-panel[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{transform:skew(2deg)}.product-brand[_ngcontent-%COMP%]{font-size:1.2rem;color:#888;text-transform:uppercase;letter-spacing:2px;margin-bottom:.5rem;display:block;font-weight:600}.product-title[_ngcontent-%COMP%]{font-family:Street,Pricedown,sans-serif;font-size:2.5rem;line-height:1;color:#39ff14;text-transform:uppercase;letter-spacing:2px;margin:0 0 15px;text-shadow:2px 2px 0 #000}.product-meta[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end;border-bottom:2px dashed #333;padding-bottom:20px;margin-bottom:30px}.price-tag[_ngcontent-%COMP%]{font-family:Street,Pricedown,sans-serif;font-size:2.2rem;color:#fff;line-height:1}.currency[_ngcontent-%COMP%]{color:#39ff14;margin-right:5px}.original-price[_ngcontent-%COMP%]{font-family:Oswald,sans-serif;font-size:1.5rem;color:#666;text-decoration:line-through;margin-left:1rem}.rating[_ngcontent-%COMP%]{font-size:1.2rem;color:#f90;display:flex;align-items:center;gap:5px}.rating[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#888;font-size:.9rem;margin-left:5px}.product-description[_ngcontent-%COMP%]{font-size:1.1rem;line-height:1.6;color:#ccc;margin-bottom:30px;border-left:3px solid #333;padding-left:15px}.product-specs[_ngcontent-%COMP%]{margin:25px 0;padding:15px;background:rgba(255,255,255,.05);border-radius:8px;border:1px solid #333}.product-specs[_ngcontent-%COMP%]   .spec-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:10px}.product-specs[_ngcontent-%COMP%]   .spec-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.product-specs[_ngcontent-%COMP%]   .spec-item[_ngcontent-%COMP%]   .spec-label[_ngcontent-%COMP%]{color:#888;font-weight:700;text-transform:uppercase;letter-spacing:1px;font-size:14px}.product-specs[_ngcontent-%COMP%]   .spec-item[_ngcontent-%COMP%]   .spec-value[_ngcontent-%COMP%]{color:#39ff14;font-weight:700}.model-info[_ngcontent-%COMP%]{display:flex;gap:15px;background:rgba(57,255,20,.1);border:1px solid #39ff14;border-radius:8px;padding:15px;margin-top:25px}.model-info[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]{color:#39ff14;font-size:24px}.model-info[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]{flex:1}.model-info[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#39ff14;margin:0 0 5px;font-size:16px;text-transform:uppercase;letter-spacing:1px}.model-info[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#aaa;margin:0;font-size:14px;line-height:1.4}.option-group[_ngcontent-%COMP%]{margin-bottom:25px}.option-group[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#39ff14;font-size:1.1rem;margin-bottom:15px;text-transform:uppercase;letter-spacing:2px;font-weight:700}.option-chips[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:15px}.chip[_ngcontent-%COMP%]{padding:10px 20px;background:#111;border:2px solid #333;color:#ccc;cursor:pointer;text-transform:uppercase;font-weight:700;transition:all .2s ease;min-width:50px;text-align:center;position:relative}.chip[_ngcontent-%COMP%]:hover{border-color:#39ff14;color:#39ff14;transform:translateY(-2px)}.chip.selected[_ngcontent-%COMP%]{background:#39ff14;color:#000;border-color:#39ff14;box-shadow:0 0 10px #39ff1466}.action-buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 1fr;gap:20px;margin-top:40px}.gta-btn[_ngcontent-%COMP%]{padding:15px;border:none;font-family:Street,Pricedown,sans-serif;font-size:1.5rem;cursor:pointer;text-transform:uppercase;display:flex;align-items:center;justify-content:center;gap:15px;transition:all .3s ease;letter-spacing:2px;position:relative;overflow:hidden}.primary-btn[_ngcontent-%COMP%]{background:#39ff14;color:#000;box-shadow:5px 5px #000}.primary-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#ff9900;transform:translate(-2px,-2px);box-shadow:7px 7px #000}.primary-btn[_ngcontent-%COMP%]:disabled{background:#666;color:#999;cursor:not-allowed;box-shadow:5px 5px #333}.secondary-btn[_ngcontent-%COMP%]{background:transparent;border:2px solid #fff;color:#fff;box-shadow:5px 5px #ffffff1a}.secondary-btn[_ngcontent-%COMP%]:hover{background:#fff;color:#000}.loading-state[_ngcontent-%COMP%]{height:80vh;display:flex;flex-direction:column;align-items:center;justify-content:center;color:#39ff14;font-family:Street,Pricedown,sans-serif;font-size:2rem}.spinner[_ngcontent-%COMP%]{width:60px;height:60px;border:5px solid rgba(57,255,20,.3);border-top-color:#39ff14;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:20px}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}@media (max-width: 900px){.product-content[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:40px}.main-image-container[_ngcontent-%COMP%]{aspect-ratio:4/3}.action-buttons[_ngcontent-%COMP%]{grid-template-columns:1fr}.model-controls[_ngcontent-%COMP%]{flex-wrap:wrap;justify-content:center}.model-controls[_ngcontent-%COMP%]   .model-btn[_ngcontent-%COMP%]{flex:1;min-width:100px}}']})}}return n})(),qQ=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Zi({type:n,selectors:[["app-try-on"]],decls:3,vars:0,template:function(i,r){1&i&&(M(0,"p"),O(1,"try-on works!"),b(),U(2,"app-bottom-nav"))},dependencies:[sl]})}}return n})();const Pf={_origin:"https://api.emailjs.com"};class o3{constructor(e){this.status=e.status,this.text=e.responseText}}const a3_send=(n,e,t,i)=>{const r=i||Pf._userID;return((n,e,t)=>{if(!n)throw"The user ID is required. Visit https://dashboard.emailjs.com/admin/integration";if(!e)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!t)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"})(r,n,e),((n,e,t={})=>new Promise((i,r)=>{const o=new XMLHttpRequest;o.addEventListener("load",({target:s})=>{const a=new o3(s);200===a.status||"OK"===a.text?i(a):r(a)}),o.addEventListener("error",({target:s})=>{r(new o3(s))}),o.open("POST",Pf._origin+n,!0),Object.keys(t).forEach(s=>{o.setRequestHeader(s,t[s])}),o.send(e)}))("/api/v1.0/email/send",JSON.stringify({lib_version:"3.2.0",user_id:r,service_id:n,template_id:e,template_params:t}),{"Content-type":"application/json"})};function KQ(n,e){if(1&n&&(M(0,"span",12),O(1),b()),2&n){const t=Q();L(1),Ye(" ",t.getTotalItems()," ITEMS ")}}function JQ(n,e){if(1&n&&(M(0,"div",36)(1,"div",37),U(2,"i",26),M(3,"span"),O(4),b()(),M(5,"div",38),U(6,"div",39),b()()),2&n){const t=Q(2);L(4),Ye("Spend ",t.formatCurrency(t.getRemainingForFreeShipping())," more for FREE shipping!"),L(2),lo("width",t.subtotal/t.SHIPPING_THRESHOLD*100+"%")}}function QQ(n,e){if(1&n&&U(0,"img",78),2&n){const t=Q().$implicit;J("src",t.product.images[0],ro)("alt",t.product.name)}}function eee(n,e){1&n&&(M(0,"div",79),U(1,"i",80),M(2,"span"),O(3,"NO IMAGE"),b()())}function tee(n,e){if(1&n&&(M(0,"div",81),O(1),b()),2&n){const t=Q().$implicit,i=Q(2);L(1),Ye(" -",i.getItemDiscountPercentage(t.product.id),"% ")}}function nee(n,e){1&n&&(M(0,"div",82),O(1," NEW "),b())}function iee(n,e){if(1&n&&(M(0,"div",83),O(1),b()),2&n){const t=Q().$implicit;L(1),Ye(" x",t.quantity," ")}}function ree(n,e){if(1&n&&(M(0,"span",84),O(1),b()),2&n){const t=Q().$implicit,i=Q(2);let r;L(1),Ye(" $",null==(r=i.getProductById(t.product.id))?null:r.originalPrice," ")}}function oee(n,e){if(1&n&&(M(0,"div",85),U(1,"i",86),O(2),b()),2&n){const t=Q().$implicit,i=Q(2);L(2),Ye(" Save $",i.getItemSavings(t)," ")}}function see(n,e){if(1&n&&(M(0,"div",89)(1,"span",90),O(2,"Size:"),b(),M(3,"span",91),O(4),b()()),2&n){const t=Q().ngIf;L(4),xt(t.sizes[0])}}function aee(n,e){if(1&n&&(M(0,"div",89)(1,"span",90),O(2,"Color:"),b(),M(3,"span",91),O(4),b()()),2&n){const t=Q().ngIf;L(4),xt(t.colors[0])}}function cee(n,e){if(1&n&&(M(0,"div",87),ie(1,see,5,1,"div",88),ie(2,aee,5,1,"div",88),b()),2&n){const t=e.ngIf;L(1),J("ngIf",null==t.sizes?null:t.sizes.length),L(1),J("ngIf",null==t.colors?null:t.colors.length)}}function lee(n,e){if(1&n){const t=tn();M(0,"div",40)(1,"div",41)(2,"div",42),U(3,"div",43)(4,"div",44)(5,"div",45),b(),M(6,"div",46),ie(7,QQ,1,2,"img",47),ie(8,eee,4,0,"ng-template",null,48,Cs),b(),M(10,"div",49),ie(11,tee,2,1,"div",50),ie(12,nee,2,0,"div",51),ie(13,iee,2,1,"div",52),b(),M(14,"div",53)(15,"button",54),ge("click",function(){const o=qe(t).$implicit;return Xe(Q(2).removeFromCart(o.product.id))}),U(16,"i",55),b(),M(17,"button",56),ge("click",function(){const o=qe(t).$implicit;return Xe(Q(2).updateQuantity(o.product.id,o.quantity+1))}),U(18,"i",57),b()()(),M(19,"div",58)(20,"div",59)(21,"div",60),O(22),b(),M(23,"h3",61),O(24),b(),M(25,"div",62),O(26),b(),M(27,"div",63)(28,"div",64)(29,"span",65),O(30),b(),ie(31,ree,2,1,"span",66),b(),ie(32,oee,3,1,"div",67),M(33,"div",68),O(34),b()(),ie(35,cee,3,2,"div",69),M(36,"div",70)(37,"label",71),O(38,"QUANTITY:"),b(),M(39,"div",72)(40,"button",73),ge("click",function(){const o=qe(t).$implicit;return Xe(Q(2).updateQuantity(o.product.id,o.quantity-1))}),U(41,"i",74),b(),M(42,"input",75),ge("change",function(r){const s=qe(t).$implicit;return Xe(Q(2).updateQuantity(s.product.id,r.target.value))})("keyup.enter",function(r){return qe(t),Xe(Q(2).onInputEnter(r))})("blur",function(r){const s=qe(t).$implicit;return Xe(Q(2).updateQuantity(s.product.id,r.target.value))}),b(),M(43,"button",76),ge("click",function(){const o=qe(t).$implicit;return Xe(Q(2).updateQuantity(o.product.id,o.quantity+1))}),U(44,"i",57),b()()()(),M(45,"div",77)(46,"span",30),O(47,"ITEM TOTAL:"),b(),M(48,"span",31),O(49),b()()()()}if(2&n){const t=e.$implicit,i=Ms(9),r=Q(2);let o,s;L(7),J("ngIf",t.product.images&&t.product.images.length>0)("ngIfElse",i),L(4),J("ngIf",r.isItemOnSale(t.product.id)),L(1),J("ngIf",null==(o=r.getProductById(t.product.id))?null:o.isFeatured),L(1),J("ngIf",t.quantity>1),L(9),xt(t.product.brand||"FREPPING"),L(2),xt(t.product.name),L(2),xt(t.product.category||"TOPS"),L(4),Ye("$",t.product.price,""),L(1),J("ngIf",r.isItemOnSale(t.product.id)),L(1),J("ngIf",r.getItemSavings(t)>0),L(2),xt((null==(s=r.getProductById(t.product.id))?null:s.material)||"Premium Quality"),L(1),J("ngIf",r.getProductById(t.product.id)),L(5),J("disabled",t.quantity<=1),L(2),J("value",t.quantity),L(7),Ye("$",r.getItemTotal(t),"")}}function uee(n,e){if(1&n&&(M(0,"div",92)(1,"span"),U(2,"i",86),O(3," Discounts Applied "),b(),M(4,"span",93),O(5),b()()),2&n){const t=Q(2);L(5),Ye("-$",t.getTotalSavings().toFixed(2),"")}}function dee(n,e){1&n&&(M(0,"span",94),O(1,"FREE"),b())}function fee(n,e){if(1&n&&(M(0,"div",95),U(1,"i",96),O(2),b()),2&n){const t=Q(2);L(2),Ye(" Add $",t.getRemainingForFreeShipping().toFixed(2)," more for free shipping! ")}}function hee(n,e){1&n&&(M(0,"div",184),O(1," Please enter your first name "),b())}function pee(n,e){1&n&&(M(0,"div",184),O(1," Please enter your last name "),b())}function gee(n,e){1&n&&(M(0,"div",184),O(1," Please enter a valid email address "),b())}function mee(n,e){1&n&&(M(0,"div",184),O(1," Please enter a valid phone number "),b())}function _ee(n,e){1&n&&(M(0,"div",184),O(1," Please enter your address "),b())}function vee(n,e){1&n&&(M(0,"div",184),O(1," Please enter your city "),b())}function xee(n,e){1&n&&(M(0,"div",184),O(1," Please select your governorate "),b())}function yee(n,e){1&n&&(M(0,"div",184),O(1," Please enter a valid postal code (4 digits) "),b())}function Mee(n,e){1&n&&(M(0,"div",185)(1,"div",106)(2,"div",107)(3,"label",186),U(4,"i",159),O(5," Card Number * "),b(),U(6,"input",187),b(),M(7,"div",107)(8,"label",188),U(9,"i",189),O(10," Expiry Date * "),b(),U(11,"input",190),b(),M(12,"div",107)(13,"label",191),U(14,"i",182),O(15," CVV * "),b(),U(16,"input",192),b()()())}function bee(n,e){1&n&&(M(0,"div",184),O(1," You must accept the terms and conditions "),b())}function Cee(n,e){if(1&n&&(M(0,"span"),O(1),b()),2&n){const t=Q(3);L(1),Ye("CONFIRM ORDER - $",t.getTotal().toFixed(2),"")}}function wee(n,e){1&n&&(M(0,"span"),U(1,"i",193),O(2," PROCESSING... "),b())}function See(n,e){if(1&n){const t=tn();M(0,"div",97)(1,"div",98)(2,"h3",19),U(3,"i",99),O(4," CHECKOUT INFORMATION "),b(),M(5,"button",100),ge("click",function(){return qe(t),Xe(Q(2).showCheckoutForm=!1)}),U(6,"i",101),b()(),M(7,"form",102),ge("ngSubmit",function(){return qe(t),Xe(Q(2).submitCheckout())}),M(8,"div",103)(9,"div",104),U(10,"i",105),M(11,"span"),O(12,"1. PERSONAL INFORMATION"),b()(),M(13,"div",106)(14,"div",107)(15,"label",108),U(16,"i",109),O(17," First Name * "),b(),U(18,"input",110),ie(19,hee,2,0,"div",111),b(),M(20,"div",107)(21,"label",112),U(22,"i",109),O(23," Last Name * "),b(),U(24,"input",113),ie(25,pee,2,0,"div",111),b(),M(26,"div",107)(27,"label",114),U(28,"i",115),O(29," Email Address * "),b(),U(30,"input",116),ie(31,gee,2,0,"div",111),b(),M(32,"div",107)(33,"label",117),U(34,"i",118),O(35," Phone Number * "),b(),U(36,"input",119),ie(37,mee,2,0,"div",111),b()()(),M(38,"div",103)(39,"div",104),U(40,"i",120),M(41,"span"),O(42,"2. ADDRESS INFORMATION"),b()(),M(43,"div",106)(44,"div",121)(45,"label",122),U(46,"i",123),O(47," Address * "),b(),U(48,"input",124),ie(49,_ee,2,0,"div",111),b(),M(50,"div",107)(51,"label",125),U(52,"i",126),O(53," City * "),b(),U(54,"input",127),ie(55,vee,2,0,"div",111),b(),M(56,"div",107)(57,"label",128),U(58,"i",129),O(59," Governorate * "),b(),M(60,"select",130)(61,"option",131),O(62,"Select Governorate"),b(),M(63,"option",132),O(64,"Tunis"),b(),M(65,"option",133),O(66,"Ariana"),b(),M(67,"option",134),O(68,"Ben Arous"),b(),M(69,"option",135),O(70,"Manouba"),b(),M(71,"option",136),O(72,"Nabeul"),b(),M(73,"option",137),O(74,"Zaghouan"),b(),M(75,"option",138),O(76,"Bizerte"),b(),M(77,"option",139),O(78,"B\xe9ja"),b(),M(79,"option",140),O(80,"Jendouba"),b(),M(81,"option",141),O(82,"Le Kef"),b(),M(83,"option",142),O(84,"Siliana"),b(),M(85,"option",143),O(86,"Sousse"),b(),M(87,"option",144),O(88,"Monastir"),b(),M(89,"option",145),O(90,"Mahdia"),b(),M(91,"option",146),O(92,"Sfax"),b(),M(93,"option",147),O(94,"Kairouan"),b(),M(95,"option",148),O(96,"Kasserine"),b(),M(97,"option",149),O(98,"Sidi Bouzid"),b(),M(99,"option",150),O(100,"Gab\xe8s"),b(),M(101,"option",151),O(102,"M\xe9denine"),b(),M(103,"option",152),O(104,"Tataouine"),b(),M(105,"option",153),O(106,"Gafsa"),b(),M(107,"option",154),O(108,"Tozeur"),b(),M(109,"option",155),O(110,"K\xe9bili"),b()(),ie(111,xee,2,0,"div",111),b(),M(112,"div",107)(113,"label",156),U(114,"i",157),O(115," Postal Code * "),b(),U(116,"input",158),ie(117,yee,2,0,"div",111),b()()(),M(118,"div",103)(119,"div",104),U(120,"i",159),M(121,"span"),O(122,"3. PAYMENT METHOD"),b()(),M(123,"div",160)(124,"label",161),U(125,"input",162),M(126,"div",163)(127,"div",164),U(128,"i",165),b(),M(129,"div",166)(130,"h4"),O(131,"Cash on Delivery"),b(),M(132,"p"),O(133,"Pay when you receive your order"),b()(),M(134,"div",167),U(135,"i",168),b()()(),M(136,"label",161),U(137,"input",169),M(138,"div",163)(139,"div",164),U(140,"i",159),b(),M(141,"div",166)(142,"h4"),O(143,"Credit/Debit Card"),b(),M(144,"p"),O(145,"Pay securely with your card"),b()(),M(146,"div",167),U(147,"i",168),b()()(),M(148,"label",161),U(149,"input",170),M(150,"div",163)(151,"div",164),U(152,"i",171),b(),M(153,"div",166)(154,"h4"),O(155,"Flouci"),b(),M(156,"p"),O(157,"Pay with Flouci wallet"),b()(),M(158,"div",167),U(159,"i",168),b()()()(),ie(160,Mee,17,0,"div",172),b(),M(161,"div",173)(162,"label",174),U(163,"input",175),M(164,"div",176),U(165,"i",168),b(),M(166,"span",177),O(167," I agree to the "),M(168,"a",178),O(169,"Terms and Conditions"),b(),O(170," and "),M(171,"a",178),O(172,"Privacy Policy"),b()()(),ie(173,bee,2,0,"div",111),b(),M(174,"div",179)(175,"button",180),ge("click",function(){return qe(t),Xe(Q(2).showCheckoutForm=!1)}),U(176,"i",8),O(177," CANCEL "),b(),M(178,"button",181),U(179,"i",182),ie(180,Cee,2,1,"span",183),ie(181,wee,3,0,"span",183),b()()()()}if(2&n){const t=Q(2);let i,r,o,s,a,c,l,u,d,f,h,p,_,m,g,v,x,y,S,P,T,I;L(7),J("formGroup",t.checkoutForm),L(11),bt("error",(null==(i=t.checkoutForm.get("firstName"))?null:i.invalid)&&(null==(i=t.checkoutForm.get("firstName"))?null:i.touched)),L(1),J("ngIf",(null==(r=t.checkoutForm.get("firstName"))?null:r.invalid)&&(null==(r=t.checkoutForm.get("firstName"))?null:r.touched)),L(5),bt("error",(null==(o=t.checkoutForm.get("lastName"))?null:o.invalid)&&(null==(o=t.checkoutForm.get("lastName"))?null:o.touched)),L(1),J("ngIf",(null==(s=t.checkoutForm.get("lastName"))?null:s.invalid)&&(null==(s=t.checkoutForm.get("lastName"))?null:s.touched)),L(5),bt("error",(null==(a=t.checkoutForm.get("email"))?null:a.invalid)&&(null==(a=t.checkoutForm.get("email"))?null:a.touched)),L(1),J("ngIf",(null==(c=t.checkoutForm.get("email"))?null:c.invalid)&&(null==(c=t.checkoutForm.get("email"))?null:c.touched)),L(5),bt("error",(null==(l=t.checkoutForm.get("phone"))?null:l.invalid)&&(null==(l=t.checkoutForm.get("phone"))?null:l.touched)),L(1),J("ngIf",(null==(u=t.checkoutForm.get("phone"))?null:u.invalid)&&(null==(u=t.checkoutForm.get("phone"))?null:u.touched)),L(11),bt("error",(null==(d=t.checkoutForm.get("address"))?null:d.invalid)&&(null==(d=t.checkoutForm.get("address"))?null:d.touched)),L(1),J("ngIf",(null==(f=t.checkoutForm.get("address"))?null:f.invalid)&&(null==(f=t.checkoutForm.get("address"))?null:f.touched)),L(5),bt("error",(null==(h=t.checkoutForm.get("city"))?null:h.invalid)&&(null==(h=t.checkoutForm.get("city"))?null:h.touched)),L(1),J("ngIf",(null==(p=t.checkoutForm.get("city"))?null:p.invalid)&&(null==(p=t.checkoutForm.get("city"))?null:p.touched)),L(5),bt("error",(null==(_=t.checkoutForm.get("governorate"))?null:_.invalid)&&(null==(_=t.checkoutForm.get("governorate"))?null:_.touched)),L(51),J("ngIf",(null==(m=t.checkoutForm.get("governorate"))?null:m.invalid)&&(null==(m=t.checkoutForm.get("governorate"))?null:m.touched)),L(5),bt("error",(null==(g=t.checkoutForm.get("postalCode"))?null:g.invalid)&&(null==(g=t.checkoutForm.get("postalCode"))?null:g.touched)),L(1),J("ngIf",(null==(v=t.checkoutForm.get("postalCode"))?null:v.invalid)&&(null==(v=t.checkoutForm.get("postalCode"))?null:v.touched)),L(7),bt("selected","cash"===(null==(x=t.checkoutForm.get("paymentMethod"))?null:x.value)),L(12),bt("selected","card"===(null==(y=t.checkoutForm.get("paymentMethod"))?null:y.value)),L(12),bt("selected","flouci"===(null==(S=t.checkoutForm.get("paymentMethod"))?null:S.value)),L(12),J("ngIf","card"===(null==(P=t.checkoutForm.get("paymentMethod"))?null:P.value)),L(4),bt("checked",null==(T=t.checkoutForm.get("acceptTerms"))?null:T.value),L(9),J("ngIf",(null==(I=t.checkoutForm.get("acceptTerms"))?null:I.invalid)&&(null==(I=t.checkoutForm.get("acceptTerms"))?null:I.touched)),L(5),J("disabled",t.checkoutForm.invalid||t.isSubmitting),L(2),J("ngIf",!t.isSubmitting),L(1),J("ngIf",t.isSubmitting)}}function Pee(n,e){if(1&n){const t=tn();M(0,"div",194)(1,"button",195),ge("click",function(){return qe(t),Xe(Q(2).continueShopping())}),U(2,"i",8),O(3," CONTINUE SHOPPING "),b(),M(4,"button",196),ge("click",function(){return qe(t),Xe(Q(2).clearCart())}),U(5,"i",197),O(6," CLEAR CART "),b(),M(7,"button",198),ge("click",function(){return qe(t),Xe(Q(2).showCheckoutForm=!0)}),U(8,"i",182),O(9),b()()}if(2&n){const t=Q(2);L(9),Ye(" SECURE CHECKOUT - $",t.getTotal().toFixed(2)," ")}}function Eee(n,e){1&n&&(M(0,"div",199)(1,"div",200),U(2,"i",201),M(3,"span"),O(4,"Secure Payment"),b()(),M(5,"div",200),U(6,"i",202),M(7,"span"),O(8,"30-Day Returns"),b()(),M(9,"div",200),U(10,"i",203),M(11,"span"),O(12,"Fast Shipping"),b()()())}function Tee(n,e){if(1&n&&(M(0,"div"),ie(1,JQ,7,3,"div",13),M(2,"div",14),ie(3,lee,50,16,"div",15),b(),M(4,"div",16)(5,"div",17)(6,"div",18)(7,"h3",19),O(8,"ORDER SUMMARY"),b(),M(9,"div",20),U(10,"i",21),M(11,"span",22),O(12),b()()(),M(13,"div",23)(14,"div",24)(15,"span"),O(16),b(),M(17,"span"),O(18),b()(),ie(19,uee,6,1,"div",25),M(20,"div",24)(21,"span"),U(22,"i",26),O(23," Shipping "),ie(24,dee,2,0,"span",27),b(),M(25,"span"),O(26),b()(),M(27,"div",24)(28,"span"),O(29),b(),M(30,"span"),O(31),b()(),U(32,"div",28),M(33,"div",29)(34,"span",30),O(35,"TOTAL"),b(),M(36,"span",31),O(37),b()(),ie(38,fee,3,1,"div",32),b(),ie(39,See,182,38,"div",33),ie(40,Pee,10,1,"div",34),ie(41,Eee,13,0,"div",35),b()()()),2&n){const t=Q();L(1),J("ngIf",!t.hasFreeShipping()&&t.cartItems.length>0),L(2),J("ngForOf",t.cartItems),L(9),xt(t.getTotalItems()),L(4),Ye("Subtotal (",t.getTotalItems()," items)"),L(2),Ye("$",t.getSubtotal().toFixed(2),""),L(1),J("ngIf",t.getTotalSavings()>0),L(5),J("ngIf",t.hasFreeShipping()),L(1),bt("free-shipping",t.hasFreeShipping()),L(1),Ye(" ",t.hasFreeShipping()?"FREE":"$"+t.getShipping().toFixed(2)," "),L(3),Ye("Tax (",100*t.TAX_RATE,"%)"),L(2),Ye("$",t.getTax().toFixed(2),""),L(6),Ye("$",t.getTotal().toFixed(2),""),L(1),J("ngIf",!t.hasFreeShipping()),L(1),J("ngIf",t.showCheckoutForm),L(1),J("ngIf",!t.showCheckoutForm),L(1),J("ngIf",!t.showCheckoutForm)}}function Aee(n,e){if(1&n){const t=tn();M(0,"div",204)(1,"div",205)(2,"div",206),U(3,"i",207)(4,"div",208),b(),M(5,"h3"),O(6,"YOUR CART IS EMPTY"),b(),M(7,"p"),O(8,"Looks like you haven't added any items to your cart yet."),b(),M(9,"button",209),ge("click",function(){return qe(t),Xe(Q().continueShopping())}),U(10,"i",210),O(11," BROWSE FREPPING PRODUCTS "),b(),M(12,"div",211)(13,"span",4),O(14,"LOS SANTOS"),b(),M(15,"span",4),O(16,"CUSTOMS"),b(),M(17,"span",4),O(18,"FREPPING"),b()()()()}}const Iee=["canvas"];function Ree(n,e){1&n&&(M(0,"div",6),U(1,"div",7),M(2,"span",8),O(3,"RECHERCHE DU FOND DE RUE..."),b(),M(4,"div",9),O(5," Test des chemins: assets/shoot_background__graffiti_street.glb "),b()())}function Nee(n,e){if(1&n&&(M(0,"div",27),O(1," \u{1f4cd} Chemin: "),M(2,"code"),O(3),b()()),2&n){const t=Q(2);L(3),xt(t.debugInfo.foundPath)}}function Lee(n,e){if(1&n&&(M(0,"div",28),O(1),b()),2&n){const t=Q(2);L(1),Ye(" \u26a0\ufe0f Erreur: ",t.debugInfo.backgroundError," ")}}function Fee(n,e){if(1&n){const t=tn();M(0,"li")(1,"code",29),ge("click",function(){const o=qe(t).$implicit;return Xe(Q(2).manualPath=o)}),O(2),b()()}if(2&n){const t=e.$implicit;L(2),xt(t)}}function kee(n,e){if(1&n){const t=tn();M(0,"div",10)(1,"div",11)(2,"h3"),O(3,"\u{1f50d} DEBUG PANEL"),b(),M(4,"button",12),ge("click",function(){return qe(t),Xe(Q().showDebugPanel=!1)}),O(5,"\xd7"),b()(),M(6,"div",13)(7,"h4"),O(8,"\u{1f3af} FOND DE RUE"),b(),M(9,"div",14)(10,"span",15),O(11),b(),M(12,"span",16),O(13),b()(),ie(14,Nee,4,1,"div",17),ie(15,Lee,2,1,"div",18),b(),M(16,"div",13)(17,"h4"),O(18,"\u{1f9ea} TEST MANUEL"),b(),M(19,"div",19)(20,"input",20),ge("ngModelChange",function(r){return qe(t),Xe(Q().manualPath=r)}),b(),M(21,"button",21),ge("click",function(){return qe(t),Xe(Q().testManualPath())}),O(22," Tester ce chemin "),b()(),M(23,"div",22)(24,"h5"),O(25,"Chemins sugg\xe9r\xe9s:"),b(),M(26,"ul"),ie(27,Fee,3,1,"li",23),b()()(),M(28,"div",13)(29,"h4"),O(30,"\u{1f4c1} ASSETS"),b(),M(31,"button",24),ge("click",function(){return qe(t),Xe(Q().checkAssetStructure())}),O(32," V\xe9rifier la structure des fichiers "),b()(),M(33,"div",25)(34,"span",26),O(35),b(),M(36,"span",26),O(37),b()()()}if(2&n){const t=Q();L(9),bt("success",t.debugInfo.backgroundLoaded),L(2),xt(t.debugInfo.backgroundLoaded?"\u2705":"\u274c"),L(2),Ye(" ",t.debugInfo.backgroundLoaded?"CHARG\xc9":"NON TROUV\xc9"," "),L(1),J("ngIf",t.debugInfo.foundPath),L(1),J("ngIf",t.debugInfo.backgroundError),L(5),J("ngModel",t.manualPath),L(7),J("ngForOf",t.backgroundPaths),L(8),Ye("\u{1f441}\ufe0f Objets: ",(null==t.children?null:t.children.length)||0,""),L(2),Ye("\u{1f3af} Rotation: ",t.autoRotate?"ON":"OFF","")}}function Uee(n,e){if(1&n){const t=tn();M(0,"button",30),ge("click",function(){return qe(t),Xe(Q().showDebugPanel=!0)}),O(1," \u{1f50d} DEBUG "),b()}}const Bee=[{path:"",component:fJ},{path:"shop",component:wQ},{path:"product/:id",component:$Q},{path:"try-on",component:qQ},{path:"cart",component:(()=>{class n{constructor(t,i,r){this.cartService=t,this.router=i,this.fb=r,this.cartItems=[],this.showCheckoutForm=!1,this.isSubmitting=!1,this.EMAILJS_CONFIG={SERVICE_ID:"service_xfoa9an",TEMPLATE_ID:"template_oozt5vf",PUBLIC_KEY:"2w26KF5jldH41vNeR",RECEIVER_EMAIL:"oussamajb02@gmail.com",SENDER_NAME:"FREPPING Store"},this.TAX_RATE=.085,this.SHIPPING_THRESHOLD=100,this.SHIPPING_COST=9.99,this.subtotal=0,this.shippingCost=0,this.taxAmount=0,this.total=0,this.discountAmount=0,this.cartItems$=this.cartService.cartItems$,this.checkoutForm=this.fb.group({}),this.initializeForm(),((n,e="https://api.emailjs.com")=>{Pf._userID=n,Pf._origin=e})(this.EMAILJS_CONFIG.PUBLIC_KEY)}ngOnInit(){this.cartSubscription=this.cartItems$.subscribe(t=>{this.cartItems=t,this.calculateCartSummary()}),this.loadSavedFormData()}ngOnDestroy(){this.cartSubscription&&this.cartSubscription.unsubscribe()}initializeForm(){this.checkoutForm=this.fb.group({firstName:["",[Rn.required,Rn.minLength(2)]],lastName:["",[Rn.required,Rn.minLength(2)]],email:["",[Rn.required,Rn.email]],phone:["",[Rn.required,Rn.pattern(/^\+?[0-9\s\-\(\)]{8,}$/)]],address:["",Rn.required],city:["",Rn.required],governorate:["",Rn.required],postalCode:["",[Rn.required,Rn.pattern(/^[0-9]{4}$/)]],paymentMethod:["cash",Rn.required],cardNumber:[""],expiryDate:[""],cvv:[""],acceptTerms:[!1,Rn.requiredTrue]}),this.checkoutForm.get("paymentMethod")?.valueChanges.subscribe(t=>{const i=this.checkoutForm.get("cardNumber"),r=this.checkoutForm.get("expiryDate"),o=this.checkoutForm.get("cvv");"card"===t?(i?.setValidators([Rn.required,Rn.pattern(/^[0-9]{16}$/)]),r?.setValidators([Rn.required,Rn.pattern(/^(0[1-9]|1[0-2])\/[0-9]{2}$/)]),o?.setValidators([Rn.required,Rn.pattern(/^[0-9]{3}$/)])):(i?.clearValidators(),r?.clearValidators(),o?.clearValidators()),i?.updateValueAndValidity(),r?.updateValueAndValidity(),o?.updateValueAndValidity()}),this.checkoutForm.get("cardNumber")?.valueChanges.subscribe(t=>{if(t){const i=t.replace(/\s/g,"").replace(/(\d{4})/g,"$1 ").trim();t!==i&&this.checkoutForm.get("cardNumber")?.setValue(i,{emitEvent:!1})}})}loadSavedFormData(){const t=localStorage.getItem("checkoutFormData");if(t)try{const i=JSON.parse(t);this.checkoutForm.patchValue(i)}catch(i){console.error("Error loading saved form data:",i)}}saveFormData(){localStorage.setItem("checkoutFormData",JSON.stringify(this.checkoutForm.value))}onInputEnter(t){t.target.blur()}goBack(){this.router.navigate(["/shop"])}removeFromCart(t){this.cartService.removeFromCart(t)}clearCart(){this.cartService.clearCart()}updateQuantity(t,i){const r=Math.max(1,Math.floor(Number(i)));isNaN(r)?console.error("Invalid quantity value"):this.cartService.updateQuantity(t,r)}getProductById(t){return Vp.find(i=>i.id===t)}getItemTotal(t){const i=this.getProductById(t.product.id);let r=t.product.price;return i?.originalPrice&&i.originalPrice>r&&(r=i.price),Math.round(r*t.quantity*100)/100}getItemSavings(t){const i=this.getProductById(t.product.id);return i?.originalPrice&&i.originalPrice>i.price?Math.round((i.originalPrice-i.price)*t.quantity*100)/100:0}calculateCartSummary(){this.subtotal=this.cartItems.reduce((t,i)=>t+this.getItemTotal(i),0),this.discountAmount=this.cartItems.reduce((t,i)=>t+this.getItemSavings(i),0),this.shippingCost=this.subtotal>=this.SHIPPING_THRESHOLD||0===this.cartItems.length?0:this.SHIPPING_COST,this.taxAmount=Math.round(this.subtotal*this.TAX_RATE*100)/100,this.total=Math.round(100*(this.subtotal+this.shippingCost+this.taxAmount))/100}getSubtotal(){return this.subtotal}getTax(){return this.taxAmount}getShipping(){return this.shippingCost}getTotal(){return this.total}getTotalSavings(){return this.discountAmount}hasFreeShipping(){return this.subtotal>=this.SHIPPING_THRESHOLD}getRemainingForFreeShipping(){return this.hasFreeShipping()||0===this.cartItems.length?0:Math.max(0,this.SHIPPING_THRESHOLD-this.subtotal)}getTotalItems(){return this.cartItems.reduce((t,i)=>t+i.quantity,0)}continueShopping(){this.router.navigate(["/shop"])}proceedToCheckout(){0!==this.cartItems.length?this.showCheckoutForm=!0:console.warn("Cart is empty! Add items before checkout.")}formatCurrency(t){return`$${t.toFixed(2)}`}isItemOnSale(t){const i=this.getProductById(t);return!!(i?.originalPrice&&i.originalPrice>i.price)}getItemDiscountPercentage(t){const i=this.getProductById(t);return i?.originalPrice&&i.originalPrice>i.price?Math.round((i.originalPrice-i.price)/i.originalPrice*100):0}submitCheckout(){if(this.checkoutForm.invalid)return void Object.keys(this.checkoutForm.controls).forEach(i=>{this.checkoutForm.get(i)?.markAsTouched()});this.isSubmitting=!0;const t={...this.checkoutForm.value,cartItems:this.cartItems,subtotal:this.subtotal,shipping:this.shippingCost,tax:this.taxAmount,total:this.total,orderDate:(new Date).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),orderId:"ORD-"+Date.now()+"-"+Math.random().toString(36).substr(2,9).toUpperCase(),itemsCount:this.getTotalItems(),hasFreeShipping:this.hasFreeShipping(),itemsList:this.generateItemsList(),itemsText:this.generateItemsListText()};this.saveFormData(),this.sendOrderEmail(t)}generateItemsList(){let t="";return this.cartItems.forEach(i=>{const r=this.getItemTotal(i);t+=`${i.quantity}x ${i.product.name} - $${r.toFixed(2)}\n`}),t}generateItemsListText(){return this.cartItems.map(t=>{const i=this.getItemTotal(t);return`${t.quantity}x ${t.product.name} - $${i.toFixed(2)}`}).join("\n")}sendOrderEmail(t){var i=this;return ki(function*(){try{const r={to_email:i.EMAILJS_CONFIG.RECEIVER_EMAIL,to_name:i.EMAILJS_CONFIG.SENDER_NAME,from_name:`${t.firstName} ${t.lastName}`,from_email:t.email,reply_to:t.email,order_id:t.orderId,order_date:t.orderDate,customer_name:`${t.firstName} ${t.lastName}`,customer_email:t.email,customer_phone:t.phone,customer_address:`\n          ${t.address}\n          ${t.city}, ${t.governorate}\n          Postal Code: ${t.postalCode}\n        `,payment_method:i.getPaymentMethodName(t.paymentMethod),subtotal:`$${t.subtotal.toFixed(2)}`,shipping_cost:t.hasFreeShipping?"FREE":`$${t.shipping.toFixed(2)}`,tax_amount:`$${t.tax.toFixed(2)}`,total_amount:`$${t.total.toFixed(2)}`,items_count:t.itemsCount.toString(),items_list:t.itemsList,items_text:t.itemsText,store_name:"FREPPING",store_email:"info@frepping.com",store_phone:"+216 XX XXX XXX",store_address:"Los Santos Customs, FREPPING Headquarters"},o=yield a3_send(i.EMAILJS_CONFIG.SERVICE_ID,i.EMAILJS_CONFIG.TEMPLATE_ID,r);console.log("Email sent successfully:",o),localStorage.setItem("lastOrder",JSON.stringify(t)),i.cartService.clearCart(),i.showOrderSuccess(t),setTimeout(()=>{i.checkoutForm.reset({paymentMethod:"cash",acceptTerms:!1}),i.showCheckoutForm=!1,i.isSubmitting=!1},3e3)}catch(r){console.error("Failed to send email:",r),i.isSubmitting=!1,i.showEmailError(t)}})()}getPaymentMethodName(t){switch(t){case"cash":return"Cash on Delivery";case"card":return"Credit/Debit Card";case"flouci":return"Flouci Wallet";default:return"Unknown"}}showEmailError(t){localStorage.setItem("lastOrder",JSON.stringify(t)),this.cartService.clearCart();const i=document.createElement("div");i.className="order-error-notification",i.innerHTML=`\n      <div class="error-content">\n        <i class="fas fa-exclamation-triangle"></i>\n        <h3>ORDER PLACED BUT EMAIL FAILED</h3>\n        <p>Your order #${t.orderId} has been saved.</p>\n        <p>Total: $${t.total.toFixed(2)}</p>\n        <p>We couldn't send the confirmation email. Please save your order number.</p>\n        <p class="order-id-highlight">${t.orderId}</p>\n      </div>\n    `,document.body.appendChild(i),setTimeout(()=>{i.parentNode&&i.parentNode.removeChild(i),this.router.navigate(["/"])},5e3)}showOrderSuccess(t){const i=document.createElement("div");i.className="order-success-notification",i.innerHTML=`\n      <div class="success-content">\n        <i class="fas fa-check-circle"></i>\n        <h3>ORDER CONFIRMED!</h3>\n        <p>Your order #${t.orderId} has been placed successfully.</p>\n        <p>Total: $${t.total.toFixed(2)}</p>\n        <p>A confirmation email has been sent to ${t.email}</p>\n        <p class="order-note">You will also receive an SMS confirmation shortly.</p>\n      </div>\n    `,document.body.appendChild(i),setTimeout(()=>{i.parentNode&&i.parentNode.removeChild(i),this.router.navigate(["/"])},5e3)}static{this.\u0275fac=function(i){return new(i||n)(te(Ed),te(Xn),te(rQ))}}static{this.\u0275cmp=Zi({type:n,selectors:[["app-cart"]],decls:17,vars:3,consts:[[1,"cart","page-container","shop"],[1,"cart-header","shop-header"],[1,"cart-title","shop-title"],[1,"cart-header-subtitle"],[1,"street-tag"],["class","cart-count-badge",4,"ngIf"],[1,"details-header"],[1,"back-button",3,"click"],[1,"fas","fa-arrow-left"],[1,"cart-section"],[4,"ngIf","ngIfElse"],["emptyCart",""],[1,"cart-count-badge"],["class","shipping-progress",4,"ngIf"],[1,"cart-modern-grid","products-modern-grid","grid-large"],["class","modern-cart-item modern-product",4,"ngFor","ngForOf"],[1,"cart-summary-modern"],[1,"summary-panel"],[1,"summary-header"],[1,"street-title"],[1,"summary-icon"],[1,"fas","fa-clipboard-list"],[1,"item-count"],[1,"summary-details"],[1,"summary-row"],["class","summary-row discount",4,"ngIf"],[1,"fas","fa-shipping-fast"],["class","free-badge",4,"ngIf"],[1,"summary-divider"],[1,"summary-row","total"],[1,"total-label"],[1,"total-amount"],["class","summary-note",4,"ngIf"],["class","checkout-form-modern",4,"ngIf"],["class","cart-actions-modern",4,"ngIf"],["class","security-badges",4,"ngIf"],[1,"shipping-progress"],[1,"progress-label"],[1,"progress-bar"],[1,"progress-fill"],[1,"modern-cart-item","modern-product"],[1,"modern-cart-image","modern-product-image"],[1,"gta-panels"],[1,"gta-panel","panel-1"],[1,"gta-panel","panel-2"],[1,"gta-panel","panel-3"],[1,"product-img-container"],["class","cart-img product-img","onerror","this.onerror=null; this.src='assets/images/products/placeholder.png'",3,"src","alt",4,"ngIf","ngIfElse"],["placeholder",""],[1,"modern-indicators"],["class","modern-badge sale",4,"ngIf"],["class","modern-badge new",4,"ngIf"],["class","modern-badge quantity",4,"ngIf"],[1,"modern-quick-actions"],["title","Remove item",1,"modern-quick-btn",3,"click"],[1,"fas","fa-trash"],["title","Add one more",1,"modern-quick-btn",3,"click"],[1,"fas","fa-plus"],[1,"modern-cart-content","modern-product-content"],[1,"modern-cart-info","modern-product-info"],[1,"modern-brand"],[1,"modern-product-name"],[1,"modern-category"],[1,"modern-price-section"],[1,"modern-price"],[1,"modern-current"],["class","modern-original",4,"ngIf"],["class","savings-badge",4,"ngIf"],[1,"modern-material"],["class","item-details",4,"ngIf"],[1,"modern-qty"],[1,"street-label"],[1,"qty-controls"],[1,"qty-btn","minus",3,"disabled","click"],[1,"fas","fa-minus"],["type","number","min","1",1,"street-input",3,"value","change","keyup.enter","blur"],[1,"qty-btn","plus",3,"click"],[1,"item-total"],["onerror","this.onerror=null; this.src='assets/images/products/placeholder.png'",1,"cart-img","product-img",3,"src","alt"],[1,"cart-img-placeholder","product-img-placeholder"],[1,"fas","fa-tshirt"],[1,"modern-badge","sale"],[1,"modern-badge","new"],[1,"modern-badge","quantity"],[1,"modern-original"],[1,"savings-badge"],[1,"fas","fa-tag"],[1,"item-details"],["class","detail-row",4,"ngIf"],[1,"detail-row"],[1,"detail-label"],[1,"detail-value"],[1,"summary-row","discount"],[1,"discount-amount"],[1,"free-badge"],[1,"summary-note"],[1,"fas","fa-info-circle"],[1,"checkout-form-modern"],[1,"form-header"],[1,"fas","fa-user-check"],[1,"close-form-btn",3,"click"],[1,"fas","fa-times"],[3,"formGroup","ngSubmit"],[1,"form-section"],[1,"section-title"],[1,"fas","fa-id-card"],[1,"form-grid"],[1,"form-group"],["for","firstName"],[1,"fas","fa-user"],["type","text","id","firstName","formControlName","firstName","placeholder","Enter your first name",1,"street-input"],["class","error-message",4,"ngIf"],["for","lastName"],["type","text","id","lastName","formControlName","lastName","placeholder","Enter your last name",1,"street-input"],["for","email"],[1,"fas","fa-envelope"],["type","email","id","email","formControlName","email","placeholder","your.email@example.com",1,"street-input"],["for","phone"],[1,"fas","fa-phone"],["type","tel","id","phone","formControlName","phone","placeholder","+216 XX XXX XXX",1,"street-input"],[1,"fas","fa-map-marker-alt"],[1,"form-group","full-width"],["for","address"],[1,"fas","fa-home"],["type","text","id","address","formControlName","address","placeholder","Street address, building, apartment",1,"street-input"],["for","city"],[1,"fas","fa-city"],["type","text","id","city","formControlName","city","placeholder","Enter your city",1,"street-input"],["for","governorate"],[1,"fas","fa-landmark"],["id","governorate","formControlName","governorate",1,"street-select"],["value",""],["value","tunis"],["value","ariana"],["value","benarous"],["value","manouba"],["value","nabeul"],["value","zaghouan"],["value","bizerte"],["value","beja"],["value","jendouba"],["value","kef"],["value","siliana"],["value","sousse"],["value","monastir"],["value","mahdia"],["value","sfax"],["value","kairouan"],["value","kasserine"],["value","sidi_bouzid"],["value","gabes"],["value","medenine"],["value","tataouine"],["value","gafsa"],["value","tozeur"],["value","kebili"],["for","postalCode"],[1,"fas","fa-mail-bulk"],["type","text","id","postalCode","formControlName","postalCode","placeholder","XXXX","maxlength","4",1,"street-input"],[1,"fas","fa-credit-card"],[1,"payment-methods"],[1,"payment-option"],["type","radio","formControlName","paymentMethod","value","cash","hidden",""],[1,"payment-content"],[1,"payment-icon"],[1,"fas","fa-money-bill-wave"],[1,"payment-info"],[1,"payment-check"],[1,"fas","fa-check"],["type","radio","formControlName","paymentMethod","value","card","hidden",""],["type","radio","formControlName","paymentMethod","value","flouci","hidden",""],[1,"fas","fa-mobile-alt"],["class","card-details",4,"ngIf"],[1,"terms-section"],[1,"terms-checkbox"],["type","checkbox","formControlName","acceptTerms","hidden",""],[1,"custom-checkbox"],[1,"terms-text"],["href","#",1,"terms-link"],[1,"form-actions"],["type","button",1,"btn-modern","secondary-btn",3,"click"],["type","submit",1,"btn-modern","checkout-btn",3,"disabled"],[1,"fas","fa-lock"],[4,"ngIf"],[1,"error-message"],[1,"card-details"],["for","cardNumber"],["type","text","id","cardNumber","formControlName","cardNumber","placeholder","XXXX XXXX XXXX XXXX","maxlength","19",1,"street-input"],["for","expiryDate"],[1,"fas","fa-calendar-alt"],["type","text","id","expiryDate","formControlName","expiryDate","placeholder","MM/YY",1,"street-input"],["for","cvv"],["type","text","id","cvv","formControlName","cvv","placeholder","123","maxlength","3",1,"street-input"],[1,"fas","fa-spinner","fa-spin"],[1,"cart-actions-modern"],[1,"btn-modern","secondary-btn",3,"click"],[1,"btn-modern","danger-btn",3,"click"],[1,"fas","fa-trash-alt"],[1,"btn-modern","checkout-btn",3,"click"],[1,"security-badges"],[1,"security-badge"],[1,"fas","fa-shield-alt"],[1,"fas","fa-undo"],[1,"fas","fa-truck"],[1,"no-products-modern"],[1,"modern-empty-state","cart-empty-state"],[1,"empty-cart-icon"],[1,"fas","fa-shopping-cart"],[1,"empty-cart-pulse"],[1,"btn-modern",3,"click"],[1,"fas","fa-store"],[1,"empty-cart-tagline"]],template:function(i,r){if(1&i&&(M(0,"div",0)(1,"header",1)(2,"h1",2),O(3,"CART"),b(),M(4,"div",3)(5,"span",4),O(6,"LOS SANTOS MERCH"),b(),ie(7,KQ,2,1,"span",5),b()(),M(8,"div",6)(9,"div",7),ge("click",function(){return r.goBack()}),U(10,"i",8),O(11," BACK "),b()(),M(12,"section",9),ie(13,Tee,42,17,"div",10),ie(14,Aee,19,0,"ng-template",null,11,Cs),b()(),U(16,"app-bottom-nav")),2&i){const o=Ms(15);L(7),J("ngIf",r.cartItems.length>0),L(6),J("ngIf",r.cartItems.length>0)("ngIfElse",o)}},dependencies:[Ps,jo,UR,Tb,Ob,Zl,ub,Sf,Cb,am,SR,Ib,_m,Eb,sl],styles:['@charset "UTF-8";.cart.page-container[_ngcontent-%COMP%]{background:#0b0f0c;min-height:100vh;padding-bottom:60px;position:relative;overflow-x:hidden}.cart.page-container[_ngcontent-%COMP%]:before{content:"";position:fixed;inset:0;background-image:radial-gradient(circle at 20% 30%,rgba(57,255,20,.05) 0%,transparent 50%),radial-gradient(circle at 80% 70%,rgba(255,153,0,.05) 0%,transparent 50%),linear-gradient(45deg,#0b0f0c 25%,#0f1f14 25%,#0f1f14 50%,#0b0f0c 50%,#0b0f0c 75%,#0f1f14 75%,#0f1f14);background-size:5px 5px,5px 5px,10px 10px;z-index:-1;opacity:.3}.cart-header[_ngcontent-%COMP%]{background:#000;padding:40px 20px 30px;border-bottom:4px solid #39ff14;position:relative;overflow:hidden;text-align:center}.cart-header[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(45deg,transparent 48%,rgba(57,255,20,.1) 50%,transparent 52%),linear-gradient(-45deg,transparent 48%,rgba(57,255,20,.1) 50%,transparent 52%);background-size:20px 20px}.cart-title[_ngcontent-%COMP%]{font-family:Street,Pricedown,sans-serif;font-size:62px;color:#39ff14;text-align:center;letter-spacing:4px;margin-bottom:15px;text-shadow:3px 3px 0 #000,-1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000,1px 1px 0 #000;position:relative;z-index:1}.cart-header-subtitle[_ngcontent-%COMP%]{position:relative;z-index:1;display:flex;justify-content:center;align-items:center;gap:20px;flex-wrap:wrap}.street-tag[_ngcontent-%COMP%]{background:#000;color:#39ff14;padding:8px 20px;border:2px solid #39ff14;font-family:Street,Pricedown,sans-serif;letter-spacing:3px;text-transform:uppercase;font-size:14px;display:inline-block;transform:skew(-5deg);box-shadow:3px 3px #000;transition:all .3s ease}.street-tag[_ngcontent-%COMP%]:hover{background:#39ff14;color:#000;transform:skew(-5deg) translate(-2px,-2px);box-shadow:5px 5px #000}.cart-count-badge[_ngcontent-%COMP%]{background:#39ff14;color:#000;padding:8px 20px;border:2px solid #000;font-family:Street,Pricedown,sans-serif;letter-spacing:2px;font-size:16px;font-weight:900;transform:skew(-5deg);display:inline-block;box-shadow:4px 4px #000;position:relative;overflow:hidden}.cart-count-badge[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.3),transparent);transition:.5s}.cart-count-badge[_ngcontent-%COMP%]:hover:before{left:100%}.cart-section[_ngcontent-%COMP%]{position:relative;z-index:2}.shipping-progress[_ngcontent-%COMP%]{background:#000;border:3px solid #39ff14;padding:20px;margin:30px auto;max-width:800px;transform:skew(-3deg);position:relative;overflow:hidden;box-shadow:8px 8px #000}.shipping-progress[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;left:0;right:0;height:4px;background:repeating-linear-gradient(90deg,#ff9900,#ff9900 10px,transparent 10px,transparent 20px)}.progress-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px;color:#39ff14;font-family:Oswald,sans-serif;margin-bottom:15px;font-size:16px;letter-spacing:1px;transform:skew(3deg)}.progress-label[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px;color:#f90}.progress-bar[_ngcontent-%COMP%]{height:12px;background:#222;border:2px solid #000;overflow:hidden;position:relative;transform:skew(3deg)}.progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#39ff14,#ff9900);transition:width .5s ease;position:relative;overflow:hidden}.progress-fill[_ngcontent-%COMP%]:after{content:"";position:absolute;inset:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);animation:_ngcontent-%COMP%_shimmer 2s infinite}@keyframes _ngcontent-%COMP%_shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}.cart-modern-grid[_ngcontent-%COMP%]{display:grid;gap:35px;padding:40px 20px;max-width:1400px;margin:0 auto}.modern-cart-item[_ngcontent-%COMP%]{background:linear-gradient(160deg,#e3efcd 0%,#cbdca8 100%);border:4px solid #000;border-radius:0;transform:skew(-3deg);box-shadow:10px 10px #000;transition:all .2s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;z-index:1;animation:_ngcontent-%COMP%_cartSlideIn .4s ease-out forwards}.modern-cart-item[_ngcontent-%COMP%]:hover{transform:skew(-3deg) translate(-4px,-4px);box-shadow:16px 16px #000;z-index:10;background:linear-gradient(160deg,#eaf4da 0%,#d4e2b6 100%)}@keyframes _ngcontent-%COMP%_cartSlideIn{0%{opacity:0;transform:translate(-30px) skew(-3deg)}to{opacity:1;transform:translate(0) skew(-3deg)}}.modern-cart-image[_ngcontent-%COMP%]{background:#000;height:320px;border-bottom:4px solid #000;position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center}.modern-cart-image[_ngcontent-%COMP%]:after{content:"";position:absolute;inset:0;background:linear-gradient(to bottom,transparent 70%,rgba(0,0,0,.2));z-index:2}.gta-panels[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;inset:0;display:flex;justify-content:center;align-items:center;gap:10px;overflow:hidden;z-index:0}.gta-panel[_ngcontent-%COMP%]{background:linear-gradient(to bottom,rgba(0,0,0,.2),rgba(0,0,0,.8)),url(bg1.54feb52e8cf9f583.jpg);background-size:cover;background-position:center;border:2px solid #000;box-shadow:8px 8px #000;position:relative}.gta-panel[_ngcontent-%COMP%]:after{content:"";position:absolute;inset:0;background:linear-gradient(120deg,rgba(255,255,255,.1),rgba(0,0,0,.1))}.gta-panel.panel-1[_ngcontent-%COMP%]{flex:.8;height:55%;transform:rotate(-5deg) translateY(10px);will-change:transform;animation:_ngcontent-%COMP%_float-1 3s ease-in-out infinite alternate}.gta-panel.panel-2[_ngcontent-%COMP%]{flex:1;height:80%;transform:rotate(0) scale(1.1);z-index:2;will-change:transform;animation:_ngcontent-%COMP%_float-2 4s ease-in-out infinite alternate}.gta-panel.panel-3[_ngcontent-%COMP%]{flex:.6;height:55%;transform:rotate(5deg) translateY(10px);will-change:transform;animation:_ngcontent-%COMP%_float-3 3.5s ease-in-out infinite alternate}@keyframes _ngcontent-%COMP%_float-1{0%{transform:rotate(-5deg) translateY(10px) translate(0)}to{transform:rotate(-5deg) translateY(10px) translate(5px,-5px)}}@keyframes _ngcontent-%COMP%_float-2{0%{transform:rotate(0) scale(1.1) translate(0)}to{transform:rotate(0) scale(1.1) translate(-5px,5px)}}@keyframes _ngcontent-%COMP%_float-3{0%{transform:rotate(5deg) translateY(10px) translate(0)}to{transform:rotate(5deg) translateY(10px) translate(8px,8px)}}.product-img-container[_ngcontent-%COMP%]{z-index:2;position:relative;width:100%;height:100%;display:flex;align-items:center;justify-content:center;padding:20px}.cart-img[_ngcontent-%COMP%]{max-width:100%;max-height:100%;object-fit:contain;filter:drop-shadow(5px 5px 0 rgba(0,0,0,.3)) contrast(1.1);mix-blend-mode:multiply}.cart-img-placeholder[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:15px;color:#39ff14;font-size:24px;z-index:2;position:relative}.cart-img-placeholder[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:64px;opacity:.5}.cart-img-placeholder[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-family:Street,Pricedown,sans-serif;font-size:32px;letter-spacing:3px;text-shadow:2px 2px 0 #000}.modern-indicators[_ngcontent-%COMP%]{position:absolute;top:15px;left:15px;display:flex;flex-direction:column;gap:10px;z-index:3}.modern-badge[_ngcontent-%COMP%]{padding:8px 15px;border-radius:0;border:2px solid #000;transform:skew(-10deg);font-size:12px;font-weight:900;letter-spacing:1px;text-transform:uppercase;font-family:Street,Pricedown,sans-serif;box-shadow:3px 3px #0000004d;z-index:4;display:flex;align-items:center;justify-content:center}.modern-badge.sale[_ngcontent-%COMP%]{background:#ffcc00;color:#000}.modern-badge.new[_ngcontent-%COMP%]{background:#39ff14;color:#000}.modern-badge.quantity[_ngcontent-%COMP%]{background:#ff9900;color:#000}.modern-badge.out[_ngcontent-%COMP%]{background:#ff3333;color:#fff}.modern-quick-actions[_ngcontent-%COMP%]{position:absolute;top:15px;right:15px;display:flex;flex-direction:column;gap:10px;opacity:0;transform:translate(20px) skew(2deg);transition:all .3s ease;z-index:3}.modern-cart-item[_ngcontent-%COMP%]:hover   .modern-quick-actions[_ngcontent-%COMP%]{opacity:1;transform:translate(0) skew(2deg)}.modern-quick-btn[_ngcontent-%COMP%]{width:42px;height:42px;border-radius:0;border:2px solid #000;background:#fff;color:#000;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s ease;font-size:18px;transform:skew(2deg);box-shadow:3px 3px #000}.modern-quick-btn[_ngcontent-%COMP%]:hover{background:#39ff14;color:#000;transform:skew(2deg) translate(-2px,-2px);box-shadow:5px 5px #000}.modern-quick-btn[_ngcontent-%COMP%]:active{transform:skew(2deg) translate(0);box-shadow:2px 2px #000}.modern-cart-content[_ngcontent-%COMP%]{position:relative;z-index:2;background:#fff;color:#000;border-top:4px solid #000;padding:25px;display:flex;flex-direction:column;flex:1;gap:20px}.modern-cart-info[_ngcontent-%COMP%]{flex:1;margin-bottom:10px}.modern-brand[_ngcontent-%COMP%]{color:#777;font-size:12px;letter-spacing:2px;text-transform:uppercase;margin-bottom:8px;font-family:Oswald,sans-serif;font-weight:600}.modern-product-name[_ngcontent-%COMP%]{font-family:Street,Pricedown,sans-serif;text-transform:uppercase;letter-spacing:1.5px;color:#000;font-size:22px;margin:0 0 10px;font-weight:900;line-height:1.2;text-shadow:1px 1px 0 rgba(0,0,0,.1);position:relative}.modern-product-name[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-5px;left:0;width:60px;height:3px;background:#ff9900}.modern-category[_ngcontent-%COMP%]{color:#39ff14;font-size:14px;text-transform:uppercase;letter-spacing:1px;margin-bottom:15px;font-family:Oswald,sans-serif;font-weight:600;background:#000;padding:4px 10px;display:inline-block;transform:skew(-5deg);box-shadow:2px 2px #000}.modern-price-section[_ngcontent-%COMP%]{margin:15px 0}.modern-price[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px;margin-bottom:5px}.modern-current[_ngcontent-%COMP%]{color:#000;font-size:28px;font-weight:900;font-family:Street,Pricedown,sans-serif;text-shadow:2px 2px 0 rgba(0,0,0,.1);position:relative}.modern-current[_ngcontent-%COMP%]:before{content:"$";font-size:18px;vertical-align:super;margin-right:2px}.modern-original[_ngcontent-%COMP%]{color:#777;font-size:18px;text-decoration:line-through;font-weight:600;font-family:Oswald,sans-serif}.savings-badge[_ngcontent-%COMP%]{background:#ff9900;color:#000;padding:5px 10px;font-size:13px;font-family:Street,Pricedown,sans-serif;display:inline-block;margin:5px 0;transform:skew(-5deg);border:2px solid #000;box-shadow:3px 3px #000;display:flex;align-items:center;gap:6px}.savings-badge[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:12px}.modern-material[_ngcontent-%COMP%]{color:#555;font-size:12px;letter-spacing:.5px;font-style:italic;font-family:Oswald,sans-serif;border-top:1px dashed #ccc;padding-top:8px;margin-top:8px}.item-details[_ngcontent-%COMP%]{margin:15px 0;border-top:1px dashed #ccc;padding-top:12px}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:13px;margin-bottom:5px;padding:3px 0}.detail-label[_ngcontent-%COMP%]{color:#777;font-weight:600;font-family:Oswald,sans-serif;text-transform:uppercase;letter-spacing:.5px}.detail-value[_ngcontent-%COMP%]{color:#000;font-family:Street,Pricedown,sans-serif;font-weight:600;letter-spacing:1px}.modern-qty[_ngcontent-%COMP%]{margin-top:20px}.street-label[_ngcontent-%COMP%]{display:block;font-family:Street,Pricedown,sans-serif;color:#000;font-size:16px;margin-bottom:12px;letter-spacing:2px;text-transform:uppercase;font-weight:900}.qty-controls[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center;background:#000;padding:8px;border:3px solid #39ff14;transform:skew(-5deg);max-width:250px;box-shadow:4px 4px #000}.street-input[_ngcontent-%COMP%]{flex:1;background:#fff;border:2px solid #000;color:#000;font-size:20px;padding:10px;text-align:center;font-family:Street,Pricedown,sans-serif;font-weight:900;outline:none;transform:skew(5deg);min-width:70px;box-shadow:inset 2px 2px #ddd}.street-input[_ngcontent-%COMP%]:focus{border-color:#f90;box-shadow:inset 2px 2px #ddd,0 0 0 2px #ff99004d}.qty-btn[_ngcontent-%COMP%]{width:46px;height:46px;background:#39ff14;border:2px solid #000;color:#000;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:900;transition:all .3s ease;transform:skew(5deg);box-shadow:3px 3px #000}.qty-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#ff9900;transform:skew(5deg) translate(-2px,-2px);box-shadow:5px 5px #000}.qty-btn[_ngcontent-%COMP%]:active:not(:disabled){transform:skew(5deg) translate(0);box-shadow:2px 2px #000}.qty-btn[_ngcontent-%COMP%]:disabled{background:#ccc;color:#777;cursor:not-allowed;box-shadow:1px 1px #777;transform:skew(5deg)}.item-total[_ngcontent-%COMP%]{border-top:3px dashed #000;margin-top:15px;display:flex;justify-content:space-between;align-items:center;background:#000;padding:15px;border:2px solid #39ff14;transform:skew(-3deg)}.total-label[_ngcontent-%COMP%]{font-family:Street,Pricedown,sans-serif;color:#fff;font-size:20px;letter-spacing:2px;text-transform:uppercase;font-weight:900}.total-amount[_ngcontent-%COMP%]{font-family:Street,Pricedown,sans-serif;color:#39ff14;font-size:28px;font-weight:900;background:#000;padding:5px 15px;border:2px solid #39ff14;transform:skew(-5deg);box-shadow:4px 4px #000;position:relative;overflow:hidden}.total-amount[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(57,255,20,.2),transparent);animation:_ngcontent-%COMP%_shimmer 2s infinite}.cart-summary-modern[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto 60px;padding:0 20px}.summary-panel[_ngcontent-%COMP%]{background:linear-gradient(160deg,#e3efcd 0%,#cbdca8 100%);border:4px solid #000;transform:skew(-2deg);box-shadow:15px 15px #000;padding:40px;position:relative;overflow:hidden}.summary-panel[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:repeating-linear-gradient(45deg,transparent,transparent 10px,rgba(0,0,0,.05) 10px,rgba(0,0,0,.05) 20px)}.summary-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:40px;position:relative;z-index:2;padding-bottom:15px;border-bottom:3px solid #000}.street-title[_ngcontent-%COMP%]{font-family:Street,Pricedown,sans-serif;font-size:36px;color:#000;letter-spacing:3px;text-transform:uppercase;margin:0;text-shadow:2px 2px 0 rgba(0,0,0,.1);position:relative}.street-title[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-18px;left:0;width:100px;height:4px;background:#39ff14}.summary-icon[_ngcontent-%COMP%]{width:70px;height:70px;background:#000;border:3px solid #39ff14;display:flex;align-items:center;justify-content:center;transform:skew(-10deg);position:relative;box-shadow:6px 6px #000}.summary-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#39ff14;font-size:32px;transform:skew(10deg)}.summary-icon[_ngcontent-%COMP%]   .item-count[_ngcontent-%COMP%]{position:absolute;top:-8px;right:-8px;background:#ff9900;color:#000;width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:16px;font-weight:900;border:2px solid #000;font-family:Street,Pricedown,sans-serif;box-shadow:3px 3px #000}.summary-details[_ngcontent-%COMP%]{background:#000;padding:30px;border:3px solid #39ff14;position:relative;z-index:2;margin-bottom:40px;box-shadow:8px 8px #000}.summary-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:15px 0;color:#fff;font-family:Oswald,sans-serif;font-size:18px;letter-spacing:1px;border-bottom:1px solid #333}.summary-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.summary-row.discount[_ngcontent-%COMP%]{color:#39ff14;border-bottom:1px dashed #39ff14;font-weight:600}.summary-row.discount[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:10px}.summary-row.total[_ngcontent-%COMP%]{border-top:4px solid #39ff14;margin-top:10px;padding-top:25px;color:#39ff14;font-size:28px;font-weight:900;font-family:Street,Pricedown,sans-serif}.discount-amount[_ngcontent-%COMP%]{color:#39ff14;font-weight:900;font-size:20px}.free-badge[_ngcontent-%COMP%]{background:#39ff14;color:#000;padding:3px 12px;margin-left:10px;font-size:12px;font-weight:900;border:1px solid #000;transform:skew(-5deg);font-family:Street,Pricedown,sans-serif;display:inline-block;box-shadow:2px 2px #000}.free-shipping[_ngcontent-%COMP%]{color:#39ff14!important;font-weight:900;font-family:Street,Pricedown,sans-serif;letter-spacing:2px}.summary-divider[_ngcontent-%COMP%]{height:4px;background:repeating-linear-gradient(90deg,#ff9900,#ff9900 10px,transparent 10px,transparent 20px);margin:25px 0}.summary-note[_ngcontent-%COMP%]{background:rgba(57,255,20,.1);border-left:4px solid #39ff14;padding:15px;margin-top:20px;font-size:14px;color:#39ff14;display:flex;align-items:center;gap:10px;font-family:Oswald,sans-serif;letter-spacing:1px}.summary-note[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px}.cart-actions-modern[_ngcontent-%COMP%]{display:flex;gap:20px;justify-content:center;position:relative;z-index:2;flex-wrap:wrap;margin-top:40px}.btn-modern[_ngcontent-%COMP%]{background:#39ff14;color:#000;border:3px solid #000;padding:18px 40px;border-radius:0;font-weight:900;letter-spacing:2px;cursor:pointer;text-transform:uppercase;transition:all .3s ease;font-family:Street,Pricedown,sans-serif;transform:skew(-5deg);box-shadow:8px 8px #000;display:flex;align-items:center;gap:12px;font-size:16px;position:relative;overflow:hidden;min-width:200px;justify-content:center}.btn-modern[_ngcontent-%COMP%]:hover{background:#ff9900;transform:skew(-5deg) translate(-4px,-4px);box-shadow:12px 12px #000}.btn-modern[_ngcontent-%COMP%]:active{transform:skew(-5deg) translate(-1px,-1px);box-shadow:4px 4px #000}.btn-modern.secondary-btn[_ngcontent-%COMP%]{background:#000;color:#39ff14;border-color:#39ff14}.btn-modern.secondary-btn[_ngcontent-%COMP%]:hover{background:#111;color:#f90}.btn-modern.danger-btn[_ngcontent-%COMP%]{background:#ff3333;color:#000;border-color:#000}.btn-modern.danger-btn[_ngcontent-%COMP%]:hover{background:#ff6666}.btn-modern.checkout-btn[_ngcontent-%COMP%]{background:linear-gradient(45deg,#ff9900,#ffcc00);color:#000;border-color:#000;padding:20px 50px;font-size:18px;min-width:300px}.btn-modern.checkout-btn[_ngcontent-%COMP%]:hover{background:linear-gradient(45deg,#ffcc00,#ff9900);animation:_ngcontent-%COMP%_pulse .5s ease-in-out}.btn-modern[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px}@keyframes _ngcontent-%COMP%_pulse{0%{transform:skew(-5deg) scale(1)}50%{transform:skew(-5deg) scale(1.05)}to{transform:skew(-5deg) scale(1)}}.security-badges[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:30px;margin-top:40px;flex-wrap:wrap;position:relative;z-index:2}.security-badge[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;color:#777;font-size:14px;font-family:Oswald,sans-serif;letter-spacing:1px;padding:10px 20px;background:#000;border:2px solid #333;transform:skew(-5deg);transition:all .3s ease}.security-badge[_ngcontent-%COMP%]:hover{border-color:#39ff14;color:#39ff14;transform:skew(-5deg) translateY(-3px);box-shadow:4px 4px #000}.security-badge[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#39ff14;font-size:20px}.no-products-modern[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:600px;padding:40px}.cart-empty-state[_ngcontent-%COMP%]{text-align:center;padding:60px;background:#000;border:4px solid #39ff14;transform:skew(-5deg);box-shadow:20px 20px #00000080;max-width:600px;width:100%}.empty-cart-icon[_ngcontent-%COMP%]{position:relative;margin-bottom:30px;display:inline-block}.empty-cart-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:100px;color:#333;position:relative;z-index:2}.empty-cart-pulse[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:120px;height:120px;background:rgba(57,255,20,.2);border-radius:50%;animation:_ngcontent-%COMP%_cartPulse 2s infinite}@keyframes _ngcontent-%COMP%_cartPulse{0%{transform:translate(-50%,-50%) scale(.8);opacity:.5}50%{transform:translate(-50%,-50%) scale(1.2);opacity:.2}to{transform:translate(-50%,-50%) scale(.8);opacity:.5}}.cart-empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#39ff14;font-size:36px;margin-bottom:20px;font-family:Street,Pricedown,sans-serif;text-transform:uppercase;letter-spacing:3px;transform:skew(5deg);text-shadow:3px 3px 0 #000}.cart-empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#ccc;margin-bottom:40px;font-size:18px;font-family:Oswald,sans-serif;transform:skew(5deg);line-height:1.6;max-width:400px;margin-left:auto;margin-right:auto}.empty-cart-tagline[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:20px;margin-top:40px;flex-wrap:wrap}@media (max-width: 1024px){.cart-title[_ngcontent-%COMP%]{font-size:52px}.cart-modern-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);gap:25px;padding:30px 15px}.modern-cart-image[_ngcontent-%COMP%]{height:280px}.summary-panel[_ngcontent-%COMP%]{padding:30px}.street-title[_ngcontent-%COMP%]{font-size:30px}.cart-actions-modern[_ngcontent-%COMP%]{gap:15px}.btn-modern[_ngcontent-%COMP%]{min-width:180px;padding:15px 30px;font-size:14px}.btn-modern.checkout-btn[_ngcontent-%COMP%]{min-width:250px}}@media (max-width: 768px){.cart-title[_ngcontent-%COMP%]{font-size:42px}.cart-header[_ngcontent-%COMP%]{padding:30px 15px}.cart-modern-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:20px;padding:20px 10px}.modern-cart-image[_ngcontent-%COMP%]{height:250px}.modern-cart-content[_ngcontent-%COMP%]{padding:20px}.summary-panel[_ngcontent-%COMP%]{padding:20px;transform:skew(0)}.summary-header[_ngcontent-%COMP%]{flex-direction:column;gap:20px;text-align:center}.street-title[_ngcontent-%COMP%]{font-size:26px}.street-title[_ngcontent-%COMP%]:after{left:50%;transform:translate(-50%)}.cart-actions-modern[_ngcontent-%COMP%]{flex-direction:column}.btn-modern[_ngcontent-%COMP%]{width:100%;min-width:auto;justify-content:center;transform:skew(0)}.btn-modern[_ngcontent-%COMP%]:hover{transform:translate(-2px,-2px)}.btn-modern.checkout-btn[_ngcontent-%COMP%]{min-width:auto;order:-1}.security-badges[_ngcontent-%COMP%]{gap:15px}.shipping-progress[_ngcontent-%COMP%]{margin:20px 15px;transform:skew(0)}.progress-label[_ngcontent-%COMP%], .progress-bar[_ngcontent-%COMP%]{transform:skew(0)}}@media (max-width: 480px){.cart-title[_ngcontent-%COMP%]{font-size:32px;letter-spacing:2px}.street-tag[_ngcontent-%COMP%]{font-size:12px;padding:6px 15px}.cart-count-badge[_ngcontent-%COMP%]{font-size:14px;padding:6px 15px}.modern-product-name[_ngcontent-%COMP%]{font-size:18px}.modern-current[_ngcontent-%COMP%]{font-size:24px}.modern-original[_ngcontent-%COMP%]{font-size:16px}.street-input[_ngcontent-%COMP%]{font-size:18px;min-width:50px}.qty-btn[_ngcontent-%COMP%]{width:40px;height:40px;font-size:16px}.total-amount[_ngcontent-%COMP%]{font-size:24px}.summary-row[_ngcontent-%COMP%]{font-size:16px;padding:12px 0}.summary-row.total[_ngcontent-%COMP%]{font-size:24px}.cart-empty-state[_ngcontent-%COMP%]{padding:40px 20px}.cart-empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:28px}.empty-cart-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:80px}.empty-cart-pulse[_ngcontent-%COMP%]{width:100px;height:100px}}@keyframes _ngcontent-%COMP%_street-pulse{0%,to{box-shadow:12px 12px #000}50%{box-shadow:12px 12px #000,0 0 20px #39ff1480}}.modern-cart-item.featured[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_street-pulse 2s infinite;border-color:#f90}.cart-empty-state[_ngcontent-%COMP%]:before{content:"EMPTY";position:absolute;bottom:20px;right:20px;font-family:Street,Pricedown,sans-serif;color:#39ff141a;font-size:60px;transform:rotate(-15deg) skew(-10deg);z-index:1;pointer-events:none}.back-button[_ngcontent-%COMP%]{cursor:pointer;background:#000;border:2px solid #39ff14;padding:10px 20px;color:#39ff14;font-family:Street,Pricedown,sans-serif;letter-spacing:2px;text-transform:uppercase;transform:skew(-5deg);display:inline-flex;align-items:center;gap:10px;font-size:18px;transition:all .3s ease}.back-button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transform:skew(5deg)}.back-button[_ngcontent-%COMP%]:hover{background:#39ff14;color:#000;box-shadow:0 0 15px #39ff1466}.checkout-form-modern[_ngcontent-%COMP%]{background:linear-gradient(160deg,#e3efcd 0%,#cbdca8 100%);border:4px solid #000;transform:skew(-2deg);box-shadow:15px 15px #000;padding:30px;position:relative;overflow:hidden;margin-top:20px;z-index:2;animation:_ngcontent-%COMP%_formSlideIn .4s ease-out}.checkout-form-modern[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:repeating-linear-gradient(45deg,transparent,transparent 10px,rgba(0,0,0,.05) 10px,rgba(0,0,0,.05) 20px);z-index:-1}@keyframes _ngcontent-%COMP%_formSlideIn{0%{opacity:0;transform:skew(-2deg) translateY(30px)}to{opacity:1;transform:skew(-2deg) translateY(0)}}.form-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;padding-bottom:15px;border-bottom:3px solid #000;position:relative}.form-header[_ngcontent-%COMP%]   .street-title[_ngcontent-%COMP%]{font-family:Street,Pricedown,sans-serif;font-size:28px;color:#000;letter-spacing:2px;margin:0;display:flex;align-items:center;gap:15px}.form-header[_ngcontent-%COMP%]   .street-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#39ff14;font-size:24px;animation:_ngcontent-%COMP%_iconGlow 2s infinite alternate}@keyframes _ngcontent-%COMP%_iconGlow{0%{filter:drop-shadow(0 0 0 rgba(57,255,20,0))}to{filter:drop-shadow(0 0 8px rgba(57,255,20,.8))}}.close-form-btn[_ngcontent-%COMP%]{background:#000;border:2px solid #39ff14;color:#39ff14;width:40px;height:40px;display:flex;align-items:center;justify-content:center;cursor:pointer;transform:skew(-5deg);transition:all .3s ease;font-size:18px;box-shadow:3px 3px #000;position:relative;overflow:hidden}.close-form-btn[_ngcontent-%COMP%]:hover{background:#ff3333;color:#000;border-color:#000;transform:skew(-5deg) scale(1.1);box-shadow:5px 5px #000}.close-form-btn[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.3),transparent);transition:.5s}.close-form-btn[_ngcontent-%COMP%]:hover:before{left:100%}.form-section[_ngcontent-%COMP%]{margin-bottom:30px;padding:20px;background:#fff;border:3px solid #000;transform:skew(-1deg);box-shadow:8px 8px #0000001a;position:relative;overflow:hidden}.form-section[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;right:0;width:60px;height:60px;background:linear-gradient(45deg,transparent 40%,rgba(57,255,20,.1) 50%,transparent 60%);transform:rotate(45deg) translate(30px,-30px)}.form-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px;margin-bottom:25px;padding-bottom:10px;border-bottom:2px solid #39ff14}.form-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-family:Street,Pricedown,sans-serif;font-size:20px;color:#000;letter-spacing:2px;text-transform:uppercase;position:relative}.form-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-12px;left:0;width:40px;height:3px;background:#ff9900}.form-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#39ff14;font-size:24px;background:#000;padding:8px;border-radius:0;border:2px solid #39ff14;transform:skew(-5deg);box-shadow:3px 3px #000}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-top:20px}.form-grid[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{grid-column:1/-1}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:relative}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-family:Oswald,sans-serif;font-weight:600;color:#000;margin-bottom:8px;font-size:14px;letter-spacing:1px;display:flex;align-items:center;gap:8px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#39ff14;font-size:14px;background:#000;padding:4px;border-radius:0;border:1px solid #39ff14;transform:skew(-3deg)}.street-input[_ngcontent-%COMP%]{background:#fff;border:2px solid #000;color:#000;padding:12px 15px;font-family:Oswald,sans-serif;font-size:16px;outline:none;transform:skew(-5deg);transition:all .3s ease;box-shadow:inset 3px 3px #eee;position:relative;z-index:1}.street-input[_ngcontent-%COMP%]:focus{border-color:#39ff14;box-shadow:inset 3px 3px #eee,0 0 0 3px #39ff1433;transform:skew(-5deg) translateY(-2px)}.street-input[_ngcontent-%COMP%]::placeholder{color:#777;font-family:Oswald,sans-serif;letter-spacing:1px;font-style:italic}.street-input.error[_ngcontent-%COMP%]{border-color:#f33;background:rgba(255,51,51,.05)}.street-input.error[_ngcontent-%COMP%]:focus{box-shadow:inset 3px 3px #eee,0 0 0 3px #f333}.street-select[_ngcontent-%COMP%]{background:#fff;border:2px solid #000;color:#000;padding:12px 40px 12px 15px;font-family:Oswald,sans-serif;font-size:16px;outline:none;transform:skew(-5deg);transition:all .3s ease;cursor:pointer;box-shadow:inset 3px 3px #eee;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'16\' height=\'16\' fill=\'%2339ff14\' viewBox=\'0 0 16 16\'%3E%3Cpath d=\'M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z\'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 15px center;background-size:12px}.street-select[_ngcontent-%COMP%]:focus{border-color:#39ff14;box-shadow:inset 3px 3px #eee,0 0 0 3px #39ff1433;transform:skew(-5deg) translateY(-2px)}.street-select.error[_ngcontent-%COMP%]{border-color:#f33;background:rgba(255,51,51,.05)}.error-message[_ngcontent-%COMP%]{color:#f33;font-family:Oswald,sans-serif;font-size:12px;margin-top:5px;letter-spacing:.5px;transform:skew(5deg);display:flex;align-items:center;gap:5px}.error-message[_ngcontent-%COMP%]:before{content:"\\26a0";font-size:10px}.payment-methods[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:15px;margin-top:20px}.payment-option[_ngcontent-%COMP%]{display:block;cursor:pointer}.payment-option[_ngcontent-%COMP%]   .payment-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px;padding:15px;background:#000;border:2px solid #333;transform:skew(-5deg);transition:all .3s ease;position:relative;overflow:hidden}.payment-option[_ngcontent-%COMP%]   .payment-content[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(57,255,20,.1),transparent);transition:.5s}.payment-option[_ngcontent-%COMP%]   .payment-content[_ngcontent-%COMP%]:hover:before{left:100%}.payment-option[_ngcontent-%COMP%]:hover   .payment-content[_ngcontent-%COMP%]{border-color:#39ff14;transform:skew(-5deg) translateY(-3px);box-shadow:4px 4px #000}.payment-option.selected[_ngcontent-%COMP%]   .payment-content[_ngcontent-%COMP%]{background:#39ff14;border-color:#000;box-shadow:5px 5px #000}.payment-option.selected[_ngcontent-%COMP%]   .payment-content[_ngcontent-%COMP%]   .payment-icon[_ngcontent-%COMP%]{background:#000;border-color:#000}.payment-option.selected[_ngcontent-%COMP%]   .payment-content[_ngcontent-%COMP%]   .payment-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#39ff14}.payment-option.selected[_ngcontent-%COMP%]   .payment-content[_ngcontent-%COMP%]   .payment-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .payment-option.selected[_ngcontent-%COMP%]   .payment-content[_ngcontent-%COMP%]   .payment-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#000}.payment-option.selected[_ngcontent-%COMP%]   .payment-content[_ngcontent-%COMP%]   .payment-check[_ngcontent-%COMP%]{opacity:1;transform:skew(5deg) scale(1)}.payment-icon[_ngcontent-%COMP%]{width:50px;height:50px;background:#111;border:2px solid #39ff14;display:flex;align-items:center;justify-content:center;transform:skew(5deg);transition:all .3s ease}.payment-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#39ff14;font-size:24px;transform:skew(-5deg);transition:color .3s ease}.payment-info[_ngcontent-%COMP%]{flex:1}.payment-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-family:Street,Pricedown,sans-serif;color:#fff;margin:0 0 5px;font-size:18px;letter-spacing:1px;transition:color .3s ease}.payment-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#aaa;margin:0;font-family:Oswald,sans-serif;font-size:14px;transition:color .3s ease}.payment-check[_ngcontent-%COMP%]{width:30px;height:30px;background:#39ff14;border:2px solid #000;display:flex;align-items:center;justify-content:center;transform:skew(5deg) scale(0);opacity:0;transition:all .3s ease}.payment-check[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#000;font-size:14px;transform:skew(-5deg)}.card-details[_ngcontent-%COMP%]{margin-top:25px;padding:20px;background:rgba(0,0,0,.05);border:2px dashed #000;transform:skew(-2deg);animation:_ngcontent-%COMP%_fadeIn .5s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:skew(-2deg) translateY(10px)}to{opacity:1;transform:skew(-2deg) translateY(0)}}.terms-section[_ngcontent-%COMP%]{margin:30px 0;padding:20px;background:#000;border:2px solid #39ff14;transform:skew(-3deg);box-shadow:6px 6px #0003}.terms-checkbox[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px;cursor:pointer}.terms-checkbox[_ngcontent-%COMP%]:hover   .custom-checkbox[_ngcontent-%COMP%]{border-color:#f90;transform:skew(-5deg) scale(1.1)}.terms-checkbox[_ngcontent-%COMP%]:hover   .terms-link[_ngcontent-%COMP%]{color:#f90}.custom-checkbox[_ngcontent-%COMP%]{width:24px;height:24px;background:#111;border:2px solid #39ff14;display:flex;align-items:center;justify-content:center;transform:skew(-5deg);transition:all .3s ease;flex-shrink:0;box-shadow:2px 2px #000}.custom-checkbox[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#39ff14;font-size:14px;opacity:0;transform:skew(5deg);transition:opacity .3s ease}.custom-checkbox.checked[_ngcontent-%COMP%]{background:#39ff14;box-shadow:3px 3px #000}.custom-checkbox.checked[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{opacity:1;color:#000}.terms-text[_ngcontent-%COMP%]{color:#fff;font-family:Oswald,sans-serif;font-size:14px;letter-spacing:.5px;line-height:1.4}.terms-link[_ngcontent-%COMP%]{color:#39ff14;text-decoration:none;font-weight:600;position:relative}.terms-link[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-2px;left:0;width:0;height:1px;background:#39ff14;transition:width .3s ease}.terms-link[_ngcontent-%COMP%]:hover:after{width:100%}.form-actions[_ngcontent-%COMP%]{display:flex;gap:20px;justify-content:center;margin-top:40px}.form-actions[_ngcontent-%COMP%]   .btn-modern[_ngcontent-%COMP%]{min-width:200px;transform:skew(-5deg);transition:all .3s ease}.form-actions[_ngcontent-%COMP%]   .btn-modern[_ngcontent-%COMP%]:disabled{background:#ccc;color:#777;border-color:#999;cursor:not-allowed;box-shadow:4px 4px #999}.form-actions[_ngcontent-%COMP%]   .btn-modern[_ngcontent-%COMP%]:disabled:hover{transform:skew(-5deg);box-shadow:4px 4px #999}.order-success-notification[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:linear-gradient(160deg,#e3efcd 0%,#cbdca8 100%);border:4px solid #000;padding:40px;z-index:9999;box-shadow:20px 20px #0000004d;animation:_ngcontent-%COMP%_successSlideIn .5s ease-out;text-align:center;max-width:500px;width:90%}.order-success-notification[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:repeating-linear-gradient(45deg,transparent,transparent 10px,rgba(0,0,0,.05) 10px,rgba(0,0,0,.05) 20px)}.order-success-notification[_ngcontent-%COMP%]   .success-content[_ngcontent-%COMP%]{position:relative;z-index:2}.order-success-notification[_ngcontent-%COMP%]   .success-content[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:60px;color:#39ff14;margin-bottom:20px;animation:_ngcontent-%COMP%_successPulse 2s infinite;filter:drop-shadow(0 0 5px rgba(57,255,20,.5))}.order-success-notification[_ngcontent-%COMP%]   .success-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-family:Street,Pricedown,sans-serif;font-size:32px;color:#000;margin-bottom:15px;letter-spacing:2px;text-transform:uppercase;text-shadow:1px 1px 0 rgba(0,0,0,.1)}.order-success-notification[_ngcontent-%COMP%]   .success-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-family:Oswald,sans-serif;color:#333;margin:8px 0;font-size:16px;line-height:1.4}.order-success-notification[_ngcontent-%COMP%]   .success-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:nth-child(4){color:#39ff14;font-weight:600;background:#000;padding:5px 15px;display:inline-block;transform:skew(-5deg);margin-top:10px}@keyframes _ngcontent-%COMP%_successSlideIn{0%{opacity:0;transform:translate(-50%,-60%)}to{opacity:1;transform:translate(-50%,-50%)}}@keyframes _ngcontent-%COMP%_successPulse{0%,to{transform:scale(1);color:#39ff14}50%{transform:scale(1.1);color:#f90}}.form-loading[_ngcontent-%COMP%]{position:relative;opacity:.7}.form-loading[_ngcontent-%COMP%]:after{content:"";position:absolute;inset:0;background:rgba(255,255,255,.8);display:flex;align-items:center;justify-content:center;z-index:100}@media (max-width: 1024px){.form-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.form-actions[_ngcontent-%COMP%]   .btn-modern[_ngcontent-%COMP%]{min-width:180px;padding:15px 25px;font-size:14px}}@media (max-width: 768px){.checkout-form-modern[_ngcontent-%COMP%]{padding:20px;transform:skew(0);margin:20px 10px}.form-header[_ngcontent-%COMP%]{flex-direction:column;gap:15px;text-align:center}.form-header[_ngcontent-%COMP%]   .street-title[_ngcontent-%COMP%]{font-size:24px;justify-content:center}.form-section[_ngcontent-%COMP%]{padding:15px;transform:skew(0)}.form-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:18px}.form-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px}.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:15px}.street-input[_ngcontent-%COMP%], .street-select[_ngcontent-%COMP%]{transform:skew(0)}.street-input[_ngcontent-%COMP%]:focus, .street-select[_ngcontent-%COMP%]:focus{transform:translateY(-2px)}.payment-option[_ngcontent-%COMP%]   .payment-content[_ngcontent-%COMP%]{transform:skew(0)}.payment-option[_ngcontent-%COMP%]   .payment-content[_ngcontent-%COMP%]:hover, .payment-option[_ngcontent-%COMP%]   .payment-content.selected[_ngcontent-%COMP%]{transform:translateY(-3px)}.payment-icon[_ngcontent-%COMP%], .payment-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transform:skew(0)}.payment-check[_ngcontent-%COMP%]{transform:skew(0) scale(0)}.payment-check[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transform:skew(0)}.payment-check.selected[_ngcontent-%COMP%]   .payment-check[_ngcontent-%COMP%]{transform:scale(1)}.terms-section[_ngcontent-%COMP%], .custom-checkbox[_ngcontent-%COMP%]{transform:skew(0)}.form-actions[_ngcontent-%COMP%]{flex-direction:column;gap:15px}.form-actions[_ngcontent-%COMP%]   .btn-modern[_ngcontent-%COMP%]{width:100%;min-width:auto;transform:skew(0)}.form-actions[_ngcontent-%COMP%]   .btn-modern[_ngcontent-%COMP%]:hover{transform:translate(-2px,-2px)}.form-actions[_ngcontent-%COMP%]   .btn-modern[_ngcontent-%COMP%]:disabled:hover{transform:none}.order-success-notification[_ngcontent-%COMP%]{padding:30px 20px}.order-success-notification[_ngcontent-%COMP%]   .success-content[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:48px}.order-success-notification[_ngcontent-%COMP%]   .success-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:24px}.order-success-notification[_ngcontent-%COMP%]   .success-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}}@media (max-width: 480px){.checkout-form-modern[_ngcontent-%COMP%]{padding:15px}.form-header[_ngcontent-%COMP%]   .street-title[_ngcontent-%COMP%]{font-size:20px;flex-direction:column;gap:8px}.form-header[_ngcontent-%COMP%]   .street-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px}.form-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px}.form-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px;padding:6px}.payment-option[_ngcontent-%COMP%]   .payment-content[_ngcontent-%COMP%]{flex-direction:column;text-align:center;padding:20px 15px}.payment-info[_ngcontent-%COMP%]{text-align:center}.payment-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:16px}.payment-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px}}@media print{.checkout-form-modern[_ngcontent-%COMP%]{box-shadow:none;border:1px solid #000;transform:none}.checkout-form-modern[_ngcontent-%COMP%]:before{display:none}.btn-modern[_ngcontent-%COMP%], .close-form-btn[_ngcontent-%COMP%]{display:none}}']})}}return n})()},{path:"profile",component:(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Zi({type:n,selectors:[["app-profile"]],decls:3,vars:0,template:function(i,r){1&i&&(M(0,"p"),O(1,"profile works!"),b(),U(2,"app-bottom-nav"))},dependencies:[sl]})}}return n})()},{path:"test-3d",component:(()=>{class n{constructor(t){this.cdRef=t,this.modelPath="",this.autoRotate=!0,this.autoScale=!0,this.targetSize=5,this.backgroundColor="#000000",this.addStreetBackground=!0,this.debugMode=!0,this.model=null,this.streetBackground=null,this.animationId=0,this.isLoaded=!1,this.isLoading=!1,this.currentRotationEnabled=!0,this.debugInfo={mainModelLoaded:!1,backgroundLoaded:!1,backgroundError:"",mainModelError:"",testedPaths:[],foundPath:""},this.backgroundPaths=["assets/shoot_background__graffiti_street.glb","assets/models/shoot_background__graffiti_street.glb","assets/3d/shoot_background__graffiti_street.glb","assets/backgrounds/shoot_background__graffiti_street.glb","assets/textures/shoot_background__graffiti_street.glb","/assets/shoot_background__graffiti_street.glb","./assets/shoot_background__graffiti_street.glb","shoot_background__graffiti_street.glb"],this.showDebugPanel=!0,this.manualPath="assets/shoot_background__graffiti_street.glb"}ngOnInit(){this.currentRotationEnabled=this.autoRotate,console.log("\u{1f3ae} TestViewerComponent initialis\xe9 - FORCEMENT du fond de rue!"),console.log("\u{1f4cd} Chemins \xe0 tester:",this.backgroundPaths)}ngAfterViewInit(){setTimeout(()=>{this.initThreeJS(),this.loadModel(),this.animate()},100)}ngOnDestroy(){this.animationId&&cancelAnimationFrame(this.animationId),this.renderer&&this.renderer.dispose()}initThreeJS(){try{const t=this.canvasRef.nativeElement,i=t.clientWidth||400,r=t.clientHeight||400;console.log("\u{1f680} Initialisation ThreeJS:",{width:i,height:r}),this.scene=new eM,this.scene.background=new xe(0),this.camera=new jn(45,i/r,.1,1e3),this.camera.position.set(0,2,10),this.renderer=new z2({canvas:t,antialias:!0,alpha:!1}),this.renderer.setSize(i,r),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.renderer.outputColorSpace=vn,this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=2,this.setupLighting(),console.log("\u2705 ThreeJS initialis\xe9 avec succ\xe8s")}catch(t){console.error("\u274c Erreur ThreeJS:",t)}}setupLighting(){const t=new UM(16777215,.8);this.scene.add(t);const i=new jl(16777215,1.2);i.position.set(10,20,15),i.castShadow=!0,this.scene.add(i);const r=new jl(16777215,.5);r.position.set(-10,10,-10),this.scene.add(r)}loadModel(){var t=this;return ki(function*(){t.isLoading=!0,console.log("\u{1f4e6} D\xe9but du chargement - FORCEMENT du fond de rue!");try{console.log("\u{1f3d9}\ufe0f FORCEMENT du chargement du fond de rue..."),yield t.loadStreetBackground(),t.modelPath?yield t.loadMainModel():t.createPlaceholder(),t.isLoaded=!0,t.isLoading=!1,t.cdRef.detectChanges(),console.log("\u{1f389} Chargement termin\xe9"),t.printDebugInfo()}catch(i){console.error("\u{1f4a5} Erreur:",i),t.isLoading=!1,t.cdRef.detectChanges()}})()}loadStreetBackground(){var t=this;return ki(function*(){console.log("\u{1f50d} Recherche du fichier shoot_background__graffiti_street.glb..."),t.debugInfo.testedPaths=[],t.debugInfo.foundPath="",t.debugInfo.backgroundLoaded=!1;for(const i of t.backgroundPaths)if(console.log(`\u{1f50e} Test du chemin: ${i}`),t.debugInfo.testedPaths.push(i),yield t.tryLoadGLB(i))return t.debugInfo.foundPath=i,t.debugInfo.backgroundLoaded=!0,void console.log(`\u2705 FOND TROUV\xc9 ET CHARG\xc9: ${i}`);console.warn("\u26a0\ufe0f Aucun chemin valide trouv\xe9 pour le fond"),t.debugInfo.backgroundError="Fichier non trouv\xe9",t.createDefaultBackground()})()}tryLoadGLB(t){return new Promise(i=>{(new X2).load(t,o=>{console.log(`\u{1f389} SUCC\xc8S: Fichier trouv\xe9 \xe0 ${t}`),console.log("\u{1f4e6} Contenu du GLB:",o),this.streetBackground=o.scene,this.streetBackground.position.set(0,-2,-15),this.streetBackground.scale.set(3,3,3),this.streetBackground.traverse(s=>{s instanceof Gt&&(s.castShadow=!0,s.receiveShadow=!0)}),this.scene.add(this.streetBackground),this.camera.position.set(0,3,10),this.camera.lookAt(0,0,-10),i(!0)},o=>{if(o.lengthComputable){const s=(o.loaded/o.total*100).toFixed(1);console.log(`\u{1f4e5} ${t}: ${s}%`)}},o=>{console.log(`\u274c ${t}: ${onmessage||"Non trouv\xe9"}`),i(!1)}),setTimeout(()=>{console.log(`\u23f1\ufe0f Timeout pour ${t}`),i(!1)},3e3)})}createDefaultBackground(){console.log("\u{1f3a8} Cr\xe9ation d'un fond par d\xe9faut");const t=new Hs(100,100),i=new Co({color:3355443,roughness:.9}),r=new Gt(t,i);r.rotation.x=-Math.PI/2,r.position.y=-5,r.receiveShadow=!0,this.scene.add(r);const o=new Hs(80,40),s=new Co({color:16777215*Math.random()}),a=new Gt(o,s);a.position.z=-30,a.position.y=15,this.scene.add(a),console.log("\u2705 Fond par d\xe9faut cr\xe9\xe9")}loadMainModel(){var t=this;return ki(function*(){console.log("\u{1f3af} Chargement du mod\xe8le principal:",t.modelPath)})()}createPlaceholder(){const t=new Bs(2,3,2),i=new Co({color:16724838,roughness:.4}),r=new Gt(t,i);r.position.set(0,0,0),r.castShadow=!0,this.scene.add(r),this.model=r,this.debugInfo.mainModelLoaded=!0,console.log("\u2705 Placeholder cr\xe9\xe9")}testManualPath(){var t=this;return ki(function*(){console.log(`\u{1f9ea} Test manuel du chemin: ${t.manualPath}`),t.streetBackground&&(t.scene.remove(t.streetBackground),t.streetBackground=null),(yield t.tryLoadGLB(t.manualPath))?(t.debugInfo.foundPath=t.manualPath,t.debugInfo.backgroundLoaded=!0,alert(`\u2705 FOND CHARG\xc9: ${t.manualPath}`)):alert(`\u274c FOND NON TROUV\xc9: ${t.manualPath}`),t.cdRef.detectChanges()})()}checkAssetStructure(){console.log("\u{1f4c1} Structure des assets attendue:"),console.log("src/assets/"),console.log("\u251c\u2500\u2500 shoot_background__graffiti_street.glb"),console.log("\u251c\u2500\u2500 models/"),console.log("\u2502   \u2514\u2500\u2500 vos-modeles.glb"),console.log("\u2514\u2500\u2500 ..."),this.testAssetPaths()}testAssetPaths(){var t=this;return ki(function*(){console.log("\u{1f50d} Test HTTP des chemins...");for(const i of t.backgroundPaths)try{const r=yield fetch(i,{method:"HEAD"});console.log(`${r.ok?"\u2705":"\u274c"} ${i}: ${r.status} ${r.statusText}`)}catch{console.log(`\u274c ${i}: ${onmessage||"Erreur inconnue"}`)}})()}printDebugInfo(){console.log("=== \u{1f4ca} DEBUG INFO ==="),console.log("\xc9tat du chargement:",this.debugInfo),console.log("Objets dans la sc\xe8ne:",this.scene.children.length),this.scene.children.forEach((t,i)=>{console.log(`  ${i}. ${t.constructor.name} "${t.name||"sans nom"}"`)}),console.log("====================")}animate(){this.animationId=requestAnimationFrame(()=>this.animate()),this.renderer.render(this.scene,this.camera)}static{this.\u0275fac=function(i){return new(i||n)(te(Xc))}}static{this.\u0275cmp=Zi({type:n,selectors:[["app-test-viewer"]],viewQuery:function(i,r){if(1&i&&ep(Iee,5),2&i){let o;td(o=nd())&&(r.canvasRef=o.first)}},inputs:{modelPath:"modelPath",autoRotate:"autoRotate",autoScale:"autoScale",targetSize:"targetSize",backgroundColor:"backgroundColor",debugMode:"debugMode"},standalone:!0,features:[q0],decls:6,vars:3,consts:[[1,"test-viewer-container"],[1,"model-canvas"],["canvas",""],["class","loading-overlay",4,"ngIf"],["class","debug-panel",4,"ngIf"],["class","toggle-debug-btn",3,"click",4,"ngIf"],[1,"loading-overlay"],[1,"loading-spinner"],[1,"loading-text"],[1,"loading-subtext"],[1,"debug-panel"],[1,"debug-header"],[1,"close-btn",3,"click"],[1,"debug-section"],[1,"debug-status"],[1,"status-icon"],[1,"status-text"],["class","debug-path",4,"ngIf"],["class","debug-error",4,"ngIf"],[1,"path-input"],["type","text","placeholder","Chemin du fichier .glb",1,"path-field",3,"ngModel","ngModelChange"],[1,"test-btn",3,"click"],[1,"suggested-paths"],[4,"ngFor","ngForOf"],[1,"asset-btn",3,"click"],[1,"debug-info"],[1,"info-text"],[1,"debug-path"],[1,"debug-error"],[3,"click"],[1,"toggle-debug-btn",3,"click"]],template:function(i,r){1&i&&(M(0,"div",0),U(1,"canvas",1,2),ie(3,Ree,6,0,"div",3),ie(4,kee,38,10,"div",4),ie(5,Uee,2,0,"button",5),b()),2&i&&(L(3),J("ngIf",r.isLoading),L(1),J("ngIf",r.isLoaded&&r.showDebugPanel),L(1),J("ngIf",!r.showDebugPanel))},dependencies:[yA,Ps,jo,i3,Zl,am,mm],styles:[".test-viewer-container[_ngcontent-%COMP%]{width:100%;height:500px;position:relative;background:#000;overflow:hidden;border-radius:8px;border:2px solid #39ff14;box-shadow:0 0 20px #39ff144d}.model-canvas[_ngcontent-%COMP%]{width:100%!important;height:100%!important;display:block}.loading-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.95);z-index:10;flex-direction:column;gap:20px;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.loading-spinner[_ngcontent-%COMP%]{width:60px;height:60px;border:4px solid rgba(57,255,20,.2);border-top:4px solid #39ff14;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.loading-text[_ngcontent-%COMP%]{color:#39ff14;font-size:18px;font-weight:700;text-transform:uppercase;letter-spacing:2px;font-family:Courier New,monospace}.loading-subtext[_ngcontent-%COMP%]{color:#888;font-size:12px;font-family:Courier New,monospace;margin-top:10px}.debug-panel[_ngcontent-%COMP%]{position:absolute;top:20px;left:20px;background:rgba(0,0,0,.9);border:2px solid #39ff14;border-radius:10px;padding:15px;width:350px;z-index:5;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);box-shadow:0 5px 20px #00000080}.debug-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;padding-bottom:10px;border-bottom:1px solid rgba(57,255,20,.3)}.debug-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#39ff14;margin:0;font-size:14px}.close-btn[_ngcontent-%COMP%]{background:none;border:none;color:#39ff14;font-size:20px;cursor:pointer;padding:0;width:24px;height:24px;display:flex;align-items:center;justify-content:center;border-radius:50%}.close-btn[_ngcontent-%COMP%]:hover{background:rgba(57,255,20,.2)}.debug-section[_ngcontent-%COMP%]{margin-bottom:20px}.debug-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#fff;margin:0 0 10px;font-size:13px;display:flex;align-items:center;gap:8px}.debug-status[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:8px 12px;background:rgba(255,255,255,.1);border-radius:6px;margin-bottom:10px}.debug-status.success[_ngcontent-%COMP%]{background:rgba(57,255,20,.1);border-left:3px solid #39ff14}.debug-status[_ngcontent-%COMP%]:not(.success){background:rgba(255,51,102,.1);border-left:3px solid #ff3366}.status-icon[_ngcontent-%COMP%]{font-size:16px}.status-text[_ngcontent-%COMP%]{color:#fff;font-weight:700;font-size:12px}.debug-path[_ngcontent-%COMP%], .debug-error[_ngcontent-%COMP%]{padding:8px 12px;background:rgba(255,255,255,.05);border-radius:6px;margin-top:8px;font-size:11px;font-family:Courier New,monospace}.debug-path[_ngcontent-%COMP%]{color:#39ff14}.debug-error[_ngcontent-%COMP%]{color:#f36}.path-input[_ngcontent-%COMP%]{display:flex;gap:8px;margin-bottom:10px}.path-field[_ngcontent-%COMP%]{flex:1;padding:8px 12px;background:rgba(255,255,255,.1);border:1px solid rgba(57,255,20,.3);border-radius:6px;color:#fff;font-size:12px;font-family:Courier New,monospace}.path-field[_ngcontent-%COMP%]:focus{outline:none;border-color:#39ff14}.test-btn[_ngcontent-%COMP%]{padding:8px 16px;background:#39ff14;color:#000;border:none;border-radius:6px;font-weight:700;font-size:12px;cursor:pointer;transition:all .3s}.test-btn[_ngcontent-%COMP%]:hover{background:#2cd50d;transform:translateY(-1px)}.suggested-paths[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{color:#888;margin:10px 0 8px;font-size:11px;text-transform:uppercase}.suggested-paths[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;max-height:150px;overflow-y:auto}.suggested-paths[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:4px}.suggested-paths[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{display:block;padding:6px 10px;background:rgba(255,255,255,.05);border-radius:4px;color:#888;font-size:10px;font-family:Courier New,monospace;cursor:pointer;transition:all .2s}.suggested-paths[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]:hover{background:rgba(57,255,20,.1);color:#39ff14}.asset-btn[_ngcontent-%COMP%]{width:100%;padding:10px;background:rgba(0,170,255,.2);color:#0af;border:1px solid #00aaff;border-radius:6px;cursor:pointer;font-size:12px;font-weight:700;transition:all .3s}.asset-btn[_ngcontent-%COMP%]:hover{background:rgba(0,170,255,.3)}.debug-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:15px;padding-top:10px;border-top:1px solid rgba(255,255,255,.1)}.info-text[_ngcontent-%COMP%]{color:#888;font-size:11px;font-family:Courier New,monospace}.toggle-debug-btn[_ngcontent-%COMP%]{position:absolute;top:20px;left:20px;padding:8px 16px;background:rgba(0,0,0,.8);color:#39ff14;border:1px solid #39ff14;border-radius:6px;cursor:pointer;font-size:12px;font-weight:700;z-index:5;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px)}.toggle-debug-btn[_ngcontent-%COMP%]:hover{background:rgba(57,255,20,.1)}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.debug-panel[_ngcontent-%COMP%]{width:300px;left:10px;top:10px}.test-viewer-container[_ngcontent-%COMP%]{height:400px}}@media (max-width: 480px){.debug-panel[_ngcontent-%COMP%]{width:calc(100% - 20px);left:10px;right:10px}.test-viewer-container[_ngcontent-%COMP%]{height:300px}}"]})}}return n})()},{path:"mod",component:_f},{path:"**",redirectTo:""}];let Vee=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Rr({type:n})}static{this.\u0275inj=fr({imports:[KO.forRoot(Bee),KO]})}}return n})(),zee=(()=>{class n{constructor(){this.introFinished=new Cn}ngOnInit(){setTimeout(()=>{this.introFinished.emit()},5e3)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Zi({type:n,selectors:[["app-intro"]],outputs:{introFinished:"introFinished"},decls:14,vars:0,consts:[[1,"intro-container"],[1,"intro-background"],[1,"sky"],[1,"grid"],[1,"horizon"],[1,"intro-text"],[1,"gta-title"],[1,"intro-subtitle"],[1,"loading-container"],[1,"fas","fa-compact-disc","spinning-icon"],[1,"loading-text"]],template:function(i,r){1&i&&(M(0,"div",0)(1,"div",1),U(2,"div",2)(3,"div",3)(4,"div",4),b(),M(5,"div",5)(6,"h1",6),O(7,"FREEPPING"),b(),M(8,"div",7),O(9,"LOADING STORY MODEe..."),b()(),M(10,"div",8),U(11,"i",9),M(12,"span",10),O(13,"LOADING"),b()()())},styles:[".intro-container[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:#000;display:flex;justify-content:center;align-items:center;z-index:10000;font-family:Pricedown;overflow:hidden;perspective:1000px}.intro-background[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1;overflow:hidden;background:linear-gradient(to bottom,#0f0c29,#302b63,#24243e)}.sky[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:50%;background:linear-gradient(to bottom,#000000 0%,#1a0b2e 100%);z-index:1}.grid[_ngcontent-%COMP%]{position:absolute;bottom:-50%;left:-50%;width:200%;height:100%;background-image:linear-gradient(rgba(57,255,20,.3) 1px,transparent 1px),linear-gradient(90deg,rgba(57,255,20,.3) 1px,transparent 1px);background-size:50px 50px;background-position:center bottom;transform:rotateX(60deg);transform-origin:50% 0;animation:_ngcontent-%COMP%_gridMove 2s infinite linear;box-shadow:0 0 100px #39ff1433;z-index:2;mask-image:linear-gradient(to bottom,transparent 0%,black 40%);-webkit-mask-image:linear-gradient(to bottom,transparent 0%,black 40%)}.horizon[_ngcontent-%COMP%]{position:absolute;top:50%;left:0;width:100%;height:2px;background:#39ff14;box-shadow:0 0 20px #39ff14,0 0 40px #39ff14;z-index:3}@keyframes _ngcontent-%COMP%_gridMove{0%{background-position:center 0}to{background-position:center 50px}}.intro-text[_ngcontent-%COMP%]{z-index:10;text-align:center;margin-top:-50px}.gta-title[_ngcontent-%COMP%]{font-size:15vw;color:#fff;text-transform:uppercase;position:relative;letter-spacing:5px;margin:0;text-shadow:1px 1px 0px #000,2px 2px 0px #000,3px 3px 0px #000,4px 4px 0px #000,-1px -1px 0 #000,1px -1px 0 #000;animation:_ngcontent-%COMP%_gtaTitleEnter 5s cubic-bezier(.25,.46,.45,.94) forwards}.intro-subtitle[_ngcontent-%COMP%]{font-family:Oswald,sans-serif;color:#39ff14;font-size:1.5rem;letter-spacing:4px;margin-top:10px;text-transform:uppercase;text-shadow:0 0 10px rgba(57,255,20,.5);animation:_ngcontent-%COMP%_pulse 1.5s infinite ease-in-out}@keyframes _ngcontent-%COMP%_gtaTitleEnter{0%{transform:scale(.5);opacity:0}20%{transform:scale(1);opacity:1}90%{transform:scale(1.05);opacity:1}to{transform:scale(1.2);opacity:0}}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:.6}50%{opacity:1}}.loading-container[_ngcontent-%COMP%]{position:absolute;bottom:40px;right:40px;display:flex;align-items:center;gap:15px;z-index:20}.spinning-icon[_ngcontent-%COMP%]{font-size:50px;color:#39ff14;animation:_ngcontent-%COMP%_spinIcon 2s linear infinite;filter:drop-shadow(0 0 5px rgba(57,255,20,.5))}.loading-text[_ngcontent-%COMP%]{font-family:Pricedown,Impact,sans-serif;color:#fff;font-size:28px;letter-spacing:2px;text-shadow:2px 2px 0 #000}@keyframes _ngcontent-%COMP%_spinIcon{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]})}}return n})();function Hee(n,e){if(1&n){const t=tn();M(0,"app-intro",2),ge("introFinished",function(){return qe(t),Xe(Q().showIntro=!1)}),b()}}function Gee(n,e){1&n&&U(0,"i",24),2&n&&bt("active",e.$implicit.active)}function jee(n,e){if(1&n&&(M(0,"div",20)(1,"div",21),ie(2,Gee,1,2,"i",22),b(),M(3,"div",23),O(4,"WANTED"),b()()),2&n){const t=Q(2);L(2),J("ngForOf",t.getWantedStars())}}function Wee(n,e){if(1&n){const t=tn();sa(0),U(1,"div",3)(2,"div",4),M(3,"div",5)(4,"button",6),ge("click",function(){return qe(t),Xe(Q().toggleAmbience())}),U(5,"i",7),b(),M(6,"div",8),U(7,"div",9),M(8,"div",10),O(9,"N"),b()(),M(10,"div",11)(11,"div",12),U(12,"div",13),M(13,"div",14),O(14,"HEALTH"),b()(),M(15,"div",15),U(16,"div",13),M(17,"div",14),O(18,"ARMOR"),b()()(),M(19,"div",16),U(20,"i",17),M(21,"span"),O(22),Qu(23,"number"),b()(),ie(24,jee,5,1,"div",18),b(),M(25,"div",19),U(26,"router-outlet"),b(),aa()}if(2&n){const t=Q();L(1),lo("opacity",t.isCursorActive?"1":"0"),L(1),lo("opacity",t.isCursorActive?"1":"0"),L(3),bt("fa-volume-up",t.isAmbiencePlaying)("fa-volume-mute",!t.isAmbiencePlaying),L(7),lo("width",t.health,"%"),L(4),lo("width",t.armor,"%"),L(6),Ye("$",UE(23,14,t.money),""),L(2),J("ngIf",t.wantedLevel>0)}}let $ee=(()=>{class n{constructor(t,i){this.renderer=t,this.router=i,this.title="FREPPING",this.showIntro=!0,this.health=100,this.armor=75,this.money=24500,this.wantedLevel=0,this.isAiming=!1,this.mouseX=0,this.mouseY=0,this.cursorTypes={default:"gta-default",pointer:"gta-pointer",grab:"gta-grab",aiming:"gta-aiming",loading:"gta-loading"},this.currentCursor="gta-default",this.ambienceAudio=null,this.audioInitialized=!1,this.isCursorActive=!0,this.isAmbiencePlaying=!1,this.isManuallyPaused=!1,this.routerSubscription=this.router.events.subscribe(r=>{r instanceof Wo&&(window.scrollTo({top:0,behavior:"smooth"}),console.log("Navigation completed, attempting to play ambience..."),setTimeout(()=>{this.attemptAutoplay()},500))})}ngOnInit(){this.initializeGTAMode(),this.startUIAnimations(),this.initializeAudio()}ngOnDestroy(){this.routerSubscription&&this.routerSubscription.unsubscribe(),this.ambienceAudio&&(this.ambienceAudio.pause(),this.ambienceAudio=null)}initializeAudio(){this.ambienceAudio=new Audio,this.ambienceAudio.src="assets/sounds/gta-ambience.mp3",this.ambienceAudio.loop=!0,this.ambienceAudio.volume=.1,this.ambienceAudio.preload="auto",this.ambienceAudio.addEventListener("playing",()=>{this.isAmbiencePlaying=!0,console.log("Ambience started playing")}),this.ambienceAudio.addEventListener("pause",()=>{this.isAmbiencePlaying=!1,console.log("Ambience paused")}),this.ambienceAudio.addEventListener("canplaythrough",()=>{this.audioInitialized=!0,console.log("Audio ready to play")})}attemptAutoplay(){!this.isManuallyPaused&&this.ambienceAudio&&this.audioInitialized&&this.playGTAAmbience()}onMouseMove(t){this.mouseX=t.clientX,this.mouseY=t.clientY,this.updateCursorPosition(),this.isCursorActive=!0,clearTimeout(this.cursorHideTimeout),this.cursorHideTimeout=setTimeout(()=>{this.isCursorActive=!1},3e3),this.checkAimingState(t),!this.isManuallyPaused&&this.ambienceAudio&&this.ambienceAudio.paused&&(Math.abs(t.movementX)>5||Math.abs(t.movementY)>5)&&this.playGTAAmbience()}toggleAmbience(){this.ambienceAudio||this.initializeAudio(),this.ambienceAudio.paused?this.playGTAAmbience().then(()=>{this.isManuallyPaused=!1}).catch(t=>{console.error("Failed to unmute ambience:",t),this.isManuallyPaused=!1}):(this.ambienceAudio.pause(),this.isManuallyPaused=!0)}onClick(t){this.playClickSound(),this.showClickEffect(t),this.isManuallyPaused||this.playGTAAmbience()}playGTAAmbience(){var t=this;return ki(function*(){if(t.ambienceAudio||t.initializeAudio(),t.ambienceAudio&&t.ambienceAudio.paused)try{yield t.ambienceAudio.play(),console.log("Ambience playback started successfully")}catch(i){console.warn("Autoplay blocked by browser:",i),t.showAutoplayHint()}})()}showAutoplayHint(){const t=this.renderer.createElement("div");this.renderer.addClass(t,"gta-autoplay-hint"),this.renderer.setStyle(t,"position","fixed"),this.renderer.setStyle(t,"bottom","20px"),this.renderer.setStyle(t,"left","50%"),this.renderer.setStyle(t,"transform","translateX(-50%)"),this.renderer.setStyle(t,"background","rgba(0, 0, 0, 0.8)"),this.renderer.setStyle(t,"color","#fff"),this.renderer.setStyle(t,"padding","10px 20px"),this.renderer.setStyle(t,"border-radius","5px"),this.renderer.setStyle(t,"font-family",'"Arial", sans-serif'),this.renderer.setStyle(t,"font-size","14px"),this.renderer.setStyle(t,"z-index","9999"),this.renderer.setStyle(t,"border","1px solid #f1c40f");const i=this.renderer.createText("Click anywhere or use the music button to enable sound");this.renderer.appendChild(t,i),this.renderer.appendChild(document.body,t),setTimeout(()=>{document.body.contains(t)&&this.renderer.removeChild(document.body,t)},5e3)}onKeyDown(t){("ShiftRight"===t.code||"ControlRight"===t.code)&&(this.isAiming=!0,this.setCursor(this.cursorTypes.aiming)),"Tab"===t.code&&this.toggleWantedLevel()}onKeyUp(t){("ShiftRight"===t.code||"ControlRight"===t.code)&&(this.isAiming=!1,this.setCursor(this.cursorTypes.default))}onMouseOver(t){const i=t.target;"BUTTON"===i.tagName||i.closest("button")||"A"===i.tagName||i.closest("a")?this.setCursor(this.cursorTypes.pointer):i.classList.contains("draggable")||i.closest(".draggable")?this.setCursor(this.cursorTypes.grab):this.setCursor(this.cursorTypes.default)}initializeGTAMode(){this.renderer.setStyle(document.body,"cursor","none"),this.showLoadingEffect()}setCursor(t){this.currentCursor=t;const i=document.getElementById("gtaCursor");i&&(Object.values(this.cursorTypes).forEach(r=>{this.renderer.removeClass(i,r)}),this.renderer.addClass(i,t))}updateCursorPosition(){const t=document.getElementById("gtaCursor"),i=document.getElementById("gtaAim");t&&(this.renderer.setStyle(t,"left",`${this.mouseX}px`),this.renderer.setStyle(t,"top",`${this.mouseY}px`)),i&&this.isAiming&&(this.renderer.setStyle(i,"left",`${this.mouseX}px`),this.renderer.setStyle(i,"top",`${this.mouseY}px`))}checkAimingState(t){2===t.buttons?(this.isAiming=!0,this.setCursor(this.cursorTypes.aiming)):(this.isAiming=!1,this.currentCursor===this.cursorTypes.aiming&&this.setCursor(this.cursorTypes.default))}toggleWantedLevel(){this.wantedLevel=5===this.wantedLevel?0:this.wantedLevel+1,this.wantedLevel>0&&this.playSirenSound()}getWantedStars(){const t=[];for(let i=1;i<=5;i++)t.push({active:i<=this.wantedLevel});return t}playClickSound(){const t=new Audio;t.src="assets/sounds/gtaclick.wav",t.volume=.3,t.play().catch(()=>{console.log("\x07")})}playSirenSound(){const t=new Audio;t.src="assets/sounds/police-siren.mp3",t.volume=.2,t.play().catch(i=>console.log("Siren audio error:",i))}showLoadingEffect(){this.setCursor(this.cursorTypes.loading),setTimeout(()=>{this.setCursor(this.cursorTypes.default)},1500)}showClickEffect(t){const i=this.renderer.createElement("div");this.renderer.addClass(i,"gta-click-effect"),this.renderer.setStyle(i,"left",`${t.clientX}px`),this.renderer.setStyle(i,"top",`${t.clientY}px`),this.renderer.appendChild(document.body,i),setTimeout(()=>{this.renderer.removeChild(document.body,i)},600)}startUIAnimations(){setInterval(()=>{this.health<100&&(this.health+=.1),this.armor<100&&(this.armor+=.05)},1e3)}static{this.\u0275fac=function(i){return new(i||n)(te(oo),te(Xn))}}static{this.\u0275cmp=Zi({type:n,selectors:[["app-root"]],hostBindings:function(i,r){1&i&&ge("mousemove",function(s){return r.onMouseMove(s)},0,h0)("click",function(s){return r.onClick(s)},!1,h0)("keydown",function(s){return r.onKeyDown(s)},!1,Nu)("keyup",function(s){return r.onKeyUp(s)},!1,Nu)("mouseover",function(s){return r.onMouseOver(s)})},decls:2,vars:2,consts:[[3,"introFinished",4,"ngIf"],[4,"ngIf"],[3,"introFinished"],["id","gtaCursor",1,"gta-cursor"],["id","gtaAim",1,"gta-aim-crosshair"],[1,"gta-ui-overlay"],[1,"gta-music-toggle",3,"click"],[1,"fas"],[1,"gta-radar"],[1,"radar-center"],[1,"radar-north"],[1,"gta-stats"],[1,"stat","health"],[1,"stat-bar"],[1,"stat-label"],[1,"stat","armor"],[1,"gta-money"],[1,"fas","fa-money-bill-wave"],["class","gta-wanted",4,"ngIf"],[1,"app-container"],[1,"gta-wanted"],[1,"wanted-stars"],["class","fas fa-star wanted-star",3,"active",4,"ngFor","ngForOf"],[1,"wanted-label"],[1,"fas","fa-star","wanted-star"]],template:function(i,r){1&i&&(ie(0,Hee,1,0,"app-intro",0),ie(1,Wee,27,16,"ng-container",1)),2&i&&(J("ngIf",r.showIntro),L(1),J("ngIf",!r.showIntro))},dependencies:[Ps,jo,px,zee,xA],styles:['@font-face{font-family:Pricedown;src:url(/assets/fonts/Pricedown.otf) format("opentype");font-weight:400;font-style:normal;font-display:swap}.gta-title[_ngcontent-%COMP%]{font-family:Pricedown,sans-serif;font-size:5rem;color:#000;text-shadow:2px 2px 4px #000000;text-align:center;margin-top:2rem}body[_ngcontent-%COMP%]{font-family:Poppins,sans-serif;background-color:#0b0f0c;color:#f5f5f5;overflow-x:hidden}.btn[_ngcontent-%COMP%]{padding:14px 28px;font-weight:700;letter-spacing:1px;cursor:pointer;border:none;border-radius:4px;transition:all .3s;font-size:16px;text-transform:uppercase}.btn-primary[_ngcontent-%COMP%]{background:#39ff14;color:#000}.btn-primary[_ngcontent-%COMP%]:hover{background:#2ee000;transform:translateY(-2px);box-shadow:0 5px 15px #39ff144d}.btn-outline[_ngcontent-%COMP%]{background:transparent;border:2px solid #39ff14;color:#39ff14}.btn-outline[_ngcontent-%COMP%]:hover{background:rgba(57,255,20,.1)}.btn-orange[_ngcontent-%COMP%]{background:#ff9900;color:#000}.btn-orange[_ngcontent-%COMP%]:hover{background:#e68900}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}.pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s infinite}[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#111}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#39ff14;border-radius:4px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#2ee000}[_nghost-%COMP%]{cursor:none!important}.gta-cursor[_ngcontent-%COMP%]{position:fixed;width:24px;height:24px;pointer-events:none;z-index:999999;transition:transform .1s ease,opacity .3s ease;transform:translate(-50%,-50%)}.gta-cursor[_ngcontent-%COMP%]:before{content:"";position:absolute;width:100%;height:100%;border:2px solid #39ff14;border-radius:50%;box-shadow:0 0 10px #39ff14;animation:_ngcontent-%COMP%_cursor-pulse 2s infinite}.gta-cursor[_ngcontent-%COMP%]:after{content:"";position:absolute;top:50%;left:50%;width:6px;height:6px;background:#39ff14;border-radius:50%;transform:translate(-50%,-50%);box-shadow:0 0 8px #39ff14}.gta-cursor.gta-pointer[_ngcontent-%COMP%]:before{border-color:#f90;box-shadow:0 0 10px #f90}.gta-cursor.gta-pointer[_ngcontent-%COMP%]:after{background:#ff9900;box-shadow:0 0 8px #f90;transform:translate(-50%,-50%) scale(1.3)}.gta-cursor.gta-grab[_ngcontent-%COMP%]:before{border-color:#00a8ff;box-shadow:0 0 10px #00a8ff;transform:rotate(45deg)}.gta-cursor.gta-grab[_ngcontent-%COMP%]:after{background:#00a8ff;box-shadow:0 0 8px #00a8ff}.gta-cursor.gta-aiming[_ngcontent-%COMP%]{opacity:0}.gta-cursor.gta-loading[_ngcontent-%COMP%]:before{animation:_ngcontent-%COMP%_cursor-loading 1s linear infinite;border-top-color:#f90;border-right-color:#39ff14;border-bottom-color:#f33;border-left-color:#00a8ff}.gta-aim-crosshair[_ngcontent-%COMP%]{position:fixed;width:32px;height:32px;pointer-events:none;z-index:999998;opacity:0;transform:translate(-50%,-50%);transition:opacity .2s ease}.gta-aim-crosshair.active[_ngcontent-%COMP%]{opacity:1}.gta-aim-crosshair[_ngcontent-%COMP%]:before, .gta-aim-crosshair[_ngcontent-%COMP%]:after{content:"";position:absolute;background:#ff3333;box-shadow:0 0 5px #f33}.gta-aim-crosshair[_ngcontent-%COMP%]:before{width:100%;height:2px;top:50%;transform:translateY(-50%)}.gta-aim-crosshair[_ngcontent-%COMP%]:after{width:2px;height:100%;left:50%;transform:translate(-50%)}.gta-ui-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;pointer-events:none;z-index:9999;font-family:Street,Pricedown,sans-serif}.gta-ui-overlay[_ngcontent-%COMP%]   .gta-music-toggle[_ngcontent-%COMP%]{position:absolute;bottom:40px;right:40px;width:60px;height:60px;background:rgba(0,0,0,.8);border:3px solid #ff9900;border-radius:50%;color:#f90;font-size:24px;display:flex;justify-content:center;align-items:center;cursor:pointer;pointer-events:auto;box-shadow:0 0 10px #00000080;transition:all .2s ease;z-index:10000}.gta-ui-overlay[_ngcontent-%COMP%]   .gta-music-toggle[_ngcontent-%COMP%]:hover{background:rgba(255,153,0,.2);box-shadow:0 0 20px #f90;transform:scale(1.1)}.gta-ui-overlay[_ngcontent-%COMP%]   .gta-radar[_ngcontent-%COMP%]{position:absolute;top:20px;right:20px;width:120px;height:120px;background:rgba(0,0,0,.7);border:3px solid #39ff14;border-radius:50%;overflow:hidden}.gta-ui-overlay[_ngcontent-%COMP%]   .gta-radar[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:conic-gradient(from 0deg,rgba(57,255,20,.3),transparent 30%,transparent 70%,rgba(57,255,20,.3) 100%);animation:_ngcontent-%COMP%_radar-scan 4s linear infinite}.gta-ui-overlay[_ngcontent-%COMP%]   .gta-radar[_ngcontent-%COMP%]   .radar-center[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:6px;height:6px;background:#39ff14;border-radius:50%;transform:translate(-50%,-50%);box-shadow:0 0 10px #39ff14}.gta-ui-overlay[_ngcontent-%COMP%]   .gta-radar[_ngcontent-%COMP%]   .radar-north[_ngcontent-%COMP%]{position:absolute;top:10px;left:50%;transform:translate(-50%);color:#39ff14;font-size:14px;font-weight:700;text-shadow:0 0 5px #39ff14}.gta-ui-overlay[_ngcontent-%COMP%]   .gta-stats[_ngcontent-%COMP%]{position:absolute;bottom:100px;left:20px;width:200px}.gta-ui-overlay[_ngcontent-%COMP%]   .gta-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{margin-bottom:15px;position:relative}.gta-ui-overlay[_ngcontent-%COMP%]   .gta-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .stat-bar[_ngcontent-%COMP%]{height:20px;background:linear-gradient(90deg,#ff3333,#ff9900);border:2px solid #000;box-shadow:3px 3px #00000080;position:relative;overflow:hidden}.gta-ui-overlay[_ngcontent-%COMP%]   .gta-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .stat-bar[_ngcontent-%COMP%]:after{content:"";position:absolute;inset:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.3),transparent);animation:_ngcontent-%COMP%_stat-pulse 2s infinite}.gta-ui-overlay[_ngcontent-%COMP%]   .gta-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{position:absolute;top:-20px;left:0;color:#39ff14;font-size:12px;text-transform:uppercase;letter-spacing:2px;text-shadow:1px 1px 0 #000}.gta-ui-overlay[_ngcontent-%COMP%]   .gta-stats[_ngcontent-%COMP%]   .stat.armor[_ngcontent-%COMP%]   .stat-bar[_ngcontent-%COMP%]{background:linear-gradient(90deg,#00a8ff,#0097e6)}.gta-ui-overlay[_ngcontent-%COMP%]   .gta-money[_ngcontent-%COMP%]{position:absolute;top:20px;left:20px;background:rgba(0,0,0,.8);border:2px solid #ff9900;padding:10px 15px;color:#f90;font-size:20px;font-weight:700;text-shadow:2px 2px 0 #000;box-shadow:5px 5px #00000080;display:flex;align-items:center;gap:10px;transform:skew(-5deg)}.gta-ui-overlay[_ngcontent-%COMP%]   .gta-money[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px;animation:_ngcontent-%COMP%_money-glow 3s infinite}.gta-ui-overlay[_ngcontent-%COMP%]   .gta-wanted[_ngcontent-%COMP%]{position:absolute;top:80px;left:20px;background:rgba(0,0,0,.8);border:2px solid #ff3333;padding:10px;transform:skew(-5deg)}.gta-ui-overlay[_ngcontent-%COMP%]   .gta-wanted[_ngcontent-%COMP%]   .wanted-stars[_ngcontent-%COMP%]{display:flex;gap:8px;margin-bottom:5px}.gta-ui-overlay[_ngcontent-%COMP%]   .gta-wanted[_ngcontent-%COMP%]   .wanted-stars[_ngcontent-%COMP%]   .wanted-star[_ngcontent-%COMP%]{color:#777;font-size:18px;transition:all .3s ease}.gta-ui-overlay[_ngcontent-%COMP%]   .gta-wanted[_ngcontent-%COMP%]   .wanted-stars[_ngcontent-%COMP%]   .wanted-star.active[_ngcontent-%COMP%]{color:#f33;text-shadow:0 0 10px #ff3333;animation:_ngcontent-%COMP%_star-blink 1s infinite}.gta-ui-overlay[_ngcontent-%COMP%]   .gta-wanted[_ngcontent-%COMP%]   .wanted-label[_ngcontent-%COMP%]{color:#fff;font-size:12px;text-transform:uppercase;letter-spacing:2px;text-align:center;font-family:Oswald,sans-serif}.gta-click-effect[_ngcontent-%COMP%]{position:fixed;width:40px;height:40px;border:2px solid #39ff14;border-radius:50%;pointer-events:none;z-index:9999999;transform:translate(-50%,-50%) scale(0);animation:_ngcontent-%COMP%_click-ripple .6s ease-out}.gta-click-effect[_ngcontent-%COMP%]:before{content:"";position:absolute;top:50%;left:50%;width:10px;height:10px;background:#39ff14;border-radius:50%;transform:translate(-50%,-50%);box-shadow:0 0 10px #39ff14}@keyframes _ngcontent-%COMP%_cursor-pulse{0%,to{transform:scale(1);opacity:1}50%{transform:scale(1.1);opacity:.8}}@keyframes _ngcontent-%COMP%_cursor-loading{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_radar-scan{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_stat-pulse{0%{transform:translate(-100%)}to{transform:translate(100%)}}@keyframes _ngcontent-%COMP%_money-glow{0%,to{filter:drop-shadow(0 0 5px #ff9900)}50%{filter:drop-shadow(0 0 10px #ff9900)}}@keyframes _ngcontent-%COMP%_star-blink{0%,to{opacity:1}50%{opacity:.5}}@keyframes _ngcontent-%COMP%_click-ripple{0%{transform:translate(-50%,-50%) scale(0);opacity:1}to{transform:translate(-50%,-50%) scale(2);opacity:0}}body[_ngcontent-%COMP%]{cursor:none!important}body[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], body[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], body[_ngcontent-%COMP%]   [role=button][_ngcontent-%COMP%], body[_ngcontent-%COMP%]   .clickable[_ngcontent-%COMP%]{position:relative}body[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:after, body[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:after, body[_ngcontent-%COMP%]   [role=button][_ngcontent-%COMP%]:hover:after, body[_ngcontent-%COMP%]   .clickable[_ngcontent-%COMP%]:hover:after{content:"";position:absolute;inset:-5px;border:2px solid #39ff14;border-radius:4px;pointer-events:none;animation:_ngcontent-%COMP%_button-glow 1.5s infinite}@keyframes _ngcontent-%COMP%_button-glow{0%,to{box-shadow:0 0 10px #39ff1480}50%{box-shadow:0 0 20px #39ff14cc}}@media (max-width: 768px){.gta-ui-overlay[_ngcontent-%COMP%]   .gta-radar[_ngcontent-%COMP%]{width:80px;height:80px;top:10px;right:10px}.gta-ui-overlay[_ngcontent-%COMP%]   .gta-stats[_ngcontent-%COMP%]{bottom:80px;left:10px;width:150px}.gta-ui-overlay[_ngcontent-%COMP%]   .gta-money[_ngcontent-%COMP%]{top:10px;left:10px;padding:8px 12px;font-size:16px}.gta-ui-overlay[_ngcontent-%COMP%]   .gta-wanted[_ngcontent-%COMP%]{top:60px;left:10px}.gta-cursor[_ngcontent-%COMP%]{width:20px;height:20px}}body[_nghost-%COMP%], body   [_nghost-%COMP%]{-webkit-user-select:none;user-select:none}']})}}return n})(),qee=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Rr({type:n,bootstrap:[$ee]})}static{this.\u0275inj=fr({imports:[T6,Vee,i3,oQ]})}}return n})();P6().bootstrapModule(qee).catch(n=>console.error(n))}},en=>{en(en.s=934)}]);